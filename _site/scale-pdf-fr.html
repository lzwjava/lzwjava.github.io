<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Mise à l'échelle du contenu PDF pour l'impression</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Mise à l’échelle du contenu PDF pour l’impression | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Mise à l’échelle du contenu PDF pour l’impression" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="fr" />
<meta name="description" content="J’ai besoin d’imprimer des documents, et j’ai remarqué que l’espace blanc autour du contenu est souvent trop grand, ce qui gaspille du papier et rend le texte plus petit qu’il ne devrait l’être. Ce script aide à redimensionner automatiquement le contenu du PDF pour mieux l’adapter à la page en détectant la zone de contenu et en la redimensionnant pour remplir la page, tout en respectant une petite marge." />
<meta property="og:description" content="J’ai besoin d’imprimer des documents, et j’ai remarqué que l’espace blanc autour du contenu est souvent trop grand, ce qui gaspille du papier et rend le texte plus petit qu’il ne devrait l’être. Ce script aide à redimensionner automatiquement le contenu du PDF pour mieux l’adapter à la page en détectant la zone de contenu et en la redimensionnant pour remplir la page, tout en respectant une petite marge." />
<link rel="canonical" href="https://lzwjava.github.io/scale-pdf-fr" />
<meta property="og:url" content="https://lzwjava.github.io/scale-pdf-fr" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-18T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Mise à l’échelle du contenu PDF pour l’impression" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2025-01-18T00:00:00+08:00","datePublished":"2025-01-18T00:00:00+08:00","description":"J’ai besoin d’imprimer des documents, et j’ai remarqué que l’espace blanc autour du contenu est souvent trop grand, ce qui gaspille du papier et rend le texte plus petit qu’il ne devrait l’être. Ce script aide à redimensionner automatiquement le contenu du PDF pour mieux l’adapter à la page en détectant la zone de contenu et en la redimensionnant pour remplir la page, tout en respectant une petite marge.","headline":"Mise à l’échelle du contenu PDF pour l’impression","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/scale-pdf-fr"},"url":"https://lzwjava.github.io/scale-pdf-fr"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=e1ee5b6988366cf809e509b29458ffc05ab1c92c">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=e1ee5b6988366cf809e509b29458ffc05ab1c92c" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Mise à l'échelle du contenu PDF pour l'impression | Original, traduit par l'IA
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/fr/2025-01-18-scale-pdf-fr.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsfr2025-01-18-scale-pdf-fr.md</span> -->
      

      <!-- <span>2025-01-18-scale-pdf-fr.md</span> -->

      
        

        
          
          <a href="#" class="button">2025.01</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/scale-pdf-en" >English</option>
        <option value="/scale-pdf-zh" >中文</option>
        <option value="/scale-pdf-ja" >日本語</option>
        <option value="/scale-pdf-es" >Español</option>
        <option value="/scale-pdf-hi" >हिंदी</option>
        <option value="/scale-pdf-fr" selected>Français</option>
        <option value="/scale-pdf-de" >Deutsch</option>
        <option value="/scale-pdf-ar" >العربية</option>
        <option value="/scale-pdf-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>J’ai besoin d’imprimer des documents, et j’ai remarqué que l’espace blanc autour du contenu est souvent trop grand, ce qui gaspille du papier et rend le texte plus petit qu’il ne devrait l’être. Ce script aide à redimensionner automatiquement le contenu du PDF pour mieux l’adapter à la page en détectant la zone de contenu et en la redimensionnant pour remplir la page, tout en respectant une petite marge.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">pdf2image</span> <span class="kn">import</span> <span class="n">convert_from_path</span>

<span class="n">MARGIN_PERCENT</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">DPI</span> <span class="o">=</span> <span class="mi">72</span>

<span class="k">def</span> <span class="nf">convert_pixels_to_points</span><span class="p">(</span><span class="n">pixels</span><span class="p">,</span> <span class="n">dpi</span><span class="p">):</span>
    <span class="s">"""Convertit les pixels en points."""</span>
    <span class="k">return</span> <span class="n">pixels</span> <span class="o">*</span> <span class="mi">72</span> <span class="o">/</span> <span class="n">dpi</span>

<span class="k">def</span> <span class="nf">get_image_dimensions</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="s">"""Obtient les dimensions de l'image en pixels et en points."""</span>
    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">image</span><span class="p">.</span><span class="n">size</span>
    <span class="n">dpi</span> <span class="o">=</span> <span class="n">image</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'dpi'</span><span class="p">,</span> <span class="p">(</span><span class="n">DPI</span><span class="p">,</span> <span class="n">DPI</span><span class="p">))</span>
    <span class="n">width_points</span> <span class="o">=</span> <span class="n">convert_pixels_to_points</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">dpi</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">height_points</span> <span class="o">=</span> <span class="n">convert_pixels_to_points</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">dpi</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width_points</span><span class="p">,</span> <span class="n">height_points</span><span class="p">,</span> <span class="n">dpi</span>

<span class="k">def</span> <span class="nf">analyze_whitespace</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
    <span class="s">"""Analyse l'espace blanc pour trouver la boîte englobante du contenu."""</span>
    <span class="n">left_margin_px</span> <span class="o">=</span> <span class="n">width</span>
    <span class="n">right_margin_px</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">top_margin_px</span> <span class="o">=</span> <span class="n">height</span>
    <span class="n">bottom_margin_px</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">found_content</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">):</span>
            <span class="n">pixel</span> <span class="o">=</span> <span class="n">image</span><span class="p">.</span><span class="n">getpixel</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pixel</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="mi">250</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">pixel</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">found_content</span><span class="p">:</span>
                        <span class="n">left_margin_px</span> <span class="o">=</span> <span class="n">x</span>
                        <span class="n">top_margin_px</span> <span class="o">=</span> <span class="n">y</span>
                        <span class="n">found_content</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">right_margin_px</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">right_margin_px</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
                    <span class="n">bottom_margin_px</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bottom_margin_px</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">pixel</span> <span class="o">&lt;</span> <span class="mi">250</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">found_content</span><span class="p">:</span>
                    <span class="n">left_margin_px</span> <span class="o">=</span> <span class="n">x</span>
                    <span class="n">top_margin_px</span> <span class="o">=</span> <span class="n">y</span>
                    <span class="n">found_content</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="n">right_margin_px</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">right_margin_px</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
                <span class="n">bottom_margin_px</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bottom_margin_px</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">found_content</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
    
    <span class="n">right_margin_px</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="n">right_margin_px</span>
    <span class="n">bottom_margin_px</span> <span class="o">=</span> <span class="n">height</span> <span class="o">-</span> <span class="n">bottom_margin_px</span>
    <span class="k">return</span> <span class="n">left_margin_px</span><span class="p">,</span> <span class="n">right_margin_px</span><span class="p">,</span> <span class="n">top_margin_px</span><span class="p">,</span> <span class="n">bottom_margin_px</span>

<span class="k">def</span> <span class="nf">calculate_scale_factor</span><span class="p">(</span><span class="n">input_pdf</span><span class="p">):</span>
    <span class="s">"""
    Détecte les dimensions de la première page d'un PDF, analyse l'espace blanc,
    et calcule le facteur d'échelle en fonction du contenu du PDF et des dimensions cibles A4 avec marges.
    Retourne le facteur d'échelle ou None si une erreur survient.
    """</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Calcul du facteur d'échelle pour : </span><span class="si">{</span><span class="n">input_pdf</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">images</span> <span class="o">=</span> <span class="n">convert_from_path</span><span class="p">(</span><span class="n">input_pdf</span><span class="p">,</span> <span class="n">first_page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">last_page</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">images</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"  Impossible de convertir le PDF en image."</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
        
        <span class="n">image</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width_points</span><span class="p">,</span> <span class="n">height_points</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="n">get_image_dimensions</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        
        <span class="n">margins</span> <span class="o">=</span> <span class="n">analyze_whitespace</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">margins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"  Impossible de déterminer la boîte englobante du contenu."</span><span class="p">)</span>
            <span class="n">left_margin_points</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">right_margin_points</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">top_margin_points</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">bottom_margin_points</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">left_margin_px</span><span class="p">,</span> <span class="n">right_margin_px</span><span class="p">,</span> <span class="n">top_margin_px</span><span class="p">,</span> <span class="n">bottom_margin_px</span> <span class="o">=</span> <span class="n">margins</span>
            <span class="n">content_width_px</span> <span class="o">=</span> <span class="n">right_margin_px</span> <span class="o">-</span> <span class="n">left_margin_px</span>
            <span class="n">content_height_px</span> <span class="o">=</span> <span class="n">bottom_margin_px</span> <span class="o">-</span> <span class="n">top_margin_px</span>
            
            <span class="n">left_margin_points</span> <span class="o">=</span> <span class="n">convert_pixels_to_points</span><span class="p">(</span><span class="n">left_margin_px</span><span class="p">,</span> <span class="n">dpi</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">right_margin_points</span> <span class="o">=</span> <span class="n">convert_pixels_to_points</span><span class="p">(</span><span class="n">right_margin_px</span><span class="p">,</span> <span class="n">dpi</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">top_margin_points</span> <span class="o">=</span> <span class="n">convert_pixels_to_points</span><span class="p">(</span><span class="n">top_margin_px</span><span class="p">,</span> <span class="n">dpi</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">bottom_margin_points</span> <span class="o">=</span> <span class="n">convert_pixels_to_points</span><span class="p">(</span><span class="n">bottom_margin_px</span><span class="p">,</span> <span class="n">dpi</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Boîte de contenu : gauche=</span><span class="si">{</span><span class="n">left_margin_px</span><span class="si">}</span><span class="s">, haut=</span><span class="si">{</span><span class="n">top_margin_px</span><span class="si">}</span><span class="s">, droite=</span><span class="si">{</span><span class="n">right_margin_px</span><span class="si">}</span><span class="s">, bas=</span><span class="si">{</span><span class="n">bottom_margin_px</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Dimensions du contenu (pixels) : largeur=</span><span class="si">{</span><span class="n">content_width_px</span><span class="si">}</span><span class="s">, hauteur=</span><span class="si">{</span><span class="n">content_height_px</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Marges (points) : gauche=</span><span class="si">{</span><span class="n">left_margin_points</span><span class="si">}</span><span class="s">, droite=</span><span class="si">{</span><span class="n">right_margin_points</span><span class="si">}</span><span class="s">, haut=</span><span class="si">{</span><span class="n">top_margin_points</span><span class="si">}</span><span class="s">, bas=</span><span class="si">{</span><span class="n">bottom_margin_points</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Dimensions détectées : largeur=</span><span class="si">{</span><span class="n">width_points</span><span class="si">}</span><span class="s">, hauteur=</span><span class="si">{</span><span class="n">height_points</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

        <span class="n">width_margin_points</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">left_margin_points</span><span class="p">,</span> <span class="n">right_margin_points</span><span class="p">)</span>
        <span class="n">height_margin_points</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">top_margin_points</span><span class="p">,</span> <span class="n">bottom_margin_points</span><span class="p">)</span>        
        
        <span class="n">content_width</span> <span class="o">=</span> <span class="n">width_points</span> <span class="o">-</span> <span class="n">width_margin_points</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="n">content_height</span> <span class="o">=</span> <span class="n">height_points</span> <span class="o">-</span> <span class="n">height_margin_points</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="n">target_width</span> <span class="o">=</span> <span class="n">width_points</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">MARGIN_PERCENT</span><span class="p">)</span>
        <span class="n">target_height</span> <span class="o">=</span> <span class="n">height_points</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">MARGIN_PERCENT</span><span class="p">)</span>

        <span class="n">width_scale</span> <span class="o">=</span> <span class="n">target_width</span> <span class="o">/</span> <span class="n">content_width</span>
        <span class="n">height_scale</span> <span class="o">=</span> <span class="n">target_height</span> <span class="o">/</span> <span class="n">content_height</span>

        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Dimensions du contenu (points) : largeur=</span><span class="si">{</span><span class="n">content_width</span><span class="si">}</span><span class="s">, hauteur=</span><span class="si">{</span><span class="n">content_height</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">content_width</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">content_height</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Erreur : Impossible de déterminer les dimensions du contenu."</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
        
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Dimensions cibles : largeur=</span><span class="si">{</span><span class="n">target_width</span><span class="si">}</span><span class="s">, hauteur=</span><span class="si">{</span><span class="n">target_height</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Facteur d'échelle calculé en largeur : </span><span class="si">{</span><span class="n">width_scale</span><span class="si">}</span><span class="s">, en hauteur : </span><span class="si">{</span><span class="n">height_scale</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="n">scale_factor</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">width_scale</span><span class="p">,</span> <span class="n">height_scale</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Facteur d'échelle final : </span><span class="si">{</span><span class="n">scale_factor</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">scale_factor</span>

    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Erreur lors de l'obtention des dimensions du PDF ou du calcul du facteur d'échelle : </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">scale_pdf</span><span class="p">(</span><span class="n">input_pdf</span><span class="p">,</span> <span class="n">output_pdf</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">):</span>
    <span class="s">"""Redimensionne un PDF en utilisant pdfjam."""</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Redimensionnement de </span><span class="si">{</span><span class="n">input_pdf</span><span class="si">}</span><span class="s"> vers </span><span class="si">{</span><span class="n">output_pdf</span><span class="si">}</span><span class="s"> avec un facteur d'échelle : </span><span class="si">{</span><span class="n">scale_factor</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s">"pdfjam"</span><span class="p">,</span>
                <span class="s">"--scale"</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">scale_factor</span><span class="p">),</span>
                <span class="n">input_pdf</span><span class="p">,</span>
                <span class="s">"--outfile"</span><span class="p">,</span>
                <span class="n">output_pdf</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Redimensionnement réussi de </span><span class="si">{</span><span class="n">input_pdf</span><span class="si">}</span><span class="s"> vers </span><span class="si">{</span><span class="n">output_pdf</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Erreur lors du redimensionnement du PDF : </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Erreur : Commande pdfjam introuvable. Veuillez vous assurer qu'elle est installée et dans le PATH de votre système."</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Utilisation : python scale-pdf.py &lt;input_pdf&gt; &lt;output_pdf&gt;"</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">input_pdf</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">output_pdf</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"PDF d'entrée : </span><span class="si">{</span><span class="n">input_pdf</span><span class="si">}</span><span class="s">, PDF de sortie : </span><span class="si">{</span><span class="n">output_pdf</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">input_pdf</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Erreur : Fichier PDF d'entrée introuvable : </span><span class="si">{</span><span class="n">input_pdf</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">scale_factor</span> <span class="o">=</span> <span class="n">calculate_scale_factor</span><span class="p">(</span><span class="n">input_pdf</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">scale_factor</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">scale_pdf</span><span class="p">(</span><span class="n">input_pdf</span><span class="p">,</span> <span class="n">output_pdf</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span>

</code></pre></div></div>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-fr" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
