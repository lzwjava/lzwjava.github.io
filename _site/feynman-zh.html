<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>mathjax2mobiï¼šå°†MathJax HTMLè½¬æ¢ä¸ºç”µå­ä¹¦</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>mathjax2mobiï¼šå°†MathJax HTMLè½¬æ¢ä¸ºç”µå­ä¹¦ | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="mathjax2mobiï¼šå°†MathJax HTMLè½¬æ¢ä¸ºç”µå­ä¹¦" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="zh" />
<meta name="description" content="é¡¹ç›®ç®€ä»‹" />
<meta property="og:description" content="é¡¹ç›®ç®€ä»‹" />
<link rel="canonical" href="https://lzwjava.github.io/feynman-zh" />
<meta property="og:url" content="https://lzwjava.github.io/feynman-zh" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-15T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="mathjax2mobiï¼šå°†MathJax HTMLè½¬æ¢ä¸ºç”µå­ä¹¦" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2021-03-15T00:00:00+08:00","datePublished":"2021-03-15T00:00:00+08:00","description":"é¡¹ç›®ç®€ä»‹","headline":"mathjax2mobiï¼šå°†MathJax HTMLè½¬æ¢ä¸ºç”µå­ä¹¦","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/feynman-zh"},"url":"https://lzwjava.github.io/feynman-zh"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=e6a8987d65efea74b6be8d6bcc520a1beee7a3e1">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=e6a8987d65efea74b6be8d6bcc520a1beee7a3e1" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       mathjax2mobiï¼šå°†MathJax HTMLè½¬æ¢ä¸ºç”µå­ä¹¦ | åŸåˆ›
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/zh/2021-03-15-feynman-zh.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postszh2021-03-15-feynman-zh.md</span> -->
      

      <!-- <span>2021-03-15-feynman-zh.md</span> -->

      
        

        
          
          <a href="#" class="button">2021.03</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/feynman-en" >English</option>
        <option value="/feynman-zh" selected>ä¸­æ–‡</option>
        <option value="/feynman-ja" >æ—¥æœ¬èª</option>
        <option value="/feynman-es" >EspaÃ±ol</option>
        <option value="/feynman-hi" >à¤¹à¤¿à¤‚à¤¦à¥€</option>
        <option value="/feynman-fr" >FranÃ§ais</option>
        <option value="/feynman-de" >Deutsch</option>
        <option value="/feynman-ar" >Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
        <option value="/feynman-hant" >ç¹é«”ä¸­æ–‡</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <h3 id="é¡¹ç›®ç®€ä»‹">é¡¹ç›®ç®€ä»‹</h3>

<p>å…ˆå¤§è‡´è®²è®²é¡¹ç›®æƒ…å†µã€‚</p>

<p><img src="assets/images/feynman/feynman_online.jpg" alt="feynman_online" /></p>

<p><img src="/assets/images/feynman/change.JPG" alt="change" style="zoom:50%;" /></p>

<p><img src="assets/images/feynman/latex.JPG" alt="latex" /></p>

<p><img src="assets/images/feynman/epub_black.JPG" alt="epub_black" /></p>

<p><img src="assets/images/feynman/epub_beautiful.JPG" alt="epub_beautiful" /></p>

<p>åšå®Œé¡¹ç›®åï¼Œæœ‰ç‚¹å¼€å¿ƒã€‚å†™ä¸‹äº†è¿™æ ·ä¸€æ®µè¯ã€‚</p>

<p>å†™äº†ä¸€å¤©ä»£ç ï¼Œç»ˆäºå¾—åˆ°äº†æ¼‚äº®çš„è´¹æ›¼ç‰©ç†è®²ä¹‰ç”µå­ä¹¦ï¼è´¹æ›¼ç‰©ç†è®²ä¹‰å…¬å¼€åœ¨ç½‘ä¸Šï¼Œæ˜¯ç”¨<code class="language-plaintext highlighter-rouge">latex</code>æ¸²æŸ“çš„ã€‚äººä»¬å¸¸ç”¨<code class="language-plaintext highlighter-rouge">latex</code>æ¥å†™è®ºæ–‡ï¼Œå®ƒå¯¹æ•°å­¦å…¬å¼çš„æ¸²æŸ“å¾ˆæ£’ã€‚è€Œå…¬å¼€åœ¨ç½‘ä¸Šï¼Œç”¨åˆ°äº†<code class="language-plaintext highlighter-rouge">mathjax</code>è¿™ä¸ªåº“ã€‚å®ƒæŠŠ<code class="language-plaintext highlighter-rouge">latex</code>æºç å˜æˆäº†<code class="language-plaintext highlighter-rouge">html</code>ä»£ç ï¼Œç”Ÿæˆäº†å¾ˆå¤šçš„<code class="language-plaintext highlighter-rouge">div</code>å’Œ<code class="language-plaintext highlighter-rouge">span</code>æ ‡ç­¾ã€‚ç”µå­ä¹¦å´ä¸æ”¯æŒè¿™ç§æ–¹å¼ã€‚è¿™æ—¶ï¼Œæƒ³æ³•æ˜¯æŠ“å–ç½‘é¡µï¼Œé€†å‘<code class="language-plaintext highlighter-rouge">mathjax</code>æ¸²æŸ“ï¼Œæ¥ç€æ›¿æ¢æˆ<code class="language-plaintext highlighter-rouge">svg</code>å›¾ç‰‡ã€‚å‡ºç°äº†æŒºå¤šé—®é¢˜ï¼Œä¸€ä¸ªæ˜¯æºç æœ‰å¾ˆå¤šçš„<code class="language-plaintext highlighter-rouge">latex</code>è‡ªå®šä¹‰å®ï¼Œéœ€è¦åŠ ä¸Šï¼›ç¬¬äºŒä¸ªæ˜¯å†…åµŒå¾ˆå¤š<code class="language-plaintext highlighter-rouge">svg</code>ä¼šæœ‰é—®é¢˜ã€‚å¦‚æœæ˜¯å•ä¸ª<code class="language-plaintext highlighter-rouge">svg</code>å€’æ²¡é—®é¢˜ï¼Œå¾ˆå¤šçš„æ—¶å€™ä¼šå‡ºç°é—®é¢˜ã€‚å¤§æ¦‚æ˜¯æµè§ˆå™¨å’Œ<code class="language-plaintext highlighter-rouge">svg</code>çš„è¯¡å¼‚Bugã€‚è¿™æ—¶åªè¦æŠŠ<code class="language-plaintext highlighter-rouge">svg</code>ä¿å­˜ä¸ºæ–‡ä»¶ï¼Œç”¨<code class="language-plaintext highlighter-rouge">img</code>æ ‡ç­¾å¼•å…¥è¿›æ¥å³å¯ã€‚å…¬å¼ä¹Ÿåˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯æ–‡æœ¬ä¸­é—´çš„å…¬å¼ï¼Œä¸€ç§æ˜¯å•è¡Œçš„å…¬å¼ã€‚æ‰€ä»¥ï¼Œæœ€åå°±å¾—åˆ°äº†æ¼‚äº®çš„ç”µå­ä¹¦ï¼</p>

<h3 id="æŸ¥è¯¢çš„èµ„æ–™">æŸ¥è¯¢çš„èµ„æ–™</h3>

<p>è¿™é‡Œè®°å½•äº†è§£å†³é¡¹ç›®è¿‡ç¨‹ä¸­è®¿é—®çš„èµ„æ–™ã€‚å› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ•™ç¨‹ï¼Œæ‰€ä»¥å‘å­¦ç”Ÿå±•ç¤ºä¸€ä¸‹å¤§æ¦‚åšä¸€ä¸ªé¡¹ç›®æ˜¯æ€ä¹ˆæ ·çš„ä½“éªŒã€‚</p>

<p><img src="assets/images/feynman/s1.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s2.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s3.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s4.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s5.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s6.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s7.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s8.PNG" alt="" /></p>

<h3 id="å¼€å§‹é¡¹ç›®">å¼€å§‹é¡¹ç›®</h3>

<p>è´¹æ›¼ç‰©ç†è®²ä¹‰å·²ç»åœ¨å…¬å¼€åœ¨ç½‘ä¸Šå¯ä»¥é˜…è¯»ã€‚æˆ‘æƒ³åœ¨<code class="language-plaintext highlighter-rouge">Kindle</code>ä¸Šçœ‹å®ƒã€‚ç„¶è€Œå› ä¸ºå®ƒæœ‰æŒºå¤šçš„æ•°å­¦å…¬å¼ã€‚å®ƒæœ€åˆçš„ç¨¿å­åº”è¯¥æ˜¯ç”¨<code class="language-plaintext highlighter-rouge">latex</code>åšçš„ã€‚å®ƒç”¨<code class="language-plaintext highlighter-rouge">mathjax</code>è¿™ä¸ªåº“æ¥æŠŠ<code class="language-plaintext highlighter-rouge">latex</code>æ ¼å¼çš„å†…å®¹æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Šã€‚</p>

<p>ä¸¾ä¸ªä¾‹å­ã€‚</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax_Preview"</span> <span class="na">style=</span><span class="s">"color: inherit; display: none;"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"MathJax_Display"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax MathJax_FullWidth"</span> <span class="na">id=</span><span class="s">"MathJax-Element-10-Frame"</span> <span class="na">tabindex=</span><span class="s">"0"</span> <span class="na">style=</span><span class="s">""</span><span class="nt">&gt;</span>
              <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"mi"</span> <span class="na">id=</span><span class="s">"MathJax-Span-159"</span> <span class="na">style=</span><span class="s">"font-family: MathJax_Math-italic;"</span><span class="nt">&gt;</span>d<span class="nt">&lt;span</span> <span class="na">style=</span><span class="s">"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;/span&gt;</span>  
    <span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"math/tex; mode=display"</span> <span class="na">id=</span><span class="s">"MathJax-Element-10"</span><span class="nt">&gt;</span><span class="err">\</span><span class="nx">begin</span><span class="p">{</span><span class="nx">equation</span><span class="p">}</span>
<span class="err">\</span><span class="nx">label</span><span class="p">{</span><span class="nl">Eq</span><span class="p">:</span><span class="nl">I</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">3</span><span class="p">}</span>
<span class="nx">dT</span><span class="o">/</span><span class="nx">dt</span> <span class="o">=</span> <span class="nx">Fv</span><span class="p">.</span>
<span class="err">\</span><span class="nx">end</span><span class="p">{</span><span class="nx">equation</span><span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>ä¸Šé¢æ˜¯æˆªå–çš„ä¸€æ®µ<code class="language-plaintext highlighter-rouge">html</code>ä»£ç ã€‚è¿™ä¸€å—<code class="language-plaintext highlighter-rouge">html</code>ä»£ç ä¸­ã€‚<code class="language-plaintext highlighter-rouge">script</code>æ ‡ç­¾ä¸‹æ˜¯<code class="language-plaintext highlighter-rouge">latex</code>çš„åŸæ ·æ–‡æœ¬ã€‚<code class="language-plaintext highlighter-rouge">mathjax</code>æŠŠå®ƒå˜æˆå¾ˆå¤šçš„<code class="language-plaintext highlighter-rouge">span</code>ã€‚æ¥æ˜¾ç¤ºå®ƒã€‚</p>

<p>æˆ‘ä»¬ç°åœ¨æœ‰ä¸ªæ€è·¯ã€‚å°±æ˜¯æŠŠ<code class="language-plaintext highlighter-rouge">mathjax</code>çš„æ˜¾ç¤ºæ–¹æ³•æ”¹æˆ<code class="language-plaintext highlighter-rouge">svg</code>å›¾ç‰‡ã€‚</p>

<p>ä» GitHub ä¸Šæ‰¾åˆ°ä¸€ä¸ªé¡¹ç›®<code class="language-plaintext highlighter-rouge">tuxu/latex2svg</code>ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">latex2svg</span> <span class="kn">import</span> <span class="n">latex2svg</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">latex2svg</span><span class="p">(</span><span class="sa">r</span><span class="s">'\( e^{i \pi} + 1 = 0 \)'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'depth'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">])</span>
</code></pre></div></div>

<p>è¯•ç€è¿è¡Œï¼Œä½†å‡ºé”™äº†ã€‚</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    raise RuntimeError<span class="o">(</span><span class="s1">'latex not found'</span><span class="o">)</span>
RuntimeError: latex not found
</code></pre></div></div>

<p>çœ‹çœ‹ä»£ç ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1"># Run LaTeX and create DVI file
</span>    <span class="k">try</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">shlex</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s">'latex_cmd'</span><span class="p">]</span><span class="o">+</span><span class="s">' code.tex'</span><span class="p">),</span>
                             <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span>
                             <span class="n">cwd</span><span class="o">=</span><span class="n">working_directory</span><span class="p">)</span>
        <span class="n">ret</span><span class="p">.</span><span class="n">check_returncode</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">RuntimeError</span><span class="p">(</span><span class="s">'latex not found'</span><span class="p">)</span>
</code></pre></div></div>

<p>åŸæ¥è¿™ä¹Ÿä¾èµ–äº<code class="language-plaintext highlighter-rouge">latex</code>å‘½ä»¤ã€‚</p>

<p>å®‰è£…ä¸€ä¸‹ã€‚</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew <span class="nb">install</span> <span class="nt">--cask</span> mactex
<span class="o">==&gt;</span> Caveats
You must restart your terminal window <span class="k">for </span>the installation of MacTex CLI tools to take effect.
Alternatively, Bash and Zsh <span class="nb">users </span>can run the <span class="nb">command</span>:
  <span class="nb">eval</span> <span class="s2">"</span><span class="si">$(</span>/usr/libexec/path_helper<span class="si">)</span><span class="s2">"</span>
<span class="o">==&gt;</span> Downloading http://mirror.ctan.org/systems/mac/mactex/mactex-20200407.pkg
<span class="o">==&gt;</span> Downloading from https://mirrors.aliyun.com/CTAN/systems/mac/mactex/mactex-20200407.pkg
<span class="c">######################################################################## 100.0%</span>
All formula dependencies satisfied.
<span class="o">==&gt;</span> Installing Cask mactex
<span class="o">==&gt;</span> Running installer <span class="k">for </span>mactex<span class="p">;</span> your password may be necessary.
installer: Package name is MacTeX
installer: choices changes file <span class="s1">'/private/tmp/choices20210315-4643-5884ro.xml'</span> applied
installer: Installing at base path /
installer: The <span class="nb">install </span>was successful.
ğŸº  mactex was successfully installed!
</code></pre></div></div>

<p>å®‰è£…æˆåŠŸã€‚</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% latex
This is pdfTeX, Version 3.14159265-2.6-1.40.21 <span class="o">(</span>TeX Live 2020<span class="o">)</span> <span class="o">(</span>preloaded <span class="nv">format</span><span class="o">=</span>latex<span class="o">)</span>
 restricted <span class="se">\w</span>rite18 enabled.
<span class="k">**</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">out</span> <span class="o">=</span> <span class="n">latex2svg</span><span class="p">(</span><span class="sa">r</span><span class="s">'\( e^{i \pi} + 1 = 0 \)'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'depth'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">])</span>

<span class="n">svg</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'1.svg'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
<span class="n">svg</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">])</span>
<span class="n">svg</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>å¯ä»¥ç”Ÿæˆ<code class="language-plaintext highlighter-rouge">svg</code>äº†ã€‚</p>

<p>æ‰€ä»¥è¯•è¯•æŠŠ<code class="language-plaintext highlighter-rouge">mathjax</code>ä¸­å¾—åˆ°çš„<code class="language-plaintext highlighter-rouge">latex</code>æ–‡æœ¬éƒ½ç”Ÿæˆä¸€ä¸‹ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">latex2svg</span> <span class="kn">import</span> <span class="n">latex2svg</span>

<span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'The Feynman Lectures on Physics Vol. I Ch. 13_ Work and Potential Energy (A).html'</span><span class="p">)</span>
<span class="n">content</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

<span class="n">mathjaxs</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">,</span> <span class="p">{</span><span class="s">'type'</span><span class="p">:</span> <span class="s">'math/tex'</span><span class="p">})</span>
<span class="k">for</span> <span class="n">mathjax</span> <span class="ow">in</span> <span class="n">mathjaxs</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">latex2svg</span><span class="p">(</span><span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">])</span>
</code></pre></div></div>

<p>å¯æƒœå‡ºé”™äº†ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">raise</span> <span class="n">CalledProcessError</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">returncode</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">stdout</span><span class="p">,</span>
<span class="n">subprocess</span><span class="p">.</span><span class="n">CalledProcessError</span><span class="p">:</span> <span class="n">Command</span> <span class="s">'['</span><span class="n">latex</span><span class="s">', '</span><span class="o">-</span><span class="n">interaction</span><span class="s">', '</span><span class="n">nonstopmode</span><span class="s">', '</span><span class="o">-</span><span class="n">halt</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">error</span><span class="s">', '</span><span class="n">code</span><span class="p">.</span><span class="n">tex</span><span class="s">']'</span> <span class="n">returned</span> <span class="n">non</span><span class="o">-</span><span class="n">zero</span> <span class="nb">exit</span> <span class="n">status</span> <span class="mf">1.</span>
</code></pre></div></div>

<p>å…·ä½“å“ªä¸ªå…¬å¼é”™äº†å‘¢ã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\tfrac</span><span class="p">{</span>1<span class="p">}{</span>2<span class="p">}</span>mv<span class="p">^</span>2
</code></pre></div></div>

<h2 id="latex">latex</h2>

<p>æ¥å­¦ä¹ ä¸€ä¸‹<code class="language-plaintext highlighter-rouge">latex</code>ã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\documentclass</span><span class="na">[12pt]</span><span class="p">{</span>article<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>lingmacros<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>tree-dvips<span class="p">}</span>
<span class="nt">\begin{document}</span>

<span class="k">\section*</span><span class="p">{</span>Notes for My Paper<span class="p">}</span>

Don't forget to include examples of topicalization.
They look like this:

<span class="p">{</span><span class="k">\small</span>
<span class="k">\enumsentence</span><span class="p">{</span>Topicalization from sentential subject:<span class="k">\\</span> 
<span class="k">\shortex</span><span class="p">{</span>7<span class="p">}{</span>a John<span class="p">$_</span><span class="nb">i</span><span class="p">$</span> [a <span class="p">&amp;</span> kltukl <span class="p">&amp;</span> [el <span class="p">&amp;</span> 
  <span class="p">{</span><span class="k">\bf</span> l-<span class="p">}</span>oltoir <span class="p">&amp;</span> er <span class="p">&amp;</span> ngii<span class="p">$_</span><span class="nb">i</span><span class="p">$</span> <span class="p">&amp;</span> a Mary]]<span class="p">}</span>
<span class="p">{</span> <span class="p">&amp;</span> <span class="p">{</span><span class="k">\bf</span> R-<span class="p">}</span>clear <span class="p">&amp;</span> <span class="p">{</span><span class="k">\sc</span> comp<span class="p">}</span> <span class="p">&amp;</span> 
  <span class="p">{</span><span class="k">\bf</span> IR<span class="p">}</span>.<span class="p">{</span><span class="k">\sc</span> 3s<span class="p">}</span>-love   <span class="p">&amp;</span> P <span class="p">&amp;</span> him <span class="p">&amp;</span> <span class="p">}</span>
<span class="p">{</span>John, (it's) clear that Mary loves (him).<span class="p">}}</span>
<span class="p">}</span>

<span class="k">\subsection*</span><span class="p">{</span>How to handle topicalization<span class="p">}</span>

I'll just assume a tree structure like (<span class="k">\ex</span><span class="p">{</span>1<span class="p">}</span>).

<span class="p">{</span><span class="k">\small</span>
<span class="k">\enumsentence</span><span class="p">{</span>Structure of A<span class="p">$</span><span class="nb">'</span><span class="p">$</span> Projections:<span class="k">\\</span> [2ex]
<span class="nt">\begin{tabular}</span>[t]<span class="p">{</span>cccc<span class="p">}</span>
    <span class="p">&amp;</span> <span class="k">\node</span><span class="p">{</span>i<span class="p">}{</span>CP<span class="p">}</span><span class="k">\\</span> [2ex]
    <span class="k">\node</span><span class="p">{</span>ii<span class="p">}{</span>Spec<span class="p">}</span> <span class="p">&amp;</span>   <span class="p">&amp;</span><span class="k">\node</span><span class="p">{</span>iii<span class="p">}{</span>C<span class="p">$</span><span class="nb">'</span><span class="p">$}</span><span class="k">\\</span> [2ex]
        <span class="p">&amp;</span><span class="k">\node</span><span class="p">{</span>iv<span class="p">}{</span>C<span class="p">}</span> <span class="p">&amp;</span> <span class="p">&amp;</span> <span class="k">\node</span><span class="p">{</span>v<span class="p">}{</span>SAgrP<span class="p">}</span>
<span class="nt">\end{tabular}</span>
<span class="k">\nodeconnect</span><span class="p">{</span>i<span class="p">}{</span>ii<span class="p">}</span>
<span class="k">\nodeconnect</span><span class="p">{</span>i<span class="p">}{</span>iii<span class="p">}</span>
<span class="k">\nodeconnect</span><span class="p">{</span>iii<span class="p">}{</span>iv<span class="p">}</span>
<span class="k">\nodeconnect</span><span class="p">{</span>iii<span class="p">}{</span>v<span class="p">}</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="k">\subsection*</span><span class="p">{</span>Mood<span class="p">}</span>

Mood changes when there is a topic, as well as when
there is WH-movement.  <span class="k">\emph</span><span class="p">{</span>Irrealis<span class="p">}</span> is the mood when
there is a non-subject topic or WH-phrase in Comp.
<span class="k">\emph</span><span class="p">{</span>Realis<span class="p">}</span> is the mood when there is a subject topic
or WH-phrase.

<span class="nt">\end{document}</span>
</code></pre></div></div>

<p>ç½‘ä¸Šæ‰¾åˆ°ä¸€æ®µæ ·ä¾‹çš„<code class="language-plaintext highlighter-rouge">latex</code>æºç ã€‚</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% latex code.tex
This is pdfTeX, Version 3.14159265-2.6-1.40.21 <span class="o">(</span>TeX Live 2020<span class="o">)</span> <span class="o">(</span>preloaded <span class="nv">format</span><span class="o">=</span>latex<span class="o">)</span>
 restricted <span class="se">\w</span>rite18 enabled.
entering extended mode
<span class="o">(</span>./code.tex
LaTeX2e &lt;2020-02-02&gt; patch level 5
L3 programming layer &lt;2020-03-06&gt;
<span class="o">(</span>/usr/local/texlive/2020/texmf-dist/tex/latex/base/article.cls
Document Class: article 2019/12/20 v1.4l Standard LaTeX document class
<span class="o">(</span>/usr/local/texlive/2020/texmf-dist/tex/latex/base/size12.clo<span class="o">))</span>
<span class="o">(</span>/usr/local/texlive/2020/texmf-dist/tex/latex/tree-dvips/lingmacros.sty<span class="o">)</span>
<span class="o">(</span>/usr/local/texlive/2020/texmf-dist/tex/latex/tree-dvips/tree-dvips.sty
tree-dvips version .91 of May 16, 1995
<span class="o">)</span> <span class="o">(</span>/usr/local/texlive/2020/texmf-dist/tex/latex/l3backend/l3backend-dvips.def<span class="o">)</span>
<span class="o">(</span>./code.aux<span class="o">)</span> <span class="o">[</span>1] <span class="o">(</span>./code.aux<span class="o">)</span> <span class="o">)</span>
Output written on code.dvi <span class="o">(</span>1 page, 3416 bytes<span class="o">)</span><span class="nb">.</span>
Transcript written on code.log.
</code></pre></div></div>

<p><img src="assets/images/feynman/latex.png" alt="latex" /></p>

<p>æ¥å¯¹ç€æºç å’Œæ¸²æŸ“åçš„æ•ˆæœï¼Œçœ‹çœ‹èƒ½å­¦åˆ°ä»€ä¹ˆã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">\begin{document}</span>
<span class="nt">\end{document}</span>
</code></pre></div></div>

<p>è¿™æ ·æ¥æŠŠæ–‡æ¡£è£¹èµ·æ¥ã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\section*</span><span class="p">{</span>Notes for My Paper<span class="p">}</span>
</code></pre></div></div>

<p>è¿™è¡¨ç¤º<code class="language-plaintext highlighter-rouge">section</code>æ ‡é¢˜å¼€å¤´ã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\subsection*</span><span class="p">{</span>How to handle topicalization<span class="p">}</span>
</code></pre></div></div>

<p>è¿™è¡¨ç¤ºå­æ ‡é¢˜ã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\shortex</span><span class="p">{</span>7<span class="p">}{</span>a John<span class="p">$_</span><span class="nb">i</span><span class="p">$</span> [a <span class="p">&amp;</span> kltukl <span class="p">&amp;</span> [el <span class="p">&amp;</span> 
  <span class="p">{</span><span class="k">\bf</span> l-<span class="p">}</span>oltoir <span class="p">&amp;</span> er <span class="p">&amp;</span> ngii<span class="p">$_</span><span class="nb">i</span><span class="p">$</span> <span class="p">&amp;</span> a Mary]]<span class="p">}</span>
</code></pre></div></div>

<p><img src="assets/images/feynman/shortex.png" alt="shortex" /></p>

<p>å¯è§<code class="language-plaintext highlighter-rouge">$_i$</code>æ¥è¡¨ç¤ºä¸‹æ ‡ã€‚<code class="language-plaintext highlighter-rouge">{\bf l-}</code>æ¥è¡¨ç¤ºåŠ ç²—ã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\enumsentence</span><span class="p">{</span>Structure of A<span class="p">$</span><span class="nb">'</span><span class="p">$</span> Projections:<span class="k">\\</span> [2ex]
<span class="nt">\begin{tabular}</span>[t]<span class="p">{</span>cccc<span class="p">}</span>
    <span class="p">&amp;</span> <span class="k">\node</span><span class="p">{</span>i<span class="p">}{</span>CP<span class="p">}</span><span class="k">\\</span> [2ex]
    <span class="k">\node</span><span class="p">{</span>ii<span class="p">}{</span>Spec<span class="p">}</span> <span class="p">&amp;</span>   <span class="p">&amp;</span><span class="k">\node</span><span class="p">{</span>iii<span class="p">}{</span>C<span class="p">$</span><span class="nb">'</span><span class="p">$}</span><span class="k">\\</span> [2ex]
        <span class="p">&amp;</span><span class="k">\node</span><span class="p">{</span>iv<span class="p">}{</span>C<span class="p">}</span> <span class="p">&amp;</span> <span class="p">&amp;</span> <span class="k">\node</span><span class="p">{</span>v<span class="p">}{</span>SAgrP<span class="p">}</span>
<span class="nt">\end{tabular}</span>
<span class="k">\nodeconnect</span><span class="p">{</span>i<span class="p">}{</span>ii<span class="p">}</span>
<span class="k">\nodeconnect</span><span class="p">{</span>i<span class="p">}{</span>iii<span class="p">}</span>
<span class="k">\nodeconnect</span><span class="p">{</span>iii<span class="p">}{</span>iv<span class="p">}</span>
<span class="k">\nodeconnect</span><span class="p">{</span>iii<span class="p">}{</span>v<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/assets/images/feynman/node.png" alt="node" style="zoom:50%;" /></p>

<p>æ³¨æ„åˆ°<code class="language-plaintext highlighter-rouge">nodeconnect</code>æ¥è¡¨ç¤ºè¿çº¿ã€‚</p>

<h3 id="latex-è½¬æ¢æˆ-svg">latex è½¬æ¢æˆ svg</h3>

<p>ç»§ç»­é¡¹ç›®ã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\documentclass</span><span class="na">[16pt]</span><span class="p">{</span>article<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsmath<span class="p">}</span>
<span class="nt">\begin{document}</span>

<span class="p">\[</span><span class="nv">\tfrac</span><span class="p">{</span><span class="m">1</span><span class="p">}{</span><span class="m">2</span><span class="p">}</span><span class="nb">mv</span><span class="p">^</span><span class="m">2</span><span class="p">\]</span>

<span class="nt">\end{document}</span>
</code></pre></div></div>

<p><img src="/assets/images/feynman/frac.png" alt="frac" style="zoom:50%;" /></p>

<p>è¿™æ ·å¯ä»¥æ­£ç¡®åœ°è¢«æ¸²æŸ“ã€‚åœ¨ä»£ç é‡Œæ— æ³•è¢«æ¸²æŸ“ï¼Œå¯èƒ½æ˜¯å› ä¸ºæ²¡æœ‰åŠ ä¸Š<code class="language-plaintext highlighter-rouge">\usepackage{amsmath}</code>ã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\documentclass</span><span class="na">[12pt,preview]</span><span class="p">{</span>standalone<span class="p">}</span>

<span class="k">\usepackage</span><span class="na">[utf8x]</span><span class="p">{</span>inputenc<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsmath<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsfonts<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amssymb<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>newtxtext<span class="p">}</span>
<span class="k">\usepackage</span><span class="na">[libertine]</span><span class="p">{</span>newtxmath<span class="p">}</span>

<span class="nt">\begin{document}</span>
<span class="nt">\begin{preview}</span>
<span class="k">\tfrac</span><span class="p">{</span>1<span class="p">}{</span>2<span class="p">}</span>mv<span class="p">^</span>2
<span class="nt">\end{preview}</span>
<span class="nt">\end{document}</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">!</span> Missing <span class="nv">$ </span>inserted.
&lt;inserted text&gt;
                <span class="err">$</span>
l.12 <span class="se">\t</span>frac<span class="o">{</span>1<span class="o">}{</span>2<span class="o">}</span>
                 <span class="nb">mv</span>^2
</code></pre></div></div>

<p>è¿™æ ·å‡ºé”™äº†ã€‚è€Œæ”¹æˆä¸€ä¸‹è¿™æ ·å°±å¯ä»¥ã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">\[</span><span class="nv">\tfrac</span><span class="p">{</span><span class="m">1</span><span class="p">}{</span><span class="m">2</span><span class="p">}</span><span class="nb">mv</span><span class="p">^</span><span class="m">2</span><span class="p">\]</span>
</code></pre></div></div>

<p>è¿›è¡Œå„ç§è¯•æ¢ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">latex2svg</span> <span class="kn">import</span> <span class="n">latex2svg</span>

<span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'The Feynman Lectures on Physics Vol. I Ch. 13_ Work and Potential Energy (A).html'</span><span class="p">)</span>
<span class="n">content</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>

<span class="n">mathjaxs</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">,</span> <span class="p">{</span><span class="s">'type'</span><span class="p">:</span> <span class="s">'math/tex'</span><span class="p">})</span>
<span class="k">for</span> <span class="n">mathjax</span> <span class="ow">in</span> <span class="n">mathjaxs</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">)</span>
    <span class="n">wrap</span> <span class="o">=</span> <span class="s">'$'</span> <span class="o">+</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span> <span class="o">+</span> <span class="s">'$'</span>
    <span class="c1"># if 'frac' in mathjax.string:
</span>    <span class="c1">#     wrap = '$' + mathjax.string + '$'
</span>    <span class="k">if</span> <span class="s">'FLP'</span> <span class="ow">in</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">elif</span> <span class="s">'Fig'</span> <span class="ow">in</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">elif</span> <span class="s">'eps'</span> <span class="ow">in</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">latex2svg</span><span class="p">(</span><span class="n">wrap</span><span class="p">)</span>
    <span class="c1"># print(out)
</span>    <span class="n">node</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">],</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>
    <span class="n">svg</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'svg'</span><span class="p">)</span>
    <span class="n">mathjax</span><span class="p">.</span><span class="n">insert_after</span><span class="p">(</span><span class="n">svg</span><span class="p">)</span>
    <span class="c1"># print(out['svg'])
</span>    <span class="c1"># break
</span>    <span class="c1"># mathjax.replaceWith(out['svg'])    
</span>    
    <span class="c1"># print(dir(mathjax))
</span>    <span class="c1"># break
</span>    
    <span class="c1"># out = latex2svg(wrap)    
</span>    <span class="c1"># print(out['svg'])
</span>
<span class="c1"># print(len(soup.contents))
</span>    
<span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'out.html'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
<span class="n">output_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">prettify</span><span class="p">())</span>
<span class="n">output_file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># print(soup.contents)
</span>
<span class="c1"># out = latex2svg(r'\( e^{i \pi} + 1 = 0 \)')
# print(out['depth'])
# print(out['svg'])
</span>
<span class="c1"># svg = open('1.svg', 'w')
# svg.write(out['svg'])
# svg.close()
</span>
</code></pre></div></div>

<p>è¿™äº›æˆ‘éƒ½åœ¨è¯•æ¢ä»€ä¹ˆå‘¢ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">if</span> <span class="s">'FLP'</span> <span class="ow">in</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">elif</span> <span class="s">'Fig'</span> <span class="ow">in</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">elif</span> <span class="s">'eps'</span> <span class="ow">in</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">:</span>
        <span class="k">continue</span>
</code></pre></div></div>

<p>è¿™é‡Œå½“è§£æåˆ°æœ‰<code class="language-plaintext highlighter-rouge">FLP</code>ã€<code class="language-plaintext highlighter-rouge">Fig</code>ã€<code class="language-plaintext highlighter-rouge">eps</code>åœ¨<code class="language-plaintext highlighter-rouge">latex</code>æºç çš„æ—¶å€™ï¼Œè½¬æ¢çš„è¿‡ç¨‹å‡ºé”™äº†ã€‚</p>

<p>ä¾‹å¦‚ï¼Œåœ¨<code class="language-plaintext highlighter-rouge">HTMLä¸­</code>ï¼Œæœ‰è¿™æ ·çš„è„šæœ¬ï¼š</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"math/tex"</span> <span class="na">id=</span><span class="s">"MathJax-Element-11"</span><span class="nt">&gt;</span><span class="err">\</span><span class="nx">FLPF</span><span class="err">\</span><span class="nx">cdot</span><span class="err">\</span><span class="nx">FLPv</span><span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>è§£ææ‹¿åˆ°ï¼š</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\FLPF\cdot\FLPv</span>
</code></pre></div></div>

<p>å½“åœ¨ä»£ç é‡Œè½¬æ¢çš„æ—¶å€™å‡ºé”™äº†ã€‚ä¹Ÿå³ï¼Œ<code class="language-plaintext highlighter-rouge">latex2svg.py</code>å‡ºé”™äº†ã€‚è¿™é‡Œå°±æ˜¯ç”¨<code class="language-plaintext highlighter-rouge">latex</code>ç¨‹åºæ¥è½¬æ¢ã€‚</p>

<p><code class="language-plaintext highlighter-rouge">code.tex</code>:</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\documentclass</span><span class="na">[12pt,preview]</span><span class="p">{</span>standalone<span class="p">}</span>

<span class="k">\usepackage</span><span class="na">[utf8x]</span><span class="p">{</span>inputenc<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsmath<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsfonts<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amssymb<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>newtxtext<span class="p">}</span>
<span class="k">\usepackage</span><span class="na">[libertine]</span><span class="p">{</span>newtxmath<span class="p">}</span>

<span class="nt">\begin{document}</span>
<span class="nt">\begin{preview}</span>
<span class="nt">\begin{equation}</span>
    <span class="k">\FLPF\cdot\FLPv</span>
<span class="nt">\end{equation}</span>
<span class="nt">\end{preview}</span>
<span class="nt">\end{document}</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$latex</span> code.tex
<span class="o">!</span> Undefined control sequence.
l.13     <span class="se">\F</span>LPF
              <span class="se">\c</span>dot<span class="se">\F</span>LPv
?
</code></pre></div></div>

<p>è¿™åˆ°åº•æ˜¯ä»€ä¹ˆé—®é¢˜ã€‚æˆ‘åæ¥æ‰æ³¨æ„åˆ°åœ¨<code class="language-plaintext highlighter-rouge">html</code>ä¸­çš„è¿™æ®µä»£ç ã€‚</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/x-mathjax-config;executed=true"</span><span class="nt">&gt;</span>
      <span class="nx">MathJax</span><span class="p">.</span><span class="nx">Hub</span><span class="p">.</span><span class="nx">Config</span><span class="p">({</span>
        <span class="na">TeX</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">Macros</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">FLPvec</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">boldsymbol{#1}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="na">Figvec</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">mathbf{#1}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="na">FLPC</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{C}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FLPF</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{F}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FLPa</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{a}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FLPb</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{b}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FLPr</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{r}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FLPs</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{s}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FLPv</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{v}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">ddt</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">frac{d#1}{d#2}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="na">epsO</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">epsilon_0</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FigC</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">Figvec{C}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>è¿™è¡¨ç¤ºç½‘é¡µåœ¨æ¸²æŸ“çš„æ—¶å€™ï¼Œç»™<code class="language-plaintext highlighter-rouge">MathJax</code>è®¾ç½®ä¸Šäº†å®ã€‚æ‰€ä»¥æˆ‘ä»¬çš„<code class="language-plaintext highlighter-rouge">latex</code>è½¬æ¢æºç é‡Œä¹Ÿåº”è¯¥åŠ ä¸Šã€‚æ¥åŠ ä¸Šå®ƒä»¬ã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\documentclass</span><span class="na">[12pt,preview]</span><span class="p">{</span>standalone<span class="p">}</span>

<span class="k">\usepackage</span><span class="na">[utf8x]</span><span class="p">{</span>inputenc<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsmath<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsfonts<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amssymb<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>newtxtext<span class="p">}</span>
<span class="k">\usepackage</span><span class="na">[libertine]</span><span class="p">{</span>newtxmath<span class="p">}</span>

<span class="k">\newcommand</span><span class="p">{</span><span class="k">\FLPvec</span><span class="p">}</span>[1]<span class="p">{</span><span class="k">\boldsymbol</span><span class="p">{</span>#1<span class="p">}}</span>
<span class="k">\newcommand</span><span class="p">{</span><span class="k">\Figvec</span><span class="p">}</span>[1]<span class="p">{</span><span class="k">\mathbf</span><span class="p">{</span>#1<span class="p">}}</span>
<span class="k">\newcommand</span><span class="p">{</span><span class="k">\FLPC</span><span class="p">}{</span><span class="k">\FLPvec</span><span class="p">{</span>C<span class="p">}}</span>
<span class="k">\newcommand</span><span class="p">{</span><span class="k">\FLPF</span><span class="p">}{</span><span class="k">\FLPvec</span><span class="p">{</span>F<span class="p">}}</span>
<span class="k">\newcommand</span><span class="p">{</span><span class="k">\FLPa</span><span class="p">}{</span><span class="k">\FLPvec</span><span class="p">{</span>a<span class="p">}}</span>
<span class="k">\newcommand</span><span class="p">{</span><span class="k">\FLPb</span><span class="p">}{</span><span class="k">\FLPvec</span><span class="p">{</span>a<span class="p">}}</span>
<span class="k">\newcommand</span><span class="p">{</span><span class="k">\FLPr</span><span class="p">}{</span><span class="k">\FLPvec</span><span class="p">{</span>r<span class="p">}}</span>
<span class="k">\newcommand</span><span class="p">{</span><span class="k">\FLPs</span><span class="p">}{</span><span class="k">\FLPvec</span><span class="p">{</span>s<span class="p">}}</span>
<span class="k">\newcommand</span><span class="p">{</span><span class="k">\FLPv</span><span class="p">}{</span><span class="k">\FLPvec</span><span class="p">{</span>v<span class="p">}}</span>
<span class="k">\newcommand</span><span class="p">{</span><span class="k">\ddt</span><span class="p">}</span>[2]<span class="p">{</span><span class="k">\frac</span><span class="p">{</span>d#1<span class="p">}{</span>d#2<span class="p">}}</span>
<span class="k">\newcommand</span><span class="p">{</span><span class="k">\epsO</span><span class="p">}{</span><span class="k">\epsilon</span><span class="p">_</span>0<span class="p">}</span>
<span class="k">\newcommand</span><span class="p">{</span><span class="k">\FigC</span><span class="p">}{</span><span class="k">\Figvec</span><span class="p">{</span>C<span class="p">}}</span>
<span class="nt">\begin{document}</span>
<span class="nt">\begin{preview}</span>
<span class="nt">\begin{equation}</span>
    <span class="k">\FLPF\cdot\FLPv</span>
<span class="nt">\end{equation}</span>
<span class="nt">\end{preview}</span>
<span class="nt">\end{document}</span>
</code></pre></div></div>

<p>è¿™æ ·å°±å¯¹äº†ã€‚</p>

<p><img src="assets/images/feynman/fv1.png" alt="fv1" /></p>

<h3 id="åˆ†æä»£ç ">åˆ†æä»£ç </h3>

<p>æ¥çœ‹çœ‹æœ€åçš„ä»£ç ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">latex2svg</span> <span class="kn">import</span> <span class="n">latex2svg</span>

<span class="k">def</span> <span class="nf">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cls</span><span class="p">):</span>
    <span class="n">previews</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="n">cls</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">preview</span> <span class="ow">in</span> <span class="n">previews</span><span class="p">:</span>
        <span class="n">preview</span><span class="p">.</span><span class="n">decompose</span><span class="p">()</span>
        
<span class="k">def</span> <span class="nf">clean_script</span><span class="p">(</span><span class="n">soup</span><span class="p">):</span>
    <span class="n">scripts</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scripts</span><span class="p">:</span>
        <span class="n">s</span><span class="p">.</span><span class="n">decompose</span><span class="p">()</span>    

<span class="k">def</span> <span class="nf">wrap_latex</span><span class="p">(</span><span class="n">mathjax</span><span class="p">,</span> <span class="n">equation</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="n">wrap</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">if</span> <span class="n">equation</span><span class="p">:</span>
        <span class="n">wrap</span> <span class="o">=</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wrap</span> <span class="o">=</span> <span class="s">'$'</span> <span class="o">+</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span> <span class="o">+</span> <span class="s">'$'</span>
    <span class="n">wrap</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'label'</span><span class="p">,</span> <span class="s">'tag'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrap</span>
 
<span class="k">def</span> <span class="nf">wrap_svg</span><span class="p">(</span><span class="n">svg</span><span class="p">,</span> <span class="n">equation</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">equation</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="sa">f</span><span class="s">'&lt;div style="text-align:center;"&gt;&lt;/div&gt;'</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>
        <span class="n">p</span><span class="p">.</span><span class="n">div</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">svg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">.</span><span class="n">div</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">svg</span>

<span class="k">def</span> <span class="nf">to_svg</span><span class="p">(</span><span class="n">mathjaxs</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">equation</span><span class="p">:</span>
        <span class="n">svg_prefix</span> <span class="o">=</span> <span class="s">'eq_'</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_prefix</span> <span class="o">=</span> <span class="s">'in_'</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">mathjax</span> <span class="ow">in</span> <span class="n">mathjaxs</span><span class="p">:</span>     
        <span class="k">print</span><span class="p">(</span><span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">)</span>
        <span class="n">wrap</span> <span class="o">=</span> <span class="n">wrap_latex</span><span class="p">(</span><span class="n">mathjax</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="n">equation</span><span class="p">)</span>   
        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">latex2svg</span><span class="p">(</span><span class="n">wrap</span><span class="p">)</span>   
        <span class="k">except</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">err</span>      
            
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s">'svgs/</span><span class="si">{</span><span class="n">svg_prefix</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s">.svg'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
        <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">])</span>
        <span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        
        <span class="n">node</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="s">'&lt;img&gt;'</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'img'</span><span class="p">)</span>
        <span class="n">img</span><span class="p">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">'src'</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'./svgs/</span><span class="si">{</span><span class="n">svg_prefix</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s">.svg'</span>
        <span class="n">img</span><span class="p">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">'style'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'vertical-align: middle; margin: 0.5em 0;'</span>
        
        <span class="n">p</span> <span class="o">=</span> <span class="n">wrap_svg</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">equation</span><span class="p">)</span>
        <span class="n">mathjax</span><span class="p">.</span><span class="n">insert_after</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span><span class="mi">1</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>    
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'The Feynman Lectures on Physics Vol. I Ch. 13_ Work and Potential Energy (A).html'</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
    
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>
    <span class="n">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="s">'span'</span><span class="p">,</span> <span class="s">'MathJax'</span><span class="p">)</span>
    <span class="n">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="s">'div'</span><span class="p">,</span> <span class="s">'MathJax_Display'</span><span class="p">)</span>
    <span class="n">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="s">'span'</span><span class="p">,</span> <span class="s">'MathJax_Preview'</span><span class="p">)</span>
    
    <span class="n">mathjaxs</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">,</span> <span class="p">{</span><span class="s">'type'</span><span class="p">:</span> <span class="s">'math/tex'</span><span class="p">})</span>
    <span class="n">to_svg</span><span class="p">(</span><span class="n">mathjaxs</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    
    <span class="n">mathjaxs</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">,</span> <span class="p">{</span><span class="s">'type'</span><span class="p">:</span> <span class="s">'math/tex; mode=display'</span><span class="p">})</span>   
    <span class="n">to_svg</span><span class="p">(</span><span class="n">mathjaxs</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="n">clean_script</span><span class="p">(</span><span class="n">soup</span><span class="p">)</span>
    
    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'out.html'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
    <span class="n">output_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">prettify</span><span class="p">())</span>
    <span class="n">output_file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>    

<span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<p>å½“æˆ‘ä»¬æƒ³è½¬æ¢æ•´ä¸ªç”µå­ä¹¦æ—¶ï¼Œå¯ä»¥å…ˆç”¨ä¸€ä¸ªé¡µé¢æ¥è¯•è¯•ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'The Feynman Lectures on Physics Vol. I Ch. 13_ Work and Potential Energy (A).html'</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
</code></pre></div></div>

<p>è¿™é‡Œä¾¿æ˜¯ä¸‹è½½äº†ä¸€ä¸ªé¡µé¢ã€‚</p>

<p><code class="language-plaintext highlighter-rouge">MathJax</code>ç”Ÿæˆäº†å¾ˆå¤šçš„<code class="language-plaintext highlighter-rouge">div</code>å’Œ<code class="language-plaintext highlighter-rouge">span</code>ã€‚æ„æ€æ˜¯æ¯”å¦‚ <code class="language-plaintext highlighter-rouge">T+U=const</code>ã€‚MathJaxè¿™æ ·æ¥ç”Ÿæˆã€‚</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax"</span><span class="nt">&gt;</span>T<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax"</span><span class="nt">&gt;</span>+<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax"</span><span class="nt">&gt;</span>U<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax"</span><span class="nt">&gt;</span>=<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax"</span><span class="nt">&gt;</span>const<span class="nt">&lt;/span&gt;</span>
</code></pre></div></div>

<p>è¿™äº›å¾ˆè®¨åŒï¼Œä¹Ÿä¼šå½±å“æˆ‘ä»¬çš„æ–‡æœ¬ã€‚å› ä¸ºå·²ç»æœ‰<code class="language-plaintext highlighter-rouge">svg</code>äº†ï¼Œä¸éœ€è¦è¿™äº›äº†ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cls</span><span class="p">):</span>
    <span class="n">previews</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="n">cls</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">preview</span> <span class="ow">in</span> <span class="n">previews</span><span class="p">:</span>
        <span class="n">preview</span><span class="p">.</span><span class="n">decompose</span><span class="p">()</span>

    <span class="n">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="s">'span'</span><span class="p">,</span> <span class="s">'MathJax'</span><span class="p">)</span>
    <span class="n">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="s">'div'</span><span class="p">,</span> <span class="s">'MathJax_Display'</span><span class="p">)</span>
    <span class="n">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="s">'span'</span><span class="p">,</span> <span class="s">'MathJax_Preview'</span><span class="p">)</span>
</code></pre></div></div>

<p>æŠŠå®ƒä»¬éƒ½å»æ‰ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">mathjaxs</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">,</span> <span class="p">{</span><span class="s">'type'</span><span class="p">:</span> <span class="s">'math/tex'</span><span class="p">})</span>
    <span class="n">to_svg</span><span class="p">(</span><span class="n">mathjaxs</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    
    <span class="n">mathjaxs</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">,</span> <span class="p">{</span><span class="s">'type'</span><span class="p">:</span> <span class="s">'math/tex; mode=display'</span><span class="p">})</span>   
    <span class="n">to_svg</span><span class="p">(</span><span class="n">mathjaxs</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>æ³¨æ„åˆ°è¿™é‡Œåˆ†æˆä¸¤ç§çš„<code class="language-plaintext highlighter-rouge">script</code>ã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>m(dv/dt)=F
</code></pre></div></div>

<p>è¿™æ˜¯å†…åµŒå½¢å¼çš„ã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">\begin{equation}</span>
<span class="k">\underset</span><span class="p">{</span><span class="k">\text</span><span class="p">{</span>K.E.<span class="p">}}{</span><span class="k">\tfrac</span><span class="p">{</span>1<span class="p">}{</span>2<span class="p">}</span>mv<span class="p">^</span>2<span class="p">}</span>+
<span class="k">\underset</span><span class="p">{</span><span class="k">\text</span><span class="p">{</span>P.E.<span class="p">}}{</span><span class="k">\vphantom</span><span class="p">{</span><span class="k">\tfrac</span><span class="p">{</span>1<span class="p">}{</span>2<span class="p">}}</span>mgh<span class="p">}</span>=<span class="k">\text</span><span class="p">{</span>const<span class="p">}</span>,<span class="k">\notag</span>
</code></pre></div></div>

<p>è¿™æ˜¯æˆæ®µå½¢å¼çš„ã€‚</p>

<p>å½“æ—¶å†…åµŒå½¢å¼æ—¶ï¼Œè½¬æ¢è¦åœ¨è¡¨è¾¾å¼å·¦å³åŠ ä¸Š<code class="language-plaintext highlighter-rouge">$</code>æˆ–<code class="language-plaintext highlighter-rouge">[]</code>ã€‚å¦åˆ™å°±æœ‰å¯èƒ½å‡ºé”™ã€‚</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">\begin{document}</span>
<span class="nt">\begin{preview}</span>
<span class="k">\tfrac</span><span class="p">{</span>1<span class="p">}{</span>2<span class="p">}</span>mv<span class="p">^</span>2
<span class="nt">\end{preview}</span>
<span class="nt">\end{document}</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">!</span> Missing <span class="nv">$ </span>inserted.
&lt;inserted text&gt;
                <span class="err">$</span>
l.26 <span class="se">\t</span>frac<span class="o">{</span>1<span class="o">}{</span>2<span class="o">}</span>
                 <span class="nb">mv</span>^2
</code></pre></div></div>

<p>å¾—æ”¹æˆè¿™æ ·ï¼š</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">\begin{document}</span>
<span class="nt">\begin{preview}</span>
<span class="p">$</span><span class="nv">\tfrac</span><span class="p">{</span><span class="m">1</span><span class="p">}{</span><span class="m">2</span><span class="p">}</span><span class="nb">mv</span><span class="p">^</span><span class="m">2</span><span class="p">$</span>
<span class="nt">\end{preview}</span>
<span class="nt">\end{document}</span>
</code></pre></div></div>

<p>æ¥ä¸‹æ¥çœ‹çœ‹å¦‚ä½•è½¬æ¢<code class="language-plaintext highlighter-rouge">latex</code>æˆ<code class="language-plaintext highlighter-rouge">svg</code>ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">if</span> <span class="n">equation</span><span class="p">:</span>
        <span class="n">svg_prefix</span> <span class="o">=</span> <span class="s">'eq_'</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_prefix</span> <span class="o">=</span> <span class="s">'in_'</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% tree svgs
svgs
â”œâ”€â”€ eq_0.svg
â”œâ”€â”€ eq_1.svg
â”œâ”€â”€ in_0.svg
</code></pre></div></div>

<p>è¿™æ ·æ¥ä¿å­˜<code class="language-plaintext highlighter-rouge">svg</code>ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">wrap_latex</span><span class="p">(</span><span class="n">mathjax</span><span class="p">,</span> <span class="n">equation</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="n">wrap</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">if</span> <span class="n">equation</span><span class="p">:</span>
        <span class="n">wrap</span> <span class="o">=</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wrap</span> <span class="o">=</span> <span class="s">'$'</span> <span class="o">+</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span> <span class="o">+</span> <span class="s">'$'</span>
    <span class="n">wrap</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'label'</span><span class="p">,</span> <span class="s">'tag'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrap</span>
</code></pre></div></div>

<p>è¿™é‡Œæ¥å¯¹<code class="language-plaintext highlighter-rouge">latex</code>æºç è¿›è¡Œä¸€äº›è°ƒæ•´ã€‚æ³¨æ„åˆ°<code class="language-plaintext highlighter-rouge">label</code>å˜æˆäº†<code class="language-plaintext highlighter-rouge">tag</code>ã€‚</p>

<p><img src="assets/images/feynman/tag.png" alt="tag" /></p>

<p>æ³¨æ„å³è¾¹çš„<code class="language-plaintext highlighter-rouge">(Eq:I:13:14)</code>ã€‚å¦‚æœæ˜¯<code class="language-plaintext highlighter-rouge">label</code>çš„è¯ï¼Œåˆ™æ²¡è§£ææˆåŠŸã€‚è¿™ä¼šæ˜¾ç¤ºçš„æ˜¯<code class="language-plaintext highlighter-rouge">(1)</code>ã€‚è¿™é‡Œå°†å°±ç”¨<code class="language-plaintext highlighter-rouge">tag</code>è¡¨ç¤ºä¸€ä¸‹ï¼Œæš‚æ—¶æ²¡æœ‰æ·±ç©¶ã€‚</p>

<p>æ¥ç€å°±è¿›è¡Œè°ƒç”¨<code class="language-plaintext highlighter-rouge">latex2svg.py</code>ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">latex2svg</span><span class="p">(</span><span class="n">wrap</span><span class="p">)</span>   
        <span class="k">except</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">err</span>    
</code></pre></div></div>

<p>çœ‹çœ‹<code class="language-plaintext highlighter-rouge">latex2svg.py</code>ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1"># Run LaTeX and create DVI file
</span>    <span class="k">try</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">shlex</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s">'latex_cmd'</span><span class="p">]</span><span class="o">+</span><span class="s">' code.tex'</span><span class="p">),</span>
                             <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span>
                             <span class="n">cwd</span><span class="o">=</span><span class="n">working_directory</span><span class="p">)</span>
        <span class="n">ret</span><span class="p">.</span><span class="n">check_returncode</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">RuntimeError</span><span class="p">(</span><span class="s">'latex not found'</span><span class="p">)</span>
</code></pre></div></div>

<p>è¿™é‡Œæ˜¯åœ¨è°ƒç”¨<code class="language-plaintext highlighter-rouge">latex</code>å‘½ä»¤ã€‚</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code> % latex <span class="nt">--help</span>
Usage: pdftex <span class="o">[</span>OPTION]... <span class="o">[</span>TEXNAME[.tex]] <span class="o">[</span>COMMANDS]
   or: pdftex <span class="o">[</span>OPTION]... <span class="se">\F</span>IRST-LINE
   or: pdftex <span class="o">[</span>OPTION]... &amp;FMT ARGS
  Run pdfTeX on TEXNAME, usually creating TEXNAME.pdf.
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">try</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">shlex</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s">'dvisvgm_cmd'</span><span class="p">]</span><span class="o">+</span><span class="s">' code.dvi'</span><span class="p">),</span>
                             <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span>
                             <span class="n">cwd</span><span class="o">=</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">)</span>
        <span class="n">ret</span><span class="p">.</span><span class="n">check_returncode</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">RuntimeError</span><span class="p">(</span><span class="s">'dvisvgm not found'</span><span class="p">)</span>
</code></pre></div></div>

<p>è¿™é‡Œæ˜¯åœ¨è°ƒç”¨<code class="language-plaintext highlighter-rouge">dvisvgm</code>å‘½ä»¤ã€‚</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% dvisvgm
dvisvgm 2.9.1

This program converts DVI files, as created by TeX/LaTeX, as well as
EPS and PDF files to the XML-based scalable vector graphics format SVG.

Usage: dvisvgm <span class="o">[</span>options] dvifile
       dvisvgm <span class="nt">--eps</span> <span class="o">[</span>options] epsfile
       dvisvgm <span class="nt">--pdf</span> <span class="o">[</span>options] pdffile
</code></pre></div></div>

<p>ä¸Šé¢è¯´çš„<code class="language-plaintext highlighter-rouge">latex</code>è‡ªå®šä¹‰å®å†™åœ¨å“ªå„¿å‘¢ã€‚è¿™é‡Œè¦æ”¹ä¸€ä¸‹<code class="language-plaintext highlighter-rouge">latex2svg.py</code>ã€‚æ”¹æ”¹<code class="language-plaintext highlighter-rouge">default_preamble</code>ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">default_preamble</span> <span class="o">=</span> <span class="sa">r</span><span class="s">"""
\usepackage[utf8x]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{newtxtext}
\usepackage[libertine]{newtxmath}

\newcommand{\FLPvec}[1]{\boldsymbol{#1}}
\newcommand{\Figvec}[1]{\mathbf{#1}}
\newcommand{\FLPC}{\FLPvec{C}}
\newcommand{\FLPF}{\FLPvec{F}}
\newcommand{\FLPa}{\FLPvec{a}}
\newcommand{\FLPb}{\FLPvec{a}}
\newcommand{\FLPr}{\FLPvec{r}}
\newcommand{\FLPs}{\FLPvec{s}}
\newcommand{\FLPv}{\FLPvec{v}}
\newcommand{\ddt}[2]{\frac{d#1}{d#2}}
\newcommand{\epsO}{\epsilon_0}
\newcommand{\FigC}{\Figvec{C}}
"""</span>
</code></pre></div></div>

<p>è½¬æ¢æˆåŠŸåï¼Œå†™å…¥åˆ°æ–‡ä»¶ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s">'svgs/</span><span class="si">{</span><span class="n">svg_prefix</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s">.svg'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
        <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">])</span>
        <span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>ç»§ç»­ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="n">node</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="s">'&lt;img&gt;'</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'img'</span><span class="p">)</span>
        <span class="n">img</span><span class="p">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">'src'</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'./svgs/</span><span class="si">{</span><span class="n">svg_prefix</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s">.svg'</span>
        <span class="n">img</span><span class="p">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">'style'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'vertical-align: middle; margin: 0.5em 0;'</span>
</code></pre></div></div>

<p>è¿™é‡Œæ„é€ ä¸€ä¸ª<code class="language-plaintext highlighter-rouge">img</code>æ ‡ç­¾ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">wrap_svg</span><span class="p">(</span><span class="n">svg</span><span class="p">,</span> <span class="n">equation</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">equation</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="sa">f</span><span class="s">'&lt;div style="text-align:center;"&gt;&lt;/div&gt;'</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>
        <span class="n">p</span><span class="p">.</span><span class="n">div</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">svg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">.</span><span class="n">div</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">svg</span>
      
<span class="n">p</span> <span class="o">=</span> <span class="n">wrap_svg</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">equation</span><span class="p">)</span>
</code></pre></div></div>

<p>å¦‚æœæ˜¯ç‹¬æ®µçš„<code class="language-plaintext highlighter-rouge">latex</code>ï¼Œé‚£ä¹ˆç”¨<code class="language-plaintext highlighter-rouge">div</code>åŒ…èµ·æ¥ï¼Œå¹¶ä¸”å±…ä¸­ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mathjax</span><span class="p">.</span><span class="n">insert_after</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div></div>

<p>è¿™é‡ŒæŠŠ<code class="language-plaintext highlighter-rouge">div</code>æ ‡ç­¾æˆ–<code class="language-plaintext highlighter-rouge">img</code>æ ‡ç­¾åŠ åœ¨åŸæ¥çš„<code class="language-plaintext highlighter-rouge">script</code>åé¢ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">clean_script</span><span class="p">(</span><span class="n">soup</span><span class="p">):</span>
    <span class="n">scripts</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scripts</span><span class="p">:</span>
        <span class="n">s</span><span class="p">.</span><span class="n">decompose</span><span class="p">()</span>    
        
<span class="n">clean_script</span><span class="p">(</span><span class="n">soup</span><span class="p">)</span>
</code></pre></div></div>

<p>æŠŠæ‰€æœ‰çš„<code class="language-plaintext highlighter-rouge">latex</code>æ›¿æ¢å®Œ<code class="language-plaintext highlighter-rouge">svg</code>åï¼Œå°±ä¸éœ€è¦<code class="language-plaintext highlighter-rouge">script</code>äº†ã€‚æŠŠå®ƒä»¬åˆ æ‰ï¼Œè¿™æ ·æ•´æ´ä¸€ç‚¹ã€‚</p>

<p>æœ€åï¼Œå†å†™å…¥æŠŠä¿®æ”¹åçš„æ•´ä¸ª<code class="language-plaintext highlighter-rouge">html</code>å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'out.html'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
    <span class="n">output_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">prettify</span><span class="p">())</span>
    <span class="n">output_file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>    
</code></pre></div></div>

<p>æ¥ç€ç”¨<code class="language-plaintext highlighter-rouge">pandoc</code>å·¥å…·ï¼Œè½¬æ¢æˆ<code class="language-plaintext highlighter-rouge">epub</code>ã€‚</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pandoc <span class="nt">-s</span> <span class="nt">-r</span> html out.html <span class="nt">-o</span> feynman.epub
</code></pre></div></div>

<p>è¿™ä¼šæ‰“å¼€ï¼Œå°±æ˜¯æ¼‚äº®çš„ç”µå­ä¹¦äº†ã€‚</p>

<p>ä¸ºä»€ä¹ˆä¸ç›´æ¥åµŒå…¥<code class="language-plaintext highlighter-rouge">svg</code>æ ‡ç­¾ï¼Œè€Œæ˜¯ç”¨<code class="language-plaintext highlighter-rouge">img</code>æ¥å¼•å…¥å‘¢ã€‚å³æ˜¯è¯´è¿™æ ·å†™ï¼š</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;p&gt;&lt;/p&gt;</span>
<span class="nt">&lt;svg&gt;&lt;/svg&gt;</span>
<span class="nt">&lt;p&gt;&lt;/p&gt;</span>
</code></pre></div></div>

<p>æœ‰ä¸ªå¾ˆå¥‡æ€ªçš„<code class="language-plaintext highlighter-rouge">bug</code>ã€‚å½“æœ‰å¾ˆå¤šçš„<code class="language-plaintext highlighter-rouge">svg</code>çš„æ—¶å€™ï¼Œä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µã€‚</p>

<p><img src="/assets/images/feynman/svg_p1.png" alt="svg_p1" style="zoom:40%;" /></p>

<p>åæ¥å‘ç°ç”¨<code class="language-plaintext highlighter-rouge">img</code>å¼•å…¥å°±è¡Œã€‚è‡³äºä¸ºä»€ä¹ˆè¿™æ ·ï¼Œæ²¡ææ˜ç™½ã€‚å½“æˆ‘æŠŠè¿™å•ä¸ªçš„<code class="language-plaintext highlighter-rouge">svg</code>æ‹¿å‡ºæ¥çš„æ—¶å€™ï¼Œç”¨æµè§ˆå™¨çœ‹å°±æ²¡æœ‰é—®é¢˜ã€‚çœ‹æ¥æ˜¯åœ¨æµè§ˆå™¨æ¸²æŸ“éå¸¸å¤šä¸ª<code class="language-plaintext highlighter-rouge">svg</code>æ—¶ï¼Œå°±ä¼šå‡ºé”™ã€‚</p>

<h3 id="æœ€å">æœ€å</h3>

<p>è‡³äº<code class="language-plaintext highlighter-rouge">epub</code>å¦‚ä½•è½¬æˆ<code class="language-plaintext highlighter-rouge">mobi</code>ï¼Œå¯ä»¥ç”¨<code class="language-plaintext highlighter-rouge">Kindle</code>çš„å®˜æ–¹å·¥å…·<code class="language-plaintext highlighter-rouge">Kindle Previewer 3</code>ã€‚æ³¨æ„è¿™é‡Œåªæ˜¯ä¸€ç« ã€‚</p>

<p>è¯¥é¡¹ç›®ä»£ç åœ¨<a href="https://github.com/lzwjava/feynman-lectures-mobi">feynman-lectures-mobi@lzwjava</a>ã€‚</p>

<p>å¦‚ä½•æŠŠæ‰€æœ‰çš„é¡µé¢éƒ½æŠ“å–æ•´ç†æˆç”µå­ä¹¦å‘¢ã€‚åç»­å†è®²ã€‚ä½†è¿™è´¹æ›¼ç‰©ç†è®²ä¹‰ä¸€ç« ä¹Ÿå¤Ÿçœ‹çš„äº†ã€‚å¥½äº†ï¼Œè®©æˆ‘ä»¬æ‹¿èµ·Kindleå¼€å§‹çœ‹å§ã€‚</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-zh" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
