<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>大模型成本、代理及编程工具</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>大模型成本、代理及编程工具 | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="大模型成本、代理及编程工具" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="zh" />
<meta name="description" content="目录" />
<meta property="og:description" content="目录" />
<link rel="canonical" href="https://lzwjava.github.io/llm-zh" />
<meta property="og:url" content="https://lzwjava.github.io/llm-zh" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-08-18T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="大模型成本、代理及编程工具" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2025-08-18T00:00:00+08:00","datePublished":"2025-08-18T00:00:00+08:00","description":"目录","headline":"大模型成本、代理及编程工具","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/llm-zh"},"url":"https://lzwjava.github.io/llm-zh"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=5dc6bde1e9a37ea9c508461e5a5cdae981a42eb8">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=5dc6bde1e9a37ea9c508461e5a5cdae981a42eb8" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       大模型成本、代理及编程工具 | 原创，AI翻译
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/zh/2025-08-18-llm-zh.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postszh2025-08-18-llm-zh.md</span> -->
      

      <!-- <span>2025-08-18-llm-zh.md</span> -->

      
        

        
          
          <a href="#" class="button">2025.08</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/llm-en" >English</option>
        <option value="/llm-zh" selected>中文</option>
        <option value="/llm-ja" >日本語</option>
        <option value="/llm-es" >Español</option>
        <option value="/llm-hi" >हिंदी</option>
        <option value="/llm-fr" >Français</option>
        <option value="/llm-de" >Deutsch</option>
        <option value="/llm-ar" >العربية</option>
        <option value="/llm-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <h3 id="目录">目录</h3>

<ol>
  <li><strong><a href="#optimizing-llm-api-costs">优化LLM API成本</a></strong>
    <ul>
      <li>优先选用性价比高的模型</li>
      <li>避免不必要的高端模型调用</li>
      <li>简单任务首选NLP工具库</li>
      <li>构建专用代理提升效率</li>
      <li>通过充分测试比较模型</li>
    </ul>
  </li>
  <li><strong><a href="#api-usage-of-deepseek-and-mistral">DeepSeek与Mistral的API使用</a></strong>
    <ul>
      <li>DeepSeek成本与缓存缺失正相关</li>
      <li>Mistral支出主要来自输出token</li>
      <li>Grok定价更倾向输入token统计</li>
      <li>任务复杂度影响token消耗</li>
      <li>实际费用符合文档标价</li>
    </ul>
  </li>
  <li><strong><a href="#general-agents-vs-vertical-agents">通用代理 vs 垂直领域代理</a></strong>
    <ul>
      <li>通用代理难以应对复杂场景</li>
      <li>垂直代理专精特定任务</li>
      <li>工作流工具灵活性受限</li>
      <li>自定义Python代理可控性强</li>
      <li>便利性与功能性的权衡</li>
    </ul>
  </li>
  <li><strong><a href="#a-picky-engineers-take-on-ai-coding-tools">工程师挑剔视角看AI编程工具</a></strong>
    <ul>
      <li>看重实用价值而非品牌光环</li>
      <li>VSCode+Copilot组合依然可靠</li>
      <li>Claude Code差异对比编辑惊艳</li>
      <li>语法工具需人工复核</li>
      <li>实验精神优于盲目跟风</li>
    </ul>
  </li>
</ol>

<hr />

<h2 id="优化llm-api成本">优化LLM API成本</h2>

<p><em>2025.08</em></p>

<p class="centered"><img src="assets/images/tokens/tokens1.png" alt="" class="responsive" /><br />
<em class="caption">来源：openrouter.ai</em></p>

<p class="centered"><img src="assets/images/tokens/tokens2.png" alt="" class="responsive" /><br />
<em class="caption">来源：openrouter.ai</em></p>

<p>优化token使用时应优先选用经济型模型，若遇问题再考虑升级。Mistral、Gemini Flash和DeepSeek通常更实惠，而Claude Sonnet价格较高。需特别注意Claude Code对路由策略的运用。</p>

<p>近期我曾因忽视该原则产生高额费用——为测算成本极限刻意满负荷调用，这显然非理性行为。比如我真的需要Sonnet 4吗？未必。虽然觉得它是Anthropic的高阶模型且在OpenRouter排名靠前，但我其实分不清Sonnet 4与3.5版本的区别。</p>

<p>Replit创始人Amjad Masad的<a href="https://www.vanta.com/resources/replit-future-of-code">访谈</a>给我启发：多数任务无需高级模型。理想情况下能完全不用LLM API更好，像中文处理用<a href="https://github.com/hankcs/HanLP">HanLP</a>等NLP库就能胜任简单任务。</p>

<p>此外可开发定制化专用代理。Claude Code并非所有场景的最佳选择。深入使用不同模型进行对比测试是辨别差异的好方法——用了一段时间Gemini 2.5 Flash后，我发现其能力确实不如Sonnet 4。</p>

<p>后续我改用以下配置参数，其中longContextThreshold尤为关键。使用Claude Code编程时很容易触发长上下文阈值，可定期清理控制台或重启解决。</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"PROXY_URL"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://127.0.0.1:7890"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"LOG"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"Providers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"openrouter"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"api_base_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://openrouter.ai/api/v1/chat/completions"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"api_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="nl">"models"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"moonshotai/kimi-k2"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"anthropic/claude-sonnet-4"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"anthropic/claude-3.5-sonnet"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"anthropic/claude-3.7-sonnet:thinking"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"anthropic/claude-opus-4"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"google/gemini-2.5-flash"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"google/gemini-2.5-pro"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"deepseek/deepseek-chat-v3-0324"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"deepseek/deepseek-chat-v3.1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"deepseek/deepseek-r1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"mistralai/mistral-medium-3.1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"qwen/qwen3-coder"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"openai/gpt-oss-120b"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"openai/gpt-5"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"openai/gpt-5-mini"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"x-ai/grok-3-mini"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"transformer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"use"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="s2">"openrouter"</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"Router"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"openrouter,openai/gpt-5-mini"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"background"</span><span class="p">:</span><span class="w"> </span><span class="s2">"openrouter,google/gemini-2.5-flash"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"think"</span><span class="p">:</span><span class="w"> </span><span class="s2">"openrouter,qwen/qwen3-coder"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"longContext"</span><span class="p">:</span><span class="w"> </span><span class="s2">"openrouter,deepseek/deepseek-chat-v3.1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"longContextThreshold"</span><span class="p">:</span><span class="w"> </span><span class="mi">2000</span><span class="p">,</span><span class="w">
    </span><span class="nl">"webSearch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"openrouter,mistralai/mistral-medium-3.1"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<hr />

<h2 id="通用代理-vs-垂直领域代理">通用代理 vs 垂直领域代理</h2>

<p><em>2025.08</em></p>

<p><a href="https://manus.im">Manus</a>自称通用AI代理工具，但实际效果恐怕不尽如人意。</p>

<p>其一是运行缓慢，做了大量无效工作；其二是遇到复杂问题或触及能力短板时，任务很容易失败。</p>

<p>垂直代理因其高度专业化而表现卓越。它们针对特定场景设计——比如应对数十种数据库、Spring等上百个Web开发框架，或Vue/React等前端框架。</p>

<p><a href="https://dify.ai">Dify</a>侧重用AI连接工作流，采用拖拽方式构建AI流程。他们在衔接信息/数据/平台方面需要大量工作。</p>

<p>我也构建过简单代理，比如Python代码重构代理、语法修正代理、bug修复代理和文章合并代理。代码极具灵活性，Dify仅覆盖了创意空间的很小部分。</p>

<p>Manus通过VNC方式展示计算机操作过程来执行任务，但需要上传代码/文本才能运作，并不便捷。Dify则需要像MIT Scratch那样拖拽搭建工作流。</p>

<p>为什么Scratch没有Python流行？因为Python无所不能，而Scratch仅限于教育用途的简单程序。Dify可能面临类似局限。</p>

<p>Manus能处理许多简单任务，但遇到其能力短板时会失败。此外许多服务需要较长的初始化时间，而Manus在这方面效率低下。</p>

<p>作为程序员，我更喜欢用Python结合AI构建垂直代理。这对我来说最简单可控——通过预设提示词和上下文能确保LLM API输出相对稳定。Manus和Dify同样基于这些LLM API构建，其优势在于已集成现成工具链。</p>

<p>若想构建Twitter机器人代理，用Dify可能比自己从头开发更方便。</p>

<hr />

<h2 id="工程师挑剔视角看ai编程工具">工程师挑剔视角看AI编程工具</h2>

<p><em>2025.08</em></p>

<p>最近成功运行Claude Code后，我想分享工具选型历程，期间还整理了些<a href="ai-tips-en.md">AI工具技巧</a>。</p>

<p>我算是Claude Code的晚期使用者。</p>

<p><a href="https://www.anthropic.com/news/claude-3-5-sonnet">Claude Code</a>发布于2025年2月底，但直到最近我才调试成功。部分原因是其需Anthropic API且不支持中国 Visa卡，后来借助<a href="https://github.com/musistudio/claude-code-router">Claude Code路由工具</a>才得以使用。</p>

<p>虽听闻诸多赞誉，但我在2025年7月尝试Gemini CLI多次修复代码失败后弃用。也试过Aider这类软件代理。而Cursor在使用半年后停用——其VSCode插件频出故障，况且作为VSCode衍生产品，我不愿给它太多”功劳”，尤其当Copilot插件近期改进明显后我更倾向于原生方案。</p>

<p>不过VSCode基于Electron开源技术，很难归功于特定团队。考虑到众多企业从开源中获利，我只关心预算内最适合的工具。短暂试用Cline后也未采纳。</p>

<p>现在我用OpenRouter定制的Grok 3 beta模型运行VSCode的Copilot插件效果不错。虽然Claude Code未必改变我的习惯，但既然能运行成功，我会在未来几周继续体验。</p>

<p>作为有十年经验的挑剔开发者，我只看重日常实用性而非品牌。Claude Code修正本文语法时表现良好，但令人沮丧的是即使要求最小修改，它仍会列出大量语法建议需人工复核——这违背了自动化初衷。折中方案是让其处理整篇文章，但这使我无法看到具体修正点从而错失学习机会。</p>

<p>最惊艳的是Claude Code以类似git diff的对比方式展示修改，大幅提升审阅效率。使用一天修复代码后，我仍维持Copilot+Grok 3的组合因其简单易用。但不得不说，几天体验下来Claude Code令我印象深刻。</p>

<p class="centered"><img src="assets/images/claude/claude-code.jpg" alt="" class="responsive" /><br />
<em class="caption">来源：自行截图</em></p>

<p class="centered"><img src="assets/images/claude/claude-fix.jpg" alt="" class="responsive" /><br />
<em class="caption">来源：自行截图</em></p>

<p class="centered"><img src="assets/images/claude/vscode-fix.jpg" alt="" class="responsive" /><br />
<em class="caption">来源：自行截图</em></p>

<hr />

<h2 id="deepseek与mistral的api使用">DeepSeek与Mistral的API使用</h2>

<p><em>2025.01.25</em></p>

<h3 id="deepseek">DeepSeek</h3>

<p>单月消耗1500万token约23.5元人民币。</p>

<p>某日使用数据如下：</p>

<table>
  <thead>
    <tr>
      <th>类型</th>
      <th>Token数</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>输入(缓存命中)</td>
      <td>946,816</td>
    </tr>
    <tr>
      <td>输入(缓存缺失)</td>
      <td>2,753,752</td>
    </tr>
    <tr>
      <td>输出</td>
      <td>3,100,977</td>
    </tr>
  </tbody>
</table>

<p>计算方式：<br />
0.94 * 0.1 + 2.75 * 1 + 3.10 * 2 = 11.83</p>

<p>可见任务成本主要取决于缓存缺失的输入token和输出token，结果符合<a href="https://api-docs.deepseek.com/quick_start/pricing/">DeepSeek API定价</a>预期。</p>

<p class="centered"><img src="assets/images/deepseek/d.jpg" alt="" /><br />
<em class="caption">来源：自行截图</em></p>

<h3 id="mistral">Mistral</h3>

<p>其模型定价如下：</p>

<table>
  <thead>
    <tr>
      <th>模型</th>
      <th>输入(美元/百万token)</th>
      <th>输出(美元/百万token)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">mistral-large-2411</code></td>
      <td>2</td>
      <td>6</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">mistral-small-latest</code></td>
      <td>0.2</td>
      <td>0.6</td>
    </tr>
  </tbody>
</table>

<p>某日使用数据(<code class="language-plaintext highlighter-rouge">mistral-large-2411</code>)：</p>

<table>
  <thead>
    <tr>
      <th>类型</th>
      <th>Token数</th>
      <th>费用(美元)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>总量</td>
      <td>772,284</td>
      <td>3.44</td>
    </tr>
    <tr>
      <td>输出</td>
      <td>474,855</td>
      <td>2.85</td>
    </tr>
    <tr>
      <td>输入</td>
      <td>297,429</td>
      <td>0.59</td>
    </tr>
  </tbody>
</table>

<p>对<code class="language-plaintext highlighter-rouge">mistral-small-2409</code>模型：总消耗1,022,407 token。假设输入占1/3、输出占2/3，则输入340,802 token(0.07美元)，输出681,605 token(0.41美元)，合计0.48美元。控制台显示0.43美元，基本吻合。</p>

<h3 id="grok">Grok</h3>

<table>
  <thead>
    <tr>
      <th>模型</th>
      <th>输入(美元/百万token)</th>
      <th>输出(美元/百万token)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">grok-2-latest</code></td>
      <td>2</td>
      <td>10</td>
    </tr>
  </tbody>
</table>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-zh" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
