<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Redsocks en Acción</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Redsocks en Acción | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Redsocks en Acción" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="es" />
<meta name="description" content="¡Por supuesto! Te guiaré a través de la configuración de un proxy Shadowsocks utilizando tu computadora Mac y configurando tu router OpenWRT para enrutar todo el tráfico de los dispositivos conectados a través de este proxy. Esta configuración implica los siguientes pasos principales:" />
<meta property="og:description" content="¡Por supuesto! Te guiaré a través de la configuración de un proxy Shadowsocks utilizando tu computadora Mac y configurando tu router OpenWRT para enrutar todo el tráfico de los dispositivos conectados a través de este proxy. Esta configuración implica los siguientes pasos principales:" />
<link rel="canonical" href="https://lzwjava.github.io/redsocks-es" />
<meta property="og:url" content="https://lzwjava.github.io/redsocks-es" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-12-18T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Redsocks en Acción" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2024-12-18T00:00:00+08:00","datePublished":"2024-12-18T00:00:00+08:00","description":"¡Por supuesto! Te guiaré a través de la configuración de un proxy Shadowsocks utilizando tu computadora Mac y configurando tu router OpenWRT para enrutar todo el tráfico de los dispositivos conectados a través de este proxy. Esta configuración implica los siguientes pasos principales:","headline":"Redsocks en Acción","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/redsocks-es"},"url":"https://lzwjava.github.io/redsocks-es"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=cf1b3c58d957960a144006e9ca3fd7c909895950">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=cf1b3c58d957960a144006e9ca3fd7c909895950" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Redsocks en Acción | Original, traducido por IA
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/es/2024-12-18-redsocks-es.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postses2024-12-18-redsocks-es.md</span> -->
      

      <!-- <span>2024-12-18-redsocks-es.md</span> -->

      
        

        
          
          <a href="#" class="button">2024.12</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/redsocks-en" >English</option>
        <option value="/redsocks-zh" >中文</option>
        <option value="/redsocks-ja" >日本語</option>
        <option value="/redsocks-es" selected>Español</option>
        <option value="/redsocks-hi" >हिंदी</option>
        <option value="/redsocks-fr" >Français</option>
        <option value="/redsocks-de" >Deutsch</option>
        <option value="/redsocks-ar" >العربية</option>
        <option value="/redsocks-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>¡Por supuesto! Te guiaré a través de la configuración de un proxy Shadowsocks utilizando tu computadora Mac y configurando tu router OpenWRT para enrutar todo el tráfico de los dispositivos conectados a través de este proxy. Esta configuración implica los siguientes pasos principales:</p>

<ol>
  <li>Configuración del Cliente Shadowsocks en macOS (Usando Shadowsocks-NG o Clash)</li>
  <li>Configuración de macOS para Permitir Conexiones de Proxy Externas</li>
  <li>Asignación de una IP Estática a tu Mac</li>
  <li>Instalación y Configuración de Redsocks en OpenWRT</li>
  <li>Redirección del Tráfico de OpenWRT a Través del Proxy en macOS</li>
  <li>Prueba de la Configuración del Proxy</li>
</ol>

<p>Profundicemos en cada paso en detalle.</p>

<hr />

<h2 id="1-configuración-del-cliente-shadowsocks-en-macos">1. Configuración del Cliente Shadowsocks en macOS</h2>

<p>Puedes usar Shadowsocks-NG o Clash como cliente de Shadowsocks. A continuación, se encuentran las instrucciones para ambos.</p>

<h3 id="opción-a-usando-shadowsocks-ng">Opción A: Usando Shadowsocks-NG</h3>

<p>Shadowsocks-NG es un cliente de Shadowsocks popular y fácil de usar para macOS.</p>

<h4 id="paso-1-descargar-e-instalar-shadowsocks-ng">Paso 1: Descargar e instalar Shadowsocks-NG</h4>

<ol>
  <li>Descargar Shadowsocks-NG:
    <ul>
      <li>Visita la <a href="https://github.com/shadowsocks/ShadowsocksX-NG/releases">página de lanzamientos de Shadowsocks-NG en GitHub</a>.</li>
      <li>Descarga el archivo <code class="language-plaintext highlighter-rouge">.dmg</code> más reciente.</li>
    </ul>
  </li>
  <li>Instala la aplicación:
    <ul>
      <li>Abre el archivo <code class="language-plaintext highlighter-rouge">.dmg</code> que descargaste.</li>
      <li>Arrastra la aplicación ShadowsocksX-NG a la carpeta de Aplicaciones.</li>
    </ul>
  </li>
  <li>Inicia Shadowsocks-NG:
    <ul>
      <li>Abre ShadowsocksX-NG desde la carpeta de Aplicaciones.</li>
      <li>Es posible que necesites otorgar los permisos necesarios a la aplicación en Preferencias del Sistema.</li>
    </ul>
  </li>
</ol>

<h4 id="paso-2-configurar-shadowsocks-ng">Paso 2: Configurar Shadowsocks-NG</h4>

<ol>
  <li>Abrir Preferencias:
    <ul>
      <li>Haz clic en el ícono de ShadowsocksX-NG en la barra de menú.</li>
      <li>Selecciona “Abrir ShadowsocksX-NG” &gt; “Preferencias”.</li>
    </ul>
  </li>
  <li>Añadir un Nuevo Servidor:
    <ul>
      <li>Navega a la pestaña “Servers”.</li>
      <li>Haz clic en el botón “+” para añadir un nuevo servidor.</li>
    </ul>
  </li>
  <li>Importa la URL de Shadowsocks:
    <ul>
      <li>Copia tu URL de Shadowsocks:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ss://[ENCRYPTED_PASSWORD]@xxx.xxx.xxx.xxx:xxxxx/?outline=1
</code></pre></div>        </div>
      </li>
      <li>Método de importación:
        <ul>
          <li>Haz clic en “Importar”.</li>
          <li>Pega tu URL de Shadowsocks.</li>
          <li>Shadowsocks-NG debería analizar automáticamente y completar los detalles del servidor.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Configura el Proxy Local:
    <ul>
      <li>Asegúrate de que la opción “Habilitar Proxy SOCKS5” esté marcada.</li>
      <li>Toma nota del Puerto Local (por defecto suele ser <code class="language-plaintext highlighter-rouge">1080</code>).</li>
    </ul>
  </li>
  <li>Guardar y Activar:
    <ul>
      <li>Haz clic en “Aceptar” para guardar el servidor.</li>
      <li>Cambia el interruptor “Habilitar Shadowsocks” a ON.</li>
    </ul>
  </li>
</ol>

<h3 id="opción-b-usando-clash">Opción B: Usando Clash</h3>

<p>Clash es un cliente proxy versátil que admite múltiples protocolos, incluyendo Shadowsocks.</p>

<h4 id="paso-1-descargar-e-instalar-clash">Paso 1: Descargar e Instalar Clash</h4>

<ol>
  <li>Descargar Clash para macOS:
    <ul>
      <li>Visita la <a href="https://github.com/Dreamacro/clash/releases">página de lanzamientos de Clash en GitHub</a>.</li>
      <li>Descarga el binario más reciente de Clash para macOS.</li>
    </ul>
  </li>
  <li>Instala la aplicación:
    <ul>
      <li>Mueve la aplicación Clash descargada a tu carpeta de Aplicaciones.</li>
    </ul>
  </li>
  <li>Iniciar Clash:
    <ul>
      <li>Abre Clash desde la carpeta de Aplicaciones.</li>
      <li>Es posible que necesites otorgar los permisos necesarios en Preferencias del Sistema.</li>
    </ul>
  </li>
</ol>

<h4 id="paso-2-configurar-clash">Paso 2: Configurar Clash</h4>

<ol>
  <li>Acceder al Archivo de Configuración:
    <ul>
      <li>Clash utiliza un archivo de configuración en formato YAML. Puedes crearlo o editarlo utilizando un editor de texto como TextEdit o Visual Studio Code.</li>
    </ul>
  </li>
  <li>Agrega tu servidor Shadowsocks:
    <ul>
      <li>Crea un archivo de configuración (por ejemplo, <code class="language-plaintext highlighter-rouge">config.yaml</code>) con el siguiente contenido:</li>
    </ul>
  </li>
</ol>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">port</span><span class="pi">:</span> <span class="m">7890</span>
<span class="na">socks-port</span><span class="pi">:</span> <span class="m">7891</span>
<span class="na">allow-lan</span><span class="pi">:</span> <span class="no">true</span>
<span class="na">mode</span><span class="pi">:</span> <span class="s">Rule</span>
<span class="na">log-level</span><span class="pi">:</span> <span class="s">info</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">proxies</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">MyShadowsocks"</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">ss</span>
    <span class="na">server</span><span class="pi">:</span> <span class="s">xxx.xxx.xxx.xxx</span>
    <span class="na">port</span><span class="pi">:</span> <span class="s">xxxxx</span>
    <span class="na">cipher</span><span class="pi">:</span> <span class="s">chacha20-ietf-poly1305</span>
    <span class="na">password</span><span class="pi">:</span> <span class="s2">"</span><span class="s">xxxxxx"</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     <span class="na">proxy-groups</span><span class="pi">:</span>
       <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Default"</span>
         <span class="na">type</span><span class="pi">:</span> <span class="s">select</span>
         <span class="na">proxies</span><span class="pi">:</span>
           <span class="pi">-</span> <span class="s2">"</span><span class="s">MyShadowsocks"</span>
           <span class="pi">-</span> <span class="s2">"</span><span class="s">DIRECT"</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rules:
   - MATCH,Default
```

 Notas:
 - `port` y `socks-port` definen los puertos de proxy HTTP y SOCKS5 en los que Clash escuchará.
 - `allow-lan: true` permite que los dispositivos de la LAN utilicen el proxy.
 - La sección `proxies` incluye los detalles de tu servidor Shadowsocks.
 - `proxy-groups` y `rules` determinan cómo se enruta el tráfico.
</code></pre></div></div>

<ol>
  <li>Iniciar Clash con la Configuración:
    <ul>
      <li>Inicia Clash y asegúrate de que utilice tu archivo <code class="language-plaintext highlighter-rouge">config.yaml</code>.</li>
      <li>Es posible que necesites especificar la ruta de la configuración al iniciar Clash.</li>
    </ul>
  </li>
  <li>Verificar que el Proxy esté en Funcionamiento:
    <ul>
      <li>Asegúrate de que Clash esté activo y conectado a tu servidor Shadowsocks.</li>
      <li>Revisa el ícono en la barra de menú para verificar el estado.</li>
    </ul>
  </li>
</ol>

<hr />

<h2 id="2-configurar-macos-para-permitir-conexiones-de-proxy-externas">2. Configurar macOS para Permitir Conexiones de Proxy Externas</h2>

<p>Por defecto, los clientes de Shadowsocks enlazan el proxy a <code class="language-plaintext highlighter-rouge">localhost</code> (<code class="language-plaintext highlighter-rouge">127.0.0.1</code>), lo que significa que solo la Mac puede usar el proxy. Para permitir que tu router OpenWRT use este proxy, necesitas enlazar el proxy a la IP LAN de la Mac.</p>

<h3 id="para-shadowsocks-ng">Para Shadowsocks-NG:</h3>

<ol>
  <li>Abrir Preferencias:
    <ul>
      <li>Haz clic en el ícono de ShadowsocksX-NG en la barra de menú.</li>
      <li>Selecciona “Abrir ShadowsocksX-NG” &gt; “Preferencias”.</li>
    </ul>
  </li>
  <li>Ve a la pestaña Avanzado:
    <ul>
      <li>Navega hasta la pestaña “Avanzado”.</li>
    </ul>
  </li>
  <li>Configurar la Dirección de Escucha:
    <ul>
      <li>Cambia la “Dirección de Escucha” de <code class="language-plaintext highlighter-rouge">127.0.0.1</code> a <code class="language-plaintext highlighter-rouge">0.0.0.0</code> para permitir conexiones desde cualquier interfaz.</li>
      <li>Alternativamente, especifica la IP LAN del Mac (por ejemplo, <code class="language-plaintext highlighter-rouge">192.168.1.xxx</code>).</li>
    </ul>
  </li>
  <li>Guardar y Reiniciar Shadowsocks-NG:
    <ul>
      <li>Haz clic en “Aceptar” para guardar los cambios.</li>
      <li>Reinicia el cliente Shadowsocks-NG para aplicar la nueva configuración.</li>
    </ul>
  </li>
</ol>

<h3 id="para-clash">Para Clash:</h3>

<ol>
  <li>Editar el archivo de configuración:
    <ul>
      <li>Asegúrate de que la opción <code class="language-plaintext highlighter-rouge">allow-lan: true</code> esté habilitada en tu archivo <code class="language-plaintext highlighter-rouge">config.yaml</code>.</li>
    </ul>
  </li>
  <li>Vincular a Todas las Interfaces:
    <ul>
      <li>En la configuración, establecer <code class="language-plaintext highlighter-rouge">allow-lan: true</code> normalmente vincula el proxy a todas las interfaces disponibles, incluyendo la LAN.</li>
    </ul>
  </li>
  <li>Reiniciar Clash:
    <ul>
      <li>Reinicia el cliente de Clash para aplicar los cambios.</li>
    </ul>
  </li>
</ol>

<hr />

<h2 id="3-asignar-una-ip-estática-a-tu-mac">3. Asignar una IP estática a tu Mac</h2>

<p>Para garantizar una conectividad constante entre tu router OpenWRT y el Mac, asigna una dirección IP estática a tu Mac dentro de tu red local.</p>

<h3 id="pasos-para-asignar-una-ip-estática-en-macos">Pasos para Asignar una IP Estática en macOS:</h3>

<ol>
  <li>Abre las Preferencias del Sistema:
    <ul>
      <li>Haz clic en el menú de Apple y selecciona “Preferencias del Sistema”.</li>
    </ul>
  </li>
  <li>Navega a la Configuración de Red:
    <ul>
      <li>Haz clic en “Red”.</li>
    </ul>
  </li>
  <li>Selecciona tu conexión activa:
    <ul>
      <li>Elige “Wi-Fi” o “Ethernet” en la barra lateral izquierda, dependiendo de cómo tu Mac esté conectado al router.</li>
    </ul>
  </li>
  <li>Configurar los ajustes de IPv4:
    <ul>
      <li>Haz clic en “Avanzado…”.</li>
      <li>Ve a la pestaña “TCP/IP”.</li>
      <li>Cambia “Configurar IPv4” de “Usar DHCP” a “Manualmente”.</li>
    </ul>
  </li>
  <li>Configurar una Dirección IP Estática:
    <ul>
      <li>Dirección IP: Elija una IP fuera del rango DHCP de su router para evitar conflictos (por ejemplo, <code class="language-plaintext highlighter-rouge">192.168.1.xxx</code>).</li>
      <li>Máscara de Subred: Normalmente <code class="language-plaintext highlighter-rouge">255.255.255.0</code>.</li>
      <li>Router: La dirección IP de su router (por ejemplo, <code class="language-plaintext highlighter-rouge">192.168.1.1</code>).</li>
      <li>Servidor DNS: Puede usar la IP de su router o otro servicio DNS como <code class="language-plaintext highlighter-rouge">8.8.8.8</code>.</li>
    </ul>
  </li>
  <li>Aplicar Configuración:
    <ul>
      <li>Haz clic en “Aceptar” y luego en “Aplicar” para guardar los cambios.</li>
    </ul>
  </li>
</ol>

<hr />

<h2 id="4-instalación-y-configuración-de-redsocks-en-openwrt">4. Instalación y Configuración de Redsocks en OpenWRT</h2>

<p>Redsocks es un redireccionador transparente de SOCKS que te permite enrutar el tráfico de red a través de un proxy SOCKS5. Utilizaremos Redsocks para redirigir el tráfico de OpenWRT a través del proxy Shadowsocks que se ejecuta en tu Mac.</p>

<h3 id="paso-1-instalar-redsocks">Paso 1: Instalar Redsocks</h3>

<ol>
  <li>Actualizar las listas de paquetes:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   ssh root@&lt;router_ip&gt;
   opkg update
</code></pre></div></div>

<ol>
  <li>Instalar Redsocks:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>opkg <span class="nb">install </span>redsocks
</code></pre></div></div>

<p><em>Si Redsocks no está disponible en tu repositorio de OpenWRT, es posible que necesites compilarlo manualmente o utilizar un paquete alternativo.</em></p>

<h3 id="paso-2-configurar-redsocks">Paso 2: Configurar Redsocks</h3>

<ol>
  <li>
    <p>Crear o Editar el Archivo de Configuración de Redsocks:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vi /etc/redsocks.conf
</code></pre></div>    </div>
  </li>
  <li>
    <p>Agrega la Siguiente Configuración:</p>
  </li>
</ol>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="n">base</span> {
       <span class="n">log_debug</span> = <span class="n">on</span>;
       <span class="n">log_info</span> = <span class="n">on</span>;
       <span class="n">log</span> = <span class="s2">"file:/var/log/redsocks.log"</span>;
       <span class="n">daemon</span> = <span class="n">on</span>;
       <span class="n">redirector</span> = <span class="n">iptables</span>;
   }
</code></pre></div></div>

<p>```redsocks {
       local_ip = 0.0.0.0;
       local_port = 12345;  # Puerto local para que Redsocks escuche
       ip = xxx.xxx.xxx.xxx;  # IP estática del Mac
       port = xxxxx;          # Puerto local del proxy SOCKS5 de Shadowsocks-NG
       type = socks5;
       login = “”;           # Si tu proxy requiere autenticación
       password = “”;
   }</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
   Notas:
   - `local_port`: El puerto en el que Redsocks escucha las conexiones entrantes desde redirecciones de iptables.
   - `ip` y `port`: Apuntan al proxy SOCKS5 de Shadowsocks en tu Mac (`xxx.xxx.xxx.xxx:xxxxx` según los pasos anteriores).
   - `type`: Configúralo como `socks5`, ya que Shadowsocks proporciona un proxy SOCKS5.

3. Guardar y Salir:
   - Presiona `ESC`, escribe `:wq`, y presiona `Enter`.

4. Crear Archivo de Registro:

```bash
   touch /var/log/redsocks.log
   chmod 644 /var/log/redsocks.log
</code></pre></div></div>

<h3 id="paso-3-iniciar-el-servicio-de-redsocks">Paso 3: Iniciar el Servicio de Redsocks</h3>

<ol>
  <li>
    <p>Habilitar Redsocks para que se Inicie al Arrancar:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/etc/init.d/redsocks <span class="nb">enable</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Iniciar Redsocks:</p>
  </li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   /etc/init.d/redsocks start
</code></pre></div></div>

<ol>
  <li>Verifica que Redsocks esté en ejecución:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ps | <span class="nb">grep </span>redsocks
</code></pre></div></div>

<p>Deberías ver un proceso de Redsocks en ejecución.</p>

<hr />

<h2 id="5-redirigiendo-el-tráfico-de-openwrt-a-través-del-proxy-de-macos">5. Redirigiendo el Tráfico de OpenWRT a Través del Proxy de macOS</h2>

<p>Ahora que Redsocks está configurado en OpenWRT, configura iptables para redirigir todo el tráfico TCP saliente a través de Redsocks, que a su vez lo enruta a través del proxy Shadowsocks de tu Mac.</p>

<h3 id="paso-1-configurar-las-reglas-de-iptables">Paso 1: Configurar las reglas de iptables</h3>

<ol>
  <li>Agregar reglas de iptables para redirigir el tráfico:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="c"># Redirigir todo el tráfico TCP a Redsocks (excepto el tráfico al propio proxy)</span>
   iptables <span class="nt">-t</span> nat <span class="nt">-N</span> REDSOCKS
   iptables <span class="nt">-t</span> nat <span class="nt">-A</span> REDSOCKS <span class="nt">-d</span> xxx.xxx.xxx.xxx <span class="nt">-p</span> tcp <span class="nt">--dport</span> xxxxx <span class="nt">-j</span> RETURN
   iptables <span class="nt">-t</span> nat <span class="nt">-A</span> REDSOCKS <span class="nt">-p</span> tcp <span class="nt">-j</span> REDIRECT <span class="nt">--to-ports</span> 12345
</code></pre></div></div>

<p># Aplicar la cadena REDSOCKS a todo el tráfico saliente
   iptables -t nat -A OUTPUT -p tcp -j REDSOCKS
   iptables -t nat -A PREROUTING -p tcp -j REDSOCKS</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
   Explicación:
   - Crear una Nueva Cadena: `REDSOCKS`
   - Excluir Tráfico del Proxy: Asegurarse de que el tráfico destinado al propio proxy no sea redirigido.
   - Redirigir Otro Tráfico TCP: Redirigir otro tráfico TCP al puerto de escucha de Redsocks (`12345`).

2. Guardar las reglas de iptables:

Para que estas reglas sean persistentes después de reinicios, agrégalas a la configuración del firewall.

   ```bash
   vi /etc/firewall.user
</code></pre></div></div>

<p>Agrega las reglas de iptables:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="c"># Redirigir todo el tráfico TCP a Redsocks (excepto el proxy)</span>
   iptables <span class="nt">-t</span> nat <span class="nt">-N</span> REDSOCKS
   iptables <span class="nt">-t</span> nat <span class="nt">-A</span> REDSOCKS <span class="nt">-d</span> xxx.xxx.xxx.xxx <span class="nt">-p</span> tcp <span class="nt">--dport</span> xxxxx <span class="nt">-j</span> RETURN
   iptables <span class="nt">-t</span> nat <span class="nt">-A</span> REDSOCKS <span class="nt">-p</span> tcp <span class="nt">-j</span> REDIRECT <span class="nt">--to-ports</span> 12345
</code></pre></div></div>

<p># Aplicar la cadena REDSOCKS
   iptables -t nat -A OUTPUT -p tcp -j REDSOCKS
   iptables -t nat -A PREROUTING -p tcp -j REDSOCKS</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
   Guardar y Salir:
   - Presiona `ESC`, escribe `:wq` y presiona `Enter`.

3. Reinicia el Firewall para Aplicar los Cambios:

```bash
   /etc/init.d/firewall restart
</code></pre></div></div>

<h3 id="paso-2-verificar-que-el-tráfico-esté-siendo-redirigido">Paso 2: Verificar que el tráfico esté siendo redirigido</h3>

<ol>
  <li>
    <p>Verificar los registros de Redsocks:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> /var/log/redsocks.log
</code></pre></div>    </div>
  </li>
</ol>

<p>Deberías ver registros que indiquen que el tráfico está siendo procesado a través de Redsocks.</p>

<ol>
  <li>Prueba desde un dispositivo cliente:
    <ul>
      <li>Conecta un dispositivo a tu router OpenWRT.</li>
      <li>Visita un sitio web o realiza una acción que utilice internet.</li>
      <li>Verifica que el tráfico se enrute a través del proxy Shadowsocks comprobando la dirección IP externa (por ejemplo, a través de <a href="https://www.whatismyip.com/">WhatIsMyIP.com</a>) para ver si refleja la IP del proxy.</li>
    </ul>
  </li>
</ol>

<hr />

<h2 id="6-prueba-de-la-configuración-del-proxy">6. Prueba de la Configuración del Proxy</h2>

<p>Asegúrate de que toda la configuración funcione como se espera realizando las siguientes pruebas.</p>

<h3 id="paso-1-verificar-la-conexión-de-shadowsocks-en-mac">Paso 1: Verificar la conexión de Shadowsocks en Mac</h3>

<ol>
  <li>Verificar el estado del cliente Shadowsocks:
    <ul>
      <li>Asegúrate de que Shadowsocks-NG o Clash estén conectados activamente al servidor Shadowsocks.</li>
      <li>Verifica que el proxy local (por ejemplo, <code class="language-plaintext highlighter-rouge">xxx.xxx.xxx.xxx:xxxxx</code>) sea accesible.</li>
    </ul>
  </li>
  <li>Prueba el Proxy Localmente:
    <ul>
      <li>En tu Mac, abre un navegador y configúralo para usar <code class="language-plaintext highlighter-rouge">localhost:1080</code> como el proxy SOCKS5.</li>
      <li>Visita <a href="https://www.whatismyip.com/">WhatIsMyIP.com</a> para confirmar que la IP coincide con la del servidor Shadowsocks.</li>
    </ul>
  </li>
</ol>

<h3 id="paso-2-verificar-que-el-tráfico-de-openwrt-se-enrute-a-través-del-proxy">Paso 2: Verificar que el tráfico de OpenWRT se enrute a través del proxy</h3>

<ol>
  <li>Verificar la IP Externa de OpenWRT:
    <ul>
      <li>Desde un dispositivo conectado a OpenWRT, visita <a href="https://www.whatismyip.com/">WhatIsMyIP.com</a> para ver si la IP refleja la IP del servidor Shadowsocks.</li>
    </ul>
  </li>
  <li>Monitorear los registros de Redsocks:
    <ul>
      <li>En OpenWRT, monitorea los registros de Redsocks para asegurarte de que el tráfico se esté redirigiendo correctamente.</li>
    </ul>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tail</span> <span class="nt">-f</span> /var/log/redsocks.log
</code></pre></div>    </div>
  </li>
  <li>Solucionar problemas si es necesario:
    <ul>
      <li>Si el tráfico no se está enrutando correctamente:
        <ul>
          <li>Asegúrate de que el cliente Shadowsocks en Mac esté en ejecución y sea accesible.</li>
          <li>Verifica que las reglas de iptables estén configuradas correctamente.</li>
          <li>Revisa la configuración del firewall tanto en Mac como en OpenWRT.</li>
        </ul>
      </li>
    </ul>
  </li>
</ol>

<hr />

<h2 id="consideraciones-adicionales">Consideraciones Adicionales</h2>

<h3 id="1-seguridad">1. Seguridad</h3>

<ul>
  <li>Asegura tu Proxy:
    <ul>
      <li>Asegúrate de que solo dispositivos de confianza puedan acceder al proxy. Dado que estás redirigiendo todo el tráfico a través de Redsocks, asegúrate de que el firewall de tu Mac solo permita conexiones desde tu router OpenWRT.</li>
    </ul>
  </li>
</ul>

<p>En macOS:</p>

<ul>
  <li>Ve a Preferencias del Sistema &gt; Seguridad y Privacidad &gt; Firewall.</li>
  <li>
    <p>Configura el firewall para permitir conexiones entrantes en el puerto del proxy (<code class="language-plaintext highlighter-rouge">xxxxx</code>) solo desde la IP del router OpenWRT.</p>
  </li>
  <li>Autenticación:
    <ul>
      <li>Shadowsocks ya proporciona un cierto nivel de seguridad a través del cifrado. Asegúrate de utilizar contraseñas fuertes y métodos de cifrado robustos.</li>
    </ul>
  </li>
</ul>

<h3 id="2-rendimiento">2. Rendimiento</h3>

<ul>
  <li>Recursos del Router:
    <ul>
      <li>Ejecutar servicios de proxy como Redsocks puede consumir CPU y memoria adicionales en tu router OpenWRT. Asegúrate de que tu router tenga recursos suficientes.</li>
    </ul>
  </li>
  <li>Rendimiento del Mac:
    <ul>
      <li>Asegúrate de que tu Mac permanezca encendida y conectada a la red para mantener la disponibilidad del proxy.</li>
    </ul>
  </li>
</ul>

<h3 id="3-mantenimiento">3. Mantenimiento</h3>

<ul>
  <li>Monitoreo de Registros:
    <ul>
      <li>Revisa periódicamente los registros de Redsocks y Shadowsocks en busca de actividades inusuales o errores.</li>
    </ul>
  </li>
  <li>Actualizar Software:
    <ul>
      <li>Mantén OpenWRT, Redsocks y tu cliente de Shadowsocks actualizados para beneficiarte de parches de seguridad y mejoras de rendimiento.</li>
    </ul>
  </li>
</ul>

<h3 id="4-enfoques-alternativos">4. Enfoques Alternativos</h3>

<p>Si bien es factible usar una Mac como servidor proxy intermediario, considera las siguientes alternativas para configuraciones potencialmente más simples:</p>

<ul>
  <li>Configurar OpenWRT directamente como cliente de Shadowsocks:
    <ul>
      <li>OpenWRT admite Shadowsocks directamente a través de paquetes como <code class="language-plaintext highlighter-rouge">shadowsocks-libev</code>. Este enfoque elimina la necesidad de un intermediario con Mac.</li>
    </ul>
  </li>
  <li>Usa un Dispositivo Dedicado de Proxy/VPN:
    <ul>
      <li>Dispositivos como Raspberry Pi pueden ejecutar servicios de proxy y actuar como puertas de enlace dedicadas.</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="conclusión">Conclusión</h2>

<p>Siguiendo los pasos descritos anteriormente, has configurado tu Mac como un servidor proxy Shadowsocks y has configurado tu router OpenWRT para enrutar todo el tráfico de los dispositivos conectados a través de este proxy. Esta configuración mejora la privacidad y el control de tu red al aprovechar el protocolo Shadowsocks.</p>

<p>Resumen de Puntos Clave:</p>

<ol>
  <li>Cliente Shadowsocks en Mac:
    <ul>
      <li>Instalé y configuré Shadowsocks-NG o Clash con la URL de Shadowsocks que proporcionaste.</li>
      <li>Configuré el cliente para que escuche en la dirección IP LAN del Mac.</li>
    </ul>
  </li>
  <li>Accesibilidad del Proxy:
    <ul>
      <li>Asigné una IP estática a la Mac para garantizar un acceso consistente al proxy.</li>
      <li>Configuré el firewall de macOS para permitir conexiones entrantes al proxy.</li>
    </ul>
  </li>
  <li>Configuración de OpenWRT:
    <ul>
      <li>Instalé y configuré Redsocks para redirigir todo el tráfico TCP saliente a través del proxy Shadowsocks.</li>
      <li>Apliqué las reglas necesarias de iptables para hacer cumplir la redirección del tráfico.</li>
    </ul>
  </li>
  <li>Pruebas:
    <ul>
      <li>Verifiqué que el tráfico de los dispositivos conectados se enruta a través del proxy Shadowsocks comprobando las direcciones IP externas.</li>
    </ul>
  </li>
</ol>

<p>Recomendaciones:</p>

<ul>
  <li><strong>Garantiza la Estabilidad</strong>: Mantén tu Mac encendida y conectada para asegurar la disponibilidad del proxy.</li>
  <li><strong>Seguridad Primero</strong>: Actualiza regularmente todos los componentes y monitorea los registros para protegerte contra accesos no autorizados.</li>
  <li><strong>Considera la Configuración Directa del Router</strong>: Para una configuración más simplificada, explora la posibilidad de configurar Shadowsocks directamente en tu router OpenWRT.</li>
</ul>

<p>Si encuentras algún problema o necesitas más ayuda con configuraciones específicas, ¡no dudes en contactarnos!</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>base {
    log_debug = on;
    log_info = on;
    log = "file:/var/log/redsocks.log";
    daemon = on;
    redirector = generic;
}
</code></pre></div></div>

<p>El bloque de configuración anterior define la configuración base para <code class="language-plaintext highlighter-rouge">redsocks</code>. Aquí está la traducción al español de los comentarios:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">log_debug = on;</code>: Activa los registros de depuración.</li>
  <li><code class="language-plaintext highlighter-rouge">log_info = on;</code>: Activa los registros de información.</li>
  <li><code class="language-plaintext highlighter-rouge">log = "file:/var/log/redsocks.log";</code>: Especifica la ubicación del archivo de registro.</li>
  <li><code class="language-plaintext highlighter-rouge">daemon = on;</code>: Ejecuta <code class="language-plaintext highlighter-rouge">redsocks</code> en modo demonio (en segundo plano).</li>
  <li><code class="language-plaintext highlighter-rouge">redirector = generic;</code>: Define el tipo de redireccionador como genérico.</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">redsocks {
    local_ip = 0.0.0.0;
    local_port = 7891;
    ip = xxx.xxx.xxx.xxx;
    port = xxxxx;
    type = http-connect;
    login = "";
    password = "";
}
</code></p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-es" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
