<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>轻聊 iOS</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>轻聊 iOS | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="轻聊 iOS" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="zh" />
<meta name="description" content="这是从 github 项目 https://github.com/lzwjava/leanchat-ios 的 README.md。" />
<meta property="og:description" content="这是从 github 项目 https://github.com/lzwjava/leanchat-ios 的 README.md。" />
<link rel="canonical" href="https://lzwjava.github.io/leanchat-ios-zh" />
<meta property="og:url" content="https://lzwjava.github.io/leanchat-ios-zh" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-11-20T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="轻聊 iOS" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2014-11-20T00:00:00+08:00","datePublished":"2014-11-20T00:00:00+08:00","description":"这是从 github 项目 https://github.com/lzwjava/leanchat-ios 的 README.md。","headline":"轻聊 iOS","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/leanchat-ios-zh"},"url":"https://lzwjava.github.io/leanchat-ios-zh"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=48c918eaf14f3bbd498388217a5c5e47049b2a84">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=48c918eaf14f3bbd498388217a5c5e47049b2a84" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       轻聊 iOS | 原创，AI翻译
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/zh/2014-11-20-leanchat-ios-zh.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postszh2014-11-20-leanchat-ios-zh.md</span> -->
      

      <!-- <span>2014-11-20-leanchat-ios-zh.md</span> -->

      
        

        
          
          <a href="#" class="button">2014.11</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/leanchat-ios-en" >English</option>
        <option value="/leanchat-ios-zh" selected>中文</option>
        <option value="/leanchat-ios-ja" >日本語</option>
        <option value="/leanchat-ios-es" >Español</option>
        <option value="/leanchat-ios-hi" >हिंदी</option>
        <option value="/leanchat-ios-fr" >Français</option>
        <option value="/leanchat-ios-de" >Deutsch</option>
        <option value="/leanchat-ios-ar" >العربية</option>
        <option value="/leanchat-ios-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>这是从 github 项目 <a href="https://github.com/lzwjava/leanchat-ios">https://github.com/lzwjava/leanchat-ios</a> 的 README.md。</p>

<hr />

<p><img src="https://img.shields.io/badge/license-MIT-green.svg?style=flat" alt="许可证 MIT" /> 
<a href="http://cocoapods.org/?q=LeanChatLib"><img src="http://img.shields.io/cocoapods/v/LeanChatLib.svg?style=flat" alt="CocoaPods" /></a> 
<a href="http://cocoapods.org/?q=LeanChatLib"><img src="http://img.shields.io/cocoapods/p/LeanChatLib.svg?style=flat" alt="CocoaPods" /></a> 
<a href="https://www.apple.com/nl/ios/"><img src="https://img.shields.io/badge/support-iOS%207%2B%20-blue.svg?style=flat" alt="支持" /></a></p>

<p><img src="https://cloud.githubusercontent.com/assets/5022872/8431636/4eff0aca-1f6d-11e5-8728-f8f450dac380.gif" alt="leanchat" /></p>

<h2 id="应用商店">应用商店</h2>
<p>LeanChat 可在应用商店获得。您可以访问 <a href="https://itunes.apple.com/gb/app/leanchat/id943324553">https://itunes.apple.com/gb/app/leanchat/id943324553</a> 或在应用商店中搜索 LeanChat。</p>

<h2 id="引言">引言</h2>
<p>该示例项目全面展示了 LeanCloud 的实时通信功能的应用。然而，它包含大量的 UI 代码和其他功能，不适合快速学习。如果您是 LeanMessage 的新手，我们推荐 <a href="https://github.com/leancloud/LeanMessage-Demo">LeanMessage-Demo</a> 项目。熟悉后，您可以访问 <a href="https://github.com/leancloud/leancloud-demos">LeanCloud-Demos</a> 选择您喜欢的 IM 外观进行集成。在集成过程中，如果遇到困难，可以参考 LeanChat 项目。</p>

<h2 id="leanchat-项目结构">LeanChat 项目结构</h2>

<ul>
  <li><a href="https://github.com/leancloud/leanchat-android">leanchat-android</a>: Android 客户端</li>
  <li><a href="https://github.com/leancloud/leanchat-ios">leanchat-ios</a>: iOS 客户端</li>
  <li><a href="https://github.com/leancloud/leanchat-webapp">leanchat-webapp</a>: Web 客户端</li>
  <li><a href="https://github.com/leancloud/leanchat-cloudcode">leanchat-cloud-code</a>: 服务器端</li>
</ul>

<h2 id="有价值的反馈">有价值的反馈</h2>

<p>如果有任何问题，请随时提交一个 <a href="https://github.com/leancloud/leanchat-ios/issues">issue</a>，说明您不理解的内容，我们会尽快提供帮助。</p>

<h2 id="下载">下载</h2>
<p>请直接点击 Github 上显示的 <code class="language-plaintext highlighter-rouge">Download Zip</code> 图标下载最新版本。如果使用 <code class="language-plaintext highlighter-rouge">git clone</code>，可能会非常慢，因为它包含了大量的提交历史。在测试中，差异为：1.5M:40M。</p>

<p><img src="https://cloud.githubusercontent.com/assets/5022872/8223520/4c25415a-15ab-11e5-912d-b5dab916ce86.png" alt="qq20150618-2 2x" /></p>

<h2 id="运行">运行</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  // LeanChat <span class="o">(</span>复杂示例<span class="o">)</span>
  <span class="nb">cd </span>LeanChat
  pod <span class="nb">install</span> <span class="nt">--verbose</span>  // 如果本地有 AVOSCloud 依赖库，可以添加 <span class="nt">--no-repo-update</span> 选项以加速过程
  open LeanChat.workspace

  // LeanChatExample <span class="o">(</span>简单示例<span class="o">)</span>
  <span class="nb">cd </span>LeanChatExample
  pod <span class="nb">install</span> <span class="nt">--verbose</span> <span class="nt">--no-repo-update</span>
  open LeanChatExample.xcworkspace

  // LeanChatSwift <span class="o">(</span>Swift 示例<span class="o">)</span>
  <span class="nb">cd </span>LeanChatSwift
  pod <span class="nb">install</span> <span class="nt">--verbose</span> <span class="nt">--no-repo-update</span>
  open LeanChatSwift.xcworkspace

  // LeanChatLib <span class="o">(</span>封装 LeanCloud 通信组件和 UI 的库<span class="o">)</span>
  <span class="nb">cd </span>LeanChatLib
  pod <span class="nb">install</span> <span class="nt">--verbose</span> <span class="nt">--no-repo-update</span>
  open LeanChatLib.xcworkspace
</code></pre></div></div>

<p>如果遇到类似于 <code class="language-plaintext highlighter-rouge">definition of 'AVUser' must be imported from module 'LeanChatLib.CDChatListVC' before it is required</code> 的问题，可以按住 Option 键，在 Produce 菜单中点击 <a href="http://stackoverflow.com/questions/8087065/xcode-4-clean-vs-clean-build-folder">Clean Build Folder</a> 清除所有构建文件，然后重新编译。这个问题似乎是 CocoaPods 在执行复杂编译时的一个错误。可以查看此 <a href="https://cloud.githubusercontent.com/assets/5022872/9230256/cf822fe4-4153-11e5-876d-ed819babad89.gif">Gif</a> 以获取更多详细信息。</p>

<p>请注意，由于默认使用生产证书，开发过程中离线消息不会有推送通知。然而，在线版本可以通过 <a href="https://itunes.apple.com/gb/app/leanchat/id943324553">App Store</a> 下载，它提供推送通知。有关更多详细信息，可以参考此 <a href="https://github.com/leancloud/leanchat-ios/issues/40">issue</a>。</p>

<h2 id="子项目介绍">子项目介绍</h2>
<ul>
  <li>LeanChatLib: 聊天的核心逻辑和 UI 库。使用它可以快速集成聊天功能，支持文本、音频、图片和表情消息，以及消息通知。还有一个对应的 <a href="https://github.com/leancloud/leanchat-android">Android 版本</a>。</li>
  <li>LeanChatExample: LeanChatLib 的最简单用法示例。它展示了如何使用最少的代码调用 LeanChatLib 加入聊天，无论使用 LeanCloud 的用户系统还是自己的用户系统。</li>
  <li>LeanChat-ios: 完整的 LeanChat 应用。它包括了好友管理、群组管理、位置消息、附近用户、个人页、登录和注册等功能，基于 LeanCloud 的存储和通信能力。这是 LeanChatLib 的一个更复杂的应用。</li>
</ul>

<h2 id="leanchatlib-介绍">LeanChatLib 介绍</h2>

<p>它封装了最近会话页面和聊天页面。LeanChat 和 LeanChatExample 项目都依赖于它。可以按照以下方法安装,</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    pod 'LeanChatLib'
</code></pre></div></div>

<p>大多数时候，您会通过将源代码拖入项目来集成 LeanChatLib。在这种情况下，您需要先安装 <code class="language-plaintext highlighter-rouge">AVOSCloud.framework</code> 和 <code class="language-plaintext highlighter-rouge">AVOSCloudIM.framework</code>。如果没有使用 <code class="language-plaintext highlighter-rouge">pod install 'AVOSCloud'</code> 和 <code class="language-plaintext highlighter-rouge">pod install 'AVOSCloudIM'</code> 进行安装，可以根据 LeanCloud <a href="https://leancloud.cn/docs/start.html">快速上手指南</a> 配置所需的 Frameworks。还需要安装其他两个依赖库 <code class="language-plaintext highlighter-rouge">JSBadgeView</code> 和 <code class="language-plaintext highlighter-rouge">DateTools</code>。在运行 <code class="language-plaintext highlighter-rouge">pod install</code> 以安装此示例时，将生成一个 Pods 目录，其中可以找到这两个 Pods。或者，可以在 <a href="https://github.com/leancloud/leanchat-ios/blob/master/LeanChatLib.podspec#L9">.podspec 文件</a> 中进行配置，描述需要集成的源文件和需要引入的系统框架等。或者，请参考此 <a href="https://ticket.leancloud.cn/tickets/7666">票据</a>。</p>

<h2 id="如何在三步中添加-im">如何在三步中添加 IM</h2>
<ol>
  <li>创建一个 LeanCloud 应用。</li>
  <li>添加 LeanChatLib pod 依赖，或者将 LeanChatLib 代码文件拖入您的项目中，以便更容易地进行 UI 定制和功能调整。</li>
  <li>在适当的地方添加以下代码,</li>
</ol>

<p>在应用启动时初始化和配置 IM 用户，</p>
<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">[</span><span class="n">AVOSCloud</span> <span class="nf">setApplicationId</span><span class="p">:</span><span class="s">@"YourAppId"</span> <span class="nf">clientKey</span><span class="p">:</span><span class="s">@"YourAppKey"</span><span class="p">];</span>
    <span class="p">[</span><span class="n">CDChatManager</span> <span class="nf">manager</span><span class="p">].</span><span class="n">userDelegate</span> <span class="o">=</span> <span class="p">[[</span><span class="n">CDUserFactory</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
</code></pre></div></div>

<p>配置一个 UserFactory，它遵循 CDUserDelegate 协议。</p>
<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#import "CDUserFactory.h"
</span>
<span class="cp">#import &lt;LeanChatLib/LeanChatLib.h&gt;
</span>
<span class="k">@interface</span> <span class="nc">CDUserFactory</span> <span class="p">()</span><span class="o">&lt;</span><span class="n">CDUserDelegate</span><span class="o">&gt;</span>

<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">CDUserFactory</span>

<span class="cp">#pragma mark - CDUserDelegate
</span><span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cacheUserByIds</span><span class="p">:(</span><span class="n">NSSet</span> <span class="o">*</span><span class="p">)</span><span class="nv">userIds</span> <span class="nf">block</span><span class="p">:(</span><span class="n">AVIMArrayResultBlock</span><span class="p">)</span><span class="nv">block</span><span class="p">{</span>
    <span class="n">block</span><span class="p">(</span><span class="nb">nil</span><span class="p">,</span><span class="nb">nil</span><span class="p">);</span> <span class="c1">// 不要忘记它</span>
<span class="p">}</span>

<span class="k">-</span><span class="p">(</span><span class="n">id</span><span class="o">&lt;</span><span class="n">CDUserModel</span><span class="o">&gt;</span><span class="p">)</span><span class="nf">getUserById</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">userId</span><span class="p">{</span>
    <span class="n">CDUser</span><span class="o">*</span> <span class="n">user</span><span class="o">=</span><span class="p">[[</span><span class="n">CDUser</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
    <span class="n">user</span><span class="p">.</span><span class="n">userId</span><span class="o">=</span><span class="n">userId</span><span class="p">;</span>
    <span class="n">user</span><span class="p">.</span><span class="n">username</span><span class="o">=</span><span class="n">userId</span><span class="p">;</span>
    <span class="n">user</span><span class="p">.</span><span class="n">avatarUrl</span><span class="o">=</span><span class="s">@"http://ac-x3o016bx.clouddn.com/86O7RAPx2BtTW5zgZTPGNwH9RZD5vNDtPm1YbIcu"</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">user</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">@end</span>
</code></pre></div></div>

<p>这里，CDUser 是应用程序中的用户对象，并且您可以在用户对象中实现 CDUserModel 协议。</p>

<p>CDUserModel,</p>
<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">@protocol</span> <span class="nc">CDUserModel</span> <span class="o">&lt;</span><span class="n">NSObject</span><span class="o">&gt;</span>

<span class="err">@required</span>

<span class="k">-</span><span class="p">(</span><span class="n">NSString</span><span class="o">*</span><span class="p">)</span><span class="n">userId</span><span class="p">;</span>

<span class="k">-</span><span class="p">(</span><span class="n">NSString</span><span class="o">*</span><span class="p">)</span><span class="n">avatarUrl</span><span class="p">;</span>

<span class="k">-</span><span class="p">(</span><span class="n">NSString</span><span class="o">*</span><span class="p">)</span><span class="n">username</span><span class="p">;</span>

<span class="k">@end</span>
</code></pre></div></div>

<p>在登录时调用，</p>
<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="p">[[</span><span class="n">CDChatManager</span> <span class="nf">manager</span><span class="p">]</span> <span class="nf">openWithClientId</span><span class="p">:</span><span class="n">selfId</span> <span class="nf">callback</span><span class="p">:</span> <span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">DLog</span><span class="p">(</span><span class="s">@"%@"</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
               <span class="c1">//go Main Controller</span>
            <span class="p">}</span>
        <span class="p">}];</span>
</code></pre></div></div>

<p>与某人聊天，</p>
<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="p">[[</span><span class="n">CDChatManager</span> <span class="nf">manager</span><span class="p">]</span> <span class="nf">fetchConvWithOtherId</span> <span class="p">:</span> <span class="n">otherId</span> <span class="nf">callback</span> <span class="p">:</span> <span class="o">^</span><span class="p">(</span><span class="n">AVIMConversation</span> <span class="o">*</span><span class="n">conversation</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">DLog</span><span class="p">(</span><span class="s">@"%@"</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="n">LCEChatRoomVC</span> <span class="o">*</span><span class="n">chatRoomVC</span> <span class="o">=</span> <span class="p">[[</span><span class="n">LCEChatRoomVC</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithConv</span><span class="p">:</span><span class="n">conversation</span><span class="p">];</span>
                <span class="p">[</span><span class="n">weakSelf</span><span class="p">.</span><span class="n">navigationController</span> <span class="nf">pushViewController</span><span class="p">:</span><span class="n">chatRoomVC</span> <span class="nf">animated</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}];</span>
</code></pre></div></div>

<p>进行群聊，</p>
<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="n">NSMutableArray</span> <span class="o">*</span><span class="n">memberIds</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableArray</span> <span class="nf">array</span><span class="p">];</span>
        <span class="p">[</span><span class="n">memberIds</span> <span class="nf">addObject</span><span class="p">:</span><span class="n">groupId1</span><span class="p">];</span>
        <span class="p">[</span><span class="n">memberIds</span> <span class="nf">addObject</span><span class="p">:</span><span class="n">groupId2</span><span class="p">];</span>
        <span class="p">[</span><span class="n">memberIds</span> <span class="nf">addObject</span><span class="p">:[</span><span class="n">CDChatManager</span> <span class="nf">manager</span><span class="p">].</span><span class="n">selfId</span><span class="p">];</span>
        <span class="p">[[</span><span class="n">CDChatManager</span> <span class="nf">manager</span><span class="p">]</span> <span class="nf">fetchConvWithMembers</span><span class="p">:</span><span class="n">memberIds</span> <span class="nf">callback</span><span class="p">:</span> <span class="o">^</span><span class="p">(</span><span class="n">AVIMConversation</span> <span class="o">*</span><span class="n">conversation</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">DLog</span><span class="p">(</span><span class="s">@"%@"</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="n">LCEChatRoomVC</span> <span class="o">*</span><span class="n">chatRoomVC</span> <span class="o">=</span> <span class="p">[[</span><span class="n">LCEChatRoomVC</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithConv</span><span class="p">:</span><span class="n">conversation</span><span class="p">];</span>
                <span class="p">[</span><span class="n">weakSelf</span><span class="p">.</span><span class="n">navigationController</span> <span class="nf">pushViewController</span><span class="p">:</span><span class="n">chatRoomVC</span> <span class="nf">animated</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}];</span>
</code></pre></div></div>

<p>在注销时，</p>
<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">[[</span><span class="n">CDChatManager</span> <span class="nf">manager</span><span class="p">]</span> <span class="nf">closeWithCallback</span><span class="p">:</span> <span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>

    <span class="p">}];</span>
</code></pre></div></div>

<p>然后，您就可以像截图中所示那样聊天。请注意，我们目前不推荐使用 pod 方法直接导入 LeanChatLib，因为有些接口和功能需要您进行自定义。因此，我们建议将 LeanChatLib 代码复制到项目中，以便更容易进行定制。</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-zh" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
