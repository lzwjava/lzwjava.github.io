<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>OpenWrt Invasion on Xiaomi Mi Router 4C</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>OpenWrt Invasion on Xiaomi Mi Router 4C | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="OpenWrt Invasion on Xiaomi Mi Router 4C" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="ar" />
<meta name="description" content="هذا هو محاولتي الثالثة لتثبيت OpenWrt. المرة الأولى كانت في عام 2019، عندما استخدمت منفذ UART للاتصال. المرة الثانية كانت في عام 2023، عندما استخدمت طريقة بعيدة مشابهة لتلك الوصفها هنا." />
<meta property="og:description" content="هذا هو محاولتي الثالثة لتثبيت OpenWrt. المرة الأولى كانت في عام 2019، عندما استخدمت منفذ UART للاتصال. المرة الثانية كانت في عام 2023، عندما استخدمت طريقة بعيدة مشابهة لتلك الوصفها هنا." />
<link rel="canonical" href="https://lzwjava.github.io/openwrt-invasion-ar" />
<meta property="og:url" content="https://lzwjava.github.io/openwrt-invasion-ar" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-02-22T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="OpenWrt Invasion on Xiaomi Mi Router 4C" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2025-02-22T00:00:00+08:00","datePublished":"2025-02-22T00:00:00+08:00","description":"هذا هو محاولتي الثالثة لتثبيت OpenWrt. المرة الأولى كانت في عام 2019، عندما استخدمت منفذ UART للاتصال. المرة الثانية كانت في عام 2023، عندما استخدمت طريقة بعيدة مشابهة لتلك الوصفها هنا.","headline":"OpenWrt Invasion on Xiaomi Mi Router 4C","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/openwrt-invasion-ar"},"url":"https://lzwjava.github.io/openwrt-invasion-ar"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=aa8525dd3b9385f3575f7ff51dabb8a21e8f2f54">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=aa8525dd3b9385f3575f7ff51dabb8a21e8f2f54" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       OpenWrt Invasion on Xiaomi Mi Router 4C | أصلي، ترجم بواسطة AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/ar/2025-02-22-openwrt-invasion-ar.md">PDF</a> -->

    <!-- Audio Button -->



    <!-- 
    <a href="#" id="playAudioButton" class="button audio-button" data-file-path="_posts/ar/2025-02-22-openwrt-invasion-ar.md">Audio</a>
     -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsar2025-02-22-openwrt-invasion-ar.md</span> -->
      

      <!-- <span>2025-02-22-openwrt-invasion-ar.md</span> -->

      
        

        
          
          <a href="#" class="button">2025.02</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/openwrt-invasion-en" >English</option>
        <option value="/openwrt-invasion-zh" >中文</option>
        <option value="/openwrt-invasion-ja" >日本語</option>
        <option value="/openwrt-invasion-es" >Español</option>
        <option value="/openwrt-invasion-hi" >हिंदी</option>
        <option value="/openwrt-invasion-fr" >Français</option>
        <option value="/openwrt-invasion-de" >Deutsch</option>
        <option value="/openwrt-invasion-ar" selected>العربية</option>
        <option value="/openwrt-invasion-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>هذا هو محاولتي الثالثة لتثبيت OpenWrt. المرة الأولى كانت في عام 2019، عندما استخدمت منفذ UART للاتصال. المرة الثانية كانت في عام 2023، عندما استخدمت طريقة بعيدة مشابهة لتلك الوصفها هنا.</p>

<p>يمكن العثور على كود الاستغلال في <a href="https://github.com/acecilia/OpenWRTInvasion">https://github.com/acecilia/OpenWRTInvasion</a>.</p>

<p>أولاً، قم بتثبيت المتطلبات:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt <span class="nt">--break-system-packages</span>
</code></pre></div></div>

<p>بعد تشغيل الاستغلال، يمكنك الوصول إلى واجهة الويب للمروحة في عنوان URL مشابه لهذا (سيعتمد قيمة <code class="language-plaintext highlighter-rouge">stok</code>):</p>

<p><code class="language-plaintext highlighter-rouge">http://192.168.1.28/cgi-bin/luci/;stok=fe9b14c5c4dee48709fbdf00e048d5ec/web/home</code></p>

<p>```bash
lzwjava@anonymous OpenWRTInvasion % python remote_command_execution_vulnerability.py
Router IP address [press enter for using the default ‘miwifi.com’]: 192.168.1.28
Enter router admin password: …
هناك خياران لتوفير الملفات اللازمة للغزو:</p>
<ol>
  <li>استخدام خادم ملفات TCP المحلي يعمل على منفذ عشوائي لتوفير الملفات في الدليل المحلي <code class="language-plaintext highlighter-rouge">script_tools</code>.</li>
  <li>تحميل الملفات المطلوبة من مستودع GitHub البعيد. (اختر هذا الخيار فقط إذا كان GitHub متاحًا داخل جهاز المروحة.)
أي خيار تفضل؟ (الاختيار الافتراضي: 1)1
<strong>**</strong><strong>**</strong><strong>**
router_ip_address: 192.168.1.28
stok: 08f4f22fed20b94580cb8e70703c941c
file provider: local file server
**</strong><strong>**</strong><strong>**</strong>
start uploading config file…
start exec command…
local file server is runing on 0.0.0.0:63067. root=’script_tools’
local file server is getting ‘busybox-mipsel’ for 192.168.1.28.
local file server is getting ‘dropbearStaticMipsel.tar.bz2’ for 192.168.1.28.
done! Now you can connect to the router using several options: (user: root, password: root)
    <ul>
      <li>telnet 192.168.1.28</li>
      <li>ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 -oHostKeyAlgorithms=+ssh-rsa -c 3des-cbc -o UserKnownHostsFile=/dev/null root@192.168.1.28</li>
      <li>ftp: using a program like cyberduck</li>
    </ul>
  </li>
</ol>

<p>root@XiaoQiang:/tmp# wget “https://downloads.openwrt.org/releases/24.10.0/targets/ramips/mt76x8/openwrt-24.10.0-ramips-mt76x8-xiaomi_mi-router-4c-squashfs-sysupgr
ade.bin”
wget: not an http or ftp url: https://downloads.openwrt.org/releases/24.10.0/targets/ramips/mt76x8/openwrt-24.10.0-ramips-mt76x8-xiaomi_mi-router-4c-squashfs-sysupgrade.bin</p>

<p>scp -oKexAlgorithms=+diffie-hellman-group1-sha1 -oHostKeyAlgorithms=+ssh-rsa -c 3des-cbc  openwrt-24.10.0-ramips-mt76x8-xiaomi_mi-router-4c-squashfs-sysupgrade.bin root@192.168.1.28:/tmp/
ash: /usr/libexec/sftp-server: not found
scp: Connection closed</p>

<table>
  <tbody>
    <tr>
      <td>cat openwrt-24.10.0-ramips-mt76x8-xiaomi_mi-router-4c-squashfs-sysupgrade.bin</td>
      <td>ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 -oHostKeyAlgorithms=+ssh-rsa root@192.168.1.28 “cat &gt; /tmp/openwrt-24.10.0-ramips-mt76x8-xiaomi_mi-router-4c-squashfs-sysupgrade.bin”</td>
    </tr>
  </tbody>
</table>

<p>root@XiaoQiang:/tmp# ls
2541.bootcheck.log                                                         oui
TZ                                                                         rc.done
appStoreRule.json                                                          rc.timing
arrays                                                                     resolv.conf
authenfailed-cache                                                         resolv.conf.auto
busybox                                                                    root
daemon                                                                     rr
datalist                                                                   run
dropbear                                                                   script.sh
dropbear.tar.bz2                                                           speedtest_urls.xml
etc                                                                        spool
ftpd                                                                       startscene_crontab.lua.PID
lock                                                                       stat_points_privacy.log
log                                                                        stat_points_rom.log
logexec                                                                    state
luci-indexcache                                                            sysapihttpd
luci-nonce                                                                 sysapihttpdconf
luci-sessions                                                              sysinfo
messages                                                                   syslog-ng.ctl
miqos.lock                                                                 syslog-ng.pid
mnt                                                                        taskmonitor
mt76xx2.sh.log                                                             uci2dat_mt7628.log
network.env                                                                uploadfiles
nginx_check.log                                                            upnp.leases
ntp.status                                                                 web_config_list
openwrt-24.10.0-ramips-mt76x8-xiaomi_mi-router-4c-squashfs-sysupgrade.bin  wifi_analysis.log</p>

<p>root@XiaoQiang:/tmp# mtd -r write openwrt-24.10.0-ramips-mt76x8-xiaomi_mi-router-4c-squashfs-sysupgrade.bin OS1
Unlocking OS1 …</p>

<p>Writing from openwrt-24.10.0-ramips-mt76x8-xiaomi_mi-router-4c-squashfs-sysupgrade.bin to OS1 …  [w]</p>

<p>اتصل بالمروحة عبر اتصال سلكي. يمكنك بعد ذلك الوصول إلى واجهة الويب في 192.168.1.1 أو استخدام SSH من خلال تشغيل <code class="language-plaintext highlighter-rouge">ssh root@192.168.1.1</code>.</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-ar" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
