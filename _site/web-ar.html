<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title># مقدمة في برمجة الويب</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>مقدمة في برمجة الويب | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="مقدمة في برمجة الويب" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="ar" />
<meta name="description" content="في المقالة السابقة، تحدثنا عن كيفية تحويل وظيفة متتالية فيبوناتشي إلى نسخة موجهة للكائنات، وقمنا بتنفيذ واجهة طرفية." />
<meta property="og:description" content="في المقالة السابقة، تحدثنا عن كيفية تحويل وظيفة متتالية فيبوناتشي إلى نسخة موجهة للكائنات، وقمنا بتنفيذ واجهة طرفية." />
<link rel="canonical" href="https://lzwjava.github.io/web-ar" />
<meta property="og:url" content="https://lzwjava.github.io/web-ar" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-07T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="مقدمة في برمجة الويب" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2021-03-07T00:00:00+08:00","datePublished":"2021-03-07T00:00:00+08:00","description":"في المقالة السابقة، تحدثنا عن كيفية تحويل وظيفة متتالية فيبوناتشي إلى نسخة موجهة للكائنات، وقمنا بتنفيذ واجهة طرفية.","headline":"مقدمة في برمجة الويب","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/web-ar"},"url":"https://lzwjava.github.io/web-ar"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=70eb137120a29d1020c8c105c9ffe3ebbb47e3e6">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=70eb137120a29d1020c8c105c9ffe3ebbb47e3e6" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       # مقدمة في برمجة الويب | أصلي، ترجم بواسطة AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/ar/2021-03-07-web-ar.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsar2021-03-07-web-ar.md</span> -->
      

      <!-- <span>2021-03-07-web-ar.md</span> -->

      
        

        
          
          <a href="#" class="button">2021.03</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/web-en" >English</option>
        <option value="/web-zh" >中文</option>
        <option value="/web-ja" >日本語</option>
        <option value="/web-es" >Español</option>
        <option value="/web-hi" >हिंदी</option>
        <option value="/web-fr" >Français</option>
        <option value="/web-de" >Deutsch</option>
        <option value="/web-ar" selected>العربية</option>
        <option value="/web-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>في المقالة السابقة، تحدثنا عن كيفية تحويل وظيفة متتالية فيبوناتشي إلى نسخة موجهة للكائنات، وقمنا بتنفيذ واجهة طرفية.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># server.py
</span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/echo'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'POST'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">echo</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">json</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">BaseHandler</span><span class="p">:</span>
  <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Server</span><span class="p">:</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handlerClass</span><span class="p">):</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">handlerClass</span> <span class="o">=</span> <span class="n">handlerClass</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>    
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
      <span class="n">request</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">handlerClass</span><span class="p">().</span><span class="n">handle</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">fib_handle.py</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">fib</span> <span class="kn">import</span> <span class="n">f</span>
<span class="kn">from</span> <span class="nn">server</span> <span class="kn">import</span> <span class="n">BaseHandler</span><span class="p">,</span> <span class="n">Server</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">FibHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'f(n)='</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">pass</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="n">FibHandler</span><span class="p">)</span>
<span class="n">server</span><span class="p">.</span><span class="n">run</span><span class="p">()</span>  
</code></pre></div></div>
<h2 id="خادم-ويب-بسيط">خادم ويب بسيط</h2>

<p>كيف يمكن تحويله إلى واجهة <code class="language-plaintext highlighter-rouge">Web</code>؟</p>

<p>سنقوم باستبدال <code class="language-plaintext highlighter-rouge">Server</code> أعلاه بـ <code class="language-plaintext highlighter-rouge">Server</code> الخاص بـ <code class="language-plaintext highlighter-rouge">بروتوكول HTTP</code>. دعونا أولاً نلقي نظرة على كيفية عمل <code class="language-plaintext highlighter-rouge">خادم HTTP</code> في Python.</p>

<p>توفر مكتبة Python القياسية خادم ويب مدمج.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python -m http.server
</code></pre></div></div>

<p>قم بتشغيله في الطرفية.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python <span class="nt">-m</span> http.server
يتم تقديم HTTP على المنفذ 8000 <span class="o">(</span>http://[::]:8000/<span class="o">)</span> ...
</code></pre></div></div>

<p>في المتصفح، يمكنك فتحه لرؤية النتيجة.</p>

<p><img src="/assets/images/web/webserver.png" alt="webserver" style="zoom:50%;" /></p>

<p>هذا يعرض محتويات الدليل الحالي. بعد ذلك، عند تصفح هذه الصفحة، ارجع إلى الطرفية. هذه المرة، سيكون الأمر مثيرًا للاهتمام.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python <span class="nt">-m</span> http.server
يتم تقديم HTTP على المنفذ 8000 <span class="o">(</span>http://[::]:8000/<span class="o">)</span> ...
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] <span class="s2">"GET / HTTP/1.1"</span> 200 -
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] رمز 404، رسالة الملف غير موجود
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] <span class="s2">"GET /favicon.ico HTTP/1.1"</span> 404 -
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] رمز 404، رسالة الملف غير موجود
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] <span class="s2">"GET /apple-touch-icon-precomposed.png HTTP/1.1"</span> 404 -
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] رمز 404، رسالة الملف غير موجود
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] <span class="s2">"GET /apple-touch-icon.png HTTP/1.1"</span> 404 -
::1 - - <span class="o">[</span>07/Mar/2021 15:30:38] <span class="s2">"GET / HTTP/1.1"</span> 200 -
</code></pre></div></div>

<p>هذا سجل زيارات صفحة الويب. حيث يشير <code class="language-plaintext highlighter-rouge">GET</code> إلى عملية وصول إلى البيانات في خدمة صفحات الويب. و<code class="language-plaintext highlighter-rouge">HTTP/1.1</code> يشير إلى استخدام بروتوكول <code class="language-plaintext highlighter-rouge">HTTP</code> بالإصدار <code class="language-plaintext highlighter-rouge">1.1</code>.</p>

<p>كيفية استخدامه لبناء خدمة متتالية فيبوناتشي الخاصة بنا. أولاً، ابحث عن نموذج للكود على الإنترنت، وقم بتعديله قليلاً، ثم اكتب خادم ويب بسيطًا:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">http.server</span> <span class="kn">import</span> <span class="n">SimpleHTTPRequestHandler</span><span class="p">,</span> <span class="n">HTTPServer</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Handler</span><span class="p">(</span><span class="n">SimpleHTTPRequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">send_header</span><span class="p">(</span><span class="s">'Content-type'</span><span class="p">,</span> <span class="s">'text'</span><span class="p">)</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">end_headers</span><span class="p">()</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="s">"مرحبًا"</span><span class="p">,</span> <span class="s">"utf-8"</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">server</span> <span class="o">=</span> <span class="n">HTTPServer</span><span class="p">((</span><span class="s">"127.0.0.1"</span><span class="p">,</span> <span class="mi">8000</span><span class="p">),</span> <span class="n">Handler</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">server</span><span class="p">.</span><span class="n">serve_forever</span><span class="p">()</span>
</code></pre></div></div>

<p>هل تبدو هذه مألوفة؟ إنها تقريبًا مثل استخدامنا لـ <code class="language-plaintext highlighter-rouge">Server</code> أعلاه. لاحظ أن <code class="language-plaintext highlighter-rouge">SimpleHTTPRequestHandler</code> ليس فئة أساسية، بل هناك فئة أخرى تسمى <code class="language-plaintext highlighter-rouge">BaseHTTPRequestHandler</code>. <code class="language-plaintext highlighter-rouge">SimpleHTTPRequestHandler</code> يعالج بعض الأشياء الإضافية مقارنة بـ <code class="language-plaintext highlighter-rouge">BaseHTTPRequestHandler</code>. إضافة وظيفة معالجة متسلسلة فيبوناتشي إلى هذه الفئة أمر سهل.</p>

<p>هنا، <code class="language-plaintext highlighter-rouge">127.0.0.1</code> يمثل عنوان الجهاز المحلي، و<code class="language-plaintext highlighter-rouge">8000</code> يمثل المنفذ (Port) على الجهاز المحلي. كيف نفهم المنفذ؟ يمكن تشبيهه بنافذة في المنزل، فهو نقطة اتصال بين المنزل والعالم الخارجي. <code class="language-plaintext highlighter-rouge">bytes</code> تعني تحويل النص إلى بايتات. <code class="language-plaintext highlighter-rouge">utf-8</code> هي طريقة ترميز للنصوص. <code class="language-plaintext highlighter-rouge">send_response</code> و<code class="language-plaintext highlighter-rouge">send_header</code> و<code class="language-plaintext highlighter-rouge">end_headers</code> كلها وظائف تُستخدم لإخراج محتوى يتوافق مع بروتوكول <code class="language-plaintext highlighter-rouge">HTTP</code>، حتى يتمكن المتصفح من فهمه. وبهذه الطريقة، نرى كلمة <code class="language-plaintext highlighter-rouge">hi</code> في صفحة الويب.</p>

<p><img src="/assets/images/web/hi.png" alt="مرحبًا" style="zoom:50%;" /></p>

<p>ثم حاول مرة أخرى الحصول على المعلمات من الطلب.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">http.server</span> <span class="kn">import</span> <span class="n">SimpleHTTPRequestHandler</span><span class="p">,</span> <span class="n">HTTPServer</span>
<span class="kn">from</span> <span class="nn">fib</span> <span class="kn">import</span> <span class="n">f</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span><span class="p">,</span><span class="n">parse_qs</span>
</code></pre></div></div>

<p>تم ترجمة الكود أعلاه إلى العربية كما يلي:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">http.server</span> <span class="kn">import</span> <span class="n">SimpleHTTPRequestHandler</span><span class="p">,</span> <span class="n">HTTPServer</span>
<span class="kn">from</span> <span class="nn">fib</span> <span class="kn">import</span> <span class="n">f</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span><span class="p">,</span><span class="n">parse_qs</span>
</code></pre></div></div>

<p>ملاحظة: الكود لم يتغير لأنه يحتوي على أسماء مكتبات ووظائف بلغة Python، والتي لا يتم ترجمتها عادةً.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Handler</span><span class="p">(</span><span class="n">SimpleHTTPRequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">send_header</span><span class="p">(</span><span class="s">'Content-type'</span><span class="p">,</span> <span class="s">'text'</span><span class="p">)</span>      
        <span class="bp">self</span><span class="p">.</span><span class="n">end_headers</span><span class="p">()</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">path</span><span class="p">)</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="n">parse_qs</span><span class="p">(</span><span class="n">parsed</span><span class="p">.</span><span class="n">query</span><span class="p">)</span>      
        <span class="n">result</span> <span class="o">=</span> <span class="s">""</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="n">qs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>          
                <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s">"utf-8"</span><span class="p">))</span>
</code></pre></div></div>

<p>تمت ترجمة الكود أعلاه إلى:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Handler</span><span class="p">(</span><span class="n">SimpleHTTPRequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">send_header</span><span class="p">(</span><span class="s">'Content-type'</span><span class="p">,</span> <span class="s">'text'</span><span class="p">)</span>      
        <span class="bp">self</span><span class="p">.</span><span class="n">end_headers</span><span class="p">()</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">path</span><span class="p">)</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="n">parse_qs</span><span class="p">(</span><span class="n">parsed</span><span class="p">.</span><span class="n">query</span><span class="p">)</span>      
        <span class="n">result</span> <span class="o">=</span> <span class="s">""</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="n">qs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>          
                <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s">"utf-8"</span><span class="p">))</span>
</code></pre></div></div>

<p>ملاحظة: الكود لم يتم تغييره لأنه يحتوي على أسماء دوال ومتغيرات بالإنجليزية، ويجب الحفاظ عليها كما هي.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">server</span> <span class="o">=</span> <span class="n">HTTPServer</span><span class="p">((</span><span class="s">"127.0.0.1"</span><span class="p">,</span> <span class="mi">8000</span><span class="p">),</span> <span class="n">Handler</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">server</span><span class="p">.</span><span class="n">serve_forever</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/web/n10.png" alt="n10" style="zoom:50%;" /></p>

<p>معقد بعض الشيء، أليس كذلك؟ هنا يتم تحليل بعض المعلمات.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>self.path<span class="o">=</span>/?n<span class="o">=</span>3
<span class="nv">parsed</span><span class="o">=</span>ParseResult<span class="o">(</span><span class="nv">scheme</span><span class="o">=</span><span class="s1">''</span>, <span class="nv">netloc</span><span class="o">=</span><span class="s1">''</span>, <span class="nv">path</span><span class="o">=</span><span class="s1">'/'</span>, <span class="nv">params</span><span class="o">=</span><span class="s1">''</span>, <span class="nv">query</span><span class="o">=</span><span class="s1">'n=3'</span>, <span class="nv">fragment</span><span class="o">=</span><span class="s1">''</span><span class="o">)</span>
<span class="nv">qs</span><span class="o">={</span><span class="s1">'n'</span>: <span class="o">[</span><span class="s1">'3'</span><span class="o">]}</span>
<span class="nv">ns</span><span class="o">=[</span><span class="s1">'3'</span><span class="o">]</span>
<span class="nv">n</span><span class="o">=</span>3
</code></pre></div></div>

<h2 id="التقدم-في-التعامل-مع-التكرار-الاستدعاء-الذاتي">التقدم في التعامل مع التكرار (الاستدعاء الذاتي)</h2>

<p>دعونا نقوم بإعادة هيكلة بسيطة للكود.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">http.server</span> <span class="kn">import</span> <span class="n">SimpleHTTPRequestHandler</span><span class="p">,</span> <span class="n">HTTPServer</span>
<span class="kn">from</span> <span class="nn">fib</span> <span class="kn">import</span> <span class="n">f</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span><span class="p">,</span> <span class="n">parse_qs</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Handler</span><span class="p">(</span><span class="n">SimpleHTTPRequestHandler</span><span class="p">):</span>
</code></pre></div></div>

<p><strong>ترجمة:</strong></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Handler</span><span class="p">(</span><span class="n">SimpleHTTPRequestHandler</span><span class="p">):</span>
</code></pre></div></div>

<p>في هذا الكود، يتم تعريف فئة جديدة باسم <code class="language-plaintext highlighter-rouge">Handler</code> والتي ترث من الفئة <code class="language-plaintext highlighter-rouge">SimpleHTTPRequestHandler</code>. هذه الفئة تُستخدم عادةً لمعالجة طلبات HTTP في خوادم الويب البسيطة.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">def</span> <span class="nf">parse_n</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
      <span class="n">parsed</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
      <span class="n">qs</span> <span class="o">=</span> <span class="n">parse_qs</span><span class="p">(</span><span class="n">parsed</span><span class="p">.</span><span class="n">query</span><span class="p">)</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="n">qs</span><span class="p">[</span><span class="s">'n'</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
          <span class="k">return</span> <span class="n">n</span>
      <span class="k">return</span> <span class="bp">None</span>
      
    <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">send_header</span><span class="p">(</span><span class="s">'Content-type'</span><span class="p">,</span> <span class="s">'text'</span><span class="p">)</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">end_headers</span><span class="p">()</span>
</code></pre></div></div>

<p>تمت ترجمة الكود أعلاه إلى اللغة العربية مع الحفاظ على الأسماء الإنجليزية كما هي. إذا كنت بحاجة إلى أي تعديلات إضافية، فلا تتردد في إعلامي!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span> <span class="o">=</span> <span class="s">""</span>
<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">parse_n</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">path</span><span class="p">)</span>
<span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
              
<span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s">"utf-8"</span><span class="p">))</span>
<span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s">"utf-8"</span><span class="p">))</span>
</code></pre></div></div>

<p>تمت ترجمة الكود أعلاه إلى:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span> <span class="o">=</span> <span class="s">""</span>
<span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">parse_n</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">path</span><span class="p">)</span>
<span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
              
<span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s">"utf-8"</span><span class="p">))</span>
<span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s">"utf-8"</span><span class="p">))</span>
</code></pre></div></div>

<p>ملاحظة: الكود لم يتغير لأنه يحتوي على أسماء دوال ومتغيرات بالإنجليزية، والتي لا يتم ترجمتها.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">server</span> <span class="o">=</span> <span class="n">HTTPServer</span><span class="p">((</span><span class="s">"127.0.0.1"</span><span class="p">,</span> <span class="mi">8000</span><span class="p">),</span> <span class="n">Handler</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">server</span><span class="p">.</span><span class="n">serve_forever</span><span class="p">()</span>
</code></pre></div></div>

<p>تم إدخال دالة <code class="language-plaintext highlighter-rouge">parse_n</code> لتغليف عملية استخراج القيمة <code class="language-plaintext highlighter-rouge">n</code> من مسار الطلب.</p>

<p>البرنامج لديه المشكلة التالية: طلب Xiao Wang العدد رقم 10000 في متسلسلة فيبوناتشي، وبعد بضعة أيام، طلب Xiao Ming أيضًا العدد رقم 10000 في متسلسلة فيبوناتشي. في كلتا المرتين، انتظر كل من Xiao Wang وXiao Ming لفترة طويلة قبل الحصول على النتيجة. كيف يمكننا تحسين كفاءة <code class="language-plaintext highlighter-rouge">خدمة الويب</code> هذه؟</p>

<p>لتحسين الكفاءة، يمكننا استخدام تقنيات التخزين المؤقت (Caching). بدلاً من حساب العدد رقم 10000 في متسلسلة فيبوناتشي في كل مرة يتم فيها الطلب، يمكننا حساب النتيجة مرة واحدة وتخزينها في ذاكرة التخزين المؤقت. عندما يتم طلب نفس العدد مرة أخرى، يمكننا ببساطة استرجاع النتيجة من التخزين المؤقت بدلاً من إعادة حسابها.</p>

<p>إليك مثال بسيط باستخدام Python وFlask:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">jsonify</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">lru_cache</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="o">@</span><span class="n">lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>

<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/fibonacci/&lt;int:n&gt;'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'GET'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_fibonacci</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="n">n</span><span class="p">:</span> <span class="n">result</span><span class="p">})</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>في هذا المثال، نستخدم الديكوراتور <code class="language-plaintext highlighter-rouge">@lru_cache</code> لتخزين نتائج الدالة <code class="language-plaintext highlighter-rouge">fibonacci</code> مؤقتًا. هذا يعني أنه عند طلب نفس العدد مرة أخرى، سيتم استرجاع النتيجة من التخزين المؤقت بدلاً من إعادة حسابها، مما يحسن بشكل كبير من كفاءة الخدمة.</p>

<p>بهذه الطريقة، عندما يطلب Xiao Wang أو Xiao Ming العدد رقم 10000 في متسلسلة فيبوناتشي، سيتم الحصول على النتيجة بسرعة أكبر.</p>

<p>لاحظنا أنه إذا كانت قيمة <code class="language-plaintext highlighter-rouge">n</code> متشابهة، فإن قيمة <code class="language-plaintext highlighter-rouge">f(n)</code> ستكون دائمًا نفسها. قمنا بإجراء بعض التجارب.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1 - - <span class="o">[</span>10/Mar/2021 00:33:01] <span class="s2">"GET /?n=1000 HTTP/1.1"</span> 200 -
<span class="nt">----------------------------------------</span>
حدث استثناء أثناء معالجة الطلب من <span class="o">(</span><span class="s1">'127.0.0.1'</span>, 50783<span class="o">)</span>
Traceback <span class="o">(</span>آخر استدعاء أخير<span class="o">)</span>:
    ...
    <span class="k">if </span>v[n] <span class="o">!=</span> <span class="nt">-1</span>:
IndexError: فهرس القائمة خارج النطاق
</code></pre></div></div>

<p>إذا كانت المصفوفة غير كافية في الحجم، فلنغير مصفوفة <code class="language-plaintext highlighter-rouge">v</code> إلى 10000.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
   <span class="n">v</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>تمت ترجمة الكود أعلاه إلى:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
   <span class="n">v</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>في هذا الكود، يتم إنشاء قائمة فارغة <code class="language-plaintext highlighter-rouge">v</code>، ثم يتم إضافة القيمة <code class="language-plaintext highlighter-rouge">-1</code> إلى القائمة 10000 مرة باستخدام حلقة <code class="language-plaintext highlighter-rouge">for</code>. النتيجة النهائية هي قائمة تحتوي على 10000 عنصر، كل عنصر منها هو <code class="language-plaintext highlighter-rouge">-1</code>.</p>

<p>ومع ذلك، عندما تكون <code class="language-plaintext highlighter-rouge">n</code> تساوي <code class="language-plaintext highlighter-rouge">2000</code>، ظهر خطأ في تجاوز عمق الاستدعاء الذاتي (Recursion Depth Overflow):</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1 - - <span class="o">[</span>10/Mar/2021 00:34:00] <span class="s2">"GET /?n=2000 HTTP/1.1"</span> 200 -
<span class="nt">----------------------------------------</span>
حدث استثناء أثناء معالجة الطلب من <span class="o">(</span><span class="s1">'127.0.0.1'</span>, 50821<span class="o">)</span>
Traceback <span class="o">(</span>آخر استدعاء أخير<span class="o">)</span>:
    ...
    <span class="k">if </span>v[n] <span class="o">!=</span> <span class="nt">-1</span>:
RecursionError: تم تجاوز الحد الأقصى لعمق الاستدعاء في المقارنة
</code></pre></div></div>

<p>ومع ذلك، كل هذا كان سريعًا إلى حد ما.</p>

<p>لماذا؟ لأن <code class="language-plaintext highlighter-rouge">f(1)</code> إلى <code class="language-plaintext highlighter-rouge">f(1000)</code>، كلها تحتاج إلى أن تُحسب مرة واحدة فقط. هذا يعني أنه عند حساب <code class="language-plaintext highlighter-rouge">f(1000)</code>، قد يتم تنفيذ عملية <code class="language-plaintext highlighter-rouge">+</code> حوالي 1000 مرة فقط. نعلم أن عمق التكرار في <code class="language-plaintext highlighter-rouge">Python</code> يبلغ حوالي 1000. وهذا يعني أنه يمكننا تحسين البرنامج بهذه الطريقة: إذا أردنا حساب <code class="language-plaintext highlighter-rouge">2000</code>، فسنحسب أولاً <code class="language-plaintext highlighter-rouge">1000</code>. لا، هذا قد يؤدي إلى حدوث <code class="language-plaintext highlighter-rouge">خطأ تجاوز عمق التكرار</code>. إذا أردنا حساب 2000، فلنحسب أولاً 1200. وإذا أردنا حساب 1200، فلنحسب أولاً 400.</p>

<p>بعد حساب 400 و1200 بهذه الطريقة، ثم حساب 2000، سيكون عمق الاستدعاء الذاتي حوالي 800، ولن يحدث خطأ في تجاوز عمق الاستدعاء الذاتي.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>
   <span class="n">v</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fplus</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">800</span><span class="p">:</span>         
      <span class="n">fplus</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">800</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">n</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</code></pre></div></div>

<p>تمت إضافة دالة <code class="language-plaintext highlighter-rouge">fplus</code>.</p>

<p>ومع ذلك، لا يسع المرء إلا أن يتساءل، ماذا لو تم استدعاء الدالة <code class="language-plaintext highlighter-rouge">fplus</code> بشكل متكرر <code class="language-plaintext highlighter-rouge">1000</code> مرة؟ 1000 * 800 = 800000. عندما قمت بتعيين قيمة <code class="language-plaintext highlighter-rouge">n</code> إلى 800 ألف، ظهرت مرة أخرى مشكلة في عمق الاستدعاءات. بعد الاستمرار في التجربة، اكتشفت أن الأمور أكثر تعقيدًا. ومع ذلك، بعد هذه التحسينات، أصبح حساب 2000 أمرًا سهلًا للغاية.</p>

<h2 id="قراءة-وكتابة-الملفات">قراءة وكتابة الملفات</h2>

<p>يبدو أن الموضوع قد انحرف قليلاً. فلنعد إلى موضوع تطوير الويب. في الطلب الأول <code class="language-plaintext highlighter-rouge">f(400)</code>، وفي الطلب الثاني <code class="language-plaintext highlighter-rouge">f(600)</code>. عند الطلب الثاني، يمكننا استخدام قيم مصفوفة <code class="language-plaintext highlighter-rouge">v</code> التي تم إنشاؤها في الطلب الأول. ومع ذلك، عندما نخرج من البرنامج ونعيد تشغيله، لن نتمكن من استخدامها. وفقًا لطريقتنا، حساب متسلسلة فيبوناتشي سريع جدًا. ولكن تخيل إذا كان بطيئًا. خاصة عندما لم نكن قد أدخلنا مصفوفة <code class="language-plaintext highlighter-rouge">v</code>، وكان هناك الكثير من الحسابات المتكررة. في هذه الحالة، نرغب في حفظ النتائج التي حصلنا عليها بصعوبة.</p>

<p>هنا يأتي دور مفهوم <code class="language-plaintext highlighter-rouge">التخزين المؤقت</code> (cache). المصفوفة <code class="language-plaintext highlighter-rouge">v</code> هنا تعتبر بمثابة تخزين مؤقت. ومع ذلك، فهي موجودة فقط خلال دورة حياة البرنامج. بمجرد إغلاق البرنامج، تختفي هذه البيانات. إذن، ما الحل؟ بطبيعة الحال، نفكر في تخزينها في ملف.</p>

<p>كيف يمكن حفظ مصفوفة <code class="language-plaintext highlighter-rouge">v</code> إلى ملف؟</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 0
1 1
2 1
3 2
4 3
...
</code></pre></div></div>

<p>يمكننا حفظ مصفوفة <code class="language-plaintext highlighter-rouge">v</code> بهذه الطريقة. يتم حفظ كل صف كـ <code class="language-plaintext highlighter-rouge">n f(n)</code>. نظرًا لأن <code class="language-plaintext highlighter-rouge">n</code> يتزايد بشكل طبيعي، ربما يمكننا فقط حفظ قيم <code class="language-plaintext highlighter-rouge">f(n)</code>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
1
1
2
3
...
</code></pre></div></div>

<p>جربها الآن.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"demofile2.txt"</span><span class="p">,</span> <span class="s">"a"</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"Now the file has more content!"</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p><strong>ترجمة الكود:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"demofile2.txt"</span><span class="p">,</span> <span class="s">"a"</span><span class="p">)</span>  <span class="c1"># فتح الملف "demofile2.txt" في وضع الإلحاق (append)
</span><span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"Now the file has more content!"</span><span class="p">)</span>  <span class="c1"># إضافة النص "Now the file has more content!" إلى الملف
</span><span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># إغلاق الملف
</span></code></pre></div></div>

<p><strong>ملاحظة:</strong> الكود يفتح ملفًا نصيًا باسم <code class="language-plaintext highlighter-rouge">demofile2.txt</code> في وضع الإلحاق (<code class="language-plaintext highlighter-rouge">"a"</code>)، مما يعني أنه سيتم إضافة النص الجديد إلى نهاية الملف دون حذف المحتوى الحالي. بعد ذلك، يتم إغلاق الملف.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># افتح واقرأ الملف بعد الإضافة:
</span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"demofile2.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div></div>

<p>الوسيط الثاني للدالة <code class="language-plaintext highlighter-rouge">open</code> يمكن أن يكون <code class="language-plaintext highlighter-rouge">a</code>، مما يعني أنه سيتم إضافة المحتوى في نهاية الملف؛ أو <code class="language-plaintext highlighter-rouge">w</code>، مما يعني أنه سيتم استبدال محتوى الملف الحالي.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_v'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">)</span>
<span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'hi'</span><span class="p">)</span>
<span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>بعد التشغيل، وجدت بالفعل ملفًا باسم <code class="language-plaintext highlighter-rouge">fib_v</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`fib_v`
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>مرحبًا
</code></pre></div></div>

<p>عندما نقوم بتشغيله مرة أخرى، يصبح هكذا.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hihi
</code></pre></div></div>

<p>كيف يمكنني إدراج سطر جديد؟</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_v'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">)</span>
<span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'hi</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>هذا سيتم طباعته مرة واحدة، وستظهر <code class="language-plaintext highlighter-rouge">hihihi</code>، ولم يتم ملاحظة أي سطر جديد. ومع ذلك، عند الطباعة مرة أخرى، يتم إدراج سطر جديد. وهذا يدل على أن السطر الجديد قد تم طباعته بالفعل في المرة الأولى، ولكنه كان في النهاية ولم يكن مرئيًا.</p>

<p>كيف يمكن القراءة؟</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_v'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div></div>

<p><strong>ملاحظة:</strong> الكود أعلاه مكتوب بلغة Python ويقوم بفتح ملف باسم <code class="language-plaintext highlighter-rouge">fib_v</code> للقراءة (<code class="language-plaintext highlighter-rouge">'r'</code>) ثم يطبع محتوى الملف. لا يوجد تغيير في الكود لأنه مكتوب بلغة برمجية عالمية ولا يحتاج إلى ترجمة.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python fib.py
hihihi
hi
</code></pre></div></div>

<p>بعد ذلك، دعونا نعدل برنامجنا لحساب متتالية فيبوناتشي.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>
   <span class="n">v</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
   <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_v'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
   <span class="n">s</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
   <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">lines</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
           <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</code></pre></div></div>

<p><strong>ترجمة الكود إلى العربية:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
   <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_v'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>  <span class="c1"># فتح الملف 'fib_v' للقراءة
</span>   <span class="n">s</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># قراءة محتوى الملف
</span>   <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># إذا كان المحتوى غير فارغ
</span>      <span class="n">lines</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>  <span class="c1"># تقسيم المحتوى إلى أسطر
</span>      <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>  <span class="c1"># إذا كان هناك أسطر
</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>  <span class="c1"># التكرار عبر كل الأسطر
</span>           <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  <span class="c1"># تحويل السطر إلى عدد صحيح وتخزينه في القائمة v
</span></code></pre></div></div>

<p><strong>ملاحظة:</strong> الكود يفترض وجود قائمة <code class="language-plaintext highlighter-rouge">v</code> مُعرفة مسبقًا لتخزين القيم التي يتم قراءتها من الملف.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">save</span><span class="p">():</span>
   <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_v'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
   <span class="n">s</span> <span class="o">=</span> <span class="s">''</span>
   <span class="n">start</span> <span class="o">=</span> <span class="bp">True</span>
   <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">vv</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
         <span class="k">break</span>      
      <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
         <span class="n">s</span> <span class="o">+=</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span>
      <span class="n">start</span> <span class="o">=</span> <span class="bp">False</span>   
      <span class="n">s</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span>
   <span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
   <span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fcache</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="n">x</span> <span class="o">=</span> <span class="n">fplus</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="n">save</span><span class="p">()</span>
   <span class="k">return</span> <span class="n">x</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fplus</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">800</span><span class="p">:</span>         
      <span class="n">fplus</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">800</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">n</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>read()
fcache(10)
save()
</code></pre></div></div>

<p>أخيرًا، انتهينا من كتابة البرنامج. بعد تشغيل البرنامج، أصبح ملف <code class="language-plaintext highlighter-rouge">fib_v</code> على النحو التالي.</p>

<p><code class="language-plaintext highlighter-rouge">fib_v</code>:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
1
1
2
3
5
8
13
21
34
55
</code></pre></div></div>

<p>نرى أن التحليل أعلاه معقد بعض الشيء. <code class="language-plaintext highlighter-rouge">\n</code> هو رمز سطر جديد. هل هناك طريقة تحليل أبسط وأكثر توحيدًا؟ لقد ابتكر الناس تنسيق البيانات <code class="language-plaintext highlighter-rouge">JSON</code>.</p>

<h2 id="json">JSON</h2>

<p>الاسم الكامل لـ JSON هو <code class="language-plaintext highlighter-rouge">JavaScript Object Notation</code>. فيما يلي مثال على <code class="language-plaintext highlighter-rouge">JSON</code>.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"John"</span><span class="p">,</span><span class="w"> </span><span class="nl">"age"</span><span class="p">:</span><span class="mi">31</span><span class="p">,</span><span class="w"> </span><span class="nl">"city"</span><span class="p">:</span><span class="s2">"New York"</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>يمكن التعبير عن التعيين بهذه الطريقة.</p>

<p>تحتوي JSON على العناصر الأساسية التالية:</p>

<ol>
  <li>الأرقام أو السلاسل النصية</li>
  <li>القوائم</li>
  <li>التعيينات (الخرائط)</li>
</ol>

<p>ويمكن أيضًا تداخل هذه العناصر الأساسية بشكل تعسفي. أي يمكن أن تحتوي القائمة على قائمة أخرى. ويمكن أن تحتوي الخريطة على قائمة أيضًا. وهكذا.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"John"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"age"</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span><span class="w">
  </span><span class="nl">"cars"</span><span class="p">:[</span><span class="w"> </span><span class="s2">"Ford"</span><span class="p">,</span><span class="w"> </span><span class="s2">"BMW"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Fiat"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>写成一行，和这样写得好看点是意义上的差别的。或许我们可以想象它们的计算图。空格不会影响它们的计算图。</p>

<p>بعد ذلك، نحتاج إلى تحويل مصفوفة <code class="language-plaintext highlighter-rouge">v</code> إلى سلسلة نصية بتنسيق <code class="language-plaintext highlighter-rouge">json</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">json</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>
   <span class="n">v</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fplus</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">800</span><span class="p">:</span>         
      <span class="n">fplus</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">800</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">n</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fplus</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
<span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>عندما نكتب بهذه الطريقة، حدث خطأ: <code class="language-plaintext highlighter-rouge">TypeError: dump() missing 1 required positional argument: 'fp'</code>. في <code class="language-plaintext highlighter-rouge">vscode</code>، يمكننا رؤية تعريف الدالة بهذه الطريقة.</p>

<p><img src="assets/images/web/json.png" alt="json" /></p>

<p>يمكنك تحريك الماوس فوق <code class="language-plaintext highlighter-rouge">dump</code> فقط. أليس ذلك مريحًا؟</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fplus</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
<span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
<span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>لحساب الأرقام حتى 100، سيتم عرض عدد كبير من الأرقام، لذا سنقوم بتغييرها إلى 10. في الأصل، يمكن تمرير الكائن <code class="language-plaintext highlighter-rouge">file</code> كمعامل ثاني للدالة <code class="language-plaintext highlighter-rouge">dump</code>.</p>

<p>يمكنك رؤية الملفات بهذه الطريقة:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="mi">34</span><span class="p">,</span><span class="w"> </span><span class="mi">55</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p>لاحظ أن هناك العديد من <code class="language-plaintext highlighter-rouge">-1</code> تم حذفها لاحقًا.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">sv</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sv</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">sv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">save</span><span class="p">():</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
    <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
    <span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p><strong>ترجمة:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">sv</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sv</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">sv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">save</span><span class="p">():</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
    <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
    <span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>قراءة()</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">vv</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span>
</code></pre></div></div>

<p>عندما يحدث هذا، يمكننا أن نرى أن الطباعة تظهر:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
1
1
2
3
5
8
13
21
34
55
</code></pre></div></div>

<p>دعونا نتحقق من هذه الدوال معًا:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">sv</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sv</span><span class="p">)):</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</code></pre></div></div>

<p>تمت ترجمة الكود إلى:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">sv</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sv</span><span class="p">)):</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</code></pre></div></div>

<p>ملاحظة: الكود يبقى كما هو لأنه مكتوب بلغة برمجة (Python) ولا يتم ترجمته.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">save</span><span class="p">():</span>
    <span class="n">sv</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">sv</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>        
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
    <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">sv</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
    <span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<pre><code class="language-read()">fplus(100)
save()
</code></pre>

<p>ثم انتقلت إلى ملف العرض، وبالفعل تم حفظ القيم الصحيحة، وبشكل مرتب.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="mi">34</span><span class="p">,</span><span class="w"> </span><span class="mi">55</span><span class="p">,</span><span class="w"> </span><span class="mi">89</span><span class="p">,</span><span class="w"> </span><span class="mi">144</span><span class="p">,</span><span class="w"> </span><span class="mi">233</span><span class="p">,</span><span class="w"> </span><span class="mi">377</span><span class="p">,</span><span class="w"> </span><span class="mi">610</span><span class="p">,</span><span class="w"> </span><span class="mi">987</span><span class="p">,</span><span class="w"> </span><span class="mi">1597</span><span class="p">,</span><span class="w"> </span><span class="mi">2584</span><span class="p">,</span><span class="w"> </span><span class="mi">4181</span><span class="p">,</span><span class="w"> </span><span class="mi">6765</span><span class="p">,</span><span class="w"> </span><span class="mi">10946</span><span class="p">,</span><span class="w"> </span><span class="mi">17711</span><span class="p">,</span><span class="w"> </span><span class="mi">28657</span><span class="p">,</span><span class="w"> </span><span class="mi">46368</span><span class="p">,</span><span class="w"> </span><span class="mi">75025</span><span class="p">,</span><span class="w"> </span><span class="mi">121393</span><span class="p">,</span><span class="w"> </span><span class="mi">196418</span><span class="p">,</span><span class="w"> </span><span class="mi">317811</span><span class="p">,</span><span class="w"> </span><span class="mi">514229</span><span class="p">,</span><span class="w"> </span><span class="mi">832040</span><span class="p">,</span><span class="w"> </span><span class="mi">1346269</span><span class="p">,</span><span class="w"> </span><span class="mi">2178309</span><span class="p">,</span><span class="w"> </span><span class="mi">3524578</span><span class="p">,</span><span class="w"> </span><span class="mi">5702887</span><span class="p">,</span><span class="w"> </span><span class="mi">9227465</span><span class="p">,</span><span class="w"> </span><span class="mi">14930352</span><span class="p">,</span><span class="w"> </span><span class="mi">24157817</span><span class="p">,</span><span class="w"> </span><span class="mi">39088169</span><span class="p">,</span><span class="w"> </span><span class="mi">63245986</span><span class="p">,</span><span class="w"> </span><span class="mi">102334155</span><span class="p">,</span><span class="w"> </span><span class="mi">165580141</span><span class="p">,</span><span class="w"> </span><span class="mi">267914296</span><span class="p">,</span><span class="w"> </span><span class="mi">433494437</span><span class="p">,</span><span class="w"> </span><span class="mi">701408733</span><span class="p">,</span><span class="w"> </span><span class="mi">1134903170</span><span class="p">,</span><span class="w"> </span><span class="mi">1836311903</span><span class="p">,</span><span class="w"> </span><span class="mi">2971215073</span><span class="p">,</span><span class="w"> </span><span class="mi">4807526976</span><span class="p">,</span><span class="w"> </span><span class="mi">7778742049</span><span class="p">,</span><span class="w"> </span><span class="mi">12586269025</span><span class="p">,</span><span class="w"> </span><span class="mi">20365011074</span><span class="p">,</span><span class="w"> </span><span class="mi">32951280099</span><span class="p">,</span><span class="w"> </span><span class="mi">53316291173</span><span class="p">,</span><span class="w"> </span><span class="mi">86267571272</span><span class="p">,</span><span class="w"> </span><span class="mi">139583862445</span><span class="p">,</span><span class="w"> </span><span class="mi">225851433717</span><span class="p">,</span><span class="w"> </span><span class="mi">365435296162</span><span class="p">,</span><span class="w"> </span><span class="mi">591286729879</span><span class="p">,</span><span class="w"> </span><span class="mi">956722026041</span><span class="p">,</span><span class="w"> </span><span class="mi">1548008755920</span><span class="p">,</span><span class="w"> </span><span class="mi">2504730781961</span><span class="p">,</span><span class="w"> </span><span class="mi">4052739537881</span><span class="p">,</span><span class="w"> </span><span class="mi">6557470319842</span><span class="p">,</span><span class="w"> </span><span class="mi">10610209857723</span><span class="p">,</span><span class="w"> </span><span class="mi">17167680177565</span><span class="p">,</span><span class="w"> </span><span class="mi">27777890035288</span><span class="p">,</span><span class="w"> </span><span class="mi">44945570212853</span><span class="p">,</span><span class="w"> </span><span class="mi">72723460248141</span><span class="p">,</span><span class="w"> </span><span class="mi">117669030460994</span><span class="p">,</span><span class="w"> </span><span class="mi">190392490709135</span><span class="p">,</span><span class="w"> </span><span class="mi">308061521170129</span><span class="p">,</span><span class="w"> </span><span class="mi">498454011879264</span><span class="p">,</span><span class="w"> </span><span class="mi">806515533049393</span><span class="p">,</span><span class="w"> </span><span class="mi">1304969544928657</span><span class="p">,</span><span class="w"> </span><span class="mi">2111485077978050</span><span class="p">,</span><span class="w"> </span><span class="mi">3416454622906707</span><span class="p">,</span><span class="w"> </span><span class="mi">5527939700884757</span><span class="p">,</span><span class="w"> </span><span class="mi">8944394323791464</span><span class="p">,</span><span class="w"> </span><span class="mi">14472334024676221</span><span class="p">,</span><span class="w"> </span><span class="mi">23416728348467685</span><span class="p">,</span><span class="w"> </span><span class="mi">37889062373143906</span><span class="p">,</span><span class="w"> </span><span class="mi">61305790721611591</span><span class="p">,</span><span class="w"> </span><span class="mi">99194853094755497</span><span class="p">,</span><span class="w"> </span><span class="mi">160500643816367088</span><span class="p">,</span><span class="w"> </span><span class="mi">259695496911122585</span><span class="p">,</span><span class="w"> </span><span class="mi">420196140727489673</span><span class="p">,</span><span class="w"> </span><span class="mi">679891637638612258</span><span class="p">,</span><span class="w"> </span><span class="mi">1100087778366101931</span><span class="p">,</span><span class="w"> </span><span class="mi">1779979416004714189</span><span class="p">,</span><span class="w"> </span><span class="mi">2880067194370816120</span><span class="p">,</span><span class="w"> </span><span class="mi">4660046610375530309</span><span class="p">,</span><span class="w"> </span><span class="mi">7540113804746346429</span><span class="p">,</span><span class="w"> </span><span class="mi">12200160415121876738</span><span class="p">,</span><span class="w"> </span><span class="mi">19740274219868223167</span><span class="p">,</span><span class="w"> </span><span class="mi">31940434634990099905</span><span class="p">,</span><span class="w"> </span><span class="mi">51680708854858323072</span><span class="p">,</span><span class="w"> </span><span class="mi">83621143489848422977</span><span class="p">,</span><span class="w"> </span><span class="mi">135301852344706746049</span><span class="p">,</span><span class="w"> </span><span class="mi">218922995834555169026</span><span class="p">,</span><span class="w"> </span><span class="mi">354224848179261915075</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<h2 id="قاعدة-البيانات">قاعدة البيانات</h2>

<p>إذا كانت البيانات كبيرة جدًا ومعقدة في الهيكل، ماذا نفعل؟ استخدام طريقة حفظ الملفات سيصبح بطيئًا ومعقدًا. هنا يأتي دور <code class="language-plaintext highlighter-rouge">قواعد البيانات</code>. وهي تعادل <code class="language-plaintext highlighter-rouge">Excel</code> قابل للبرمجة. يمكن بسهولة إضافة البيانات وحذفها وتعديلها والبحث فيها باستخدام الكود، مثل <code class="language-plaintext highlighter-rouge">Excel</code>.</p>

<p>في وثائق الموقع الرسمي وجدت مثالًا.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="s">'example.db'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>
</code></pre></div></div>

<h1 id="إنشاء-جدول">إنشاء جدول</h1>
<p>cur.execute(‘'’CREATE TABLE stocks
               (date text, trans text, symbol text, qty real, price real)’’’)</p>

<h1 id="إدراج-صف-من-البيانات">إدراج صف من البيانات</h1>
<p>cur.execute(“INSERT INTO stocks VALUES (‘2006-01-05’,’BUY’,’RHAT’,100,35.14)”)</p>

<h1 id="حفظ-إيداع-التغييرات">حفظ (إيداع) التغييرات</h1>
<p>con.commit()</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># يمكننا أيضًا إغلاق الاتصال إذا انتهينا منه.
# فقط تأكد من أن أي تغييرات قد تم حفظها (commit) وإلا سيتم فقدانها.
</span><span class="n">con</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'SELECT * FROM stocks ORDER BY price'</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</code></pre></div></div>

<p>(ملاحظة: الكود المذكور أعلاه مكتوب بلغة Python ويقوم بطباعة الصفوف من جدول “stocks” مرتبة حسب السعر. لم يتم ترجمة الكود لأنه يحتوي على أوامر برمجية يجب أن تبقى كما هي.)</p>

<p><code class="language-plaintext highlighter-rouge">cursor</code> تعني المؤشر، وهو يشبه المؤشر الذي تراه على الشاشة. ما سبق يوضح كيفية الاتصال بقاعدة البيانات، وإنشاء الجداول، وإدخال البيانات، وإرسال التغييرات، وإغلاق الاتصال. المثال الأخير يوضح كيفية استعلام البيانات.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sqlite3</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>
   <span class="n">v</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">:</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">Connection</span><span class="p">):</span>
    <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'CREATE TABLE vs(v text)'</span><span class="p">)</span>
</code></pre></div></div>

<p>تمت ترجمة الكود أعلاه إلى:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">:</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">Connection</span><span class="p">):</span>
    <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'CREATE TABLE vs(v text)'</span><span class="p">)</span>
</code></pre></div></div>

<p>في هذه الدالة، يتم إنشاء جدول جديد باسم <code class="language-plaintext highlighter-rouge">vs</code> يحتوي على عمود واحد من نوع النص (<code class="language-plaintext highlighter-rouge">text</code>).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="k">pass</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">save</span><span class="p">():</span>
    <span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="s">'fib.db'</span><span class="p">)</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vv</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'INSERT INTO vs VALUES('</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span> <span class="o">+</span> <span class="s">')'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">con</span><span class="p">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="n">con</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<pre><code class="language-fplus(10)">save()
</code></pre>

<p>سيتم ترجمة الكود أعلاه إلى:</p>

<pre><code class="language-fplus(10)">save()
</code></pre>

<p>ملاحظة: الكود لم يتم ترجمته لأنه يحتوي على أوامر برمجية قد تكون خاصة بلغة برمجة معينة، والترجمة قد تؤدي إلى تغيير في وظيفة الكود.</p>

<p>تمت الكتابة. جربها الآن.</p>

<p>لدي بالفعل <code class="language-plaintext highlighter-rouge">sqlite3</code> على جهاز الكمبيوتر الخاص بي.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>sqlite3
SQLite version 3.32.3 2020-06-18 14:16:19
أدخل <span class="s2">".help"</span> للحصول على تلميحات الاستخدام.
متصل بقاعدة بيانات مؤقتة في الذاكرة.
استخدم <span class="s2">".open FILENAME"</span> لإعادة الفتح على قاعدة بيانات دائمة.
</code></pre></div></div>

<pre><code class="language-sqlite">sqlite&gt; .help
.auth ON|OFF             عرض استدعاءات التفويض
.backup ?DB? FILE        نسخ احتياطي للقاعدة DB (الافتراضية "main") إلى الملف FILE
.bail on|off             التوقف بعد حدوث خطأ. الافتراضي OFF
.binary on|off           تشغيل أو إيقاف الإخراج الثنائي. الافتراضي OFF
.cd DIRECTORY            تغيير الدليل الحالي إلى DIRECTORY
.changes on|off          عرض عدد الصفوف التي تم تغييرها بواسطة SQL
.check GLOB              الفشل إذا كان الإخراج منذ .testcase لا يتطابق
.clone NEWDB             نسخ البيانات إلى NEWDB من قاعدة البيانات الحالية
.databases               عرض أسماء وملفات قواعد البيانات المرفقة
.dbconfig ?op? ?val?     عرض أو تغيير خيارات sqlite3_db_config()
.dbinfo ?DB?             عرض معلومات الحالة عن قاعدة البيانات
.dump ?TABLE?            عرض محتوى قاعدة البيانات كـ SQL
.echo on|off             تشغيل أو إيقاف صدى الأوامر
.eqp on|off|full|...     تمكين أو تعطيل EXPLAIN QUERY PLAN التلقائي
.excel                   عرض إخراج الأمر التالي في جدول بيانات
.exit ?CODE?             الخروج من البرنامج مع رمز العودة CODE
.expert                  تجريبي. اقتراح فهارس للاستعلامات
.explain ?on|off|auto?   تغيير نمط تنسيق EXPLAIN. الافتراضي: auto
.filectrl CMD ...        تشغيل عمليات sqlite3_file_control() المختلفة
.fullschema ?--indent?   عرض المخطط ومحتوى جداول sqlite_stat
.headers on|off          تشغيل أو إيقاف عرض العناوين
.help ?-all? ?PATTERN?   عرض نص المساعدة لـ PATTERN
.import FILE TABLE       استيراد البيانات من الملف FILE إلى الجدول TABLE
.imposter INDEX TABLE    إنشاء جدول وهمي TABLE على الفهرس INDEX
.indexes ?TABLE?         عرض أسماء الفهارس
.limit ?LIMIT? ?VAL?     عرض أو تغيير قيمة SQLITE_LIMIT
.lint OPTIONS            الإبلاغ عن مشاكل المخطط المحتملة
.log FILE|off            تشغيل أو إيقاف التسجيل. يمكن أن يكون الملف stderr/stdout
.mode MODE ?TABLE?       تعيين نمط الإخراج
.nullvalue STRING        استخدام STRING بدلاً من القيم NULL
.once ?OPTIONS? ?FILE?   إخراج الأمر SQL التالي فقط إلى الملف FILE
.open ?OPTIONS? ?FILE?   إغلاق قاعدة البيانات الحالية وإعادة فتح الملف FILE
.output ?FILE?           إرسال الإخراج إلى الملف FILE أو stdout إذا تم حذف FILE
.parameter CMD ...       إدارة روابط معلمات SQL
.print STRING...         طباعة STRING حرفيًا
.progress N              استدعاء معالج التقدم بعد كل N من الأوامر
.prompt MAIN CONTINUE    استبدال المطالبات القياسية
.quit                    الخروج من البرنامج
.read FILE               قراءة الإدخال من الملف FILE
.recover                 استعادة أكبر قدر ممكن من البيانات من قاعدة بيانات تالفة
.restore ?DB? FILE       استعادة محتوى DB (الافتراضية "main") من الملف FILE
.save FILE               كتابة قاعدة البيانات في الذاكرة إلى الملف FILE
.scanstats on|off        تشغيل أو إيقاف مقاييس sqlite3_stmt_scanstatus()
.schema ?PATTERN?        عرض عبارات CREATE التي تطابق PATTERN
.selftest ?OPTIONS?      تشغيل الاختبارات المحددة في جدول SELFTEST
.separator COL ?ROW?     تغيير فواصل الأعمدة والصفوف
.session ?NAME? CMD ...  إنشاء أو التحكم في الجلسات
.sha3sum ...             حساب تجزئة SHA3 لمحتوى قاعدة البيانات
.shell CMD ARGS...       تشغيل CMD ARGS... في shell النظام
.show                    عرض القيم الحالية للإعدادات المختلفة
.stats ?on|off?          عرض الإحصائيات أو تشغيلها أو إيقافها
.system CMD ARGS...      تشغيل CMD ARGS... في shell النظام
.tables ?TABLE?          عرض أسماء الجداول التي تطابق النمط LIKE TABLE
.testcase NAME           بدء إعادة توجيه الإخراج إلى 'testcase-out.txt'
.testctrl CMD ...        تشغيل عمليات sqlite3_test_control() المختلفة
.timeout MS              محاولة فتح الجداول المقفلة لمدة MS ميلي ثانية
.timer on|off            تشغيل أو إيقاف مؤقت SQL
.trace ?OPTIONS?         إخراج كل عبارة SQL أثناء تشغيلها
.vfsinfo ?AUX?           معلومات عن VFS الرئيسي
.vfslist                 عرض جميع VFSes المتاحة
.vfsname ?AUX?           طباعة اسم مكدس VFS
.width NUM1 NUM2 ...     تعيين عرض الأعمدة لوضع "column"
</code></pre>

<p>يمكنك رؤية العديد من الأوامر. من بينها <code class="language-plaintext highlighter-rouge">.quit</code> الذي يعني الخروج.</p>

<p>إذا لم يكن لديك SQLite مثبتًا، يمكنك تنزيله من الموقع الرسمي، أو تشغيل الأمر <code class="language-plaintext highlighter-rouge">brew install sqlite</code> لتثبيته.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>sqlite3 fib.db
</code></pre></div></div>

<pre><code class="language-sqlite">sqlite&gt; show tables
   ...&gt; ;
خطأ: بالقرب من "show": خطأ في الصياغة
sqlite&gt; tables;
خطأ: بالقرب من "tables": خطأ في الصياغة
sqlite&gt; .schema
CREATE TABLE vs(v text);
</code></pre>

<p>في البداية اعتقدت أن الأمر يشبه <code class="language-plaintext highlighter-rouge">MySQL</code>. حيث يمكن استخدام <code class="language-plaintext highlighter-rouge">show tables</code> لمعرفة الجداول المتوفرة. لكن لاحقًا اكتشفت أن الأمر في <code class="language-plaintext highlighter-rouge">SQLite</code> مختلف. <code class="language-plaintext highlighter-rouge">MySQL</code> هو نوع آخر من قواعد البيانات، وهو أيضًا ما سنتعلمه في المستقبل.</p>

<pre><code class="language-sqlite">sqlite&gt; select * from vs;
0
1
1
2
3
5
8
13
21
34
55
</code></pre>

<p>بالفعل، قمنا بكتابة البيانات بشكل صحيح. لاحظ أننا استخدمنا <code class="language-plaintext highlighter-rouge">text</code> لأن أرقامنا كبيرة وقد لا يتمكن نوع الأعداد الصحيحة في قاعدة البيانات من حفظها.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sqlite3</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>
   <span class="n">v</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fplus</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">800</span><span class="p">:</span>         
      <span class="n">fplus</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">800</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">n</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">:</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">Connection</span><span class="p">):</span>
    <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'CREATE TABLE vs(v text)'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="s">'fib.db'</span><span class="p">)</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>    
    <span class="n">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'SELECT * from vs'</span><span class="p">):</span>
         <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="n">con</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>تمت ترجمة الكود إلى:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="s">'fib.db'</span><span class="p">)</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>    
    <span class="n">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'SELECT * from vs'</span><span class="p">):</span>
         <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="n">con</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>ملاحظة: الكود الأصلي يحتوي على بعض الأخطاء المحتملة، مثل عدم تعريف المتغير <code class="language-plaintext highlighter-rouge">v</code> قبل استخدامه، وعدم زيادة قيمة <code class="language-plaintext highlighter-rouge">i</code> داخل الحلقة. هذه الأخطاء لم يتم تصحيحها في الترجمة.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">save</span><span class="p">():</span>
    <span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="s">'fib.db'</span><span class="p">)</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vv</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'INSERT INTO vs VALUES('</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span> <span class="o">+</span> <span class="s">')'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">con</span><span class="p">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="n">con</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">read</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</code></pre></div></div>

<p>نستمر بإضافة دالة <code class="language-plaintext highlighter-rouge">read</code>. ومع ذلك، بعد التشغيل، ظهر خطأ.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">python</span> <span class="n">fib_db</span><span class="p">.</span><span class="n">py</span>
  <span class="p">...</span>
  <span class="n">File</span> <span class="s">"fib_db.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">27</span><span class="p">,</span> <span class="ow">in</span> <span class="n">create_table</span>
    <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'CREATE TABLE vs(v text)'</span><span class="p">)</span>
<span class="n">sqlite3</span><span class="p">.</span><span class="n">OperationalError</span><span class="p">:</span> <span class="n">الجدول</span> <span class="n">vs</span> <span class="n">موجود</span> <span class="n">بالفعل</span>
</code></pre></div></div>

<p>لا يمكننا إنشاء الجدول مرة أخرى، الجدول موجود بالفعل. سنقوم بتعديل الصيغة قليلاً.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">:</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">Connection</span><span class="p">):</span>
    <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'CREATE TABLE IF NOT EXISTS vs(v text)'</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>الترجمة:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">:</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">Connection</span><span class="p">):</span>
    <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'CREATE TABLE IF NOT EXISTS vs(v text)'</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>ملاحظة:</strong> الكود المقدم لا يحتاج إلى ترجمة حيث أنه مكتوب بلغة برمجة Python، والترجمة هنا هي نفس الكود الأصلي.</p>

<p>ومع ذلك، حدث خطأ.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    v[i] <span class="o">=</span> int<span class="o">(</span>row<span class="o">)</span>
TypeError: يجب أن تكون وسيطة int<span class="o">()</span> عبارة عن سلسلة نصية، أو كائن يشبه البايتات، أو رقمًا، وليس <span class="s1">'tuple'</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">tuple</code> هو نوع من أنواع البيانات في Python. يعني أن الدالة <code class="language-plaintext highlighter-rouge">row</code> تُرجع <code class="language-plaintext highlighter-rouge">tuple</code>. دعنا نطبعها.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'SELECT * from vs'</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</code></pre></div></div>

<p>النتيجة هي:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span><span class="s1">'0'</span>,<span class="o">)</span>
</code></pre></div></div>

<p>في الواقع، <code class="language-plaintext highlighter-rouge">tuple</code> يشبه إلى حد كبير المصفوفة. الفرق الرئيسي هو أن عناصر <code class="language-plaintext highlighter-rouge">tuple</code> يمكن أن تكون مختلفة عن بعضها البعض، على عكس المصفوفة التي يجب أن تكون جميع عناصرها من نفس النوع.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="s">'fib.db'</span><span class="p">)</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>    
    <span class="n">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'SELECT * from vs'</span><span class="p">):</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">con</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p><strong>ملاحظة:</strong> الكود أعلاه مكتوب بلغة Python ويقوم بقراءة البيانات من قاعدة بيانات SQLite. لا يتم تغيير الكود أثناء الترجمة.</p>

<p>هذا التعديل. ومع ذلك، من الغريب أن يكون الناتج هكذا:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>55
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
</code></pre></div></div>

<p>اتضح أن المتغير <code class="language-plaintext highlighter-rouge">i</code> لم يتم زيادته.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'SELECT * from vs'</span><span class="p">):</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></div>

<p>هذا صحيح.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
1
1
2
3
5
8
13
21
34
</code></pre></div></div>

<p>ومع ذلك، لاحظنا أنه عندما تكون الأرقام كبيرة، يتم حفظها في قاعدة البيانات بهذا الشكل:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4660046610375530309
7540113804746346429
1.22001604151219e+19
1.97402742198682e+19
3.19404346349901e+19
</code></pre></div></div>

<p>عند إعادة التشغيل، ستكون النتيجة كالتالي.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python fib_db.py
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"fib_db.py"</span>, line 35, <span class="k">in </span><span class="nb">read
    </span>v[i] <span class="o">=</span> int<span class="o">(</span>row[0]<span class="o">)</span>
ValueError: invalid literal <span class="k">for </span>int<span class="o">()</span> with base 10: <span class="s1">'1.22001604151219e+19'</span>
</code></pre></div></div>

<p>تمت ترجمة النص أعلاه إلى العربية كما يلي:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python fib_db.py
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"fib_db.py"</span>, line 35, <span class="k">in </span><span class="nb">read
    </span>v[i] <span class="o">=</span> int<span class="o">(</span>row[0]<span class="o">)</span>
ValueError: قيمة غير صالحة لـ int<span class="o">()</span> بالأساس 10: <span class="s1">'1.22001604151219e+19'</span>
</code></pre></div></div>

<p>غيّر أو عدّل</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"INSERT INTO vs VALUES('"</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span> <span class="o">+</span> <span class="s">"')"</span><span class="p">)</span>
</code></pre></div></div>

<p>في الكود أعلاه، يتم إدراج قيمة المتغير <code class="language-plaintext highlighter-rouge">vv</code> في جدول يسمى <code class="language-plaintext highlighter-rouge">vs</code> باستخدام أمر SQL <code class="language-plaintext highlighter-rouge">INSERT INTO</code>. يتم تحويل قيمة <code class="language-plaintext highlighter-rouge">vv</code> إلى سلسلة نصية باستخدام الدالة <code class="language-plaintext highlighter-rouge">str()</code> قبل إدراجها في الاستعلام.</p>

<p>لاحظ أننا هنا قمنا بتغيير علامات الاقتباس الفردية حول عبارة <code class="language-plaintext highlighter-rouge">INSERT</code> إلى علامات اقتباس مزدوجة، وأضفنا أيضًا علامات اقتباس حول سلسلة الأرقام الخاصة بنا. إذا كنا قد كتبناها بهذه الطريقة من قبل، لكانت قاعدة البيانات قد تعاملت مع السلسلة على أنها أرقام، ولكن الآن، باستخدام علامات الاقتباس، يتم التعامل معها على أنها سلسلة نصية.</p>

<p>ثم أصبح صحيحًا. ومع ذلك، كيف يمكن مسح البيانات الخاطئة السابقة؟</p>

<pre><code class="language-sqlite">$ sqlite3 fib.db
SQLite version 3.32.3 2020-06-18 14:16:19
أدخل ".help" للحصول على تلميحات الاستخدام.
sqlite&gt; delete * from vs;
</code></pre>

<p>يمكنك تجربة عبارات أخرى بعد ذلك. <code class="language-plaintext highlighter-rouge">إضافة، حذف، تعديل، استعلام</code>. لقد قدمنا هنا أمثلة على <code class="language-plaintext highlighter-rouge">الإضافة، الحذف، الاستعلام</code>.</p>

<h2 id="التمرين">التمرين</h2>

<ul>
  <li>يجب على الطلاب استكشاف الأمور بشكل مشابه لما ورد أعلاه.</li>
</ul>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-ar" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
