<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Implementación de ID de Traza de Extremo a Extremo</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Implementación de ID de Traza de Extremo a Extremo | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Implementación de ID de Traza de Extremo a Extremo" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="es" />
<meta name="description" content="Esta entrada del blog fue escrita con la asistencia de ChatGPT-4o." />
<meta property="og:description" content="Esta entrada del blog fue escrita con la asistencia de ChatGPT-4o." />
<link rel="canonical" href="https://lzwjava.github.io/trace-es" />
<meta property="og:url" content="https://lzwjava.github.io/trace-es" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-07-06T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Implementación de ID de Traza de Extremo a Extremo" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2024-07-06T00:00:00+08:00","datePublished":"2024-07-06T00:00:00+08:00","description":"Esta entrada del blog fue escrita con la asistencia de ChatGPT-4o.","headline":"Implementación de ID de Traza de Extremo a Extremo","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/trace-es"},"url":"https://lzwjava.github.io/trace-es"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=8b5e7974abb5ddbf635377734cdf4be0972e4509">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=8b5e7974abb5ddbf635377734cdf4be0972e4509" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Implementación de ID de Traza de Extremo a Extremo | Original, traducido por IA
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/es/2024-07-06-trace-es.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postses2024-07-06-trace-es.md</span> -->
      

      <!-- <span>2024-07-06-trace-es.md</span> -->

      
        

        
          
          <a href="#" class="button">2024.07</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/trace-en" >English</option>
        <option value="/trace-zh" >中文</option>
        <option value="/trace-ja" >日本語</option>
        <option value="/trace-es" selected>Español</option>
        <option value="/trace-hi" >हिंदी</option>
        <option value="/trace-fr" >Français</option>
        <option value="/trace-de" >Deutsch</option>
        <option value="/trace-ar" >العربية</option>
        <option value="/trace-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p><em>Esta entrada del blog fue escrita con la asistencia de ChatGPT-4o.</em></p>

<hr />

<p>Trabajé en una solución de ID de seguimiento de extremo a extremo para garantizar que cada solicitud y respuesta en nuestro sistema pueda rastrearse de manera consistente entre el frontend y el backend. Esta solución ayuda en la depuración, monitoreo y registro al asociar cada operación con un ID de seguimiento único. A continuación, se presenta una explicación detallada de cómo funciona la solución, junto con ejemplos de código.</p>

<h2 id="cómo-funciona">Cómo Funciona</h2>

<h3 id="frontend">Frontend</h3>

<p>La parte del frontend de esta solución implica generar un ID de seguimiento para cada solicitud y enviarlo junto con la información del cliente al backend. Este ID de seguimiento se utiliza para rastrear la solicitud a través de varias etapas de procesamiento en el backend.</p>

<ol>
  <li>
    <p>Recopilación de Información del Cliente: Recopilamos información relevante del cliente, como las dimensiones de la pantalla, el tipo de red, la zona horaria y más. Esta información se envía junto con los encabezados de la solicitud.</p>
  </li>
  <li>
    <p>Generación de ID de Traza: Se genera un ID de traza único para cada solicitud. Este ID de traza se incluye en los encabezados de la solicitud, lo que nos permite rastrear la solicitud a lo largo de su ciclo de vida.</p>
  </li>
  <li>
    <p>API Fetch: La función <code class="language-plaintext highlighter-rouge">apiFetch</code> se utiliza para realizar llamadas a la API. Incluye el ID de seguimiento y la información del cliente en los encabezados de cada solicitud.</p>
  </li>
</ol>

<h3 id="backend">Backend</h3>

<p>La parte del backend de la solución implica registrar el ID de traza con cada mensaje de registro e incluir el ID de traza en las respuestas. Esto nos permite rastrear las solicitudes a través del procesamiento del backend y hacer coincidir las respuestas con las solicitudes.</p>

<ol>
  <li>
    <p>Manejo del Trace ID: El backend recibe el Trace ID desde los encabezados de la solicitud o genera uno nuevo si no se proporciona. El Trace ID se almacena en un objeto global de Flask para su uso durante todo el ciclo de vida de la solicitud.</p>
  </li>
  <li>
    <p>Registro (Logging): Se utilizan formateadores de registros personalizados para incluir el ID de seguimiento en cada mensaje de registro. Esto garantiza que todos los mensajes de registro relacionados con una solicitud puedan correlacionarse utilizando el ID de seguimiento.</p>
  </li>
  <li>
    <p>Manejo de la Respuesta: El ID de traza se incluye en los encabezados de la respuesta. Si ocurre un error, el ID de traza también se incluye en el cuerpo de la respuesta de error para ayudar en la depuración.</p>
  </li>
</ol>

<h3 id="kibana">Kibana</h3>

<p>Kibana es una interfaz de visualización de datos de código abierto diseñada para trabajar con Elasticsearch. Proporciona capacidades de visualización y exploración de datos, permitiendo a los usuarios crear gráficos, mapas y tablas interactivas a partir de los datos almacenados en Elasticsearch. Kibana es ampliamente utilizado en el análisis de registros (log analysis), monitoreo de aplicaciones y otras tareas relacionadas con la exploración de datos en tiempo real.</p>

<h4 id="características-principales-de-kibana">Características principales de Kibana:</h4>

<ol>
  <li>
    <p><strong>Visualización de datos</strong>: Kibana permite crear gráficos, tablas y mapas interactivos para representar datos de manera clara y comprensible.</p>
  </li>
  <li>
    <p><strong>Dashboards personalizables</strong>: Los usuarios pueden crear paneles personalizados que combinan múltiples visualizaciones para monitorear y analizar datos en tiempo real.</p>
  </li>
  <li>
    <p><strong>Exploración de datos</strong>: Con la función “Discover”, los usuarios pueden explorar y filtrar datos almacenados en Elasticsearch de manera interactiva.</p>
  </li>
  <li>
    <p><strong>Integración con Elasticsearch</strong>: Kibana está diseñado para funcionar de manera nativa con Elasticsearch, lo que facilita la consulta y visualización de grandes volúmenes de datos.</p>
  </li>
  <li>
    <p><strong>Alertas y monitoreo</strong>: Kibana permite configurar alertas basadas en condiciones específicas de los datos, lo que es útil para el monitoreo proactivo de sistemas y aplicaciones.</p>
  </li>
  <li>
    <p><strong>Machine Learning</strong>: Kibana integra herramientas de machine learning para detectar anomalías y patrones en los datos.</p>
  </li>
</ol>

<h4 id="casos-de-uso-comunes">Casos de uso comunes:</h4>

<ul>
  <li>
    <p><strong>Análisis de registros (Log Analysis)</strong>: Kibana es ampliamente utilizado para analizar y visualizar registros de sistemas y aplicaciones, lo que ayuda a identificar problemas y optimizar el rendimiento.</p>
  </li>
  <li>
    <p><strong>Monitoreo de infraestructura</strong>: Con Kibana, los equipos de operaciones pueden monitorear el estado de servidores, redes y aplicaciones en tiempo real.</p>
  </li>
  <li>
    <p><strong>Análisis de métricas de negocio</strong>: Las empresas pueden utilizar Kibana para visualizar y analizar métricas clave de negocio, como ventas, tráfico web y rendimiento de marketing.</p>
  </li>
  <li>
    <p><strong>Seguridad y cumplimiento</strong>: Kibana se utiliza en la detección de amenazas y el análisis de eventos de seguridad, ayudando a las organizaciones a cumplir con normativas y proteger sus sistemas.</p>
  </li>
</ul>

<h4 id="ejemplo-básico-de-uso">Ejemplo básico de uso:</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Iniciar Kibana (asumiendo que Elasticsearch ya está en ejecución)</span>
bin/kibana
</code></pre></div></div>

<p>Una vez que Kibana esté en funcionamiento, puedes acceder a la interfaz web a través de <code class="language-plaintext highlighter-rouge">http://localhost:5601</code>. Desde allí, puedes comenzar a crear visualizaciones y paneles personalizados.</p>

<h4 id="conclusión">Conclusión:</h4>

<p>Kibana es una herramienta poderosa para la visualización y exploración de datos, especialmente cuando se utiliza junto con Elasticsearch. Su facilidad de uso y su capacidad para manejar grandes volúmenes de datos lo convierten en una opción popular para equipos de operaciones, desarrolladores y analistas de datos.</p>

<p>Kibana es una herramienta potente para visualizar y buscar datos de registros almacenados en Elasticsearch. Con nuestra solución de Trace ID, puedes rastrear y depurar solicitudes fácilmente utilizando Kibana. El ID de traza, que se incluye en cada entrada de registro, se puede utilizar para filtrar y buscar registros específicos.</p>

<p>Para buscar registros con un ID de traza específico, puedes utilizar el Lenguaje de Consulta de Kibana (KQL). Por ejemplo, puedes buscar todos los registros relacionados con un ID de traza en particular con la siguiente consulta:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>trace_id:"Lc6t"
</code></pre></div></div>

<p>Esta consulta devolverá todas las entradas de registro que contengan el ID de traza “Lc6t”, lo que te permitirá rastrear la ruta de la solicitud a través del sistema. Además, puedes combinar esta consulta con otros criterios para reducir los resultados de búsqueda, como filtrar por nivel de registro, marca de tiempo o palabras clave específicas dentro de los mensajes de registro.</p>

<p>Al aprovechar las capacidades de visualización de Kibana, también puedes crear paneles que muestren métricas y tendencias basadas en los IDs de traza. Por ejemplo, puedes visualizar el número de solicitudes procesadas, los tiempos de respuesta promedio y las tasas de error, todo correlacionado con sus respectivos IDs de traza. Esto ayuda a identificar patrones y posibles problemas en el rendimiento y la confiabilidad de tu aplicación.</p>

<p>El uso de Kibana en conjunto con nuestra solución de Trace ID ofrece un enfoque integral para monitorear, depurar y analizar el comportamiento de tu sistema, asegurando que cada solicitud pueda ser rastreada e investigada de manera efectiva.</p>

<h2 id="frontend-1">Frontend</h2>

<h3 id="apijs"><code class="language-plaintext highlighter-rouge">api.js</code></h3>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">BASE_URL</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">REACT_APP_BASE_URL</span><span class="p">;</span>
</code></pre></div></div>

<p>// Función para obtener información del cliente
const getClientInfo = () =&gt; {
    const { language, platform, cookieEnabled, doNotTrack, onLine } = navigator;
    const { width, height } = window.screen;
    const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
    const networkType = connection ? connection.effectiveType : ‘unknown’;
    const timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;
    const referrer = document.referrer;
    const viewportWidth = window.innerWidth;
    const viewportHeight = window.innerHeight;</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>return {
    screenWidth: width,
    screenHeight: height,
    networkType,
    timeZone,
    language,
    platform,
    cookieEnabled,
    doNotTrack,
    onLine,
    referrer,
    viewportWidth,
    viewportHeight
}; };
</code></pre></div></div>

<p>// Función para generar un ID de traza único
export const generateTraceId = (length = 4) =&gt; {
    const characters = ‘ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789’;
    let traceId = ‘’;
    for (let i = 0; i &lt; length; i++) {
        const randomIndex = Math.floor(Math.random() * characters.length);
        traceId += characters.charAt(randomIndex);
    }
    return traceId;
};</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">apiFetch</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">endpoint</span><span class="p">,</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">BASE_URL</span><span class="p">}${</span><span class="nx">endpoint</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">clientInfo</span> <span class="o">=</span> <span class="nx">getClientInfo</span><span class="p">();</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const traceId = options.traceId || generateTraceId();
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">const</span> <span class="nx">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
        <span class="dl">'</span><span class="s1">X-Client-Info</span><span class="dl">'</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">clientInfo</span><span class="p">),</span>
        <span class="dl">'</span><span class="s1">X-Trace-Id</span><span class="dl">'</span><span class="p">:</span> <span class="nx">traceId</span><span class="p">,</span>
        <span class="p">...(</span><span class="nx">options</span><span class="p">.</span><span class="nx">headers</span> <span class="o">||</span> <span class="p">{})</span>
    <span class="p">};</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="p">{</span>
        <span class="p">...</span><span class="nx">options</span><span class="p">,</span>
        <span class="nx">headers</span>
    <span class="p">});</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">return</span> <span class="nx">response</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="appjs"><code class="language-plaintext highlighter-rouge">App.js</code></h3>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">apiFetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">api</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">content</span><span class="p">),</span>
    <span class="na">traceId</span><span class="p">:</span> <span class="nx">traceId</span>
  <span class="p">});</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
    <span class="c1">//...        </span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">errorData</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
    <span class="kd">const</span> <span class="nx">errorMessage</span> <span class="o">=</span> <span class="nx">errorData</span><span class="p">.</span><span class="nx">message</span> <span class="o">||</span> <span class="dl">'</span><span class="s1">Ocurrió un error desconocido</span><span class="dl">'</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">errorToastMessage</span> <span class="o">=</span> <span class="nx">errorMessage</span><span class="p">;</span>
    <span class="nx">errorToastMessage</span> <span class="o">+=</span> <span class="s2">` (Trace ID: </span><span class="p">${</span><span class="nx">traceId</span><span class="p">}</span><span class="s2">)`</span><span class="p">;</span>
    <span class="nx">toast</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">errorToastMessage</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">autoClose</span><span class="p">:</span> <span class="mi">8000</span>
    <span class="p">});</span>
    <span class="nx">setError</span><span class="p">(</span><span class="nx">errorToastMessage</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">errorString</span> <span class="o">=</span> <span class="nx">error</span> <span class="k">instanceof</span> <span class="nb">Error</span> <span class="p">?</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span> <span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
</code></pre></div></div>

<p>const duration = (Date.now() - startTime) / 1000;</p>

<p>if (error.response) {
    // La solicitud fue realizada y el servidor respondió con un código de estado que no está en el rango de 2xx
    errorString += ` (HTTP ${error.response.status}: ${error.response.statusText})<code class="language-plaintext highlighter-rouge">;
    console.error('Datos del error en la respuesta:', error.response.data);
  } else if (error.request) {
    // La solicitud fue realizada pero no se recibió respuesta
    errorString += ' (No se recibió respuesta)';
    console.error('Datos del error en la solicitud:', error.request);
  } else {
    // Algo ocurrió al configurar la solicitud que provocó un Error
    errorString += </code> (Error al configurar la solicitud: ${error.message})`;
  }</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">errorString</span> <span class="o">+=</span> <span class="s2">` (ID de seguimiento: </span><span class="p">${</span><span class="nx">traceId</span><span class="p">}</span><span class="s2">)`</span><span class="p">;</span>
</code></pre></div></div>

<p>if (error instanceof Error) {
    errorString += <code class="language-plaintext highlighter-rouge">\nStack: ${error.stack}</code>;
  }</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">errorString</span> <span class="o">+=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">errorString</span> <span class="o">+=</span> <span class="s2">` (Duración: </span><span class="p">${</span><span class="nx">duration</span><span class="p">}</span><span class="s2"> segundos)`</span><span class="p">;</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">toast</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">`Error: </span><span class="p">${</span><span class="nx">errorString</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">autoClose</span><span class="p">:</span> <span class="mi">8000</span>
  <span class="p">});</span>
  <span class="nx">setError</span><span class="p">(</span><span class="nx">errorString</span><span class="p">);</span>
<span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
  <span class="nx">toast</span><span class="p">.</span><span class="nx">dismiss</span><span class="p">(</span><span class="nx">toastId</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="backend-1">Backend</h2>

<h3 id="__init__py"><code class="language-plaintext highlighter-rouge">__init__.py</code></h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># -*- encoding: utf-8 -*-
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">random</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">Response</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">has_request_context</span>
<span class="kn">from</span> <span class="nn">flask_cors</span> <span class="kn">import</span> <span class="n">CORS</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">.routes</span> <span class="kn">import</span> <span class="n">initialize_routes</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">db</span><span class="p">,</span> <span class="n">insert_default_config</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">logging.handlers</span> <span class="kn">import</span> <span class="n">RotatingFileHandler</span>
<span class="kn">from</span> <span class="nn">prometheus_client</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">generate_latest</span><span class="p">,</span> <span class="n">Gauge</span>
<span class="kn">from</span> <span class="nn">flask_migrate</span> <span class="kn">import</span> <span class="n">Migrate</span>
<span class="kn">from</span> <span class="nn">logstash_formatter</span> <span class="kn">import</span> <span class="n">LogstashFormatterV1</span>
</code></pre></div></div>

<p>Traducción al español:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">.routes</span> <span class="kn">import</span> <span class="n">initialize_routes</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">db</span><span class="p">,</span> <span class="n">insert_default_config</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">logging.handlers</span> <span class="kn">import</span> <span class="n">RotatingFileHandler</span>
<span class="kn">from</span> <span class="nn">prometheus_client</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">generate_latest</span><span class="p">,</span> <span class="n">Gauge</span>
<span class="kn">from</span> <span class="nn">flask_migrate</span> <span class="kn">import</span> <span class="n">Migrate</span>
<span class="kn">from</span> <span class="nn">logstash_formatter</span> <span class="kn">import</span> <span class="n">LogstashFormatterV1</span>
</code></pre></div></div>

<p>Nota: Los nombres de las bibliotecas y funciones no se traducen, ya que son específicos del código y deben mantenerse en inglés para su correcto funcionamiento.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
</code></pre></div></div>

<p>app.config.from_object(‘api.config.BaseConfig’)</p>

<p>db.init_app(app)
initialize_routes(app)</p>

<p>CORS(app)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">migrate</span> <span class="o">=</span> <span class="n">Migrate</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">RequestFormatter</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">Formatter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">has_request_context</span><span class="p">():</span>
            <span class="n">record</span><span class="p">.</span><span class="n">trace_id</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s">'trace_id'</span><span class="p">,</span> <span class="s">'unknown'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">record</span><span class="p">.</span><span class="n">trace_id</span> <span class="o">=</span> <span class="s">'unknown'</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">().</span><span class="nb">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">CustomLogstashFormatter</span><span class="p">(</span><span class="n">LogstashFormatterV1</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">has_request_context</span><span class="p">():</span>
            <span class="n">record</span><span class="p">.</span><span class="n">trace_id</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="s">'trace_id'</span><span class="p">,</span> <span class="s">'unknown'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">record</span><span class="p">.</span><span class="n">trace_id</span> <span class="o">=</span> <span class="s">'unknown'</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">().</span><span class="nb">format</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">setup_loggers</span><span class="p">():</span>
    <span class="n">logstash_handler</span> <span class="o">=</span> <span class="n">RotatingFileHandler</span><span class="p">(</span>
        <span class="s">'app.log'</span><span class="p">,</span> <span class="n">maxBytes</span><span class="o">=</span><span class="mi">100000000</span><span class="p">,</span> <span class="n">backupCount</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">logstash_handler</span><span class="p">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="n">logstash_formatter</span> <span class="o">=</span> <span class="n">CustomLogstashFormatter</span><span class="p">()</span>
    <span class="n">logstash_handler</span><span class="p">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">logstash_formatter</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">txt_handler</span> <span class="o">=</span> <span class="n">RotatingFileHandler</span><span class="p">(</span>
    <span class="s">'plain.log'</span><span class="p">,</span> <span class="n">maxBytes</span><span class="o">=</span><span class="mi">100000000</span><span class="p">,</span> <span class="n">backupCount</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">txt_handler</span><span class="p">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">DEBUG</span><span class="p">)</span>
<span class="n">txt_formatter</span> <span class="o">=</span> <span class="n">RequestFormatter</span><span class="p">(</span>
    <span class="s">'%(asctime)s %(levelname)s: %(message)s [en %(pathname)s:%(lineno)d] [trace_id: %(trace_id)s]'</span><span class="p">)</span>
<span class="n">txt_handler</span><span class="p">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">txt_formatter</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">root_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">root_logger</span><span class="p">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">DEBUG</span><span class="p">)</span>
<span class="n">root_logger</span><span class="p">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logstash_handler</span><span class="p">)</span>
<span class="n">root_logger</span><span class="p">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">txt_handler</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app.logger.addHandler(logstash_handler)
app.logger.addHandler(txt_handler)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">werkzeug_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="p">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">'werkzeug'</span><span class="p">)</span>
<span class="n">werkzeug_logger</span><span class="p">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="p">.</span><span class="n">DEBUG</span><span class="p">)</span>
<span class="n">werkzeug_logger</span><span class="p">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logstash_handler</span><span class="p">)</span>
<span class="n">werkzeug_logger</span><span class="p">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">txt_handler</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">setup_loggers</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">generar_trace_id</span><span class="p">(</span><span class="n">longitud</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">caracteres</span> <span class="o">=</span> <span class="n">string</span><span class="p">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span>
    <span class="k">return</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">caracteres</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">longitud</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">before_request</span>
<span class="k">def</span> <span class="nf">before_request</span><span class="p">():</span>
    <span class="n">request</span><span class="p">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">trace_id</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'X-Trace-Id'</span><span class="p">,</span> <span class="n">generate_trace_id</span><span class="p">())</span>
    <span class="n">g</span><span class="p">.</span><span class="n">trace_id</span> <span class="o">=</span> <span class="n">trace_id</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">client_info</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">headers</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'X-Client-Info'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">client_info</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">client_info_json</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">client_info</span><span class="p">)</span>
            <span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">"Información del Cliente: </span><span class="si">{</span><span class="n">client_info_json</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">json</span><span class="p">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
            <span class="n">logging</span><span class="p">.</span><span class="n">warning</span><span class="p">(</span><span class="s">"Formato JSON inválido para el encabezado X-Client-Info"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">after_request</span>
<span class="k">def</span> <span class="nf">after_request</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="n">response</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="s">'X-Trace-Id'</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">trace_id</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if response.status_code != 200:
    logging.error(f'Código de estado de la respuesta: {response.status_code}')
    logging.error(f'Cuerpo de la respuesta: {response.get_data(as_text=True)}')

    if response.content_type == 'application/json':
        try:
            response_json = response.get_json()
            response_json['trace_id'] = g.trace_id
            response.set_data(json.dumps(response_json))
        except Exception as e:
            logging.error(f"Error al agregar trace_id a la respuesta: {e}")
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></div>

<h2 id="registro">Registro</h2>

<p>Puedes buscar todos los registros relacionados con un ID de traza específico utilizando la siguiente consulta:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>trace_id:"Lc6t"
</code></pre></div></div>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"_index"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flask-logs-2024.07.05"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"_doc"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ae9zgZABqOMSOpxCZC5X"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"_version"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"_score"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"_source"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"_grokparsefailure"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"filename"</span><span class="p">:</span><span class="w"> </span><span class="s2">"generate.py"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"funcName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"post"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Solicitud procesada exitosamente"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"@version"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"root"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ip-172-31-35-xxx.ec2.internal"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"relativeCreated"</span><span class="p">:</span><span class="w"> </span><span class="mf">685817.8744316101</span><span class="p">,</span><span class="w">
    </span><span class="nl">"levelname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"INFO"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"created"</span><span class="p">:</span><span class="w"> </span><span class="mf">1720158740.894831</span><span class="p">,</span><span class="w">
    </span><span class="nl">"thread"</span><span class="p">:</span><span class="w"> </span><span class="mi">139715118360128</span><span class="p">,</span><span class="w">
    </span><span class="nl">"threadName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Thread-5"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"levelno"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
    </span><span class="nl">"pathname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/home/project/project-name/api/routes/generate.py"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"msecs"</span><span class="p">:</span><span class="w"> </span><span class="mf">894.8309421539307</span><span class="p">,</span><span class="w">
    </span><span class="nl">"processName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MainProcess"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"lineno"</span><span class="p">:</span><span class="w"> </span><span class="mi">287</span><span class="p">,</span><span class="w">
    </span><span class="nl">"path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/home/project/project-name/app.log"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"args"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nl">"source_host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ip-172-31-35-xxx.ec2.internal"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"module"</span><span class="p">:</span><span class="w"> </span><span class="s2">"generate"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"trace_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Lc6t"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"stack_info"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nl">"process"</span><span class="p">:</span><span class="w"> </span><span class="mi">107613</span><span class="p">,</span><span class="w">
    </span><span class="nl">"@timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2024-07-05T05:52:20.894Z"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"levelname.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"INFO"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"tags.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"_grokparsefailure"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"relativeCreated"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="mf">685817.9</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"processName.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"MainProcess"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"filename.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"generate.py"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"funcName"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"post"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"path"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"/home/project/project-name/app.log"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"processName"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"MainProcess"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"@version"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="mi">1</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"host"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"ip-172-31-35-xxx.ec2.internal"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"msecs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="mf">894.83093</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"source_host.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"ip-172-31-35-xxx.ec2.internal"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"host.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"ip-172-31-35-xxx.ec2.internal"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"levelname"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"INFO"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"process"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="mi">107613</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"threadName.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"Thread-5"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"trace_id"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"Lc6t"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"source_host"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"ip-172-31-35-xxx.ec2.internal"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"created"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="mi">1720158700</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"module"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"generate"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"module.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"generate"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"name.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"root"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"thread"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="mi">139715118360128</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"Solicitud procesada exitosamente"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"levelno"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="mi">20</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"trace_id.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"Lc6t"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"threadName"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"Thread-5"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"pathname"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"/home/project/project-name/api/routes/generate.py"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"_grokparsefailure"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"pathname.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"/home/project/project-name/api/routes/generate.py"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"@timestamp"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"2024-07-05T05:52:20.894Z"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"filename"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"generate.py"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"lineno"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="mi">287</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"message.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"Solicitud procesada exitosamente"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"root"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"funcName.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"post"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"path.keyword"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"/home/project/project-name/app.log"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Como se muestra arriba, puedes ver el ID de traza en el registro.</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-es" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
