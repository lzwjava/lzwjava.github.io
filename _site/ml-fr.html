<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Introduction au *Machine Learning* – TensorFlow</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Introduction au Machine Learning – TensorFlow | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Introduction au Machine Learning – TensorFlow" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="fr" />
<meta name="description" content="Ce post a été initialement écrit en chinois. Il a été traduit en anglais pour faciliter les traductions dans d’autres langues." />
<meta property="og:description" content="Ce post a été initialement écrit en chinois. Il a été traduit en anglais pour faciliter les traductions dans d’autres langues." />
<link rel="canonical" href="https://lzwjava.github.io/ml-fr" />
<meta property="og:url" content="https://lzwjava.github.io/ml-fr" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-12T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Introduction au Machine Learning – TensorFlow" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2021-03-12T00:00:00+08:00","datePublished":"2021-03-12T00:00:00+08:00","description":"Ce post a été initialement écrit en chinois. Il a été traduit en anglais pour faciliter les traductions dans d’autres langues.","headline":"Introduction au Machine Learning – TensorFlow","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/ml-fr"},"url":"https://lzwjava.github.io/ml-fr"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=e6a8987d65efea74b6be8d6bcc520a1beee7a3e1">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=e6a8987d65efea74b6be8d6bcc520a1beee7a3e1" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Introduction au *Machine Learning* – TensorFlow | Original, traduit par l'IA
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/fr/2021-03-12-ml-fr.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsfr2021-03-12-ml-fr.md</span> -->
      

      <!-- <span>2021-03-12-ml-fr.md</span> -->

      
        

        
          
          <a href="#" class="button">2021.03</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/ml-en" >English</option>
        <option value="/ml-zh" >中文</option>
        <option value="/ml-ja" >日本語</option>
        <option value="/ml-es" >Español</option>
        <option value="/ml-hi" >हिंदी</option>
        <option value="/ml-fr" selected>Français</option>
        <option value="/ml-de" >Deutsch</option>
        <option value="/ml-ar" >العربية</option>
        <option value="/ml-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>Ce post a été initialement écrit en chinois. Il a été traduit en anglais pour faciliter les traductions dans d’autres langues.</p>

<hr />

<p>Puisque nous apprenons <code class="language-plaintext highlighter-rouge">Python</code>, nous devons absolument parler d’apprentissage automatique. Beaucoup de ses bibliothèques sont écrites en Python. Commençons par les installer et les essayer.</p>

<h2 id="tensorflow">TensorFlow</h2>

<p>Installons-le.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pip <span class="nb">install </span>tensorflow
ERROR: Could not find a version that satisfies the requirement tensorflow
ERROR: No matching distribution found <span class="k">for </span>tensorflow
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">type </span>python
python est un <span class="nb">alias </span>pour <span class="sb">`</span>/usr/local/Cellar/python@3.9/3.9.1_6/bin/python3<span class="s1">'
</span></code></pre></div></div>

<p>Cependant, <code class="language-plaintext highlighter-rouge">TensorFlow 2</code> ne supporte que <code class="language-plaintext highlighter-rouge">Python 3.5–3.8</code>. Nous utilisons la version <code class="language-plaintext highlighter-rouge">3.9</code>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% <span class="nb">type </span>python3
python3 est /usr/bin/python3
% python3 <span class="nt">-V</span>
Python 3.8.2
</code></pre></div></div>

<p>Remarquez que le <code class="language-plaintext highlighter-rouge">python3</code> de mon système est la version <code class="language-plaintext highlighter-rouge">3.8.2</code>. Où le <code class="language-plaintext highlighter-rouge">pip</code> correspondant à cette version de Python installe-t-il les paquets ?</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% python3 <span class="nt">-m</span> pip <span class="nt">-V</span>
pip 21.0.1 from /Users/lzw/Library/Python/3.8/lib/python/site-packages/pip <span class="o">(</span>python 3.8<span class="o">)</span>
</code></pre></div></div>

<p>Le <code class="language-plaintext highlighter-rouge">pip</code> correspondant se trouve ici. Je vais donc modifier le fichier <code class="language-plaintext highlighter-rouge">.zprofile</code>. Récemment, j’ai changé mon <code class="language-plaintext highlighter-rouge">shell</code>, et <code class="language-plaintext highlighter-rouge">.zprofile</code> est équivalent à l’ancien <code class="language-plaintext highlighter-rouge">.bash_profile</code>. Ajoutez une ligne :</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">alias </span><span class="nv">pip3</span><span class="o">=</span>/Users/lzw/Library/Python/3.8/bin/pip3
</code></pre></div></div>

<p>Ainsi, nous pouvons utiliser <code class="language-plaintext highlighter-rouge">python3</code> et <code class="language-plaintext highlighter-rouge">pip3</code> pour travailler avec <code class="language-plaintext highlighter-rouge">TensorFlow</code>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% pip3 <span class="nb">install </span>tensorflow
...
Successfully installed absl-py-0.12.0 astunparse-1.6.3 cachetools-4.2.1 certifi-2020.12.5 chardet-4.0.0 flatbuffers-1.12 gast-0.3.3 google-auth-1.27.1 google-auth-oauthlib-0.4.3 google-pasta-0.2.0 grpcio-1.32.0 h5py-2.10.0 idna-2.10 keras-preprocessing-1.1.2 markdown-3.3.4 numpy-1.19.5 oauthlib-3.1.0 opt-einsum-3.3.0 protobuf-3.15.6 pyasn1-0.4.8 pyasn1-modules-0.2.8 requests-2.25.1 requests-oauthlib-1.3.0 rsa-4.7.2 tensorboard-2.4.1 tensorboard-plugin-wit-1.8.0 tensorflow-2.4.1 tensorflow-estimator-2.4.0 termcolor-1.1.0 typing-extensions-3.7.4.3 urllib3-1.26.3 werkzeug-1.0.1 wheel-0.36.2 wrapt-1.12.1
</code></pre></div></div>

<p>De nombreuses bibliothèques ont été installées. Utilisons un exemple du site officiel.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>

<span class="n">mnist</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">datasets</span><span class="p">.</span><span class="n">mnist</span>

<span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="p">.</span><span class="n">load_data</span><span class="p">()</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span> <span class="o">=</span> <span class="n">x_train</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">x_test</span> <span class="o">/</span> <span class="mf">255.0</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">models</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x_train</span><span class="p">[:</span><span class="mi">1</span><span class="p">]).</span><span class="n">numpy</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</code></pre></div></div>

<p>Exécutons-le.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>/usr/bin/python3 tf.py
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
11493376/11490434 <span class="o">[==============================]</span> - 10s 1us/step
<span class="o">[[</span> 0.15477428 <span class="nt">-0</span>.3877643   0.0994779   0.07474922 <span class="nt">-0</span>.26219758 <span class="nt">-0</span>.03550266
   0.32226565 <span class="nt">-0</span>.37141111  0.10925996 <span class="nt">-0</span>.0115255 <span class="o">]]</span>
</code></pre></div></div>

<p>Comme vous pouvez le voir, le jeu de données a été téléchargé et les résultats ont été affichés.</p>

<p>Ensuite, regardons un exemple de classification d’images.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># TensorFlow et tf.keras
</span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>

<span class="c1"># Bibliothèques auxiliaires
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="k">print</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">__version__</span><span class="p">)</span>
</code></pre></div></div>

<p>Une erreur s’est produite.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ModuleNotFoundError: No module named <span class="s1">'matplotlib'</span>
</code></pre></div></div>

<p>Installons-le.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% pip3 <span class="nb">install </span>matplotlib
</code></pre></div></div>

<p>Maintenant, c’est correct.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>/usr/bin/python3 image.py
2.4.1
</code></pre></div></div>

<p>Copions et collons le code de l’exemple.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># TensorFlow et tf.keras
</span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>

<span class="c1"># Bibliothèques auxiliaires
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">fashion_mnist</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">datasets</span><span class="p">.</span><span class="n">fashion_mnist</span>

<span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">),</span> <span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">)</span> <span class="o">=</span> <span class="n">fashion_mnist</span><span class="p">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">'T-shirt/haut'</span><span class="p">,</span> <span class="s">'Pantalon'</span><span class="p">,</span> <span class="s">'Pull'</span><span class="p">,</span> <span class="s">'Robe'</span><span class="p">,</span> <span class="s">'Manteau'</span><span class="p">,</span>
               <span class="s">'Sandale'</span><span class="p">,</span> <span class="s">'Chemise'</span><span class="p">,</span> <span class="s">'Basket'</span><span class="p">,</span> <span class="s">'Sac'</span><span class="p">,</span> <span class="s">'Bottine'</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">train_images</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_labels</span><span class="p">))</span>
</code></pre></div></div>

<p>Les résultats sont affichés. Remarquez que nous avons <code class="language-plaintext highlighter-rouge">train_images</code>, <code class="language-plaintext highlighter-rouge">train_labels</code>, <code class="language-plaintext highlighter-rouge">test_images</code> et <code class="language-plaintext highlighter-rouge">test_labels</code>. Ceux-ci sont divisés en ensembles de données d’entraînement et de test.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>60000, 28, 28<span class="o">)</span>
60000
</code></pre></div></div>

<p>Ensuite, essayons d’afficher une image.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div>

<p>Voyons le résultat.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[[</span>  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 <span class="o">[</span>  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 <span class="o">[</span>  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 <span class="o">[</span>  0   0   0   0   0   0   0   0   0   0   0   0   1   0   0  13  73   0
    0   1   4   0   0   0   0   1   1   0]
 <span class="o">[</span>  0   0   0   0   0   0   0   0   0   0   0   0   3   0  36 136 127  62
   54   0   0   0   1   3   4   0   0   3]
 <span class="o">[</span>  0   0   0   0   0   0   0   0   0   0   0   0   6   0 102 204 176 134
  144 123  23   0   0   0   0  12  10   0]
 <span class="o">[</span>  0   0   0   0   0   0   0   0   0   0   0   0   0   0 155 236 207 178
  107 156 161 109  64  23  77 130  72  15]
  ....
</code></pre></div></div>

<p>Ici, une partie du résultat est extraite.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
</code></pre></div></div>

<p>Affiche <code class="language-plaintext highlighter-rouge">28</code>. Il est donc clair que c’est une matrice de largeur 28. Continuons à afficher.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">TypeError</span><span class="p">:</span> <span class="nb">object</span> <span class="n">of</span> <span class="nb">type</span> <span class="s">'numpy.uint8'</span> <span class="n">has</span> <span class="n">no</span> <span class="nb">len</span><span class="p">()</span>
</code></pre></div></div>

<p>Donc, c’est clair. Chaque image est un tableau <code class="language-plaintext highlighter-rouge">28*28</code>. La dernière dimension stocke les valeurs RVB. Cependant, nous pourrions nous tromper sur ce point.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">20</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
</code></pre></div></div>

<p>Cela montre que chaque image est un tableau <code class="language-plaintext highlighter-rouge">28*28</code>. Après quelques ajustements, nous avons finalement compris le secret.</p>

<p>Commençons par regarder l’image de sortie.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/tf.png" alt="tf" style="zoom:30%;" /></p>

<p>Voyez-vous la barre de couleur à droite ? De <code class="language-plaintext highlighter-rouge">0</code> à <code class="language-plaintext highlighter-rouge">250</code>. Il s’avère que c’est un dégradé entre deux couleurs. Mais comment sait-il quelles sont ces deux couleurs ? Où avons-nous spécifié cela ?</p>

<p>Ensuite, affichons également la deuxième image.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/plt.png" alt="plt" style="zoom:30%;" /></p>

<p>Très intéressant. Est-ce le paramètre par défaut de la bibliothèque <code class="language-plaintext highlighter-rouge">pyplot</code> ? Continuons à exécuter le code fourni par le site officiel.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">binary</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">train_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/tf2.png" alt="tf2" style="zoom:20%;" /></p>

<p>Remarquez que les images et leurs classifications sont affichées ici. Enfin, nous comprenons le paramètre <code class="language-plaintext highlighter-rouge">cmap</code>. Si <code class="language-plaintext highlighter-rouge">cmap</code> n’est pas spécifié, il utilisera par défaut le schéma de couleurs que nous avons vu précédemment. En effet.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>plt.imshow<span class="o">(</span>train_images[i]<span class="o">)</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/cmap.png" alt="cmap" style="zoom:20%;" /></p>

<p>Cette fois, nous recherchons <code class="language-plaintext highlighter-rouge">pyplot cmap</code> et trouvons quelques ressources.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>plt.imshow<span class="o">(</span>train_images[i], <span class="nv">cmap</span><span class="o">=</span>plt.cm.PiYG<span class="o">)</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/cmap1.png" alt="cmap1" style="zoom:20%;" /></p>

<p>Modifions le code.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>   <span class="c1">## Ligne modifiée
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">Blues</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">train_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p>Cependant, une erreur s’est produite.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ValueError: num must be 1 &lt;<span class="o">=</span> num &lt;<span class="o">=</span> 10, not 11
</code></pre></div></div>

<p>Que signifie ceci ? Que signifie exactement le <code class="language-plaintext highlighter-rouge">5,5,i+1</code> précédent ? Pourquoi cela ne fonctionne-t-il pas lorsqu’il est changé en <code class="language-plaintext highlighter-rouge">2</code> ? Bien que nous comprenions intuitivement qu’il pourrait signifier 5 lignes et 5 colonnes, pourquoi cette erreur se produit-elle ? Comment le <code class="language-plaintext highlighter-rouge">11</code> est-il calculé ? Que signifie <code class="language-plaintext highlighter-rouge">num</code> ? Que signifie <code class="language-plaintext highlighter-rouge">10</code> ? Remarquez que <code class="language-plaintext highlighter-rouge">2*5=10</code>. Donc, peut-être que l’erreur se produit lorsque <code class="language-plaintext highlighter-rouge">i=11</code>. Lorsque nous changeons en <code class="language-plaintext highlighter-rouge">for i in range(10):</code>, nous obtenons le résultat suivant.</p>

<p><img src="/assets/images/ml/plot3.png" alt="plot3" style="zoom:20%;" /></p>

<p>Cette fois, après avoir brièvement consulté la documentation, nous apprenons à propos de <code class="language-plaintext highlighter-rouge">subplot(nrows, ncols, index, **kwargs)</code>. D’accord, maintenant nous comprenons.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># plt.xticks([])
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">Blues</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">train_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/plot_xticks.png" alt="plot_xticks" style="zoom:30%;" /></p>

<p>Remarquez que des éléments comme <code class="language-plaintext highlighter-rouge">0 25</code> sont appelés <code class="language-plaintext highlighter-rouge">xticks</code>. Lorsque nous zoomons ou dézoomons ce cadre, l’affichage change.</p>

<p><img src="assets/images/ml/plot_scale.png" alt="plot_scale" /></p>

<p>Remarquez que lors du zoom avant ou arrière, <code class="language-plaintext highlighter-rouge">xticks</code> et <code class="language-plaintext highlighter-rouge">xlabels</code> s’affichent différemment.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">losses</span><span class="p">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>

<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">test_loss</span><span class="p">,</span> <span class="n">test_acc</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_images</span><span class="p">,</span>  <span class="n">test_labels</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">Test accuracy:'</span><span class="p">,</span> <span class="n">test_acc</span><span class="p">)</span>
</code></pre></div></div>

<p>Remarquez la manière dont le modèle est défini ici, en utilisant la classe <code class="language-plaintext highlighter-rouge">Sequential</code>. Faites attention à ces paramètres : <code class="language-plaintext highlighter-rouge">28,28</code>, <code class="language-plaintext highlighter-rouge">128</code>, <code class="language-plaintext highlighter-rouge">relu</code>, <code class="language-plaintext highlighter-rouge">10</code>. Remarquez que vous devez <code class="language-plaintext highlighter-rouge">compile</code> et <code class="language-plaintext highlighter-rouge">fit</code>. <code class="language-plaintext highlighter-rouge">fit</code> signifie ajustement. Remarquez que <code class="language-plaintext highlighter-rouge">28,28</code> correspond à la taille de l’image.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Epoch 1/10
1875/1875 <span class="o">[==============================]</span> - 2s 928us/step - loss: 0.6331 - accuracy: 0.7769
Epoch 2/10
1875/1875 <span class="o">[==============================]</span> - 2s 961us/step - loss: 0.3860 - accuracy: 0.8615
Epoch 3/10
1875/1875 <span class="o">[==============================]</span> - 2s 930us/step - loss: 0.3395 - accuracy: 0.8755
Epoch 4/10
1875/1875 <span class="o">[==============================]</span> - 2s 1ms/step - loss: 0.3071 - accuracy: 0.8890
Epoch 5/10
1875/1875 <span class="o">[==============================]</span> - 2s 1ms/step - loss: 0.2964 - accuracy: 0.8927
Epoch 6/10
1875/1875 <span class="o">[==============================]</span> - 2s 985us/step - loss: 0.2764 - accuracy: 0.8955
Epoch 7/10
1875/1875 <span class="o">[==============================]</span> - 2s 961us/step - loss: 0.2653 - accuracy: 0.8996
Epoch 8/10
1875/1875 <span class="o">[==============================]</span> - 2s 1ms/step - loss: 0.2549 - accuracy: 0.9052
Epoch 9/10
1875/1875 <span class="o">[==============================]</span> - 2s 1ms/step - loss: 0.2416 - accuracy: 0.9090
Epoch 10/10
1875/1875 <span class="o">[==============================]</span> - 2s 1ms/step - loss: 0.2372 - accuracy: 0.9086
313/313 - 0s - loss: 0.3422 - accuracy: 0.8798

Test accuracy: 0.879800021648407
</code></pre></div></div>

<p>Le modèle a été entraîné. Modifions les paramètres.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>model <span class="o">=</span> tf.keras.Sequential<span class="o">([</span>
    tf.keras.layers.Flatten<span class="o">(</span><span class="nv">input_shape</span><span class="o">=(</span>28, 28<span class="o">))</span>,
    tf.keras.layers.Dense<span class="o">(</span>28, <span class="nv">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="o">)</span>,    <span class="c"># 128 -&gt; 28</span>
    tf.keras.layers.Dense<span class="o">(</span>10<span class="o">)</span>
<span class="o">])</span>
</code></pre></div></div>

<p>Modifions le premier paramètre de <code class="language-plaintext highlighter-rouge">Dense</code>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Epoch 1/10
1875/1875 <span class="o">[==============================]</span> - 2s 714us/step - loss: 6.9774 - accuracy: 0.3294
Epoch 2/10
1875/1875 <span class="o">[==============================]</span> - 1s 715us/step - loss: 1.3038 - accuracy: 0.4831
Epoch 3/10
1875/1875 <span class="o">[==============================]</span> - 1s 747us/step - loss: 1.0160 - accuracy: 0.6197
Epoch 4/10
1875/1875 <span class="o">[==============================]</span> - 1s 800us/step - loss: 0.7963 - accuracy: 0.6939
Epoch 5/10
1875/1875 <span class="o">[==============================]</span> - 2s 893us/step - loss: 0.7006 - accuracy: 0.7183
Epoch 6/10
1875/1875 <span class="o">[==============================]</span> - 1s 747us/step - loss: 0.6675 - accuracy: 0.7299
Epoch 7/10
1875/1875 <span class="o">[==============================]</span> - 1s 694us/step - loss: 0.6681 - accuracy: 0.7330
Epoch 8/10
1875/1875 <span class="o">[==============================]</span> - 1s 702us/step - loss: 0.6675 - accuracy: 0.7356
Epoch 9/10
1875/1875 <span class="o">[==============================]</span> - 1s 778us/step - loss: 0.6508 - accuracy: 0.7363
Epoch 10/10
1875/1875 <span class="o">[==============================]</span> - 1s 732us/step - loss: 0.6532 - accuracy: 0.7350
313/313 - 0s - loss: 0.6816 - accuracy: 0.7230

Test accuracy: 0.7229999899864197
</code></pre></div></div>

<p>Remarquez le changement de <code class="language-plaintext highlighter-rouge">Test accuracy</code> avant et après. Les journaux <code class="language-plaintext highlighter-rouge">Epoch</code> sont produits par la fonction <code class="language-plaintext highlighter-rouge">fit</code>. Remarquez qu’avec <code class="language-plaintext highlighter-rouge">128</code>, <code class="language-plaintext highlighter-rouge">accuracy</code> passe de <code class="language-plaintext highlighter-rouge">0.7769</code> à <code class="language-plaintext highlighter-rouge">0.9086</code>. Avec <code class="language-plaintext highlighter-rouge">28</code>, <code class="language-plaintext highlighter-rouge">accuracy</code> passe de <code class="language-plaintext highlighter-rouge">0.3294</code> à <code class="language-plaintext highlighter-rouge">0.7350</code>. Cette fois, nous voyons que nous utilisons d’abord l’ensemble d’entraînement pour optimiser <code class="language-plaintext highlighter-rouge">loss</code> et <code class="language-plaintext highlighter-rouge">accuracy</code>, puis nous utilisons l’ensemble de test pour évaluer. Regardons <code class="language-plaintext highlighter-rouge">train_labels</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">train_labels</span><span class="p">)</span>
<span class="p">[</span><span class="mi">9</span> <span class="mi">0</span> <span class="mi">0</span> <span class="p">...</span> <span class="mi">3</span> <span class="mi">0</span> <span class="mi">5</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_labels</span><span class="p">))</span>
<span class="mi">60000</span>
</code></pre></div></div>

<p>Cela signifie que les nombres <code class="language-plaintext highlighter-rouge">0 à 9</code> représentent ces catégories. Par coïncidence, <code class="language-plaintext highlighter-rouge">class_names</code> compte également 10 éléments.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class_names <span class="o">=</span> <span class="o">[</span><span class="s1">'T-shirt/haut'</span>, <span class="s1">'Pantalon'</span>, <span class="s1">'Pull'</span>, <span class="s1">'Robe'</span>, <span class="s1">'Manteau'</span>,
               <span class="s1">'Sandale'</span>, <span class="s1">'Chemise'</span>, <span class="s1">'Basket'</span>, <span class="s1">'Sac'</span>, <span class="s1">'Bottine'</span><span class="o">]</span>
</code></pre></div></div>

<p>Apportons une autre modification.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>   <span class="c1"># 10 -&gt; 5
</span><span class="p">])</span>

<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">losses</span><span class="p">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>

<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<p>Une erreur s’est produite.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorflow.python.framework.errors_impl.InvalidArgumentError:  Received a label value of 9 which is outside the valid range of <span class="o">[</span>0, 5<span class="o">)</span><span class="nb">.</span>  Label values: 4 3 2 9 4 1 6 0 7 9 1 6 5 2 3 8 6 3 8 0 3 5 6 1 2 6 3 6 8 4 8 4
         <span class="o">[[</span>node sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits <span class="o">(</span>defined at /curiosity-courses/ml/tf/image.py:53<span class="o">)</span> <span class="o">]]</span> <span class="o">[</span>Op:__inference_train_function_538]

Function call stack:
train_function
</code></pre></div></div>

<p>Changer le troisième paramètre de <code class="language-plaintext highlighter-rouge">Sequential</code>, <code class="language-plaintext highlighter-rouge">Dense</code>, en <code class="language-plaintext highlighter-rouge">15</code> résout le problème. Les résultats ne sont pas très différents. Essayons de changer <code class="language-plaintext highlighter-rouge">Epoch</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">losses</span><span class="p">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>

<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>  <span class="c1"># 10 -&gt; 15
</span>
<span class="n">test_loss</span><span class="p">,</span> <span class="n">test_acc</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_images</span><span class="p">,</span>  <span class="n">test_labels</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">Test accuracy:'</span><span class="p">,</span> <span class="n">test_acc</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Epoch 1/15
1875/1875 <span class="o">[==============================]</span> - 2s 892us/step - loss: 6.5778 - accuracy: 0.3771
Epoch 2/15
1875/1875 <span class="o">[==============================]</span> - 2s 872us/step - loss: 1.3121 - accuracy: 0.4910
Epoch 3/15
1875/1875 <span class="o">[==============================]</span> - 2s 909us/step - loss: 1.0900 - accuracy: 0.5389
Epoch 4/15
1875/1875 <span class="o">[==============================]</span> - 1s 730us/step - loss: 1.0422 - accuracy: 0.5577
Epoch 5/15
1875/1875 <span class="o">[==============================]</span> - 1s 709us/step - loss: 0.9529 - accuracy: 0.5952
Epoch 6/15
1875/1875 <span class="o">[==============================]</span> - 1s 714us/step - loss: 0.9888 - accuracy: 0.5950
Epoch 7/15
1875/1875 <span class="o">[==============================]</span> - 1s 767us/step - loss: 0.8678 - accuracy: 0.6355
Epoch 8/15
1875/1875 <span class="o">[==============================]</span> - 1s 715us/step - loss: 0.8247 - accuracy: 0.6611
Epoch 9/15
1875/1875 <span class="o">[==============================]</span> - 1s 721us/step - loss: 0.8011 - accuracy: 0.6626
Epoch 10/15
1875/1875 <span class="o">[==============================]</span> - 1s 711us/step - loss: 0.8024 - accuracy: 0.6622
Epoch 11/15
1875/1875 <span class="o">[==============================]</span> - 1s 781us/step - loss: 0.7777 - accuracy: 0.6696
Epoch 12/15
1875/1875 <span class="o">[==============================]</span> - 1s 724us/step - loss: 0.7764 - accuracy: 0.6728
Epoch 13/15
1875/1875 <span class="o">[==============================]</span> - 1s 731us/step - loss: 0.7688 - accuracy: 0.6767
Epoch 14/15
1875/1875 <span class="o">[==============================]</span> - 1s 715us/step - loss: 0.7592 - accuracy: 0.6793
Epoch 15/15
1875/1875 <span class="o">[==============================]</span> - 1s 786us/step - loss: 0.7526 - accuracy: 0.6792
313/313 - 0s - loss: 0.8555 - accuracy: 0.6418

Test accuracy: 0.6417999863624573
</code></pre></div></div>

<p>Remarquez que le changement à 15 ne fait pas une grande différence. <code class="language-plaintext highlighter-rouge">tf.keras.layers.Dense(88, activation='relu')</code> est important. En essayant de changer 128 en 88, nous avons obtenu <code class="language-plaintext highlighter-rouge">Test accuracy: 0.824999988079071</code>. Avec 128, c’était <code class="language-plaintext highlighter-rouge">0.879800021648407</code>. Avec 28, c’était <code class="language-plaintext highlighter-rouge">0.7229999899864197</code>. Une valeur plus grande signifie-t-elle de meilleurs résultats ? Cependant, lorsque nous l’avons changé en <code class="language-plaintext highlighter-rouge">256</code>, nous avons obtenu <code class="language-plaintext highlighter-rouge">Test accuracy: 0.8409000039100647</code>. Cela nous amène à réfléchir sur la signification de <code class="language-plaintext highlighter-rouge">loss</code> et <code class="language-plaintext highlighter-rouge">accuracy</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">probability_model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span><span class="n">model</span><span class="p">,</span>
                                         <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Softmax</span><span class="p">()])</span>
</code></pre></div></div>

<p>Ensuite, faisons une prédiction. Remarquez que <code class="language-plaintext highlighter-rouge">Sequential</code> est le même que ci-dessus. Faites attention aux paramètres <code class="language-plaintext highlighter-rouge">model</code> et <code class="language-plaintext highlighter-rouge">tf.keras.layers.Softmax()</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">probability_model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span><span class="n">model</span><span class="p">,</span>
                                         <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Softmax</span><span class="p">()])</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">probability_model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_images</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">predictions_array</span><span class="p">,</span> <span class="n">true_label</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
  <span class="n">true_label</span><span class="p">,</span> <span class="n">img</span> <span class="o">=</span> <span class="n">true_label</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">img</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">([])</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">yticks</span><span class="p">([])</span>

  <span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">binary</span><span class="p">)</span>

  <span class="n">predicted_label</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions_array</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">predicted_label</span> <span class="o">==</span> <span class="n">true_label</span><span class="p">:</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s">'blue'</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span>

  <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"{} {:2.0f}% ({})"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">predicted_label</span><span class="p">],</span>
                                <span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">predictions_array</span><span class="p">),</span>
                                <span class="n">class_names</span><span class="p">[</span><span class="n">true_label</span><span class="p">]),</span>
                                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_value_array</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">predictions_array</span><span class="p">,</span> <span class="n">true_label</span><span class="p">):</span>
  <span class="n">true_label</span> <span class="o">=</span> <span class="n">true_label</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">yticks</span><span class="p">([])</span>
  <span class="n">thisplot</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">predictions_array</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"#777777"</span><span class="p">)</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
  <span class="n">predicted_label</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions_array</span><span class="p">)</span>

  <span class="n">thisplot</span><span class="p">[</span><span class="n">predicted_label</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="s">'red'</span><span class="p">)</span>
  <span class="n">thisplot</span><span class="p">[</span><span class="n">true_label</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="s">'blue'</span><span class="p">)</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plot_image</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">test_images</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot_value_array</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>  <span class="n">test_labels</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/pred.png" alt="pred" style="zoom:50%;" /></p>

<p>Cela indique que cette image a 99 % de chances d’être une <code class="language-plaintext highlighter-rouge">Bottine</code>. Remarquez que <code class="language-plaintext highlighter-rouge">plot_image</code> affiche le graphique de gauche et <code class="language-plaintext highlighter-rouge">plot_value_array</code> produit le graphique de droite.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">num_rows</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">num_images</span> <span class="o">=</span> <span class="n">num_rows</span><span class="o">*</span><span class="n">num_cols</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">num_cols</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">num_rows</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_images</span><span class="p">):</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">num_cols</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">plot_image</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">test_images</span><span class="p">)</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">num_cols</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">plot_value_array</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test_labels</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/pred1.png" alt="pred1" style="zoom:50%;" /></p>

<p>Remarquez que cela affiche simplement plus de résultats de test. Nous comprenons donc grossièrement le flux d’utilisation. Nous ne savons toujours pas comment les calculs fonctionnent en interne, mais nous savons comment les utiliser. Derrière tout cela se trouve le calcul infinitésimal. Comment comprenons-nous le calcul infinitésimal ?</p>

<p>Par exemple, il y a un nombre entre 1 et 100 que vous devez deviner. Chaque fois que vous devinez, je vous dis si c’est trop bas ou trop haut. Vous devinez 50. Je dis trop bas. Vous devinez 80. Je dis trop haut. Vous devinez 65. Je dis trop haut. Vous devinez 55. Je dis trop bas. Vous devinez 58. Je dis oui, vous l’avez trouvé.</p>

<p>L’apprentissage automatique simule un processus similaire en interne, simplement plus complexe. Il pourrait impliquer de nombreuses plages comme <code class="language-plaintext highlighter-rouge">1 à 100</code>, en devinant plusieurs nombres à la fois. Chaque supposition implique beaucoup de calculs, et déterminer si c’est trop haut ou trop bas nécessite également de nombreux calculs.</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-fr" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
