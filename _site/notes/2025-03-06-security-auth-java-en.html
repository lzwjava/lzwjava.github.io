<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Authentication and Authorization in Java</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Authentication and Authorization in Java | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Authentication and Authorization in Java" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-03-06-security-auth-java-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-03-06-security-auth-java-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Authentication and Authorization in Java" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"Authentication and Authorization in Java","url":"https://lzwjava.github.io/notes/2025-03-06-security-auth-java-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=3065c90513924cece18917dbcf75e57a98b0bf33">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=3065c90513924cece18917dbcf75e57a98b0bf33" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Authentication and Authorization in Java | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-03-06-security-auth-java-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-03-06-security-auth-java-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/security-auth-java-en" selected>English</option>
        <option value="/security-auth-java-zh" >中文</option>
        <option value="/security-auth-java-ja" >日本語</option>
        <option value="/security-auth-java-es" >Español</option>
        <option value="/security-auth-java-hi" >हिंदी</option>
        <option value="/security-auth-java-fr" >Français</option>
        <option value="/security-auth-java-de" >Deutsch</option>
        <option value="/security-auth-java-ar" >العربية</option>
        <option value="/security-auth-java-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>To use the <code class="language-plaintext highlighter-rouge">javax.security.auth</code> package in Java, you need to understand that it is part of the Java Authentication and Authorization Service (JAAS) framework. This package provides classes and interfaces for authenticating users (verifying who they are) and authorizing them (determining what they can do). Below is a step-by-step guide to using <code class="language-plaintext highlighter-rouge">javax.security.auth</code> for a basic authentication scenario, such as authenticating a user with a username and password.</p>

<hr />

<h3 id="overview-of-key-concepts"><strong>Overview of Key Concepts</strong></h3>
<p>Before diving into the steps, here’s a brief explanation of the core components in <code class="language-plaintext highlighter-rouge">javax.security.auth</code>:</p>

<ul>
  <li><strong>Subject</strong>: Represents an entity (e.g., a user or service) being authenticated. It can have multiple identities (Principals) and credentials (e.g., passwords or certificates).</li>
  <li><strong>Principal</strong>: An identity or role associated with a Subject, such as a username or group membership.</li>
  <li><strong>Credential</strong>: Information used to authenticate a Subject, such as a password or a cryptographic key.</li>
  <li><strong>LoginModule</strong>: A pluggable component that performs the authentication logic (e.g., checking a username and password against a database).</li>
  <li><strong>LoginContext</strong>: The central class that coordinates the authentication process using one or more LoginModules.</li>
  <li><strong>CallbackHandler</strong>: An interface for interacting with the user, such as prompting for a username and password.</li>
</ul>

<p>With these concepts in mind, let’s explore how to use the package.</p>

<hr />

<h3 id="steps-to-use-javaxsecurityauth"><strong>Steps to Use <code class="language-plaintext highlighter-rouge">javax.security.auth</code></strong></h3>

<h4 id="1-set-up-a-jaas-configuration"><strong>1. Set Up a JAAS Configuration</strong></h4>
<p>The authentication process relies on a configuration that specifies which <code class="language-plaintext highlighter-rouge">LoginModule</code>(s) to use. This can be defined in a configuration file or programmatically.</p>

<p>For example, create a file named <code class="language-plaintext highlighter-rouge">jaas.config</code> with the following content:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MyApp {
    com.example.MyLoginModule required;
};
</code></pre></div></div>

<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">MyApp</code></strong>: The name of the application or context, which you’ll reference in your code.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">com.example.MyLoginModule</code></strong>: The fully qualified name of your custom <code class="language-plaintext highlighter-rouge">LoginModule</code> (you’ll implement this later).</li>
  <li><strong><code class="language-plaintext highlighter-rouge">required</code></strong>: A flag indicating that this module must succeed for authentication to pass. Other flags include <code class="language-plaintext highlighter-rouge">requisite</code>, <code class="language-plaintext highlighter-rouge">sufficient</code>, and <code class="language-plaintext highlighter-rouge">optional</code>, which allow more complex logic with multiple modules.</li>
</ul>

<p>Set the system property to point to this file:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">"java.security.auth.login.config"</span><span class="o">,</span> <span class="s">"jaas.config"</span><span class="o">);</span>
</code></pre></div></div>

<p>Alternatively, you can set the configuration programmatically, but a file is simpler for most cases.</p>

<h4 id="2-implement-a-callbackhandler"><strong>2. Implement a CallbackHandler</strong></h4>
<p>A <code class="language-plaintext highlighter-rouge">CallbackHandler</code> collects input from the user, such as a username and password. Here’s a simple implementation using the console:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">javax.security.auth.callback.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyCallbackHandler</span> <span class="kd">implements</span> <span class="nc">CallbackHandler</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">Callback</span><span class="o">[]</span> <span class="n">callbacks</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span><span class="o">,</span> <span class="nc">UnsupportedCallbackException</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Callback</span> <span class="n">callback</span> <span class="o">:</span> <span class="n">callbacks</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">callback</span> <span class="k">instanceof</span> <span class="nc">NameCallback</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">NameCallback</span> <span class="n">nc</span> <span class="o">=</span> <span class="o">(</span><span class="nc">NameCallback</span><span class="o">)</span> <span class="n">callback</span><span class="o">;</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">nc</span><span class="o">.</span><span class="na">getPrompt</span><span class="o">());</span>
                <span class="n">nc</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">console</span><span class="o">().</span><span class="na">readLine</span><span class="o">());</span>
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">callback</span> <span class="k">instanceof</span> <span class="nc">PasswordCallback</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">PasswordCallback</span> <span class="n">pc</span> <span class="o">=</span> <span class="o">(</span><span class="nc">PasswordCallback</span><span class="o">)</span> <span class="n">callback</span><span class="o">;</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">pc</span><span class="o">.</span><span class="na">getPrompt</span><span class="o">());</span>
                <span class="n">pc</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">console</span><span class="o">().</span><span class="na">readPassword</span><span class="o">());</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnsupportedCallbackException</span><span class="o">(</span><span class="n">callback</span><span class="o">,</span> <span class="s">"Unsupported callback"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li><strong>NameCallback</strong>: Prompts for and retrieves the username.</li>
  <li><strong>PasswordCallback</strong>: Prompts for and retrieves the password (stored as a <code class="language-plaintext highlighter-rouge">char[]</code> for security).</li>
</ul>

<h4 id="3-implement-a-loginmodule"><strong>3. Implement a LoginModule</strong></h4>
<p>A <code class="language-plaintext highlighter-rouge">LoginModule</code> defines the authentication logic. Below is a basic example that checks against a hardcoded username and password (in practice, you’d use a database or external service):</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">javax.security.auth.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.security.auth.callback.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.security.auth.login.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.security.auth.spi.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.Principal</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyLoginModule</span> <span class="kd">implements</span> <span class="nc">LoginModule</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Subject</span> <span class="n">subject</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">CallbackHandler</span> <span class="n">callbackHandler</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">succeeded</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

    <span class="c1">// Initialize the module</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="nc">Subject</span> <span class="n">subject</span><span class="o">,</span> <span class="nc">CallbackHandler</span> <span class="n">callbackHandler</span><span class="o">,</span>
                           <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="o">?&gt;</span> <span class="n">sharedState</span><span class="o">,</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="o">?&gt;</span> <span class="n">options</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">subject</span> <span class="o">=</span> <span class="n">subject</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">callbackHandler</span> <span class="o">=</span> <span class="n">callbackHandler</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// Perform authentication</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">login</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">LoginException</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">callbackHandler</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">LoginException</span><span class="o">(</span><span class="s">"No callback handler provided"</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">NameCallback</span> <span class="n">nameCallback</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">NameCallback</span><span class="o">(</span><span class="s">"Username: "</span><span class="o">);</span>
            <span class="nc">PasswordCallback</span> <span class="n">passwordCallback</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PasswordCallback</span><span class="o">(</span><span class="s">"Password: "</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
            <span class="n">callbackHandler</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="k">new</span> <span class="nc">Callback</span><span class="o">[]{</span><span class="n">nameCallback</span><span class="o">,</span> <span class="n">passwordCallback</span><span class="o">});</span>

            <span class="nc">String</span> <span class="n">username</span> <span class="o">=</span> <span class="n">nameCallback</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>
            <span class="kt">char</span><span class="o">[]</span> <span class="n">password</span> <span class="o">=</span> <span class="n">passwordCallback</span><span class="o">.</span><span class="na">getPassword</span><span class="o">();</span>

            <span class="c1">// Hardcoded check (replace with real logic in practice)</span>
            <span class="k">if</span> <span class="o">(</span><span class="s">"myuser"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">username</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="s">"mypassword"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">password</span><span class="o">)))</span> <span class="o">{</span>
                <span class="n">succeeded</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
                <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">succeeded</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">FailedLoginException</span><span class="o">(</span><span class="s">"Authentication failed"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">LoginException</span><span class="o">(</span><span class="s">"Login error: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="c1">// Commit the authentication (add Principals to the Subject)</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">commit</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">LoginException</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">succeeded</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">subject</span><span class="o">.</span><span class="na">getPrincipals</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">MyPrincipal</span><span class="o">(</span><span class="s">"myuser"</span><span class="o">));</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// Abort the authentication process</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">abort</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">LoginException</span> <span class="o">{</span>
        <span class="n">succeeded</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// Logout the Subject</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">logout</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">LoginException</span> <span class="o">{</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">getPrincipals</span><span class="o">().</span><span class="na">clear</span><span class="o">();</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">getPublicCredentials</span><span class="o">().</span><span class="na">clear</span><span class="o">();</span>
        <span class="n">subject</span><span class="o">.</span><span class="na">getPrivateCredentials</span><span class="o">().</span><span class="na">clear</span><span class="o">();</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Simple Principal implementation</span>
<span class="kd">class</span> <span class="nc">MyPrincipal</span> <span class="kd">implements</span> <span class="nc">Principal</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">MyPrincipal</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li><strong>login()</strong>: Uses the <code class="language-plaintext highlighter-rouge">CallbackHandler</code> to get credentials and checks them.</li>
  <li><strong>commit()</strong>: If authentication succeeds, adds a <code class="language-plaintext highlighter-rouge">Principal</code> to the <code class="language-plaintext highlighter-rouge">Subject</code>.</li>
  <li><strong>abort()</strong> and <strong>logout()</strong>: Handle cleanup or cancellation.</li>
</ul>

<h4 id="4-authenticate-using-logincontext"><strong>4. Authenticate Using LoginContext</strong></h4>
<p>Now, use <code class="language-plaintext highlighter-rouge">LoginContext</code> to perform the authentication in your main application:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">javax.security.auth.login.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.Principal</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Ensure the JAAS configuration is set</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">"java.security.auth.login.config"</span><span class="o">,</span> <span class="s">"jaas.config"</span><span class="o">);</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="c1">// Create LoginContext with the configuration name and CallbackHandler</span>
            <span class="nc">LoginContext</span> <span class="n">lc</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LoginContext</span><span class="o">(</span><span class="s">"MyApp"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">MyCallbackHandler</span><span class="o">());</span>

            <span class="c1">// Perform authentication</span>
            <span class="n">lc</span><span class="o">.</span><span class="na">login</span><span class="o">();</span>

            <span class="c1">// Get the authenticated Subject</span>
            <span class="nc">Subject</span> <span class="n">subject</span> <span class="o">=</span> <span class="n">lc</span><span class="o">.</span><span class="na">getSubject</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Authenticated subject: "</span> <span class="o">+</span> <span class="n">subject</span><span class="o">);</span>

            <span class="c1">// Print the Subject's Principals</span>
            <span class="k">for</span> <span class="o">(</span><span class="nc">Principal</span> <span class="n">p</span> <span class="o">:</span> <span class="n">subject</span><span class="o">.</span><span class="na">getPrincipals</span><span class="o">())</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Principal: "</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
            <span class="o">}</span>

            <span class="c1">// Logout when done</span>
            <span class="n">lc</span><span class="o">.</span><span class="na">logout</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">LoginException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Authentication failed: "</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">LoginContext lc = new LoginContext("MyApp", new MyCallbackHandler())</code></strong>: Links to the <code class="language-plaintext highlighter-rouge">"MyApp"</code> configuration and uses <code class="language-plaintext highlighter-rouge">MyCallbackHandler</code>.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">lc.login()</code></strong>: Triggers the authentication process.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">lc.getSubject()</code></strong>: Retrieves the authenticated <code class="language-plaintext highlighter-rouge">Subject</code>.</li>
</ul>

<h4 id="5-perform-authorized-actions-optional"><strong>5. Perform Authorized Actions (Optional)</strong></h4>
<p>Once authenticated, you can use the <code class="language-plaintext highlighter-rouge">Subject</code> to execute code with its privileges using <code class="language-plaintext highlighter-rouge">Subject.doAs()</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.security.PrivilegedAction</span><span class="o">;</span>

<span class="nc">Subject</span><span class="o">.</span><span class="na">doAs</span><span class="o">(</span><span class="n">subject</span><span class="o">,</span> <span class="k">new</span> <span class="nc">PrivilegedAction</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Running as: "</span> <span class="o">+</span> <span class="nc">Subject</span><span class="o">.</span><span class="na">getSubject</span><span class="o">(</span><span class="n">java</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">AccessController</span><span class="o">.</span><span class="na">getContext</span><span class="o">()));</span>
        <span class="c1">// Perform privileged actions here</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre></div></div>

<p>This is useful for authorization, where actions are restricted based on the <code class="language-plaintext highlighter-rouge">Subject</code>’s <code class="language-plaintext highlighter-rouge">Principals</code>.</p>

<hr />

<h3 id="putting-it-all-together"><strong>Putting It All Together</strong></h3>
<ol>
  <li><strong>Configuration</strong>: Define <code class="language-plaintext highlighter-rouge">jaas.config</code> with your <code class="language-plaintext highlighter-rouge">LoginModule</code>.</li>
  <li><strong>CallbackHandler</strong>: Implement <code class="language-plaintext highlighter-rouge">MyCallbackHandler</code> to collect user input.</li>
  <li><strong>LoginModule</strong>: Implement <code class="language-plaintext highlighter-rouge">MyLoginModule</code> with your authentication logic.</li>
  <li><strong>Main Code</strong>: Use <code class="language-plaintext highlighter-rouge">LoginContext</code> to authenticate and retrieve a <code class="language-plaintext highlighter-rouge">Subject</code>.</li>
  <li><strong>Authorization</strong>: Use <code class="language-plaintext highlighter-rouge">Subject.doAs()</code> for privileged actions if needed.</li>
</ol>

<p>When you run the <code class="language-plaintext highlighter-rouge">Main</code> class, it will:</p>
<ul>
  <li>Prompt for a username and password.</li>
  <li>Authenticate using <code class="language-plaintext highlighter-rouge">MyLoginModule</code>.</li>
  <li>Print the <code class="language-plaintext highlighter-rouge">Subject</code> and its <code class="language-plaintext highlighter-rouge">Principals</code> if successful.</li>
</ul>

<hr />

<h3 id="additional-notes"><strong>Additional Notes</strong></h3>
<ul>
  <li><strong>Real-World Usage</strong>: Replace hardcoded credentials in <code class="language-plaintext highlighter-rouge">MyLoginModule</code> with checks against a database, LDAP, or another service. Java provides standard modules like <code class="language-plaintext highlighter-rouge">Krb5LoginModule</code> (Kerberos) or <code class="language-plaintext highlighter-rouge">JndiLoginModule</code> (LDAP), but they may require additional setup.</li>
  <li><strong>Multiple LoginModules</strong>: The configuration can specify multiple modules with flags (<code class="language-plaintext highlighter-rouge">required</code>, <code class="language-plaintext highlighter-rouge">sufficient</code>, etc.) to create complex authentication flows.</li>
  <li><strong>Security</strong>: Use secure practices, such as avoiding <code class="language-plaintext highlighter-rouge">String</code> for passwords (use <code class="language-plaintext highlighter-rouge">char[]</code>) and integrating with existing security frameworks.</li>
</ul>

<p>This guide covers the basics of using <code class="language-plaintext highlighter-rouge">javax.security.auth</code> for authentication and authorization in Java!</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
