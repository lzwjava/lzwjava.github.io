<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>CodeIgniter Migrations Database Schema Management</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>CodeIgniter Migrations Database Schema Management | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="CodeIgniter Migrations Database Schema Management" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-10-02-codeigniter-migrations-schema-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-10-02-codeigniter-migrations-schema-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CodeIgniter Migrations Database Schema Management" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"CodeIgniter Migrations Database Schema Management","url":"https://lzwjava.github.io/notes/2025-10-02-codeigniter-migrations-schema-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=e75355f84ffbe78abee7497bff5463df7ad99b19">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=e75355f84ffbe78abee7497bff5463df7ad99b19" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       CodeIgniter Migrations Database Schema Management | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-10-02-codeigniter-migrations-schema-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-10-02-codeigniter-migrations-schema-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/codeigniter-migrations-schema-en" selected>English</option>
        <option value="/codeigniter-migrations-schema-zh" >中文</option>
        <option value="/codeigniter-migrations-schema-ja" >日本語</option>
        <option value="/codeigniter-migrations-schema-es" >Español</option>
        <option value="/codeigniter-migrations-schema-hi" >हिंदी</option>
        <option value="/codeigniter-migrations-schema-fr" >Français</option>
        <option value="/codeigniter-migrations-schema-de" >Deutsch</option>
        <option value="/codeigniter-migrations-schema-ar" >العربية</option>
        <option value="/codeigniter-migrations-schema-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <h3 id="what-are-codeigniter-migrations">What Are CodeIgniter Migrations?</h3>

<p>CodeIgniter (CI) migrations are a feature that helps manage database schema changes in a version-controlled way, similar to tools like Flyway or Liquibase. They allow you to write PHP scripts that define database alterations (e.g., creating tables, adding columns, or modifying data), then run them in sequence to keep your schema up-to-date across environments. This prevents manual SQL errors and supports rollback.</p>

<p>Migrations work by:</p>
<ul>
  <li>Storing migration files in a directory (default: <code class="language-plaintext highlighter-rouge">application/migrations/</code>).</li>
  <li>Tracking “versions” in a database table to know which migrations have been applied.</li>
  <li>Running scripts forward (up) or backward (down) based on your needs.</li>
</ul>

<p>The config file you shared (<code class="language-plaintext highlighter-rouge">migration.php</code>) controls how migrations behave. It uses PHP arrays to set options. Below, I’ll explain the key settings with examples.</p>

<h3 id="key-configuration-settings">Key Configuration Settings</h3>

<table>
  <thead>
    <tr>
      <th>Setting</th>
      <th>Value in Your Code</th>
      <th>Explanation</th>
      <th>How It Works</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">migration_enabled</code></td>
      <td><code class="language-plaintext highlighter-rouge">FALSE</code></td>
      <td>Enables or disables migrations globally. When <code class="language-plaintext highlighter-rouge">FALSE</code>, you can’t run migrations (for security, as they modify the DB).</td>
      <td>CI checks this before executing any migration command. Set to <code class="language-plaintext highlighter-rouge">TRUE</code> during development, then back to <code class="language-plaintext highlighter-rouge">FALSE</code> in production. Example: If enabled, run via <code class="language-plaintext highlighter-rouge">$this-&gt;migration-&gt;current()</code> in a controller.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">migration_type</code></td>
      <td><code class="language-plaintext highlighter-rouge">'timestamp'</code></td>
      <td>File naming style: <code class="language-plaintext highlighter-rouge">'sequential'</code> (e.g., <code class="language-plaintext highlighter-rouge">001_add_blog.php</code>) or <code class="language-plaintext highlighter-rouge">'timestamp'</code> (e.g., <code class="language-plaintext highlighter-rouge">20121031104401_add_blog.php</code>). Timestamp is recommended for better version control.</td>
      <td>Files are loaded in chronological order. Timestamp uses <code class="language-plaintext highlighter-rouge">YYYYMMDDHHIISS</code> format (e.g., <code class="language-plaintext highlighter-rouge">20121031104401</code> for Oct 31, 2012, 10:44:01).</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">migration_table</code></td>
      <td><code class="language-plaintext highlighter-rouge">'migrations'</code></td>
      <td>Name of the DB table that tracks applied migrations. Required.</td>
      <td>CI creates this table if it doesn’t exist. It stores the latest migration version. Deletes or updates this table reset migration history.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">migration_auto_latest</code></td>
      <td><code class="language-plaintext highlighter-rouge">FALSE</code></td>
      <td>If <code class="language-plaintext highlighter-rouge">TRUE</code> and <code class="language-plaintext highlighter-rouge">migration_enabled</code> is <code class="language-plaintext highlighter-rouge">TRUE</code>, auto-runs migrations to the latest version when the Migration library loads (e.g., on page load).</td>
      <td>Useful for dev environments to auto-sync schemas. Set <code class="language-plaintext highlighter-rouge">FALSE</code> to run migrations manually for control (safer in prod).</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">migration_version</code></td>
      <td><code class="language-plaintext highlighter-rouge">0</code></td>
      <td>The target version/number to migrate to. Set to the filename prefix (e.g., <code class="language-plaintext highlighter-rouge">20121031104401</code>). <code class="language-plaintext highlighter-rouge">0</code> means no migrations applied.</td>
      <td>Running <code class="language-plaintext highlighter-rouge">$this-&gt;migration-&gt;version(20121031104401)</code> migrates up to that point. Used for targeted rollbacks—negative numbers downgrade.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">migration_path</code></td>
      <td><code class="language-plaintext highlighter-rouge">APPPATH.'migrations/'</code></td>
      <td>Directory where migration files are stored. <code class="language-plaintext highlighter-rouge">APPPATH</code> is a CI constant pointing to <code class="language-plaintext highlighter-rouge">application/</code>.</td>
      <td>CI scans this folder for PHP files matching the naming convention. Must be writable by the web server. Custom paths like <code class="language-plaintext highlighter-rouge">BASEPATH.'custom/migrations/'</code> are possible.</td>
    </tr>
  </tbody>
</table>

<h3 id="how-to-use-migrations-step-by-step">How to Use Migrations (Step-by-Step)</h3>

<ol>
  <li>
    <p><strong>Enable Migrations</strong>: Temporarily set <code class="language-plaintext highlighter-rouge">$config['migration_enabled'] = TRUE;</code> in the config file.</p>
  </li>
  <li><strong>Create a Migration File</strong>: Add a PHP file in <code class="language-plaintext highlighter-rouge">application/migrations/</code> with a name like <code class="language-plaintext highlighter-rouge">20121031104401_add_blog.php</code>. Inside, use CI’s Migration class:
    <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">defined</span><span class="p">(</span><span class="s1">'BASEPATH'</span><span class="p">)</span> <span class="k">OR</span> <span class="k">exit</span><span class="p">(</span><span class="s1">'No direct script access allowed'</span><span class="p">);</span>

<span class="kd">class</span> <span class="nc">Migration_Add_blog</span> <span class="kd">extends</span> <span class="nc">CI_Migration</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">up</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">dbforge</span><span class="o">-&gt;</span><span class="nf">add_field</span><span class="p">(</span><span class="s1">'id'</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">dbforge</span><span class="o">-&gt;</span><span class="nf">create_table</span><span class="p">(</span><span class="s1">'blogs'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">down</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">dbforge</span><span class="o">-&gt;</span><span class="nf">drop_table</span><span class="p">(</span><span class="s1">'blogs'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">up()</code> applies changes (e.g., create table).</li>
      <li><code class="language-plaintext highlighter-rouge">down()</code> reverses them (e.g., drop table).</li>
    </ul>
  </li>
  <li><strong>Run Migrations</strong>:
    <ul>
      <li>Load the library: <code class="language-plaintext highlighter-rouge">$this-&gt;load-&gt;library('migration');</code></li>
      <li>To latest: <code class="language-plaintext highlighter-rouge">$this-&gt;migration-&gt;current();</code></li>
      <li>To specific: <code class="language-plaintext highlighter-rouge">$this-&gt;migration-&gt;version('20121031104401');</code></li>
      <li>From command line (if CLI enabled): <code class="language-plaintext highlighter-rouge">php index.php migrate current</code></li>
    </ul>
  </li>
  <li><strong>Common Commands</strong>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">$this-&gt;migration-&gt;latest()</code>: Alias for <code class="language-plaintext highlighter-rouge">current()</code>.</li>
      <li><code class="language-plaintext highlighter-rouge">$this-&gt;migration-&gt;find_migratables()</code>: Lists available files.
Errors log to CI’s log files or throw exceptions.</li>
    </ul>
  </li>
  <li><strong>Best Practices</strong>:
    <ul>
      <li>Keep migrations idempotent (safe to re-run).</li>
      <li>Test in dev first; avoid enabling auto-migrate in production to prevent accidental schema changes.</li>
      <li>Use transactions if your DB supports them for atomic changes.</li>
      <li>Disable after use: Set back to <code class="language-plaintext highlighter-rouge">FALSE</code> for security.</li>
    </ul>
  </li>
</ol>

<p>If you run into issues (e.g., permissions on the path), check CI’s logs or documentation at <a href="https://codeigniter.com/user_guide/libraries/migration.html">codeigniter.com/user_guide/libraries/migration.html</a>. Specify your CI version for more tailored advice!</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    
      <p class="model">x-ai/grok-code-fast-1</p>
    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
