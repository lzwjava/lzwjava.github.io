<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>How to Call GitHub Copilot from a VSCode Extension</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>How to Call GitHub Copilot from a VSCode Extension | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="How to Call GitHub Copilot from a VSCode Extension" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-06-05-vscode-copilot-extension-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-06-05-vscode-copilot-extension-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="How to Call GitHub Copilot from a VSCode Extension" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"How to Call GitHub Copilot from a VSCode Extension","url":"https://lzwjava.github.io/notes/2025-06-05-vscode-copilot-extension-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=5ed887fe3ef5334418d51fd3c91878d0831fcb62">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=5ed887fe3ef5334418d51fd3c91878d0831fcb62" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       How to Call GitHub Copilot from a VSCode Extension | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-06-05-vscode-copilot-extension-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-06-05-vscode-copilot-extension-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.09</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/vscode-copilot-extension-en" selected>English</option>
        <option value="/vscode-copilot-extension-zh" >中文</option>
        <option value="/vscode-copilot-extension-ja" >日本語</option>
        <option value="/vscode-copilot-extension-es" >Español</option>
        <option value="/vscode-copilot-extension-hi" >हिंदी</option>
        <option value="/vscode-copilot-extension-fr" >Français</option>
        <option value="/vscode-copilot-extension-de" >Deutsch</option>
        <option value="/vscode-copilot-extension-ar" >العربية</option>
        <option value="/vscode-copilot-extension-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>GitHub Copilot is a powerful AI-powered coding assistant integrated into Visual Studio Code (VSCode) and IntelliJ IDEA through their respective plugins. While there’s no public REST API for directly calling Copilot, developers can interact with its capabilities programmatically within a VSCode extension using the VSCode Chat API, Language Model API, or command-based interactions. This blog post walks through creating a VSCode extension that triggers Copilot’s chat functionality with a custom prompt, effectively simulating an “API call” to Copilot, and explains how to leverage Copilot itself to streamline development.</p>

<h2 id="understanding-copilots-integration-in-vscode">Understanding Copilot’s Integration in VSCode</h2>

<p>GitHub Copilot doesn’t expose a traditional API (e.g., REST endpoints) for direct programmatic access. Instead, its functionality is available through:</p>
<ul>
  <li><strong>VSCode Chat API</strong>: Enables extensions to create custom chat participants that interact with Copilot’s chat system for natural language queries.</li>
  <li><strong>VSCode Language Model API</strong>: Allows extensions to access Copilot’s large language models (LLMs) for tasks like code generation or analysis.</li>
  <li><strong>VSCode Commands</strong>: Permits triggering Copilot’s built-in features, such as opening the chat window with a predefined prompt.</li>
</ul>

<p>This guide focuses on using the <code class="language-plaintext highlighter-rouge">workbench.action.chat.open</code> command to trigger Copilot’s chat interface, as it’s the simplest way to integrate Copilot’s capabilities into an extension.</p>

<h2 id="step-by-step-building-a-vscode-extension-to-trigger-copilot-chat">Step-by-Step: Building a VSCode Extension to Trigger Copilot Chat</h2>

<p>Below is a step-by-step guide to creating a VSCode extension that opens Copilot’s chat window with a custom prompt, effectively “calling” Copilot to process a user-defined query.</p>

<h3 id="1-set-up-the-vscode-extension">1. Set Up the VSCode Extension</h3>

<ol>
  <li><strong>Scaffold the Project</strong>:
    <ul>
      <li>Install the Yeoman VSCode extension generator: <code class="language-plaintext highlighter-rouge">npm install -g yo generator-code</code>.</li>
      <li>Run <code class="language-plaintext highlighter-rouge">yo code</code> and select “New Extension (TypeScript)” to create a TypeScript-based extension.</li>
      <li>Name the extension, e.g., <code class="language-plaintext highlighter-rouge">copilot-api-caller</code>.</li>
    </ul>
  </li>
  <li><strong>Configure <code class="language-plaintext highlighter-rouge">package.json</code></strong>:
    <ul>
      <li>Define a command to trigger Copilot’s chat.</li>
      <li>Example <code class="language-plaintext highlighter-rouge">package.json</code>:</li>
    </ul>
  </li>
</ol>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"copilot-api-caller"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"displayName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Copilot API Caller"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Triggers GitHub Copilot Chat with a custom prompt"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0.1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"engines"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"vscode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.85.0"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Other"</span><span class="p">],</span><span class="w">
  </span><span class="nl">"activationEvents"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"onCommand:copilot-api-caller.triggerCopilotChat"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"main"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./out/extension.js"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"contributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"commands"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"command"</span><span class="p">:</span><span class="w"> </span><span class="s2">"copilot-api-caller.triggerCopilotChat"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Trigger Copilot Chat"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"vscode:prepublish"</span><span class="p">:</span><span class="w"> </span><span class="s2">"npm run compile"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"compile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tsc -p ./"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"watch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tsc -watch -p ./"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"devDependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@types/vscode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.85.0"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"@types/node"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^20.2.5"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"typescript"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^5.1.3"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li><strong>Using Copilot</strong>: While editing <code class="language-plaintext highlighter-rouge">package.json</code>, Copilot may suggest fields like <code class="language-plaintext highlighter-rouge">contributes.commands</code> or <code class="language-plaintext highlighter-rouge">activationEvents</code> as you type. Accept these with <code class="language-plaintext highlighter-rouge">Tab</code> to speed up setup.</li>
</ul>

<h3 id="2-write-the-extension-code">2. Write the Extension Code</h3>

<p>Create the extension logic to register a command that opens Copilot’s chat with a user-provided prompt.</p>

<ul>
  <li><strong>File</strong>: <code class="language-plaintext highlighter-rouge">src/extension.ts</code></li>
  <li><strong>Code</strong>:</li>
</ul>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">vscode</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vscode</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">activate</span><span class="p">(</span><span class="nx">context</span><span class="p">:</span> <span class="nx">vscode</span><span class="p">.</span><span class="nx">ExtensionContext</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Register the command to trigger Copilot Chat</span>
  <span class="kd">let</span> <span class="nx">disposable</span> <span class="o">=</span> <span class="nx">vscode</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">registerCommand</span><span class="p">(</span><span class="dl">'</span><span class="s1">copilot-api-caller.triggerCopilotChat</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Get user input for the prompt</span>
    <span class="kd">const</span> <span class="nx">prompt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">vscode</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">showInputBox</span><span class="p">({</span>
      <span class="na">prompt</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Enter your query for GitHub Copilot</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">placeHolder</span><span class="p">:</span> <span class="dl">'</span><span class="s1">e.g., Write a JavaScript function to sort an array</span><span class="dl">'</span>
    <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">prompt</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="c1">// Execute the command to open Copilot Chat with the prompt</span>
        <span class="k">await</span> <span class="nx">vscode</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">executeCommand</span><span class="p">(</span><span class="dl">'</span><span class="s1">workbench.action.chat.open</span><span class="dl">'</span><span class="p">,</span> <span class="nx">prompt</span><span class="p">);</span>
        <span class="nx">vscode</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">showInformationMessage</span><span class="p">(</span><span class="dl">'</span><span class="s1">Sent prompt to Copilot Chat!</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">vscode</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">showErrorMessage</span><span class="p">(</span><span class="s2">`Failed to trigger Copilot Chat: </span><span class="p">${</span><span class="nx">error</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="nx">context</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">disposable</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">deactivate</span><span class="p">()</span> <span class="p">{}</span>
</code></pre></div></div>

<ul>
  <li><strong>How It Works</strong>:
    <ul>
      <li>Registers a command <code class="language-plaintext highlighter-rouge">copilot-api-caller.triggerCopilotChat</code>.</li>
      <li>Prompts the user for a query (e.g., “Write a Python function to reverse a string”).</li>
      <li>Uses <code class="language-plaintext highlighter-rouge">vscode.commands.executeCommand('workbench.action.chat.open', prompt)</code> to open Copilot’s chat window with the prompt.</li>
    </ul>
  </li>
  <li><strong>Using Copilot</strong>: In VSCode, type <code class="language-plaintext highlighter-rouge">import * as vscode</code> and Copilot will suggest the full import. Add a comment like <code class="language-plaintext highlighter-rouge">// Register a command to open Copilot Chat</code>, and Copilot may propose the <code class="language-plaintext highlighter-rouge">vscode.commands.registerCommand</code> structure. For the command execution, type <code class="language-plaintext highlighter-rouge">// Open Copilot Chat with a prompt</code>, and Copilot might suggest the <code class="language-plaintext highlighter-rouge">executeCommand</code> call.</li>
</ul>

<h3 id="3-enhance-with-context-optional">3. Enhance with Context (Optional)</h3>

<p>To make the extension more powerful, include context from the editor, such as selected code, to provide Copilot with additional information.</p>

<ul>
  <li><strong>Modified Code</strong> (<code class="language-plaintext highlighter-rouge">src/extension.ts</code>):</li>
</ul>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">vscode</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vscode</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">activate</span><span class="p">(</span><span class="nx">context</span><span class="p">:</span> <span class="nx">vscode</span><span class="p">.</span><span class="nx">ExtensionContext</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">disposable</span> <span class="o">=</span> <span class="nx">vscode</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">registerCommand</span><span class="p">(</span><span class="dl">'</span><span class="s1">copilot-api-caller.triggerCopilotChat</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Get selected text from the active editor</span>
    <span class="kd">const</span> <span class="nx">editor</span> <span class="o">=</span> <span class="nx">vscode</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">activeTextEditor</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">context</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">editor</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">selection</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">selection</span><span class="p">;</span>
      <span class="nx">context</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">getText</span><span class="p">(</span><span class="nx">selection</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Prompt for user input</span>
    <span class="kd">const</span> <span class="nx">prompt</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">vscode</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">showInputBox</span><span class="p">({</span>
      <span class="na">prompt</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Enter your query for GitHub Copilot</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">placeHolder</span><span class="p">:</span> <span class="dl">'</span><span class="s1">e.g., Explain this code</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">value</span><span class="p">:</span> <span class="nx">context</span> <span class="p">?</span> <span class="s2">`Regarding this code: \n</span><span class="se">\`\`\`</span><span class="s2">\n</span><span class="p">${</span><span class="nx">context</span><span class="p">}</span><span class="s2">\n</span><span class="se">\`\`\`</span><span class="s2">\n`</span> <span class="p">:</span> <span class="dl">''</span>
    <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">prompt</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">try</span> <span class="p">{</span>
        <span class="k">await</span> <span class="nx">vscode</span><span class="p">.</span><span class="nx">commands</span><span class="p">.</span><span class="nx">executeCommand</span><span class="p">(</span><span class="dl">'</span><span class="s1">workbench.action.chat.open</span><span class="dl">'</span><span class="p">,</span> <span class="nx">prompt</span><span class="p">);</span>
        <span class="nx">vscode</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">showInformationMessage</span><span class="p">(</span><span class="dl">'</span><span class="s1">Sent prompt to Copilot Chat!</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">vscode</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">showErrorMessage</span><span class="p">(</span><span class="s2">`Failed to trigger Copilot Chat: </span><span class="p">${</span><span class="nx">error</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="nx">context</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">disposable</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">deactivate</span><span class="p">()</span> <span class="p">{}</span>
</code></pre></div></div>

<ul>
  <li><strong>How It Works</strong>:
    <ul>
      <li>Retrieves selected text from the active editor and includes it as context in the prompt.</li>
      <li>Pre-fills the input box with the selected code, formatted as a Markdown code block.</li>
      <li>Sends the combined prompt to Copilot’s chat interface.</li>
    </ul>
  </li>
  <li><strong>Using Copilot</strong>: Comment <code class="language-plaintext highlighter-rouge">// Get selected text from editor</code>, and Copilot may suggest <code class="language-plaintext highlighter-rouge">vscode.window.activeTextEditor</code>. For formatting, type <code class="language-plaintext highlighter-rouge">// Format code as markdown</code>, and Copilot might propose the triple-backtick syntax.</li>
</ul>

<h3 id="4-test-the-extension">4. Test the Extension</h3>

<ol>
  <li>Press <code class="language-plaintext highlighter-rouge">F5</code> in VSCode to launch the Extension Development Host.</li>
  <li>Open the Command Palette (<code class="language-plaintext highlighter-rouge">Ctrl+Shift+P</code> or <code class="language-plaintext highlighter-rouge">Cmd+Shift+P</code>) and run <code class="language-plaintext highlighter-rouge">Trigger Copilot Chat</code>.</li>
  <li>Enter a prompt (e.g., “Generate a REST API client in TypeScript”) or select code and run the command.</li>
  <li>Verify that Copilot’s chat window opens with your prompt and provides a response.</li>
  <li><strong>Using Copilot</strong>: If errors occur, add a comment like <code class="language-plaintext highlighter-rouge">// Handle errors for command execution</code>, and Copilot may suggest try-catch blocks or error messages.</li>
</ol>

<h3 id="5-advanced-using-the-vscode-chat-api">5. Advanced: Using the VSCode Chat API</h3>

<p>For more control, use the VSCode Chat API to create a custom chat participant that integrates with Copilot’s language models, allowing natural language processing within your extension.</p>

<ul>
  <li><strong>Example Code</strong> (<code class="language-plaintext highlighter-rouge">src/extension.ts</code>):</li>
</ul>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">vscode</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">vscode</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">activate</span><span class="p">(</span><span class="nx">context</span><span class="p">:</span> <span class="nx">vscode</span><span class="p">.</span><span class="nx">ExtensionContext</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Register a chat participant</span>
  <span class="kd">const</span> <span class="nx">participant</span> <span class="o">=</span> <span class="nx">vscode</span><span class="p">.</span><span class="nx">chat</span><span class="p">.</span><span class="nx">createChatParticipant</span><span class="p">(</span><span class="dl">'</span><span class="s1">copilot-api-caller.myParticipant</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">stream</span><span class="p">,</span> <span class="nx">token</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">stream</span><span class="p">.</span><span class="nx">markdown</span><span class="p">(</span><span class="dl">'</span><span class="s1">Processing your query...</span><span class="se">\n</span><span class="dl">'</span><span class="p">);</span>
    <span class="c1">// Use the Language Model API to generate a response</span>
    <span class="kd">const</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">vscode</span><span class="p">.</span><span class="nx">lm</span><span class="p">.</span><span class="nx">selectChatModels</span><span class="p">({</span> <span class="na">family</span><span class="p">:</span> <span class="dl">'</span><span class="s1">gpt-4</span><span class="dl">'</span> <span class="p">})[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">model</span><span class="p">.</span><span class="nx">sendRequest</span><span class="p">([{</span> <span class="na">text</span><span class="p">:</span> <span class="nx">request</span><span class="p">.</span><span class="nx">prompt</span> <span class="p">}],</span> <span class="p">{},</span> <span class="nx">token</span><span class="p">);</span>
      <span class="k">for</span> <span class="k">await</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">chunk</span> <span class="k">of</span> <span class="nx">response</span><span class="p">.</span><span class="nx">stream</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">stream</span><span class="p">.</span><span class="nx">markdown</span><span class="p">(</span><span class="nx">chunk</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">stream</span><span class="p">.</span><span class="nx">markdown</span><span class="p">(</span><span class="dl">'</span><span class="s1">No suitable model available.</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="nx">participant</span><span class="p">.</span><span class="nx">iconPath</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">vscode</span><span class="p">.</span><span class="nx">ThemeIcon</span><span class="p">(</span><span class="dl">'</span><span class="s1">sparkle</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">context</span><span class="p">.</span><span class="nx">subscriptions</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">participant</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">deactivate</span><span class="p">()</span> <span class="p">{}</span>
</code></pre></div></div>

<ul>
  <li><strong>How It Works</strong>:
    <ul>
      <li>Creates a chat participant (<code class="language-plaintext highlighter-rouge">@copilot-api-caller.myParticipant</code>) invocable in the Copilot Chat view.</li>
      <li>Uses the Language Model API to access Copilot’s <code class="language-plaintext highlighter-rouge">gpt-4</code> model (or another available model) to process the prompt.</li>
      <li>Streams the response back to the chat view.</li>
    </ul>
  </li>
  <li><strong>Using Copilot</strong>: Comment <code class="language-plaintext highlighter-rouge">// Create a chat participant for Copilot</code>, and Copilot may suggest the <code class="language-plaintext highlighter-rouge">vscode.chat.createChatParticipant</code> structure. For the Language Model API, comment <code class="language-plaintext highlighter-rouge">// Access Copilot’s LLM</code>, and Copilot might propose <code class="language-plaintext highlighter-rouge">vscode.lm.selectChatModels</code>.</li>
</ul>

<h3 id="6-package-and-deploy">6. Package and Deploy</h3>

<ol>
  <li>Install <code class="language-plaintext highlighter-rouge">vsce</code>: <code class="language-plaintext highlighter-rouge">npm install -g @vscode/vsce</code>.</li>
  <li>Run <code class="language-plaintext highlighter-rouge">vsce package</code> to create a <code class="language-plaintext highlighter-rouge">.vsix</code> file.</li>
  <li>Install the extension in VSCode via the Extensions view or share the <code class="language-plaintext highlighter-rouge">.vsix</code> file with others.</li>
  <li><strong>Using Copilot</strong>: Add a comment like <code class="language-plaintext highlighter-rouge">// Add script to package extension</code> in <code class="language-plaintext highlighter-rouge">package.json</code>, and Copilot may suggest the <code class="language-plaintext highlighter-rouge">vscode:prepublish</code> script.</li>
</ol>

<h2 id="leveraging-copilot-during-development">Leveraging Copilot During Development</h2>

<p>GitHub Copilot can significantly speed up extension development:</p>
<ul>
  <li><strong>Code Suggestions</strong>: As you type in <code class="language-plaintext highlighter-rouge">src/extension.ts</code>, Copilot suggests imports, command registrations, and error handling. For example, typing <code class="language-plaintext highlighter-rouge">vscode.commands.</code> prompts suggestions like <code class="language-plaintext highlighter-rouge">registerCommand</code>.</li>
  <li><strong>Prompt Engineering</strong>: Use clear comments like <code class="language-plaintext highlighter-rouge">// Trigger Copilot Chat with a user prompt</code> to guide Copilot’s suggestions. Refine comments if suggestions are inaccurate.</li>
  <li><strong>Debugging</strong>: If the extension fails, add comments like <code class="language-plaintext highlighter-rouge">// Log error details</code>, and Copilot may suggest <code class="language-plaintext highlighter-rouge">console.log</code> or <code class="language-plaintext highlighter-rouge">vscode.window.showErrorMessage</code>.</li>
</ul>

<h2 id="limitations">Limitations</h2>

<ul>
  <li><strong>No Direct API Access</strong>: Copilot doesn’t expose a public REST API. The VSCode Chat and Language Model APIs are the primary programmatic interfaces.</li>
  <li><strong>Authentication</strong>: Users must have an active Copilot subscription (free or paid) and be signed into VSCode with a GitHub account.</li>
  <li><strong>Chat API Scope</strong>: The Chat API is limited to the chat interface; direct access to Copilot’s code completion engine is not available programmatically.</li>
  <li><strong>Environment</strong>: Ensure the extension complies with any organizational policies regarding custom VSCode extensions.</li>
</ul>

<h2 id="conclusion">Conclusion</h2>

<p>By using VSCode’s command system or Chat API, developers can effectively “call” GitHub Copilot from a custom extension, enabling programmatic interaction with its AI capabilities. The example above demonstrates triggering Copilot’s chat with a custom prompt, enhanced with editor context, and provides a foundation for more advanced integrations using the Language Model API. With Copilot’s assistance during development, creating such extensions becomes faster and more intuitive.</p>

<p>For further exploration, consider experimenting with the Chat API for custom participants or integrating additional editor context for richer prompts. Happy coding!</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
