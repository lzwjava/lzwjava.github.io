<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Python Cryptography Guide</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Python Cryptography Guide | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Python Cryptography Guide" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-05-13-python-cryptography-guide-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-05-13-python-cryptography-guide-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Python Cryptography Guide" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"Python Cryptography Guide","url":"https://lzwjava.github.io/notes/2025-05-13-python-cryptography-guide-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=a1f7f3b032a039b527f9b454d7a34e18a4a67a6c">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=a1f7f3b032a039b527f9b454d7a34e18a4a67a6c" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Python Cryptography Guide | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-05-13-python-cryptography-guide-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-05-13-python-cryptography-guide-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/python-cryptography-guide-en" selected>English</option>
        <option value="/python-cryptography-guide-zh" >中文</option>
        <option value="/python-cryptography-guide-ja" >日本語</option>
        <option value="/python-cryptography-guide-es" >Español</option>
        <option value="/python-cryptography-guide-hi" >हिंदी</option>
        <option value="/python-cryptography-guide-fr" >Français</option>
        <option value="/python-cryptography-guide-de" >Deutsch</option>
        <option value="/python-cryptography-guide-ar" >العربية</option>
        <option value="/python-cryptography-guide-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <h3 id="introduction-to-the-cryptography-package">Introduction to the Cryptography Package</h3>
<p>The <code class="language-plaintext highlighter-rouge">cryptography</code> package is a popular Python library that provides cryptographic primitives and recipes for secure protocols. It focuses on ease of use and security, implementing standards like AES, RSA, and more. It’s not for implementing high-level protocols like SSH or TLS directly—use it as a building block. Always verify it’s up-to-date for security patches.</p>

<h3 id="installation">Installation</h3>
<p>Install via pip:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>cryptography
</code></pre></div></div>
<p>For better performance (especially for large keys or frequent operations), install with OpenSSL support:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>cryptography[openssl]
</code></pre></div></div>
<p>Note: On some systems, you may need to install OpenSSL headers separately (e.g., <code class="language-plaintext highlighter-rouge">apt install libssl-dev</code> on Ubuntu).</p>

<h3 id="basic-concepts">Basic Concepts</h3>
<ul>
  <li><strong>Primitives</strong>: Low-level operations like encryption/decryption.</li>
  <li><strong>Recipes</strong>: High-level, opinionated functions (e.g., Fernet for symmetric encryption).</li>
  <li><strong>Hazard Warnings</strong>: The library uses warnings for insecure usage—pay attention to them.</li>
</ul>

<p>Import the library:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">cryptography.fernet</span> <span class="kn">import</span> <span class="n">Fernet</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives</span> <span class="kn">import</span> <span class="n">serialization</span><span class="p">,</span> <span class="n">hashes</span><span class="p">,</span> <span class="n">asyncioc</span> <span class="k">as</span> <span class="n">a</span>
<span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.asymmetric</span> <span class="kn">import</span> <span class="n">rsa</span><span class="p">,</span> <span class="n">padding</span>
</code></pre></div></div>

<h3 id="examples">Examples</h3>

<h4 id="1-symmetric-encryption-with-fernet-easiest-for-beginners">1. Symmetric Encryption with Fernet (Easiest for Beginners)</h4>
<p>Fernet uses AES-128 in CBC mode with HMAC for integrity. It’s ideal for storing encrypted data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">cryptography.fernet</span> <span class="kn">import</span> <span class="n">Fernet</span>

<span class="c1"># Generate a key (store securely, e.g., in env vars)
</span><span class="n">key</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">.</span><span class="n">generate_key</span><span class="p">()</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="c1"># Encrypt
</span><span class="n">plaintext</span> <span class="o">=</span> <span class="sa">b</span><span class="s">"This is a secret message."</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Encrypted:"</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>

<span class="c1"># Decrypt
</span><span class="n">decrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Decrypted:"</span><span class="p">,</span> <span class="n">decrypted</span><span class="p">)</span>
</code></pre></div></div>
<ul>
  <li><strong>Notes</strong>: Keys are URL-safe base64 (44 chars). Never hardcode keys; rotate them periodically.</li>
</ul>

<h4 id="2-asymmetric-encryption-with-rsa">2. Asymmetric Encryption with RSA</h4>
<p>Generate a public/private key pair and encrypt data that only the private key holder can decrypt.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives.asymmetric</span> <span class="kn">import</span> <span class="n">rsa</span><span class="p">,</span> <span class="n">padding</span>

<span class="c1"># Generate private key
</span><span class="n">private_key</span> <span class="o">=</span> <span class="n">rsa</span><span class="p">.</span><span class="n">generate_private_key</span><span class="p">(</span><span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>

<span class="c1"># Serialize for storage
</span><span class="n">pem_private</span> <span class="o">=</span> <span class="n">private_key</span><span class="p">.</span><span class="n">private_bytes</span><span class="p">(</span>
    <span class="n">encoding</span><span class="o">=</span><span class="n">serialization</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">PEM</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="n">serialization</span><span class="p">.</span><span class="n">PrivateFormat</span><span class="p">.</span><span class="n">PKCS8</span><span class="p">,</span>
    <span class="n">encryption_algorithm</span><span class="o">=</span><span class="n">serialization</span><span class="p">.</span><span class="n">NoEncryption</span><span class="p">()</span>  <span class="c1"># Use BestAvailableEncryption() for password protection
</span><span class="p">)</span>

<span class="c1"># Get public key and serialize
</span><span class="n">public_key</span> <span class="o">=</span> <span class="n">private_key</span><span class="p">.</span><span class="n">public_key</span><span class="p">()</span>
<span class="n">pem_public</span> <span class="o">=</span> <span class="n">public_key</span><span class="p">.</span><span class="n">public_bytes</span><span class="p">(</span>
    <span class="n">encoding</span><span class="o">=</span><span class="n">serialization</span><span class="p">.</span><span class="n">Encoding</span><span class="p">.</span><span class="n">PEM</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="n">serialization</span><span class="p">.</span><span class="n">PublicFormat</span><span class="p">.</span><span class="n">SubjectPublicKeyInfo</span>
<span class="p">)</span>

<span class="c1"># Encrypt with public key
</span><span class="n">plaintext</span> <span class="o">=</span> <span class="sa">b</span><span class="s">"Secret message"</span>
<span class="n">ciphertext</span> <span class="o">=</span> <span class="n">public_key</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span>
    <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">.</span><span class="n">OAEP</span><span class="p">(</span><span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="p">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">()),</span> <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Decrypt with private key
</span><span class="n">decrypted</span> <span class="o">=</span> <span class="n">private_key</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span>
    <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">.</span><span class="n">OAEP</span><span class="p">(</span><span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="p">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">()),</span> <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Decrypted:"</span><span class="p">,</span> <span class="n">decrypted</span><span class="p">)</span>
</code></pre></div></div>
<ul>
  <li><strong>Notes</strong>: RSA is slow for large data; use it for key exchange or small messages. OAEP padding prevents attacks.</li>
</ul>

<h4 id="3-generating-and-using-hashes">3. Generating and Using Hashes</h4>
<p>For integrity checks or password hashing.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">cryptography.hazmat.primitives</span> <span class="kn">import</span> <span class="n">hashes</span>

<span class="c1"># Hash data
</span><span class="n">digest</span> <span class="o">=</span> <span class="n">hashes</span><span class="p">.</span><span class="n">Hash</span><span class="p">(</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">())</span>
<span class="n">digest</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="sa">b</span><span class="s">"Some data"</span><span class="p">)</span>
<span class="n">hash_result</span> <span class="o">=</span> <span class="n">digest</span><span class="p">.</span><span class="n">finalize</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"SHA256 Hash:"</span><span class="p">,</span> <span class="n">hash_result</span><span class="p">.</span><span class="nb">hex</span><span class="p">())</span>
</code></pre></div></div>

<p>For passwords, use <code class="language-plaintext highlighter-rouge">cryptography.hazmat.primitives.kdf.pbkdf2</code> for key derivation (e.g., PBKDF2 for slow, salted hashing).</p>

<h4 id="4-digital-signatures-with-rsa">4. Digital Signatures with RSA</h4>
<p>Sign data to prove authenticity.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Using the RSA keys from earlier
</span><span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s">"Data to sign"</span>
<span class="n">signature</span> <span class="o">=</span> <span class="n">private_key</span><span class="p">.</span><span class="n">sign</span><span class="p">(</span>
    <span class="n">message</span><span class="p">,</span>
    <span class="n">padding</span><span class="p">.</span><span class="n">PSS</span><span class="p">(</span><span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="p">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">()),</span> <span class="n">salt_length</span><span class="o">=</span><span class="n">padding</span><span class="p">.</span><span class="n">PSS</span><span class="p">.</span><span class="n">MAX_LENGTH</span><span class="p">),</span>
    <span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">()</span>
<span class="p">)</span>

<span class="c1"># Verify with public key
</span><span class="k">try</span><span class="p">:</span>
    <span class="n">public_key</span><span class="p">.</span><span class="n">verify</span><span class="p">(</span>
        <span class="n">signature</span><span class="p">,</span>
        <span class="n">message</span><span class="p">,</span>
        <span class="n">padding</span><span class="p">.</span><span class="n">PSS</span><span class="p">(</span><span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="p">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">()),</span> <span class="n">salt_length</span><span class="o">=</span><span class="n">padding</span><span class="p">.</span><span class="n">PSS</span><span class="p">.</span><span class="n">MAX_LENGTH</span><span class="p">),</span>
        <span class="n">hashes</span><span class="p">.</span><span class="n">SHA256</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Signature valid"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Signature invalid"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="best-practices">Best Practices</h3>
<ul>
  <li><strong>Key Management</strong>: Store keys securely (e.g., using AWS KMS, hardware security modules). Never reuse keys.</li>
  <li><strong>Padding and Modes</strong>: Always use secure padding (e.g., OAEP for RSA, GCM for AES).</li>
  <li><strong>Randomness</strong>: Use <code class="language-plaintext highlighter-rouge">os.urandom()</code> or <code class="language-plaintext highlighter-rouge">secrets</code> module for seeds; avoid <code class="language-plaintext highlighter-rouge">random</code>.</li>
  <li><strong>Updates</strong>: Cryptography evolves—check for vulnerabilities in your usage.</li>
  <li><strong>Avoid Rolling Your Own</strong>: For complex needs, use recipes or integrate with higher-level libs like <code class="language-plaintext highlighter-rouge">pyjwt</code> or <code class="language-plaintext highlighter-rouge">boto3</code>.</li>
  <li><strong>Testing</strong>: Use the library’s constants and exceptions for error handling.</li>
</ul>

<h3 id="further-reading">Further Reading</h3>
<ul>
  <li><a href="https://cryptography.io/en/latest/">Official Documentation</a> – Detailed API reference and tutorials.</li>
  <li><a href="https://pypi.org/project/cryptography/">PyPI Page</a> – Version history and integrations.</li>
  <li>For advanced topics, explore the <code class="language-plaintext highlighter-rouge">cryptography</code> wiki or RFCs (e.g., RFC 8017 for PKCS#1).</li>
</ul>

<p>If you have a specific use case (e.g., encrypting files or API security), provide more details for tailored examples.</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    
      <p class="model">x-ai/grok-code-fast-1</p>
    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
