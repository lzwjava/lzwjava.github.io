<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Cryptography In Java</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Cryptography In Java | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Cryptography In Java" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-03-05-cryptography-java-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-03-05-cryptography-java-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Cryptography In Java" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"Cryptography In Java","url":"https://lzwjava.github.io/notes/2025-03-05-cryptography-java-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=b5d88586598e3ae75868c91d809b1d78419d4012">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=b5d88586598e3ae75868c91d809b1d78419d4012" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Cryptography In Java | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-03-05-cryptography-java-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-03-05-cryptography-java-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/cryptography-java-en" selected>English</option>
        <option value="/cryptography-java-zh" >中文</option>
        <option value="/cryptography-java-ja" >日本語</option>
        <option value="/cryptography-java-es" >Español</option>
        <option value="/cryptography-java-hi" >हिंदी</option>
        <option value="/cryptography-java-fr" >Français</option>
        <option value="/cryptography-java-de" >Deutsch</option>
        <option value="/cryptography-java-ar" >العربية</option>
        <option value="/cryptography-java-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>The <code class="language-plaintext highlighter-rouge">javax.crypto</code> package in Java provides a set of classes and methods for performing cryptographic operations such as encryption, decryption, key generation, and message authentication. Below is a comprehensive guide on how to use <code class="language-plaintext highlighter-rouge">javax.crypto</code>, including explanations and practical examples for common use cases like symmetric encryption, asymmetric encryption, and message authentication.</p>

<hr />

<h3 id="what-is-javaxcrypto"><strong>What is javax.crypto?</strong></h3>
<p>The <code class="language-plaintext highlighter-rouge">javax.crypto</code> package is part of the Java Cryptography Architecture (JCA) and offers tools to implement secure communication through cryptography. It supports:</p>
<ul>
  <li><strong>Symmetric cryptography</strong>: Uses the same key for encryption and decryption (e.g., AES, DES).</li>
  <li><strong>Asymmetric cryptography</strong>: Uses a public/private key pair (e.g., RSA).</li>
  <li><strong>Message authentication</strong>: Ensures data integrity and authenticity (e.g., HMAC).</li>
  <li><strong>Key generation and management</strong>: Tools to create and handle cryptographic keys.</li>
</ul>

<p>To use <code class="language-plaintext highlighter-rouge">javax.crypto</code>, you need to:</p>
<ol>
  <li>Select a cryptographic algorithm.</li>
  <li>Generate or obtain the necessary keys.</li>
  <li>Use the provided classes (e.g., <code class="language-plaintext highlighter-rouge">Cipher</code>, <code class="language-plaintext highlighter-rouge">KeyGenerator</code>, <code class="language-plaintext highlighter-rouge">Mac</code>) to perform operations.</li>
</ol>

<p>Below are step-by-step examples for common scenarios.</p>

<hr />

<h3 id="1-symmetric-encryption-with-aes"><strong>1. Symmetric Encryption with AES</strong></h3>
<p>Symmetric encryption uses a single key for both encryption and decryption. Here’s how to encrypt and decrypt a string using AES (Advanced Encryption Standard) with the <code class="language-plaintext highlighter-rouge">Cipher</code> class in CBC mode with PKCS5 padding.</p>

<h4 id="steps"><strong>Steps</strong></h4>
<ul>
  <li>Generate a secret key.</li>
  <li>Create and initialize a <code class="language-plaintext highlighter-rouge">Cipher</code> instance.</li>
  <li>Encrypt and decrypt the data.</li>
</ul>

<h4 id="example-code"><strong>Example Code</strong></h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">javax.crypto.Cipher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.KeyGenerator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.SecretKey</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.IvParameterSpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.SecureRandom</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SymmetricEncryptionExample</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="c1">// Step 1: Generate a secret key for AES</span>
        <span class="nc">KeyGenerator</span> <span class="n">keyGen</span> <span class="o">=</span> <span class="nc">KeyGenerator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"AES"</span><span class="o">);</span>
        <span class="n">keyGen</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="mi">128</span><span class="o">);</span> <span class="c1">// 128-bit key</span>
        <span class="nc">SecretKey</span> <span class="n">secretKey</span> <span class="o">=</span> <span class="n">keyGen</span><span class="o">.</span><span class="na">generateKey</span><span class="o">();</span>

        <span class="c1">// Step 2: Generate a random Initialization Vector (IV)</span>
        <span class="nc">SecureRandom</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecureRandom</span><span class="o">();</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">iv</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">16</span><span class="o">];</span> <span class="c1">// AES block size is 16 bytes</span>
        <span class="n">random</span><span class="o">.</span><span class="na">nextBytes</span><span class="o">(</span><span class="n">iv</span><span class="o">);</span>
        <span class="nc">IvParameterSpec</span> <span class="n">ivSpec</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IvParameterSpec</span><span class="o">(</span><span class="n">iv</span><span class="o">);</span>

        <span class="c1">// Step 3: Create and initialize Cipher for encryption</span>
        <span class="nc">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"AES/CBC/PKCS5Padding"</span><span class="o">);</span>
        <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">ENCRYPT_MODE</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">,</span> <span class="n">ivSpec</span><span class="o">);</span>

        <span class="c1">// Step 4: Encrypt data</span>
        <span class="nc">String</span> <span class="n">plaintext</span> <span class="o">=</span> <span class="s">"Hello, World!"</span><span class="o">;</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">plaintextBytes</span> <span class="o">=</span> <span class="n">plaintext</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">plaintextBytes</span><span class="o">);</span>

        <span class="c1">// Step 5: Initialize Cipher for decryption with the same IV</span>
        <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">DECRYPT_MODE</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">,</span> <span class="n">ivSpec</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">decryptedBytes</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">ciphertext</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">decryptedText</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">decryptedBytes</span><span class="o">,</span> <span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">);</span>

        <span class="c1">// Output results</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Original: "</span> <span class="o">+</span> <span class="n">plaintext</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Decrypted: "</span> <span class="o">+</span> <span class="n">decryptedText</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="key-points"><strong>Key Points</strong></h4>
<ul>
  <li><strong>Algorithm</strong>: <code class="language-plaintext highlighter-rouge">"AES/CBC/PKCS5Padding"</code> specifies AES with CBC mode and padding to handle data that isn’t a multiple of the block size.</li>
  <li><strong>IV</strong>: The Initialization Vector must be random for encryption and reused for decryption. It’s typically prepended to the ciphertext or transmitted separately.</li>
  <li><strong>Key Management</strong>: In a real application, securely share the <code class="language-plaintext highlighter-rouge">secretKey</code> with the recipient.</li>
</ul>

<hr />

<h3 id="2-asymmetric-encryption-with-rsa"><strong>2. Asymmetric Encryption with RSA</strong></h3>
<p>Asymmetric encryption uses a public key to encrypt and a private key to decrypt. Here’s an example using RSA.</p>

<h4 id="steps-1"><strong>Steps</strong></h4>
<ul>
  <li>Generate a public/private key pair.</li>
  <li>Encrypt with the public key.</li>
  <li>Decrypt with the private key.</li>
</ul>

<h4 id="example-code-1"><strong>Example Code</strong></h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">javax.crypto.Cipher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.KeyPair</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.KeyPairGenerator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.PrivateKey</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.PublicKey</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AsymmetricEncryptionExample</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="c1">// Step 1: Generate an RSA key pair</span>
        <span class="nc">KeyPairGenerator</span> <span class="n">keyPairGen</span> <span class="o">=</span> <span class="nc">KeyPairGenerator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"RSA"</span><span class="o">);</span>
        <span class="n">keyPairGen</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="mi">2048</span><span class="o">);</span> <span class="c1">// 2048-bit key</span>
        <span class="nc">KeyPair</span> <span class="n">keyPair</span> <span class="o">=</span> <span class="n">keyPairGen</span><span class="o">.</span><span class="na">generateKeyPair</span><span class="o">();</span>
        <span class="nc">PublicKey</span> <span class="n">publicKey</span> <span class="o">=</span> <span class="n">keyPair</span><span class="o">.</span><span class="na">getPublic</span><span class="o">();</span>
        <span class="nc">PrivateKey</span> <span class="n">privateKey</span> <span class="o">=</span> <span class="n">keyPair</span><span class="o">.</span><span class="na">getPrivate</span><span class="o">();</span>

        <span class="c1">// Step 2: Encrypt with the public key</span>
        <span class="nc">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"RSA"</span><span class="o">);</span>
        <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">ENCRYPT_MODE</span><span class="o">,</span> <span class="n">publicKey</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">plaintext</span> <span class="o">=</span> <span class="s">"Secret Message"</span><span class="o">;</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">plaintextBytes</span> <span class="o">=</span> <span class="n">plaintext</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">plaintextBytes</span><span class="o">);</span>

        <span class="c1">// Step 3: Decrypt with the private key</span>
        <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">DECRYPT_MODE</span><span class="o">,</span> <span class="n">privateKey</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">decryptedBytes</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">ciphertext</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">decryptedText</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">decryptedBytes</span><span class="o">,</span> <span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">);</span>

        <span class="c1">// Output results</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Original: "</span> <span class="o">+</span> <span class="n">plaintext</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Decrypted: "</span> <span class="o">+</span> <span class="n">decryptedText</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="key-points-1"><strong>Key Points</strong></h4>
<ul>
  <li><strong>Size Limit</strong>: RSA can only encrypt data smaller than the key size (e.g., ~245 bytes for a 2048-bit key). For larger data, use hybrid encryption (encrypt data with a symmetric key, then encrypt that key with RSA).</li>
  <li><strong>Key Distribution</strong>: Share the public key openly; keep the private key secret.</li>
</ul>

<hr />

<h3 id="3-message-authentication-with-hmac"><strong>3. Message Authentication with HMAC</strong></h3>
<p>A Message Authentication Code (MAC) ensures data integrity and authenticity. Here’s how to use <code class="language-plaintext highlighter-rouge">Mac</code> with HMAC-SHA256.</p>

<h4 id="example-code-2"><strong>Example Code</strong></h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">javax.crypto.Mac</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Base64</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MacExample</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="c1">// Step 1: Create a secret key</span>
        <span class="nc">String</span> <span class="n">secret</span> <span class="o">=</span> <span class="s">"mysecretkey"</span><span class="o">;</span>
        <span class="nc">SecretKeySpec</span> <span class="n">secretKey</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">secret</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">),</span> <span class="s">"HmacSHA256"</span><span class="o">);</span>

        <span class="c1">// Step 2: Initialize Mac with the key</span>
        <span class="nc">Mac</span> <span class="n">mac</span> <span class="o">=</span> <span class="nc">Mac</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"HmacSHA256"</span><span class="o">);</span>
        <span class="n">mac</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">secretKey</span><span class="o">);</span>

        <span class="c1">// Step 3: Compute MAC for the data</span>
        <span class="nc">String</span> <span class="n">data</span> <span class="o">=</span> <span class="s">"Data to authenticate"</span><span class="o">;</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">macValue</span> <span class="o">=</span> <span class="n">mac</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
        <span class="nc">String</span> <span class="n">macBase64</span> <span class="o">=</span> <span class="nc">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">macValue</span><span class="o">);</span>

        <span class="c1">// Output result</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"MAC: "</span> <span class="o">+</span> <span class="n">macBase64</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="key-points-2"><strong>Key Points</strong></h4>
<ul>
  <li><strong>Verification</strong>: The recipient recomputes the MAC with the same key and data; if it matches, the data is authentic and unaltered.</li>
  <li><strong>Key</strong>: Use a shared secret key, securely distributed beforehand.</li>
</ul>

<hr />

<h3 id="4-encryptingdecrypting-streams"><strong>4. Encrypting/Decrypting Streams</strong></h3>
<p>For large data (e.g., files), use <code class="language-plaintext highlighter-rouge">CipherInputStream</code> or <code class="language-plaintext highlighter-rouge">CipherOutputStream</code>.</p>

<h4 id="example-code-encrypting-a-file"><strong>Example Code (Encrypting a File)</strong></h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">javax.crypto.Cipher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.CipherOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.KeyGenerator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.SecretKey</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.IvParameterSpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.SecureRandom</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">StreamEncryptionExample</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="c1">// Generate key and IV</span>
        <span class="nc">KeyGenerator</span> <span class="n">keyGen</span> <span class="o">=</span> <span class="nc">KeyGenerator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"AES"</span><span class="o">);</span>
        <span class="n">keyGen</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="mi">128</span><span class="o">);</span>
        <span class="nc">SecretKey</span> <span class="n">secretKey</span> <span class="o">=</span> <span class="n">keyGen</span><span class="o">.</span><span class="na">generateKey</span><span class="o">();</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">iv</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">16</span><span class="o">];</span>
        <span class="k">new</span> <span class="nf">SecureRandom</span><span class="o">().</span><span class="na">nextBytes</span><span class="o">(</span><span class="n">iv</span><span class="o">);</span>
        <span class="nc">IvParameterSpec</span> <span class="n">ivSpec</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IvParameterSpec</span><span class="o">(</span><span class="n">iv</span><span class="o">);</span>

        <span class="c1">// Initialize Cipher</span>
        <span class="nc">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"AES/CBC/PKCS5Padding"</span><span class="o">);</span>
        <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">ENCRYPT_MODE</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">,</span> <span class="n">ivSpec</span><span class="o">);</span>

        <span class="c1">// Encrypt file</span>
        <span class="k">try</span> <span class="o">(</span><span class="nc">FileInputStream</span> <span class="n">fis</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileInputStream</span><span class="o">(</span><span class="s">"input.txt"</span><span class="o">);</span>
             <span class="nc">FileOutputStream</span> <span class="n">fos</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"encrypted.txt"</span><span class="o">);</span>
             <span class="nc">CipherOutputStream</span> <span class="n">cos</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CipherOutputStream</span><span class="o">(</span><span class="n">fos</span><span class="o">,</span> <span class="n">cipher</span><span class="o">))</span> <span class="o">{</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">];</span>
            <span class="kt">int</span> <span class="n">bytesRead</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">bytesRead</span> <span class="o">=</span> <span class="n">fis</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">buffer</span><span class="o">))</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">cos</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">buffer</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">bytesRead</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="key-points-3"><strong>Key Points</strong></h4>
<ul>
  <li><strong>Streams</strong>: Use <code class="language-plaintext highlighter-rouge">CipherOutputStream</code> for encryption and <code class="language-plaintext highlighter-rouge">CipherInputStream</code> for decryption to process data incrementally.</li>
  <li><strong>IV Handling</strong>: Store the IV with the encrypted file (e.g., prepend it).</li>
</ul>

<hr />

<h3 id="5-password-based-encryption-pbe"><strong>5. Password-Based Encryption (PBE)</strong></h3>
<p>Derive a key from a password using <code class="language-plaintext highlighter-rouge">SecretKeyFactory</code>.</p>

<h4 id="example-code-3"><strong>Example Code</strong></h4>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">javax.crypto.Cipher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.SecretKey</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.SecretKeyFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.PBEKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.SecureRandom</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PBEExample</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="c1">// Password and salt</span>
        <span class="kt">char</span><span class="o">[]</span> <span class="n">password</span> <span class="o">=</span> <span class="s">"mysecretpassword"</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">();</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">salt</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">16</span><span class="o">];</span>
        <span class="k">new</span> <span class="nf">SecureRandom</span><span class="o">().</span><span class="na">nextBytes</span><span class="o">(</span><span class="n">salt</span><span class="o">);</span>

        <span class="c1">// Derive key from password</span>
        <span class="nc">PBEKeySpec</span> <span class="n">pbeKeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PBEKeySpec</span><span class="o">(</span><span class="n">password</span><span class="o">,</span> <span class="n">salt</span><span class="o">,</span> <span class="mi">10000</span><span class="o">,</span> <span class="mi">256</span><span class="o">);</span> <span class="c1">// 256-bit key</span>
        <span class="nc">SecretKeyFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="nc">SecretKeyFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"PBKDF2WithHmacSHA256"</span><span class="o">);</span>
        <span class="nc">SecretKey</span> <span class="n">tempKey</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">generateSecret</span><span class="o">(</span><span class="n">pbeKeySpec</span><span class="o">);</span>
        <span class="nc">SecretKey</span> <span class="n">secretKey</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">tempKey</span><span class="o">.</span><span class="na">getEncoded</span><span class="o">(),</span> <span class="s">"AES"</span><span class="o">);</span>

        <span class="c1">// Encrypt with derived key</span>
        <span class="nc">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"AES"</span><span class="o">);</span>
        <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">ENCRYPT_MODE</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">plaintext</span> <span class="o">=</span> <span class="s">"Hello from PBE"</span><span class="o">;</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">plaintext</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Encrypted: "</span> <span class="o">+</span> <span class="nc">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">ciphertext</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="key-points-4"><strong>Key Points</strong></h4>
<ul>
  <li><strong>Salt</strong>: Randomize the key derivation; store it with the encrypted data.</li>
  <li><strong>Iterations</strong>: Increase computational cost to thwart brute-force attacks (e.g., 10,000).</li>
</ul>

<hr />

<h3 id="key-classes-in-javaxcrypto"><strong>Key Classes in javax.crypto</strong></h3>
<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">Cipher</code></strong>: Performs encryption and decryption.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">KeyGenerator</code></strong>: Generates symmetric keys (e.g., AES).</li>
  <li><strong><code class="language-plaintext highlighter-rouge">KeyPairGenerator</code></strong>: Generates asymmetric key pairs (e.g., RSA).</li>
  <li><strong><code class="language-plaintext highlighter-rouge">Mac</code></strong>: Computes message authentication codes.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">SecretKeyFactory</code></strong>: Derives keys (e.g., from passwords).</li>
  <li><strong><code class="language-plaintext highlighter-rouge">SecureRandom</code></strong>: Generates cryptographically secure random numbers.</li>
</ul>

<hr />

<h3 id="best-practices"><strong>Best Practices</strong></h3>
<ul>
  <li><strong>Exception Handling</strong>: Wrap code in try-catch blocks for exceptions like <code class="language-plaintext highlighter-rouge">NoSuchAlgorithmException</code>, <code class="language-plaintext highlighter-rouge">InvalidKeyException</code>, etc.</li>
  <li><strong>Key Management</strong>: Store keys securely (e.g., in a <code class="language-plaintext highlighter-rouge">KeyStore</code>) and never hardcode them.</li>
  <li><strong>Algorithm Choice</strong>: Use secure algorithms (e.g., AES-256, RSA-2048) and modes (e.g., CBC with IV).</li>
  <li><strong>Providers</strong>: The default SunJCE provider suffices, but you can use others (e.g., BouncyCastle) via <code class="language-plaintext highlighter-rouge">Cipher.getInstance("AES", "BC")</code>.</li>
</ul>

<hr />

<h3 id="conclusion"><strong>Conclusion</strong></h3>
<p>To use <code class="language-plaintext highlighter-rouge">javax.crypto</code>, select the appropriate cryptographic algorithm for your needs, generate or obtain keys, and leverage classes like <code class="language-plaintext highlighter-rouge">Cipher</code>, <code class="language-plaintext highlighter-rouge">KeyGenerator</code>, and <code class="language-plaintext highlighter-rouge">Mac</code> to perform operations. Whether encrypting data symmetrically with AES, asymmetrically with RSA, or ensuring integrity with HMAC, <code class="language-plaintext highlighter-rouge">javax.crypto</code> provides the tools—paired with proper initialization and secure key management—to implement robust cryptography in Java.</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
