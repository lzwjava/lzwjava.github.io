<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Kibana Setup for PCF Logs</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Kibana Setup for PCF Logs | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Kibana Setup for PCF Logs" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-10-04-kibana-pcf-logs-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-10-04-kibana-pcf-logs-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Kibana Setup for PCF Logs" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"Kibana Setup for PCF Logs","url":"https://lzwjava.github.io/notes/2025-10-04-kibana-pcf-logs-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=f33d12f4787137731a3802bcfcfaf1c496080e06">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=f33d12f4787137731a3802bcfcfaf1c496080e06" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Kibana Setup for PCF Logs | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-10-04-kibana-pcf-logs-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-10-04-kibana-pcf-logs-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/kibana-pcf-logs-en" selected>English</option>
        <option value="/kibana-pcf-logs-zh" >中文</option>
        <option value="/kibana-pcf-logs-ja" >日本語</option>
        <option value="/kibana-pcf-logs-es" >Español</option>
        <option value="/kibana-pcf-logs-hi" >हिंदी</option>
        <option value="/kibana-pcf-logs-fr" >Français</option>
        <option value="/kibana-pcf-logs-de" >Deutsch</option>
        <option value="/kibana-pcf-logs-ar" >العربية</option>
        <option value="/kibana-pcf-logs-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>It looks like “kabana” is likely a reference to <strong>Kibana</strong>, the open-source data visualization dashboard for Elasticsearch. In the context of <strong>Pivotal Cloud Foundry (PCF)</strong> (now rebranded as VMware Tanzu Application Service), Kibana is commonly used for searching, visualizing, and analyzing logs through the platform’s logging system (Loggregator). PCF doesn’t natively run Kibana standalone but integrates it via the <strong>Log Search</strong> tile/service, which stores logs in Elasticsearch and exposes Kibana for querying.</p>

<p>If this isn’t what you meant, feel free to clarify! Below, I’ll explain how to set up and use Kibana with PCF logs. This assumes you’re an admin with access to PCF Ops Manager and have a running PCF deployment (version 2.0+). Note that PCF logging has evolved; check your version’s documentation for specifics.</p>

<h3 id="prerequisites">Prerequisites</h3>
<ul>
  <li><strong>PCF Version</strong>: Log Search (with Kibana) is available in PCF 2.2+. Earlier versions used a separate “ELK” (Elasticsearch, Logstash, Kibana) tile.</li>
  <li><strong>Tiles/Services</strong>: Ensure you have the <strong>Elastic Runtime</strong> tile (for Loggregator) and the <strong>Log Search</strong> tile installed via Pivotal Network (now Broadcom Support Portal).</li>
  <li><strong>Access</strong>: Admin privileges in Ops Manager and the PCF CLI (cf command-line tool).</li>
  <li><strong>Resources</strong>: Allocate sufficient resources (e.g., 4-8 GB RAM for Log Search, depending on log volume).</li>
</ul>

<h3 id="step-1-install-and-configure-log-search-tile-in-ops-manager">Step 1: Install and Configure Log Search Tile in Ops Manager</h3>
<p>The Log Search tile forwards PCF logs (from apps, platforms, and system components) to Elasticsearch, making them searchable via Kibana.</p>

<ol>
  <li><strong>Download and Import the Tile</strong>:
    <ul>
      <li>Log in to the Broadcom Support Portal (formerly Pivotal Network).</li>
      <li>Download the <strong>Log Search for PCF</strong> tile (e.g., version matching your PCF release).</li>
      <li>In Ops Manager (web UI), go to <strong>Catalog</strong> &gt; <strong>Import a Product</strong> and upload the tile.</li>
    </ul>
  </li>
  <li><strong>Configure the Tile</strong>:
    <ul>
      <li>In Ops Manager, go to the <strong>Elastic Runtime</strong> tile &gt; <strong>Loggregator</strong> tab:
        <ul>
          <li>Enable <strong>Loggregator forwarding to external systems</strong> (e.g., set up syslog or HTTP forwarding if needed, but for Log Search, it’s internal).</li>
          <li>Set <strong>Loggregator log retention</strong> to a value like 5-30 days.</li>
        </ul>
      </li>
      <li>Go to the <strong>Log Search</strong> tile:
        <ul>
          <li><strong>Assign Availability Zones</strong>: Select at least one AZ for high availability.</li>
          <li><strong>Elasticsearch Configuration</strong>:
            <ul>
              <li>Set instance count (start with 3 for production).</li>
              <li>Configure storage (e.g., 100 GB persistent disks).</li>
              <li>Enable security (e.g., TLS for Elasticsearch).</li>
            </ul>
          </li>
          <li><strong>Kibana Configuration</strong>:
            <ul>
              <li>Enable Kibana (it’s bundled).</li>
              <li>Set admin credentials (username/password).</li>
            </ul>
          </li>
          <li><strong>Loggregator Integration</strong>:
            <ul>
              <li>Set the maximum log lines per second (e.g., 1000-5000 based on your load).</li>
              <li>Define index patterns (e.g., retain logs for 7-30 days).</li>
            </ul>
          </li>
          <li><strong>Networking</strong>: Expose Kibana via a route (e.g., <code class="language-plaintext highlighter-rouge">kibana.YOUR-PCF-DOMAIN.com</code>).</li>
        </ul>
      </li>
      <li>Click <strong>Apply Changes</strong> to deploy. This may take 30-60 minutes.</li>
    </ul>
  </li>
  <li><strong>Verify Deployment</strong>:
    <ul>
      <li>Run <code class="language-plaintext highlighter-rouge">cf tiles</code> or check Ops Manager for success.</li>
      <li>SSH into a Log Search VM (using BOSH CLI: <code class="language-plaintext highlighter-rouge">bosh ssh log-search/0</code>) and confirm Elasticsearch is running (<code class="language-plaintext highlighter-rouge">curl localhost:9200</code>).</li>
    </ul>
  </li>
</ol>

<h3 id="step-2-access-kibana">Step 2: Access Kibana</h3>
<p>Once deployed:</p>

<ol>
  <li><strong>Via PCF Apps Manager (GUI)</strong>:
    <ul>
      <li>Log in to Apps Manager (e.g., <code class="language-plaintext highlighter-rouge">https://apps.YOUR-PCF-DOMAIN.com</code>).</li>
      <li>Search for “Log Search” service instance (it auto-creates one).</li>
      <li>Click the service instance &gt; <strong>Logs</strong> tab. This opens an embedded Kibana view for quick log searches.</li>
    </ul>
  </li>
  <li><strong>Direct Access to Kibana</strong>:
    <ul>
      <li>Navigate to the Kibana URL configured in the tile (e.g., <code class="language-plaintext highlighter-rouge">https://kibana.YOUR-PCF-DOMAIN.com</code>).</li>
      <li>Log in with the admin credentials you set.</li>
      <li>If using a custom domain, ensure DNS is pointed correctly and routes are registered (<code class="language-plaintext highlighter-rouge">cf routes</code> to verify).</li>
    </ul>
  </li>
  <li><strong>CLI Access (Optional)</strong>:
    <ul>
      <li>Use <code class="language-plaintext highlighter-rouge">cf logs APP-NAME</code> for basic logs, but for advanced querying, use the Kibana UI or API.</li>
      <li>Bind Log Search to your apps: <code class="language-plaintext highlighter-rouge">cf create-service log-search standard my-log-search</code> then <code class="language-plaintext highlighter-rouge">cf bind-service APP-NAME my-log-search</code>.</li>
    </ul>
  </li>
</ol>

<h3 id="step-3-using-kibana-for-pcf-logs">Step 3: Using Kibana for PCF Logs</h3>
<p>Kibana provides a web-based interface to query, filter, and visualize logs from PCF components (e.g., app logs, Diego cells, Gorouter, etc.).</p>

<ol>
  <li><strong>Basic Navigation</strong>:
    <ul>
      <li><strong>Discover Tab</strong>: Search logs using Lucene query syntax.
        <ul>
          <li>Example: Search for errors in a specific app: <code class="language-plaintext highlighter-rouge">source_id:APP:your-app-name AND json.message:ERROR</code>.</li>
          <li>Fields available: <code class="language-plaintext highlighter-rouge">timestamp</code>, <code class="language-plaintext highlighter-rouge">source_id</code> (e.g., <code class="language-plaintext highlighter-rouge">APP:your-app</code>, <code class="language-plaintext highlighter-rouge">RTR:router</code>), <code class="language-plaintext highlighter-rouge">message</code>, <code class="language-plaintext highlighter-rouge">deployment</code>, etc.</li>
        </ul>
      </li>
      <li><strong>Visualize Tab</strong>: Create dashboards for charts (e.g., log volume over time, error rates).
        <ul>
          <li>Sample visualization: Bar chart of logs by source_id.</li>
        </ul>
      </li>
      <li><strong>Dashboard Tab</strong>: Save and share pre-built dashboards (Log Search includes defaults for PCF logs).</li>
    </ul>
  </li>
  <li><strong>Common Queries and Tips</strong>:
    <ul>
      <li><strong>Filter by App</strong>: <code class="language-plaintext highlighter-rouge">source_id:APP:your-app-name</code> (replace with actual app GUID or name).</li>
      <li><strong>Filter by Time</strong>: Use the time picker (e.g., last 24 hours).</li>
      <li><strong>System Logs</strong>: <code class="language-plaintext highlighter-rouge">source_id:DEA</code> (for Diego cells) or <code class="language-plaintext highlighter-rouge">source_id:LOGGREGATOR</code>.</li>
      <li><strong>Export Logs</strong>: Download as CSV/JSON from Discover.</li>
      <li><strong>Advanced</strong>: Use Kibana’s Dev Tools (console) to query Elasticsearch directly, e.g.:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /logstash-*/_search
{
  "query": { "match": { "message": "error" } },
  "sort": [ { "timestamp": { "order": "desc" } } ]
}
</code></pre></div>        </div>
      </li>
      <li><strong>Retention and Indexing</strong>: Logs are indexed by day (e.g., <code class="language-plaintext highlighter-rouge">logstash-YYYY.MM.DD</code>). Configure rollover in the tile to manage storage.</li>
    </ul>
  </li>
  <li><strong>Troubleshooting Logs</strong>:
    <ul>
      <li><strong>No Logs Appearing?</strong> Check forwarding rules in Loggregator (Ops Manager &gt; Elastic Runtime &gt; Loggregator). Ensure apps are emitting logs (e.g., via <code class="language-plaintext highlighter-rouge">console.log</code> in Node.js).</li>
      <li><strong>Performance Issues?</strong> Scale up Elasticsearch instances or tune log rate limits.</li>
      <li><strong>Security</strong>: Enable UAA integration in Log Search for SSO login to Kibana.</li>
      <li><strong>Errors</strong>: Check PCF logs with <code class="language-plaintext highlighter-rouge">cf logs log-search</code> or Ops Manager errand logs.</li>
    </ul>
  </li>
</ol>

<h3 id="additional-resources">Additional Resources</h3>
<ul>
  <li><strong>Official Docs</strong>: VMware Tanzu docs on <a href="https://docs.vmware.com/en/VMware-Tanzu-Application-Service/10.0/tas/GUID-log-search-index.html">Log Search</a> (search for your version).</li>
  <li><strong>CLI Tools</strong>: Install <code class="language-plaintext highlighter-rouge">uaac</code> for UAA auth if needed, or use <code class="language-plaintext highlighter-rouge">cf curl</code> for API access.</li>
  <li><strong>Alternatives</strong>: For simpler needs, use PCF’s built-in <strong>Log Cache</strong> (cf CLI: <code class="language-plaintext highlighter-rouge">cf tail APP-NAME</code>) or integrate with external tools like Splunk via syslog forwarding.</li>
  <li><strong>Upgrades</strong>: If you’re on legacy PCF, migrate to the ELK tile or contact Broadcom support.</li>
</ul>

<p>If you provide more details (e.g., your PCF version, error messages, or specific use case), I can refine this further!</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    
      <p class="model">x-ai/grok-4-fast</p>
    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
