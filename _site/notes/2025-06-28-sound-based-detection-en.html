<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Sound-Based Detection for Maytag Washing Machine</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Sound-Based Detection for Maytag Washing Machine | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Sound-Based Detection for Maytag Washing Machine" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-06-28-sound-based-detection-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-06-28-sound-based-detection-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Sound-Based Detection for Maytag Washing Machine" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"Sound-Based Detection for Maytag Washing Machine","url":"https://lzwjava.github.io/notes/2025-06-28-sound-based-detection-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=4048dc5cb2fb57297e2cd6d9097c812f4ddbe413">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=4048dc5cb2fb57297e2cd6d9097c812f4ddbe413" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Sound-Based Detection for Maytag Washing Machine | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-06-28-sound-based-detection-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-06-28-sound-based-detection-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.09</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/sound-based-detection-en" selected>English</option>
        <option value="/sound-based-detection-zh" >中文</option>
        <option value="/sound-based-detection-ja" >日本語</option>
        <option value="/sound-based-detection-es" >Español</option>
        <option value="/sound-based-detection-hi" >हिंदी</option>
        <option value="/sound-based-detection-fr" >Français</option>
        <option value="/sound-based-detection-de" >Deutsch</option>
        <option value="/sound-based-detection-ar" >العربية</option>
        <option value="/sound-based-detection-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>Using sound to detect when your Maytag MHW8630HW washing machine stops is a viable alternative to the camera-based approach. By placing a sound sensor close to the washing machine, you can monitor the noise generated during operation (e.g., motor hum, water flow, or drum rotation) and detect when it stops, indicating the end of the wash cycle. Below, I’ll explain how to adapt the previous project to use a sound sensor instead of a camera, focusing on the hardware, algorithm, and code changes while keeping the Telegram notification system.</p>

<hr />

<h3 id="tech-stack">Tech Stack</h3>
<h4 id="hardware">Hardware</h4>
<ol>
  <li><strong>Arduino Board</strong>:
    <ul>
      <li><strong>ESP32-CAM</strong> (still usable) – Retains Wi-Fi for Telegram integration, though the camera is not needed.</li>
      <li>Alternative: <strong>ESP8266 NodeMCU</strong> or <strong>Arduino Uno</strong> with an ESP8266 module for Wi-Fi (simpler if you don’t need the camera).</li>
    </ul>
  </li>
  <li><strong>Sound Sensor</strong>:
    <ul>
      <li><strong>KY-038 Microphone Sound Sensor</strong> or similar – Affordable, detects sound levels via an analog output.</li>
      <li>Alternative: <strong>MAX9814 Electret Microphone Amplifier</strong> – More sensitive, with adjustable gain for better detection.</li>
    </ul>
  </li>
  <li><strong>Power Supply</strong>:
    <ul>
      <li>5V USB power adapter or battery pack for the ESP32 or other board.</li>
    </ul>
  </li>
  <li><strong>Mounting</strong>:
    <ul>
      <li>Place the sound sensor close to the washing machine (e.g., taped to the side or top) where it can detect operational sounds but avoid direct water exposure.</li>
      <li>Use a small enclosure to protect the sensor and board.</li>
    </ul>
  </li>
  <li><strong>Wi-Fi Router</strong>:
    <ul>
      <li>For internet connectivity to send Telegram notifications.</li>
    </ul>
  </li>
</ol>

<h4 id="software">Software</h4>
<ul>
  <li><strong>Arduino IDE</strong>: For programming the ESP32 or other board.</li>
  <li><strong>Libraries</strong>:
    <ul>
      <li><strong>Universal Arduino Telegram Bot Library</strong> by Brian Lough – For Telegram integration.</li>
      <li><strong>ArduinoJson</strong> – For handling JSON data in Telegram API communication.</li>
    </ul>
  </li>
  <li><strong>Telegram Bot</strong>: Same as before, using BotFather to get a bot token and chat ID.</li>
  <li><strong>Programming Language</strong>: C++ (Arduino sketch).</li>
</ul>

<hr />

<h3 id="algorithm-for-detecting-washing-machine-status-with-sound">Algorithm for Detecting Washing Machine Status with Sound</h3>
<p>The sound sensor will detect the noise level produced by the washing machine. When the machine is running, it generates consistent sounds (e.g., motor, water, or drum). When it stops, the sound level drops significantly. The algorithm processes these sound levels to determine the machine’s status.</p>

<h4 id="detection-algorithm">Detection Algorithm</h4>
<ol>
  <li><strong>Sound Sampling</strong>:
    <ul>
      <li>Continuously read the analog output from the sound sensor to measure noise levels.</li>
    </ul>
  </li>
  <li><strong>Signal Processing</strong>:
    <ul>
      <li><strong>Averaging</strong>: Calculate the average sound level over a short window (e.g., 1-2 seconds) to smooth out transient noises (e.g., a door slam).</li>
      <li><strong>Thresholding</strong>: Compare the average sound level to a predefined threshold. A high level indicates the machine is running, while a low level suggests it’s stopped.</li>
    </ul>
  </li>
  <li><strong>State Machine</strong>:
    <ul>
      <li>Track the machine’s state (ON or OFF) based on sound levels.</li>
      <li>If the sound level exceeds the threshold for several cycles, assume the machine is running.</li>
      <li>If the sound level drops below the threshold and remains low for a set period (e.g., 5 minutes), assume the wash cycle is complete.</li>
    </ul>
  </li>
  <li><strong>Debouncing</strong>:
    <ul>
      <li>Implement a delay (e.g., 5 minutes) to confirm the machine has stopped, avoiding false notifications during quiet phases (e.g., soaking or pauses in the cycle).</li>
    </ul>
  </li>
  <li><strong>Notification</strong>:
    <ul>
      <li>When the machine is confirmed stopped, send a Telegram message (e.g., “Washing machine stopped! Time to hang up clothes.”).</li>
    </ul>
  </li>
</ol>

<h4 id="why-sound-detection">Why Sound Detection?</h4>
<ul>
  <li>Sound detection is simpler than image processing, as it doesn’t require complex algorithms or high computational resources.</li>
  <li>It’s less sensitive to ambient light changes compared to camera-based detection.</li>
  <li>However, it may be affected by background noise (e.g., a loud TV), so placement and threshold tuning are critical.</li>
</ul>

<hr />

<h3 id="implementation-guide">Implementation Guide</h3>
<h4 id="step-1-set-up-the-telegram-bot">Step 1: Set Up the Telegram Bot</h4>
<ul>
  <li>Follow the same steps as in the original guide:
    <ul>
      <li>Create a bot using <strong>@BotFather</strong> to get a <strong>Bot Token</strong>.</li>
      <li>Get your <strong>Chat ID</strong> using <strong>@GetIDsBot</strong> or by checking incoming messages.</li>
      <li>Ensure Telegram is set up on your phone to receive notifications.</li>
    </ul>
  </li>
</ul>

<h4 id="step-2-hardware-setup">Step 2: Hardware Setup</h4>
<ol>
  <li><strong>Choose a Sound Sensor</strong>:
    <ul>
      <li><strong>KY-038</strong>: Provides an analog output (0-1023 for ESP32’s 10-bit ADC) proportional to sound intensity. It also has a digital output, but analog is better for nuanced detection.</li>
      <li><strong>MAX9814</strong>: More sensitive, with adjustable gain via a potentiometer. Connect to an analog pin.</li>
    </ul>
  </li>
  <li><strong>Connect the Sound Sensor</strong>:
    <ul>
      <li>For KY-038:
        <ul>
          <li><strong>VCC</strong> to 5V (or 3.3V, depending on the board).</li>
          <li><strong>GND</strong> to GND.</li>
          <li><strong>Analog Out (A0)</strong> to an analog pin on the ESP32 (e.g., GPIO 4).</li>
        </ul>
      </li>
      <li>For MAX9814:
        <ul>
          <li>Similar connections, but adjust gain using the onboard potentiometer for optimal sensitivity.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Position the Sensor</strong>:
    <ul>
      <li>Place the sensor close to the washing machine (e.g., on the side or top) where it can detect motor or drum noise. Avoid areas with water exposure.</li>
      <li>Test placement by monitoring sound levels during a wash cycle (use Serial Monitor to log values).</li>
    </ul>
  </li>
  <li><strong>Power the Board</strong>:
    <ul>
      <li>Connect a 5V USB power adapter or battery pack to the ESP32 or other board.</li>
      <li>Ensure stable power, as Wi-Fi communication requires consistent voltage.</li>
    </ul>
  </li>
  <li><strong>Mounting</strong>:
    <ul>
      <li>Use a small enclosure or tape to secure the sensor and board, ensuring the microphone is exposed to capture sound.</li>
    </ul>
  </li>
</ol>

<h4 id="step-3-software-setup">Step 3: Software Setup</h4>
<ul>
  <li><strong>Arduino IDE</strong>: Install as described in the original guide.</li>
  <li><strong>ESP32 Board Support</strong>: Add the ESP32 board package via the Boards Manager (same URL as before).</li>
  <li><strong>Libraries</strong>:
    <ul>
      <li>Install <strong>Universal Arduino Telegram Bot Library</strong> and <strong>ArduinoJson</strong> as described.</li>
    </ul>
  </li>
  <li><strong>Wi-Fi</strong>: Ensure the board can connect to your 2.4GHz Wi-Fi network.</li>
</ul>

<h4 id="step-4-write-the-arduino-code">Step 4: Write the Arduino Code</h4>
<p>Below is a sample Arduino sketch for the ESP32 (or ESP8266) to detect sound levels and send Telegram notifications. This assumes a KY-038 sound sensor connected to GPIO 4.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;WiFi.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;UniversalTelegramBot.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ArduinoJson.h&gt;</span><span class="cp">
</span>
<span class="c1">// Wi-Fi credentials</span>
<span class="cp">#define WIFI_SSID "your_wifi_ssid"
#define WIFI_PASSWORD "your_wifi_password"
</span>
<span class="c1">// Telegram Bot credentials</span>
<span class="cp">#define BOT_TOKEN "your_bot_token"
#define CHAT_ID "your_chat_id"
</span>
<span class="c1">// Sound sensor pin</span>
<span class="cp">#define SOUND_PIN 4 // GPIO 4 for analog input
</span>
<span class="c1">// Sound detection parameters</span>
<span class="cp">#define SOUND_THRESHOLD 300 // Adjust based on testing (0-1023)
#define SAMPLE_WINDOW 2000 // 2 seconds for averaging
#define STOP_DELAY 300000 // 5 minutes in milliseconds
</span>
<span class="n">WiFiClientSecure</span> <span class="n">client</span><span class="p">;</span>
<span class="n">UniversalTelegramBot</span> <span class="nf">bot</span><span class="p">(</span><span class="n">BOT_TOKEN</span><span class="p">,</span> <span class="n">client</span><span class="p">);</span>

<span class="kt">bool</span> <span class="n">machineRunning</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">lastOnTime</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>

  <span class="c1">// Connect to Wi-Fi</span>
  <span class="n">WiFi</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">WIFI_SSID</span><span class="p">,</span> <span class="n">WIFI_PASSWORD</span><span class="p">);</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span> <span class="o">!=</span> <span class="n">WL_CONNECTED</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"."</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"WiFi connected"</span><span class="p">);</span>

  <span class="c1">// Configure Telegram client</span>
  <span class="n">client</span><span class="p">.</span><span class="n">setInsecure</span><span class="p">();</span> <span class="c1">// For simplicity; consider proper SSL in production</span>

  <span class="c1">// Set up sound sensor pin</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">SOUND_PIN</span><span class="p">,</span> <span class="n">INPUT</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Sample sound level over a window</span>
  <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">startMillis</span> <span class="o">=</span> <span class="n">millis</span><span class="p">();</span>
  <span class="kt">uint32_t</span> <span class="n">totalSound</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">uint16_t</span> <span class="n">sampleCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="k">while</span> <span class="p">(</span><span class="n">millis</span><span class="p">()</span> <span class="o">-</span> <span class="n">startMillis</span> <span class="o">&lt;</span> <span class="n">SAMPLE_WINDOW</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">totalSound</span> <span class="o">+=</span> <span class="n">analogRead</span><span class="p">(</span><span class="n">SOUND_PIN</span><span class="p">);</span>
    <span class="n">sampleCount</span><span class="o">++</span><span class="p">;</span>
    <span class="n">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="c1">// Small delay between samples</span>
  <span class="p">}</span>

  <span class="kt">float</span> <span class="n">avgSound</span> <span class="o">=</span> <span class="n">sampleCount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">totalSound</span> <span class="o">/</span> <span class="n">sampleCount</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Average sound level: "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">avgSound</span><span class="p">);</span>

  <span class="c1">// State machine</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">avgSound</span> <span class="o">&gt;</span> <span class="n">SOUND_THRESHOLD</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">machineRunning</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">machineRunning</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Machine is ON"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">lastOnTime</span> <span class="o">=</span> <span class="n">millis</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">machineRunning</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">millis</span><span class="p">()</span> <span class="o">-</span> <span class="n">lastOnTime</span> <span class="o">&gt;</span> <span class="n">STOP_DELAY</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">machineRunning</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"Machine stopped"</span><span class="p">);</span>
      <span class="n">bot</span><span class="p">.</span><span class="n">sendMessage</span><span class="p">(</span><span class="n">CHAT_ID</span><span class="p">,</span> <span class="s">"Washing machine stopped! Time to hang up clothes."</span><span class="p">,</span> <span class="s">""</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">delay</span><span class="p">(</span><span class="mi">10000</span><span class="p">);</span> <span class="c1">// Check every 10 seconds</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="step-5-customize-the-code">Step 5: Customize the Code</h4>
<ol>
  <li><strong>Update Credentials</strong>:
    <ul>
      <li>Replace <code class="language-plaintext highlighter-rouge">your_wifi_ssid</code>, <code class="language-plaintext highlighter-rouge">your_wifi_password</code>, <code class="language-plaintext highlighter-rouge">your_bot_token</code>, and <code class="language-plaintext highlighter-rouge">your_chat_id</code> with your actual values.</li>
    </ul>
  </li>
  <li><strong>Tune <code class="language-plaintext highlighter-rouge">SOUND_THRESHOLD</code></strong>:
    <ul>
      <li>Run the washing machine and monitor sound levels via the Serial Monitor (<code class="language-plaintext highlighter-rouge">Serial.println(analogRead(SOUND_PIN));</code>).</li>
      <li>Set <code class="language-plaintext highlighter-rouge">SOUND_THRESHOLD</code> to a value above ambient noise but below the machine’s operational noise (e.g., 200-500, depending on your setup).</li>
    </ul>
  </li>
  <li><strong>Adjust <code class="language-plaintext highlighter-rouge">SAMPLE_WINDOW</code></strong>:
    <ul>
      <li>A 2-second window (<code class="language-plaintext highlighter-rouge">2000</code> ms) smooths out transient noises. Increase if background noise causes false readings.</li>
    </ul>
  </li>
  <li><strong>Adjust <code class="language-plaintext highlighter-rouge">STOP_DELAY</code></strong>:
    <ul>
      <li>Set to <code class="language-plaintext highlighter-rouge">300000</code> (5 minutes) to avoid false notifications during quiet phases like soaking.</li>
    </ul>
  </li>
</ol>

<h4 id="step-6-test-and-deploy">Step 6: Test and Deploy</h4>
<ol>
  <li><strong>Upload the Code</strong>:
    <ul>
      <li>Connect the ESP32 to your computer via a USB-to-serial adapter.</li>
      <li>Select <strong>ESP32 Wrover Module</strong> (or <strong>NodeMCU</strong> for ESP8266) in Arduino IDE and upload the sketch.</li>
    </ul>
  </li>
  <li><strong>Test the System</strong>:
    <ul>
      <li>Start the washing machine and monitor the Serial Monitor for sound levels and state changes.</li>
      <li>Verify Telegram notifications when the machine stops.</li>
    </ul>
  </li>
  <li><strong>Fine-Tune</strong>:
    <ul>
      <li>Adjust <code class="language-plaintext highlighter-rouge">SOUND_THRESHOLD</code> or <code class="language-plaintext highlighter-rouge">STOP_DELAY</code> if false positives/negatives occur.</li>
      <li>Test in different conditions (e.g., with background noise) to ensure reliability.</li>
    </ul>
  </li>
  <li><strong>Permanent Installation</strong>:
    <ul>
      <li>Secure the sensor and board in an enclosure near the machine, ensuring the microphone is exposed but protected from water.</li>
    </ul>
  </li>
</ol>

<hr />

<h3 id="advantages-of-sound-detection">Advantages of Sound Detection</h3>
<ul>
  <li><strong>Simpler Processing</strong>: No image processing, reducing computational load on the ESP32.</li>
  <li><strong>Cost-Effective</strong>: Sound sensors like KY-038 are inexpensive (often under $5).</li>
  <li><strong>Non-Invasive</strong>: No need to attach anything directly to the machine’s panel light.</li>
</ul>

<h3 id="challenges-and-mitigations">Challenges and Mitigations</h3>
<ul>
  <li><strong>Background Noise</strong>: Household noises (e.g., TV, talking) may interfere. Mitigate by:
    <ul>
      <li>Placing the sensor close to the machine’s motor or drum.</li>
      <li>Tuning <code class="language-plaintext highlighter-rouge">SOUND_THRESHOLD</code> to ignore ambient noise.</li>
      <li>Using a directional microphone or adjusting gain on MAX9814.</li>
    </ul>
  </li>
  <li><strong>Quiet Phases</strong>: Some wash cycles have pauses (e.g., soaking). The <code class="language-plaintext highlighter-rouge">STOP_DELAY</code> ensures notifications are sent only after prolonged silence.</li>
  <li><strong>Water Exposure</strong>: Ensure the sensor is in a water-resistant enclosure, as washing machines may have splashes or humidity.</li>
</ul>

<h3 id="optional-enhancements">Optional Enhancements</h3>
<ul>
  <li><strong>Frequency Analysis</strong>: If background noise is a persistent issue, analyze sound frequencies (e.g., motor hum at 50-200 Hz) using a Fast Fourier Transform (FFT) library like <code class="language-plaintext highlighter-rouge">arduinoFFT</code>. This requires more processing power and may not be feasible on a basic ESP32 without optimization.</li>
  <li><strong>Dual Sensors</strong>: Combine sound and vibration sensors (e.g., SW-420) for redundancy. If both indicate the machine is off, confidence in the detection increases.</li>
  <li><strong>Battery Power</strong>: For portability, use a rechargeable LiPo battery with a charging module (e.g., TP4056) instead of a USB adapter.</li>
</ul>

<hr />

<h3 id="troubleshooting">Troubleshooting</h3>
<ul>
  <li><strong>No Sound Detection</strong>: Check sensor wiring, test with Serial Monitor, and ensure the sensor is close to the machine’s noise source.</li>
  <li><strong>False Notifications</strong>: Increase <code class="language-plaintext highlighter-rouge">STOP_DELAY</code> or adjust <code class="language-plaintext highlighter-rouge">SOUND_THRESHOLD</code> to filter out background noise or cycle pauses.</li>
  <li><strong>Wi-Fi Issues</strong>: Verify 2.4GHz Wi-Fi credentials and signal strength near the machine.</li>
  <li><strong>No Telegram Messages</strong>: Confirm bot token and chat ID, check Serial Monitor for errors.</li>
</ul>

<p>This sound-based approach is simpler and more robust in varying light conditions compared to the camera-based method, making it ideal for a washing machine monitor. Let me know if you need help with specific steps, sensor calibration, or integrating additional features!</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
