<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Python Library Design Lessons from OpenAI</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Python Library Design Lessons from OpenAI | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Python Library Design Lessons from OpenAI" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-09-02-python-lib-design-openai-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-09-02-python-lib-design-openai-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Python Library Design Lessons from OpenAI" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"Python Library Design Lessons from OpenAI","url":"https://lzwjava.github.io/notes/2025-09-02-python-lib-design-openai-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=4742595643bfaed35c38b77337b119254f3fac13">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=4742595643bfaed35c38b77337b119254f3fac13" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Python Library Design Lessons from OpenAI | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-09-02-python-lib-design-openai-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-09-02-python-lib-design-openai-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.09</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/python-lib-design-openai-en" selected>English</option>
        <option value="/python-lib-design-openai-zh" >中文</option>
        <option value="/python-lib-design-openai-ja" >日本語</option>
        <option value="/python-lib-design-openai-es" >Español</option>
        <option value="/python-lib-design-openai-hi" >हिंदी</option>
        <option value="/python-lib-design-openai-fr" >Français</option>
        <option value="/python-lib-design-openai-de" >Deutsch</option>
        <option value="/python-lib-design-openai-ar" >العربية</option>
        <option value="/python-lib-design-openai-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>Here’s a quick teardown of <code class="language-plaintext highlighter-rouge">openai/openai-python</code> and the lessons you can lift for building a great Python library.</p>

<h1 id="what-the-repo-shows-at-a-glance">What the repo shows (at a glance)</h1>

<ul>
  <li><strong>Clear “src layout”</strong>: <code class="language-plaintext highlighter-rouge">src/openai</code> for code; top-level <code class="language-plaintext highlighter-rouge">tests/</code>, <code class="language-plaintext highlighter-rouge">examples/</code>, <code class="language-plaintext highlighter-rouge">scripts/</code>, <code class="language-plaintext highlighter-rouge">.github/</code>, <code class="language-plaintext highlighter-rouge">pyproject.toml</code>, <code class="language-plaintext highlighter-rouge">mypy.ini</code>, <code class="language-plaintext highlighter-rouge">noxfile.py</code>, etc. That separation keeps import paths clean and test discovery predictable. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Typed public surface</strong>: requests use <code class="language-plaintext highlighter-rouge">TypedDict</code>, responses are <strong>Pydantic</strong> models; great DX and safer refactors. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Sync + Async parity</strong>: <code class="language-plaintext highlighter-rouge">OpenAI</code> and <code class="language-plaintext highlighter-rouge">AsyncOpenAI</code> share the same API; default transport is <code class="language-plaintext highlighter-rouge">httpx</code>, with optional <code class="language-plaintext highlighter-rouge">aiohttp</code>. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>First-class streaming</strong>: Server-Sent Events with simple iteration in both sync and async. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Auto-pagination</strong>: iterable list endpoints so users don’t hand-roll page loops. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Realtime/WebSocket client</strong>: an opt-in sub-client with examples and error-handling guidance. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Codegen pipeline</strong>: the SDK is generated from an OpenAPI spec (via Stainless), which enforces consistency and type coverage. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
</ul>

<h1 id="design-takeaways-you-can-reuse">Design takeaways you can reuse</h1>

<ul>
  <li><strong>Keep the “one obvious way”</strong>: expose a single <code class="language-plaintext highlighter-rouge">Client</code> (plus <code class="language-plaintext highlighter-rouge">AsyncClient</code>) with mirror method names. Users shouldn’t wonder “which class should I use?” The OpenAI SDK shows this with <code class="language-plaintext highlighter-rouge">OpenAI</code> and <code class="language-plaintext highlighter-rouge">AsyncOpenAI</code>. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Portable transports</strong>: default to <code class="language-plaintext highlighter-rouge">httpx</code>, but allow a swappable HTTP backend (e.g., <code class="language-plaintext highlighter-rouge">aiohttp</code>), so high-concurrency users aren’t boxed in. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Typed requests + models</strong>: ship typed request payloads and rich response models. That buys you editor autocomplete, lintable examples, and safer breaking changes. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Zero-friction streaming</strong>: design streaming as a plain iterator / async iterator. No custom event pumps needed. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Iterator-based pagination</strong>: expose <code class="language-plaintext highlighter-rouge">for item in client.resource.list(limit=...)</code> and fetch pages lazily. It keeps user code tiny while remaining efficient. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Subsystems are sub-clients</strong>: put specialized features (e.g., realtime) behind a clearly-named namespace (<code class="language-plaintext highlighter-rouge">client.beta.realtime</code>) to keep the main surface clean. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Generate where it helps</strong>: if your API is spec-driven, let codegen create the boring, strongly-typed layers and hand-craft the ergonomic bits. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
</ul>

<h1 id="a-skeleton-you-can-copy">A skeleton you can copy</h1>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yourlib/
  pyproject.toml
  noxfile.py
  mypy.ini
  README.md
  CHANGELOG.md
  SECURITY.md
  src/yourlib/
    __init__.py
    _version.py
    _types.py            <span class="c"># TypedDicts, enums</span>
    _errors.py           <span class="c"># Exception hierarchy</span>
    _http.py             <span class="c"># httpx client wrapper, retries, timeouts</span>
    _pagination.py       <span class="c"># generic Pager[T]</span>
    client.py            <span class="c"># Client + AsyncClient, auth, base URL</span>
    resources/
      __init__.py
      widgets.py         <span class="c"># resource groups w/ sync+async methods</span>
    streaming.py         <span class="c"># SSE helpers (sync/async)</span>
  tests/
    test_client.py
    test_widgets.py
  examples/
    quickstart.py
    async_quickstart.py
</code></pre></div></div>

<h2 id="public-api-srcyourlib__init__py">Public API (<code class="language-plaintext highlighter-rouge">src/yourlib/__init__.py</code>)</h2>

<ul>
  <li>Re-export just what users need:</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">.client</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">AsyncClient</span>
<span class="kn">from</span> <span class="nn">._errors</span> <span class="kn">import</span> <span class="n">YourLibError</span><span class="p">,</span> <span class="n">APIError</span><span class="p">,</span> <span class="n">RateLimitError</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Client"</span><span class="p">,</span> <span class="s">"AsyncClient"</span><span class="p">,</span> <span class="s">"YourLibError"</span><span class="p">,</span> <span class="s">"APIError"</span><span class="p">,</span> <span class="s">"RateLimitError"</span><span class="p">]</span>
</code></pre></div></div>

<h2 id="client-shape-sync--async">Client shape (sync &amp; async)</h2>

<ul>
  <li>Mirror the same method names; differ only in <code class="language-plaintext highlighter-rouge">await</code>/<code class="language-plaintext highlighter-rouge">async</code>:</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># src/yourlib/client.py
</span><span class="kn">import</span> <span class="nn">httpx</span>
<span class="kn">from</span> <span class="nn">.resources.widgets</span> <span class="kn">import</span> <span class="n">Widgets</span>
<span class="kn">from</span> <span class="nn">._http</span> <span class="kn">import</span> <span class="n">HttpTransport</span>

<span class="k">class</span> <span class="nc">Client</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">base_url</span><span class="o">=</span><span class="s">"https://api.example.com"</span><span class="p">,</span> <span class="n">http_client</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_transport</span> <span class="o">=</span> <span class="n">HttpTransport</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">base_url</span><span class="p">,</span> <span class="n">http_client</span> <span class="ow">or</span> <span class="n">httpx</span><span class="p">.</span><span class="n">Client</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">widgets</span> <span class="o">=</span> <span class="n">Widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_transport</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">AsyncClient</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">base_url</span><span class="o">=</span><span class="s">"https://api.example.com"</span><span class="p">,</span> <span class="n">http_client</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_transport</span> <span class="o">=</span> <span class="n">HttpTransport</span><span class="p">(</span><span class="n">api_key</span><span class="p">,</span> <span class="n">base_url</span><span class="p">,</span> <span class="n">http_client</span> <span class="ow">or</span> <span class="n">httpx</span><span class="p">.</span><span class="n">AsyncClient</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">widgets</span> <span class="o">=</span> <span class="n">Widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_transport</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="pagination-pattern">Pagination pattern</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># src/yourlib/_pagination.py
</span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">AsyncIterator</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">Generic</span><span class="p">,</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Optional</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s">"T"</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Pager</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fetch</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[...,</span> <span class="nb">dict</span><span class="p">],</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_fetch</span> <span class="o">=</span> <span class="n">fetch</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_limit</span> <span class="o">=</span> <span class="n">limit</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_cursor</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">page</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_fetch</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">_limit</span><span class="p">,</span> <span class="n">cursor</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">_cursor</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">page</span><span class="p">[</span><span class="s">"data"</span><span class="p">]:</span>
                <span class="k">yield</span> <span class="n">item</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_cursor</span> <span class="o">=</span> <span class="n">page</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"next_cursor"</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">_cursor</span><span class="p">:</span>
                <span class="k">break</span>
</code></pre></div></div>

<p>Expose it so users can <code class="language-plaintext highlighter-rouge">for item in client.widgets.list(limit=50): ...</code>. (OpenAI’s SDK takes the same approach. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>))</p>

<h2 id="streaming-pattern-sse">Streaming pattern (SSE)</h2>

<ul>
  <li>Wrap <code class="language-plaintext highlighter-rouge">httpx</code>’s streaming with a small iterator that yields events; mirror an async variant. That yields the ergonomic <code class="language-plaintext highlighter-rouge">for event in client.responses.create(..., stream=True)</code> UX seen in the OpenAI SDK. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
</ul>

<h1 id="tooling--release-flow-that-scales">Tooling &amp; release flow that scales</h1>

<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">pyproject.toml</code> (PEP 621)</strong> for metadata; lock dev deps separately.</li>
  <li><strong>Type checking</strong>: ship types, run <code class="language-plaintext highlighter-rouge">mypy</code> in CI (their repo has <code class="language-plaintext highlighter-rouge">mypy.ini</code>). (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Task runner</strong>: <code class="language-plaintext highlighter-rouge">nox</code> sessions for test, lint, typecheck, build (they use <code class="language-plaintext highlighter-rouge">noxfile.py</code>). (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>CI</strong>: GitHub Actions in <code class="language-plaintext highlighter-rouge">.github/</code> to run tests across Python versions/platforms. (<a href="https://github.com/openai/openai-python/tree/main/.github" title="openai-python/.github at main · openai/openai-python · GitHub">GitHub</a>)</li>
  <li><strong>CHANGELOG</strong> and <strong>versioning</strong>: keep a human-readable log; automate releases (they use release-please). (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Security &amp; Contributing docs</strong>: set expectations for reporters and contributors. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
</ul>

<h1 id="docs--examples">Docs &amp; examples</h1>

<ul>
  <li><strong>README examples</strong> should be runnable and copy-paste friendly—sync, async, streaming, pagination, and any “special transports” (like <code class="language-plaintext highlighter-rouge">aiohttp</code>). The OpenAI README demonstrates each succinctly. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>API reference</strong>: if code-generated, publish an <code class="language-plaintext highlighter-rouge">api.md</code>/reference site and keep it in lockstep with releases. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Examples folder</strong>: include minimal, focused scripts, plus one “full” sample.</li>
</ul>

<h1 id="errors-retries-and-timeouts-what-to-implement">Errors, retries, and timeouts (what to implement)</h1>

<ul>
  <li><strong>Error hierarchy</strong>: <code class="language-plaintext highlighter-rouge">YourLibError</code> → <code class="language-plaintext highlighter-rouge">APIError</code>, <code class="language-plaintext highlighter-rouge">AuthError</code>, <code class="language-plaintext highlighter-rouge">RateLimitError</code>, <code class="language-plaintext highlighter-rouge">TimeoutError</code>. Map HTTP status codes to exceptions; include request IDs.</li>
  <li><strong>Retries</strong>: idempotent operations should auto-retry with exponential backoff + jitter on 429/5xx.</li>
  <li><strong>Timeouts</strong>: set sensible defaults and make them configurable at client and per-call levels.</li>
  <li><strong>Logging hooks</strong>: structured debug logging without leaking secrets.</li>
</ul>

<h1 id="packaging--compatibility">Packaging &amp; compatibility</h1>

<ul>
  <li><strong>Support 3–4 active Python minors</strong> (e.g., 3.9–3.13), and test them in CI.</li>
  <li><strong>No side effects on import</strong>; defer network/client creation until first use.</li>
  <li><strong>Environment config</strong>: accept <code class="language-plaintext highlighter-rouge">API_KEY</code> env var but let users pass credentials explicitly too (OpenAI shows <code class="language-plaintext highlighter-rouge">OPENAI_API_KEY</code> and a <code class="language-plaintext highlighter-rouge">.env</code> tip). (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li><strong>Stable public API</strong>: keep internals private (<code class="language-plaintext highlighter-rouge">_module.py</code>), re-export a tidy surface in <code class="language-plaintext highlighter-rouge">__init__.py</code>.</li>
</ul>

<h1 id="pitfalls-to-avoid">Pitfalls to avoid</h1>

<ul>
  <li>Cramming everything into a single module; split by resource and keep public imports stable.</li>
  <li>Leaking transport types; your resources should depend on a tiny “transport” protocol, not <code class="language-plaintext highlighter-rouge">httpx</code> directly.</li>
  <li>Making async feel second-class; ensure tests and examples cover both equally (OpenAI’s parity is a good model). (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
  <li>For streaming, don’t force users to juggle threads or callbacks—iterators are simpler. (<a href="https://github.com/openai/openai-python" title="GitHub - openai/openai-python: The official Python library for the OpenAI API">GitHub</a>)</li>
</ul>

<p>If you want, I can scaffold this structure for a concrete domain (e.g., a typed client for your internal REST services, with sync/async, pagination, and streaming) and drop in ready-to-run <code class="language-plaintext highlighter-rouge">nox</code>, CI, and example scripts.</p>



  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
