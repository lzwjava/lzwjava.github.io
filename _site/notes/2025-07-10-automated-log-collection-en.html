<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Automate Log Collection in Spring Boot</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Automate Log Collection in Spring Boot | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Automate Log Collection in Spring Boot" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-07-10-automated-log-collection-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-07-10-automated-log-collection-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Automate Log Collection in Spring Boot" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"Automate Log Collection in Spring Boot","url":"https://lzwjava.github.io/notes/2025-07-10-automated-log-collection-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=80225c4734dcb7bab5b1b37b08e6c355438bcb69">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=80225c4734dcb7bab5b1b37b08e6c355438bcb69" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Automate Log Collection in Spring Boot | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-07-10-automated-log-collection-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-07-10-automated-log-collection-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/automated-log-collection-en" selected>English</option>
        <option value="/automated-log-collection-zh" >中文</option>
        <option value="/automated-log-collection-ja" >日本語</option>
        <option value="/automated-log-collection-es" >Español</option>
        <option value="/automated-log-collection-hi" >हिंदी</option>
        <option value="/automated-log-collection-fr" >Français</option>
        <option value="/automated-log-collection-de" >Deutsch</option>
        <option value="/automated-log-collection-ar" >العربية</option>
        <option value="/automated-log-collection-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>You’re absolutely right! Manually copying and pasting logs is tedious and error-prone. Let me show you how to set up automated log collection in Spring Boot projects using Logback.Now let me show you how to configure this in your Spring Boot application properties:Here’s also a Java configuration approach if you prefer programmatic setup:Here are the key benefits of this automated setup:</p>

<p><strong>What this gives you:</strong></p>
<ol>
  <li><strong>Automatic log directory creation</strong> - Creates a <code class="language-plaintext highlighter-rouge">logs/</code> folder in your project</li>
  <li><strong>Multiple log files</strong> - Separates general logs, error logs, and startup logs</li>
  <li><strong>Rolling files</strong> - Automatically rotates logs by date and size</li>
  <li><strong>Session-based logging</strong> - Each run gets timestamped log files</li>
  <li><strong>No manual copying</strong> - Everything is automatically saved</li>
</ol>

<p><strong>File structure you’ll get:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>logs/
├── myapp.log                    # Current general log
├── myapp-error.log             # Error logs only
├── myapp-startup.log           # Startup logs
├── myapp-session-20250710_143022.log  # Session-specific
└── archived/                   # Older rotated logs
</code></pre></div></div>

<p><strong>To use this:</strong></p>
<ol>
  <li>Place <code class="language-plaintext highlighter-rouge">logback-spring.xml</code> in your <code class="language-plaintext highlighter-rouge">src/main/resources/</code> folder</li>
  <li>Update your <code class="language-plaintext highlighter-rouge">application.yml</code> with the logging configuration</li>
  <li>Run your Spring Boot application</li>
  <li>Logs will automatically be collected in the <code class="language-plaintext highlighter-rouge">logs/</code> directory</li>
</ol>

<p>This completely eliminates the need for manual log copying - every run of your application will automatically generate organized, searchable log files that you can easily reference later!</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
    <span class="c">&lt;!-- Define log directory and file patterns --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"LOG_DIR"</span> <span class="na">value=</span><span class="s">"logs"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"APP_NAME"</span> <span class="na">value=</span><span class="s">"myapp"</span><span class="nt">/&gt;</span>
    
    <span class="c">&lt;!-- Console appender for development --&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"CONSOLE"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.ConsoleAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;encoder&gt;</span>
            <span class="nt">&lt;pattern&gt;</span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n<span class="nt">&lt;/pattern&gt;</span>
        <span class="nt">&lt;/encoder&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>
    
    <span class="c">&lt;!-- File appender for all logs --&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"FILE"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.rolling.RollingFileAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;file&gt;</span>${LOG_DIR}/${APP_NAME}.log<span class="nt">&lt;/file&gt;</span>
        <span class="nt">&lt;encoder&gt;</span>
            <span class="nt">&lt;pattern&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n<span class="nt">&lt;/pattern&gt;</span>
        <span class="nt">&lt;/encoder&gt;</span>
        <span class="nt">&lt;rollingPolicy</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;fileNamePattern&gt;</span>${LOG_DIR}/${APP_NAME}.%d{yyyy-MM-dd}.%i.log<span class="nt">&lt;/fileNamePattern&gt;</span>
            <span class="nt">&lt;maxFileSize&gt;</span>10MB<span class="nt">&lt;/maxFileSize&gt;</span>
            <span class="nt">&lt;maxHistory&gt;</span>30<span class="nt">&lt;/maxHistory&gt;</span>
            <span class="nt">&lt;totalSizeCap&gt;</span>300MB<span class="nt">&lt;/totalSizeCap&gt;</span>
        <span class="nt">&lt;/rollingPolicy&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>
    
    <span class="c">&lt;!-- Separate appender for ERROR logs only --&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"ERROR_FILE"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.rolling.RollingFileAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;file&gt;</span>${LOG_DIR}/${APP_NAME}-error.log<span class="nt">&lt;/file&gt;</span>
        <span class="nt">&lt;filter</span> <span class="na">class=</span><span class="s">"ch.qos.logback.classic.filter.LevelFilter"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;level&gt;</span>ERROR<span class="nt">&lt;/level&gt;</span>
            <span class="nt">&lt;onMatch&gt;</span>ACCEPT<span class="nt">&lt;/onMatch&gt;</span>
            <span class="nt">&lt;onMismatch&gt;</span>DENY<span class="nt">&lt;/onMismatch&gt;</span>
        <span class="nt">&lt;/filter&gt;</span>
        <span class="nt">&lt;encoder&gt;</span>
            <span class="nt">&lt;pattern&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n%ex<span class="nt">&lt;/pattern&gt;</span>
        <span class="nt">&lt;/encoder&gt;</span>
        <span class="nt">&lt;rollingPolicy</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;fileNamePattern&gt;</span>${LOG_DIR}/${APP_NAME}-error.%d{yyyy-MM-dd}.%i.log<span class="nt">&lt;/fileNamePattern&gt;</span>
            <span class="nt">&lt;maxFileSize&gt;</span>10MB<span class="nt">&lt;/maxFileSize&gt;</span>
            <span class="nt">&lt;maxHistory&gt;</span>30<span class="nt">&lt;/maxHistory&gt;</span>
            <span class="nt">&lt;totalSizeCap&gt;</span>100MB<span class="nt">&lt;/totalSizeCap&gt;</span>
        <span class="nt">&lt;/rollingPolicy&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>
    
    <span class="c">&lt;!-- Separate appender for startup logs --&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"STARTUP_FILE"</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.rolling.RollingFileAppender"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;file&gt;</span>${LOG_DIR}/${APP_NAME}-startup.log<span class="nt">&lt;/file&gt;</span>
        <span class="nt">&lt;encoder&gt;</span>
            <span class="nt">&lt;pattern&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n<span class="nt">&lt;/pattern&gt;</span>
        <span class="nt">&lt;/encoder&gt;</span>
        <span class="nt">&lt;rollingPolicy</span> <span class="na">class=</span><span class="s">"ch.qos.logback.core.rolling.TimeBasedRollingPolicy"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;fileNamePattern&gt;</span>${LOG_DIR}/${APP_NAME}-startup.%d{yyyy-MM-dd}.log<span class="nt">&lt;/fileNamePattern&gt;</span>
            <span class="nt">&lt;maxHistory&gt;</span>7<span class="nt">&lt;/maxHistory&gt;</span>
        <span class="nt">&lt;/rollingPolicy&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>
    
    <span class="c">&lt;!-- Application-specific logger for startup events --&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"org.springframework.boot"</span> <span class="na">level=</span><span class="s">"INFO"</span> <span class="na">additivity=</span><span class="s">"false"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"STARTUP_FILE"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"FILE"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"CONSOLE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
    
    <span class="c">&lt;!-- Capture SQL logs if using JPA --&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"org.hibernate.SQL"</span> <span class="na">level=</span><span class="s">"DEBUG"</span> <span class="na">additivity=</span><span class="s">"false"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"FILE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
    
    <span class="c">&lt;!-- Root logger configuration --&gt;</span>
    <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">"INFO"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"CONSOLE"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"FILE"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"ERROR_FILE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/root&gt;</span>
    
    <span class="c">&lt;!-- Profile-specific configurations --&gt;</span>
    <span class="nt">&lt;springProfile</span> <span class="na">name=</span><span class="s">"prod"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">"WARN"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"FILE"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"ERROR_FILE"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/root&gt;</span>
    <span class="nt">&lt;/springProfile&gt;</span>
    
    <span class="nt">&lt;springProfile</span> <span class="na">name=</span><span class="s">"dev"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">"DEBUG"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"CONSOLE"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"FILE"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"ERROR_FILE"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/root&gt;</span>
    <span class="nt">&lt;/springProfile&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">spring</span><span class="pi">:</span>
  <span class="na">application</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">myapp</span>
  
<span class="na">logging</span><span class="pi">:</span>
  <span class="na">config</span><span class="pi">:</span> <span class="s">classpath:logback-spring.xml</span>
  <span class="na">level</span><span class="pi">:</span>
    <span class="na">root</span><span class="pi">:</span> <span class="s">INFO</span>
    <span class="na">com.yourpackage</span><span class="pi">:</span> <span class="s">DEBUG</span>
    <span class="na">org.springframework.web</span><span class="pi">:</span> <span class="s">DEBUG</span>
    <span class="na">org.hibernate.SQL</span><span class="pi">:</span> <span class="s">DEBUG</span>
    
<span class="c1"># Alternative: Direct configuration in application.yml (simpler approach)</span>
  <span class="na">file</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">logs/${spring.application.name}.log</span>
  <span class="na">pattern</span><span class="pi">:</span>
    <span class="na">console</span><span class="pi">:</span> <span class="s2">"</span><span class="s">%d{HH:mm:ss.SSS}</span><span class="nv"> </span><span class="s">[%thread]</span><span class="nv"> </span><span class="s">%-5level</span><span class="nv"> </span><span class="s">%logger{36}</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">%msg%n"</span>
    <span class="na">file</span><span class="pi">:</span> <span class="s2">"</span><span class="s">%d{yyyy-MM-dd</span><span class="nv"> </span><span class="s">HH:mm:ss.SSS}</span><span class="nv"> </span><span class="s">[%thread]</span><span class="nv"> </span><span class="s">%-5level</span><span class="nv"> </span><span class="s">%logger{36}</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">%msg%n"</span>
  <span class="na">logback</span><span class="pi">:</span>
    <span class="na">rollingpolicy</span><span class="pi">:</span>
      <span class="na">max-file-size</span><span class="pi">:</span> <span class="s">10MB</span>
      <span class="na">max-history</span><span class="pi">:</span> <span class="m">30</span>
      <span class="na">total-size-cap</span><span class="pi">:</span> <span class="s">300MB</span>

<span class="c1"># Management endpoints for monitoring logs</span>
<span class="na">management</span><span class="pi">:</span>
  <span class="na">endpoints</span><span class="pi">:</span>
    <span class="na">web</span><span class="pi">:</span>
      <span class="na">exposure</span><span class="pi">:</span>
        <span class="na">include</span><span class="pi">:</span> <span class="s">health,info,loggers,logfile</span>
  <span class="na">endpoint</span><span class="pi">:</span>
    <span class="na">loggers</span><span class="pi">:</span>
      <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.yourpackage.config</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">ch.qos.logback.classic.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">ch.qos.logback.classic.LoggerContext</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">ch.qos.logback.classic.encoder.PatternLayoutEncoder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">ch.qos.logback.classic.filter.LevelFilter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">ch.qos.logback.core.rolling.RollingFileAppender</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">ch.qos.logback.core.rolling.TimeBasedRollingPolicy</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">ch.qos.logback.core.util.FileSize</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Value</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Profile</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.annotation.PostConstruct</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.format.DateTimeFormatter</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoggingConfiguration</span> <span class="o">{</span>

    <span class="nd">@Value</span><span class="o">(</span><span class="s">"${spring.application.name:myapp}"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">appName</span><span class="o">;</span>

    <span class="nd">@Value</span><span class="o">(</span><span class="s">"${logging.path:logs}"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">logPath</span><span class="o">;</span>

    <span class="nd">@PostConstruct</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initLogging</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">setupLogDirectory</span><span class="o">();</span>
        <span class="n">setupSessionLogger</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">setupLogDirectory</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">File</span> <span class="n">logDir</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">logPath</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">logDir</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">logDir</span><span class="o">.</span><span class="na">mkdirs</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">setupSessionLogger</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">LoggerContext</span> <span class="n">context</span> <span class="o">=</span> <span class="o">(</span><span class="nc">LoggerContext</span><span class="o">)</span> <span class="nc">LoggerFactory</span><span class="o">.</span><span class="na">getILoggerFactory</span><span class="o">();</span>
        
        <span class="c1">// Create session-specific log file</span>
        <span class="nc">String</span> <span class="n">sessionId</span> <span class="o">=</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">().</span><span class="na">format</span><span class="o">(</span><span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="na">ofPattern</span><span class="o">(</span><span class="s">"yyyyMMdd_HHmmss"</span><span class="o">));</span>
        <span class="nc">String</span> <span class="n">sessionLogFile</span> <span class="o">=</span> <span class="n">logPath</span> <span class="o">+</span> <span class="s">"/"</span> <span class="o">+</span> <span class="n">appName</span> <span class="o">+</span> <span class="s">"-session-"</span> <span class="o">+</span> <span class="n">sessionId</span> <span class="o">+</span> <span class="s">".log"</span><span class="o">;</span>
        
        <span class="c1">// Setup session appender</span>
        <span class="nc">RollingFileAppender</span> <span class="n">sessionAppender</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RollingFileAppender</span><span class="o">();</span>
        <span class="n">sessionAppender</span><span class="o">.</span><span class="na">setContext</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
        <span class="n">sessionAppender</span><span class="o">.</span><span class="na">setFile</span><span class="o">(</span><span class="n">sessionLogFile</span><span class="o">);</span>
        
        <span class="c1">// Pattern encoder</span>
        <span class="nc">PatternLayoutEncoder</span> <span class="n">encoder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PatternLayoutEncoder</span><span class="o">();</span>
        <span class="n">encoder</span><span class="o">.</span><span class="na">setContext</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
        <span class="n">encoder</span><span class="o">.</span><span class="na">setPattern</span><span class="o">(</span><span class="s">"%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"</span><span class="o">);</span>
        <span class="n">encoder</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        <span class="n">sessionAppender</span><span class="o">.</span><span class="na">setEncoder</span><span class="o">(</span><span class="n">encoder</span><span class="o">);</span>
        
        <span class="c1">// Rolling policy</span>
        <span class="nc">TimeBasedRollingPolicy</span> <span class="n">rollingPolicy</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TimeBasedRollingPolicy</span><span class="o">();</span>
        <span class="n">rollingPolicy</span><span class="o">.</span><span class="na">setContext</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
        <span class="n">rollingPolicy</span><span class="o">.</span><span class="na">setParent</span><span class="o">(</span><span class="n">sessionAppender</span><span class="o">);</span>
        <span class="n">rollingPolicy</span><span class="o">.</span><span class="na">setFileNamePattern</span><span class="o">(</span><span class="n">logPath</span> <span class="o">+</span> <span class="s">"/"</span> <span class="o">+</span> <span class="n">appName</span> <span class="o">+</span> <span class="s">"-session-%d{yyyy-MM-dd}.%i.log"</span><span class="o">);</span>
        <span class="n">rollingPolicy</span><span class="o">.</span><span class="na">setMaxHistory</span><span class="o">(</span><span class="mi">7</span><span class="o">);</span>
        <span class="n">rollingPolicy</span><span class="o">.</span><span class="na">setTotalSizeCap</span><span class="o">(</span><span class="nc">FileSize</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="s">"100MB"</span><span class="o">));</span>
        <span class="n">rollingPolicy</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        
        <span class="n">sessionAppender</span><span class="o">.</span><span class="na">setRollingPolicy</span><span class="o">(</span><span class="n">rollingPolicy</span><span class="o">);</span>
        <span class="n">sessionAppender</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        
        <span class="c1">// Add to root logger</span>
        <span class="nc">Logger</span> <span class="n">rootLogger</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">Logger</span><span class="o">.</span><span class="na">ROOT_LOGGER_NAME</span><span class="o">);</span>
        <span class="n">rootLogger</span><span class="o">.</span><span class="na">addAppender</span><span class="o">(</span><span class="n">sessionAppender</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// Utility class for custom log collection</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LogCollector</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="nc">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">LogCollector</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    
    <span class="nd">@Value</span><span class="o">(</span><span class="s">"${logging.path:logs}"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">logPath</span><span class="o">;</span>
    
    <span class="nd">@EventListener</span><span class="o">(</span><span class="nc">ApplicationReadyEvent</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onApplicationReady</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Application started successfully at {}"</span><span class="o">,</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">());</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Log files are being collected in: {}"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">logPath</span><span class="o">).</span><span class="na">getAbsolutePath</span><span class="o">());</span>
    <span class="o">}</span>
    
    <span class="nd">@EventListener</span><span class="o">(</span><span class="nc">ContextClosedEvent</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onApplicationShutdown</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Application shutting down at {}"</span><span class="o">,</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">());</span>
        <span class="n">collectFinalLogs</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">collectFinalLogs</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Optional: Compress or archive logs on shutdown</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">File</span> <span class="n">logDir</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">logPath</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">logDir</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Log collection completed. Total files: {}"</span><span class="o">,</span> <span class="n">logDir</span><span class="o">.</span><span class="na">listFiles</span><span class="o">().</span><span class="na">length</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Error during log collection"</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>



  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
