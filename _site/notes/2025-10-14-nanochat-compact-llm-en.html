<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>NanoChat Compact Full Stack LLM</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>NanoChat Compact Full Stack LLM | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="NanoChat Compact Full Stack LLM" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-10-14-nanochat-compact-llm-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-10-14-nanochat-compact-llm-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="NanoChat Compact Full Stack LLM" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"NanoChat Compact Full Stack LLM","url":"https://lzwjava.github.io/notes/2025-10-14-nanochat-compact-llm-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=42549519b4f7b762014abde17a9cfc973a8aae82">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=42549519b4f7b762014abde17a9cfc973a8aae82" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       NanoChat Compact Full Stack LLM | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-10-14-nanochat-compact-llm-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-10-14-nanochat-compact-llm-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/nanochat-compact-llm-en" selected>English</option>
        <option value="/nanochat-compact-llm-zh" >中文</option>
        <option value="/nanochat-compact-llm-ja" >日本語</option>
        <option value="/nanochat-compact-llm-es" >Español</option>
        <option value="/nanochat-compact-llm-hi" >हिंदी</option>
        <option value="/nanochat-compact-llm-fr" >Français</option>
        <option value="/nanochat-compact-llm-de" >Deutsch</option>
        <option value="/nanochat-compact-llm-ar" >العربية</option>
        <option value="/nanochat-compact-llm-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <h3 id="what-is-nanochat">What is NanoChat?</h3>

<p>NanoChat is a compact, full-stack implementation of a large language model (LLM) system similar to ChatGPT, built in a single, minimal codebase that’s easy to hack on and requires few dependencies. Created by Andrej Karpathy (famous for his work in AI, like nanoGPT), it’s designed to run the complete LLM pipeline—from tokenization and pretraining to finetuning, evaluation, inference, and even a simple web UI for chatting with your model—on affordable hardware like a single 8xH100 GPU node.</p>

<p>It’s positioned as the “best ChatGPT that $100 can buy,” serving as a baseline for budget-friendly LLM development (under $1,000 total). This makes it a capstone project for Karpathy’s upcoming LLM101n course by Eureka Labs, emphasizing simplicity over complex configs.</p>

<h3 id="key-features">Key Features</h3>
<ul>
  <li><strong>End-to-End Pipeline</strong>: Handles everything in ~2,000 lines of code (with a tiny <code class="language-plaintext highlighter-rouge">uv.lock</code> file for deps). Trains a capable model with 4e19 FLOPs in about 4 hours on an 8xH100 setup costing ~$24/hour.</li>
  <li><strong>ChatGPT-Like UI</strong>: After training, spin up a web server to interact with your model just like the real ChatGPT.</li>
  <li><strong>Evaluation Report</strong>: Auto-generates a <code class="language-plaintext highlighter-rouge">report.md</code> with benchmark scores on tasks like ARC-Challenge, GSM8K, HumanEval, MMLU, and more. For example, a sample $100 run shows progressive improvements across stages (BASE, MID, SFT, RL):</li>
</ul>

<table>
  <thead>
    <tr>
      <th>Metric</th>
      <th>BASE</th>
      <th>MID</th>
      <th>SFT</th>
      <th>RL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CORE</td>
      <td>0.2219</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <td>ARC-Challenge</td>
      <td>-</td>
      <td>0.2875</td>
      <td>0.2807</td>
      <td>-</td>
    </tr>
    <tr>
      <td>ARC-Easy</td>
      <td>-</td>
      <td>0.3561</td>
      <td>0.3876</td>
      <td>-</td>
    </tr>
    <tr>
      <td>GSM8K</td>
      <td>-</td>
      <td>0.0250</td>
      <td>0.0455</td>
      <td>0.0758</td>
    </tr>
    <tr>
      <td>HumanEval</td>
      <td>-</td>
      <td>0.0671</td>
      <td>0.0854</td>
      <td>-</td>
    </tr>
    <tr>
      <td>MMLU</td>
      <td>-</td>
      <td>0.3111</td>
      <td>0.3151</td>
      <td>-</td>
    </tr>
    <tr>
      <td>ChatCORE</td>
      <td>-</td>
      <td>0.0730</td>
      <td>0.0884</td>
      <td>-</td>
    </tr>
  </tbody>
</table>

<p>(Total time: ~3h51m for the full run.)</p>
<ul>
  <li><strong>Hardware Flexibility</strong>: Works on Ampere 8xA100 (slower), single GPUs (with auto gradient accumulation), or lower-VRAM setups by tweaking batch sizes. Uses vanilla PyTorch; adaptable to other devices with tweaks.</li>
  <li><strong>Data Sources</strong>: Pulls from Hugging Face datasets like FineWeb and SmolTalk.</li>
  <li><strong>Extras</strong>: Includes tests (e.g., for the Rust-based tokenizer), and it’s easy to package the whole repo (~330KB) for querying with other LLMs.</li>
</ul>

<p>It’s inspired by Karpathy’s earlier nanoGPT project and modded-nanoGPT, but scaled up for a full chat experience.</p>

<h3 id="how-to-get-started">How to Get Started</h3>
<p>The quickest way is the <code class="language-plaintext highlighter-rouge">speedrun.sh</code> script, which handles the $100-tier model end-to-end on an 8xH100 (e.g., via Lambda Labs):</p>

<ol>
  <li>Boot an 8xH100 instance and clone the repo.</li>
  <li>Run:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash speedrun.sh
</code></pre></div>    </div>
    <p>(Or in a screen session for logging: <code class="language-plaintext highlighter-rouge">screen -L -Logfile speedrun.log -S speedrun bash speedrun.sh</code>. Detach with Ctrl+A+D and tail the log.)</p>
  </li>
  <li>Once done (~4 hours), activate the env (<code class="language-plaintext highlighter-rouge">source .venv/bin/activate</code>) and serve the UI:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python -m scripts.chat_web
</code></pre></div>    </div>
    <p>Open the local URL (e.g., http://your-ip:8000) to chat with your model. Check <code class="language-plaintext highlighter-rouge">report.md</code> for results.</p>
  </li>
</ol>

<p>For bigger models (e.g., $300 tier in ~12 hours, beating GPT-2 on some scores), edit <code class="language-plaintext highlighter-rouge">speedrun.sh</code> to download more data shards and adjust depth/batch sizes. Run tests like <code class="language-plaintext highlighter-rouge">python -m pytest tests/test_rustbpe.py -v -s</code>.</p>

<p>It’s MIT-licensed and open for contributions to push micro-models further. For a detailed walkthrough, check the repo’s Discussions.</p>

<p><a href="https://github.com/karpathy/nanochat">nanoChat GitHub Repo</a></p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    
      <p class="model">x-ai/grok-4-fast</p>
    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
