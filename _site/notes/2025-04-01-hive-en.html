<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Apache Hive</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Apache Hive | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Apache Hive" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-04-01-hive-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-04-01-hive-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Apache Hive" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"Apache Hive","url":"https://lzwjava.github.io/notes/2025-04-01-hive-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=48c918eaf14f3bbd498388217a5c5e47049b2a84">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=48c918eaf14f3bbd498388217a5c5e47049b2a84" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Apache Hive | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-04-01-hive-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-04-01-hive-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/hive-en" selected>English</option>
        <option value="/hive-zh" >中文</option>
        <option value="/hive-ja" >日本語</option>
        <option value="/hive-es" >Español</option>
        <option value="/hive-hi" >हिंदी</option>
        <option value="/hive-fr" >Français</option>
        <option value="/hive-de" >Deutsch</option>
        <option value="/hive-ar" >العربية</option>
        <option value="/hive-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>Apache Hive is a powerful open-source data warehouse system built on top of Hadoop. It provides an SQL-like interface called Hive Query Language (HQL) to query and analyze large datasets residing in distributed storage systems like Hadoop Distributed File System (HDFS) or cloud-based object stores. Hive translates these HQL queries into MapReduce or other execution frameworks like Tez or Spark, enabling scalable data processing.</p>

<p>Here’s a comprehensive guide to Apache Hive:</p>

<p><strong>1. Introduction to Hive:</strong></p>

<ul>
  <li><strong>Purpose:</strong> Hive simplifies the process of querying and analyzing massive datasets by providing a familiar SQL-like interface. It abstracts away the complexities of underlying distributed processing frameworks.</li>
  <li><strong>Schema on Read:</strong> Unlike traditional relational databases that enforce a schema on write, Hive operates on a “schema on read” principle. This means you define the structure of your data when you query it, providing flexibility in handling diverse and evolving datasets.</li>
  <li><strong>Data Warehouse System:</strong> Hive is designed for Online Analytical Processing (OLAP) workloads, focusing on data summarization, aggregation, and analysis rather than transactional operations (OLTP).</li>
  <li><strong>Scalability and Fault Tolerance:</strong> Built on Hadoop, Hive inherits its scalability and fault tolerance capabilities, allowing it to process petabytes of data across large clusters of commodity hardware.</li>
</ul>

<p><strong>2. Hive Architecture and Components:</strong></p>

<ul>
  <li><strong>Hive Clients:</strong> These are the interfaces through which users interact with Hive. Common clients include:
    <ul>
      <li><strong>Beeline:</strong> A command-line interface (CLI) for executing HQL queries. It is recommended over the older Hive CLI, especially for HiveServer2.</li>
      <li><strong>HiveServer2:</strong> A server that allows multiple clients (JDBC, ODBC, Thrift) to connect and execute queries concurrently. It provides better security and supports more advanced features than its predecessor, HiveServer1.</li>
      <li><strong>WebHCat:</strong> A REST API for accessing Hive metastore and executing Hive queries.</li>
    </ul>
  </li>
  <li><strong>Hive Services:</strong> These are the core components that enable Hive functionality:
    <ul>
      <li><strong>Metastore:</strong> A central repository that stores metadata about Hive tables, such as their schema (column names and data types), location in HDFS, and other properties. It typically uses a relational database (e.g., MySQL, PostgreSQL) to persist this metadata.</li>
      <li><strong>Driver:</strong> Receives HQL queries from clients, parses them, and initiates the compilation and execution process.</li>
      <li><strong>Compiler:</strong> Analyzes the HQL query, performs semantic checks, and generates an execution plan (a directed acyclic graph of tasks).</li>
      <li><strong>Optimizer:</strong> Optimizes the execution plan for better performance by applying various transformations, such as reordering joins, choosing appropriate join strategies, and more. Cost-Based Optimization (CBO) uses statistics about the data to make more informed optimization decisions.</li>
      <li><strong>Execution Engine:</strong> Executes the tasks in the execution plan. By default, Hive uses MapReduce, but it can also leverage other engines like Tez or Spark, which often offer significant performance improvements.</li>
      <li><strong>Thrift Server:</strong> Enables communication between Hive clients and the Hive server using the Apache Thrift framework.</li>
    </ul>
  </li>
  <li><strong>Processing Framework and Resource Management:</strong> Hive relies on a distributed processing framework (typically MapReduce, Tez, or Spark) and a resource management system (like YARN in Hadoop) to execute queries across the cluster.</li>
  <li><strong>Distributed Storage:</strong> Hive primarily uses HDFS to store the actual data of tables. It can also interact with other storage systems like Amazon S3, Azure Blob Storage, and Alluxio.</li>
</ul>

<p><strong>3. Hive Query Language (HQL):</strong></p>

<ul>
  <li><strong>SQL-like Syntax:</strong> HQL has a syntax very similar to standard SQL, making it easier for users familiar with relational databases to learn and use Hive.</li>
  <li><strong>Data Definition Language (DDL):</strong> HQL provides commands to define and manage database objects:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">CREATE DATABASE</code>: Creates a new database (a namespace for tables).</li>
      <li><code class="language-plaintext highlighter-rouge">DROP DATABASE</code>: Deletes a database and all its tables.</li>
      <li><code class="language-plaintext highlighter-rouge">CREATE TABLE</code>: Defines a new table, specifying its schema, storage format, and location. You can create either <strong>managed tables</strong> (where Hive controls the data lifecycle) or <strong>external tables</strong> (where the data is managed externally, and Hive only manages the metadata).</li>
      <li><code class="language-plaintext highlighter-rouge">DROP TABLE</code>: Deletes a table and its associated data (for managed tables) or only the metadata (for external tables).</li>
      <li><code class="language-plaintext highlighter-rouge">ALTER TABLE</code>: Modifies the schema or properties of an existing table (e.g., adding/dropping columns, renaming the table, changing the storage format).</li>
      <li><code class="language-plaintext highlighter-rouge">CREATE VIEW</code>: Creates a virtual table based on the result of a query.</li>
    </ul>
  </li>
  <li><strong>Data Manipulation Language (DML):</strong> HQL includes commands to load data into tables and query data:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">LOAD DATA INPATH</code>: Copies data from a specified source (local file system or HDFS) into a Hive table.</li>
      <li><code class="language-plaintext highlighter-rouge">INSERT INTO</code>: Inserts new rows into an existing table (often the result of a <code class="language-plaintext highlighter-rouge">SELECT</code> query).</li>
      <li><code class="language-plaintext highlighter-rouge">SELECT</code>: Retrieves data from one or more tables based on specified conditions. It supports various clauses like <code class="language-plaintext highlighter-rouge">WHERE</code>, <code class="language-plaintext highlighter-rouge">GROUP BY</code>, <code class="language-plaintext highlighter-rouge">HAVING</code>, <code class="language-plaintext highlighter-rouge">ORDER BY</code>, <code class="language-plaintext highlighter-rouge">SORT BY</code>, <code class="language-plaintext highlighter-rouge">CLUSTER BY</code>, and <code class="language-plaintext highlighter-rouge">DISTRIBUTE BY</code>.</li>
      <li><strong>Joins:</strong> Hive supports different types of joins (INNER JOIN, LEFT OUTER JOIN, RIGHT OUTER JOIN, FULL OUTER JOIN) to combine data from multiple tables. Map-side joins can significantly improve performance for smaller tables.</li>
    </ul>
  </li>
  <li><strong>Functions:</strong> Hive provides a rich set of built-in functions for data manipulation, aggregation, and more. You can also create <strong>User-Defined Functions (UDFs)</strong>, <strong>User-Defined Aggregate Functions (UDAFs)</strong>, and <strong>User-Defined Table-Generating Functions (UDTFs)</strong> to extend Hive’s functionality.</li>
</ul>

<p><strong>4. Hive Data Types and Formats:</strong></p>

<ul>
  <li><strong>Primitive Data Types:</strong>
    <ul>
      <li>Numeric: <code class="language-plaintext highlighter-rouge">TINYINT</code>, <code class="language-plaintext highlighter-rouge">SMALLINT</code>, <code class="language-plaintext highlighter-rouge">INT</code>, <code class="language-plaintext highlighter-rouge">BIGINT</code>, <code class="language-plaintext highlighter-rouge">FLOAT</code>, <code class="language-plaintext highlighter-rouge">DOUBLE</code>, <code class="language-plaintext highlighter-rouge">DECIMAL</code>.</li>
      <li>String: <code class="language-plaintext highlighter-rouge">STRING</code>, <code class="language-plaintext highlighter-rouge">VARCHAR</code>, <code class="language-plaintext highlighter-rouge">CHAR</code>.</li>
      <li>Boolean: <code class="language-plaintext highlighter-rouge">BOOLEAN</code>.</li>
      <li>Date and Time: <code class="language-plaintext highlighter-rouge">TIMESTAMP</code>, <code class="language-plaintext highlighter-rouge">DATE</code>, <code class="language-plaintext highlighter-rouge">INTERVAL</code> (available in later versions).</li>
      <li>Binary: <code class="language-plaintext highlighter-rouge">BINARY</code>.</li>
    </ul>
  </li>
  <li><strong>Complex Data Types:</strong>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">ARRAY</code>: An ordered list of elements of the same type (e.g., <code class="language-plaintext highlighter-rouge">ARRAY&lt;STRING&gt;</code>).</li>
      <li><code class="language-plaintext highlighter-rouge">MAP</code>: A collection of key-value pairs where keys are of a primitive type and values can be of any type (e.g., <code class="language-plaintext highlighter-rouge">MAP&lt;STRING, INT&gt;</code>).</li>
      <li><code class="language-plaintext highlighter-rouge">STRUCT</code>: A record type with a fixed set of named fields, each with its own type (e.g., <code class="language-plaintext highlighter-rouge">STRUCT&lt;first_name:STRING, last_name:STRING, age:INT&gt;</code>).</li>
      <li><code class="language-plaintext highlighter-rouge">UNION</code>: A type that can hold a value of one of several specified data types.</li>
    </ul>
  </li>
  <li><strong>Data Formats:</strong> Hive supports various data storage formats:
    <ul>
      <li><strong>Text Files:</strong> Plain text data with delimiters (e.g., CSV, TSV). Defined using <code class="language-plaintext highlighter-rouge">ROW FORMAT DELIMITED FIELDS TERMINATED BY ...</code>.</li>
      <li><strong>Sequence Files:</strong> A binary file format that stores data in key-value pairs.</li>
      <li><strong>RCFile (Record Columnar File):</strong> A columnar storage format that improves query performance for read-heavy workloads.</li>
      <li><strong>ORC (Optimized Row Columnar):</strong> A highly optimized columnar storage format that provides better compression and query performance compared to RCFile. It is often the recommended format.</li>
      <li><strong>Parquet:</strong> Another popular columnar storage format known for its efficient data compression and encoding schemes, making it suitable for analytical queries.</li>
      <li><strong>Avro:</strong> A row-based storage format with a schema defined in JSON, providing schema evolution capabilities.</li>
      <li><strong>JSON:</strong> Data stored in JavaScript Object Notation format.</li>
    </ul>
  </li>
</ul>

<p><strong>5. Hive Installation and Configuration:</strong></p>

<ul>
  <li><strong>Prerequisites:</strong> Typically, you need a running Hadoop cluster (HDFS and YARN) and Java Development Kit (JDK) installed.</li>
  <li><strong>Installation Methods:</strong>
    <ul>
      <li><strong>From Tarball:</strong> Download a pre-built binary package, extract it, and configure the environment variables (<code class="language-plaintext highlighter-rouge">HIVE_HOME</code>, <code class="language-plaintext highlighter-rouge">PATH</code>).</li>
      <li><strong>From Source:</strong> Download the source code and build Hive using Apache Maven.</li>
    </ul>
  </li>
  <li><strong>Configuration:</strong> The primary configuration file is <code class="language-plaintext highlighter-rouge">hive-site.xml</code>, located in the <code class="language-plaintext highlighter-rouge">conf</code> directory. Key configuration properties include:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">javax.jdo.option.ConnectionURL</code>, <code class="language-plaintext highlighter-rouge">javax.jdo.option.ConnectionDriverName</code>, <code class="language-plaintext highlighter-rouge">javax.jdo.option.ConnectionUserName</code>, <code class="language-plaintext highlighter-rouge">javax.jdo.option.ConnectionPassword</code>: Configure the connection to the Hive metastore database.</li>
      <li><code class="language-plaintext highlighter-rouge">hive.metastore.warehouse.dir</code>: Specifies the default location in HDFS for managed table data.</li>
      <li><code class="language-plaintext highlighter-rouge">hive.exec.engine</code>: Sets the execution engine to use (e.g., <code class="language-plaintext highlighter-rouge">mr</code> for MapReduce, <code class="language-plaintext highlighter-rouge">tez</code>, <code class="language-plaintext highlighter-rouge">spark</code>).</li>
      <li><code class="language-plaintext highlighter-rouge">hive.server2.thrift.http.port</code> (for HTTP mode) or <code class="language-plaintext highlighter-rouge">hive.server2.thrift.port</code> (for binary mode): Configures the port for HiveServer2.</li>
      <li><code class="language-plaintext highlighter-rouge">hive.metastore.uris</code>: Specifies the URI(s) of the metastore server(s) if running in remote metastore mode.</li>
    </ul>
  </li>
  <li><strong>Setting up the Metastore:</strong> You need to initialize the metastore schema in the configured database. This is typically done using the <code class="language-plaintext highlighter-rouge">schematool</code> command provided with Hive.</li>
</ul>

<p><strong>6. Hive Performance Tuning and Optimization:</strong></p>

<ul>
  <li><strong>Execution Engine Selection:</strong> Using Tez or Spark as the execution engine can significantly improve performance compared to MapReduce, especially for complex queries.</li>
  <li><strong>Data Format Optimization:</strong> Choosing columnar formats like ORC or Parquet can lead to better compression ratios and faster query execution due to reduced I/O.</li>
  <li><strong>Partitioning:</strong> Dividing tables into smaller, more manageable parts based on frequently queried columns (e.g., date, region) allows Hive to prune unnecessary data during query execution, improving performance. Static and dynamic partitioning are available.</li>
  <li><strong>Bucketing:</strong> Further dividing partitions into buckets based on the hash of a column can improve the efficiency of joins and sampling.</li>
  <li><strong>Indexing:</strong> Creating indexes on frequently filtered columns can speed up query execution. Hive supports different types of indexes, such as compact and bitmap indexes.</li>
  <li><strong>Cost-Based Optimization (CBO):</strong> Enabling CBO allows Hive to generate more efficient execution plans based on data statistics. Use the <code class="language-plaintext highlighter-rouge">ANALYZE TABLE</code> command to collect statistics.</li>
  <li><strong>Vectorization:</strong> Enabling vectorized query execution processes data in batches, improving the performance of operations like scans, aggregations, and filters.</li>
  <li><strong>Map-Side Joins:</strong> For joins involving a small table, Hive can perform the join on the map side, avoiding the shuffle phase and improving performance. Configure <code class="language-plaintext highlighter-rouge">hive.auto.convert.join</code> and related properties.</li>
  <li><strong>Parallel Execution:</strong> Allow Hive to execute independent tasks in parallel by setting <code class="language-plaintext highlighter-rouge">hive.exec.parallel</code> to <code class="language-plaintext highlighter-rouge">true</code>.</li>
  <li><strong>Join Optimization:</strong> Hive automatically optimizes the order of joins. You can also provide hints to influence the join strategy.</li>
  <li><strong>Avoid Unnecessary Data Retrieval:</strong> Use <code class="language-plaintext highlighter-rouge">SELECT</code> with specific columns instead of <code class="language-plaintext highlighter-rouge">SELECT *</code> to reduce the amount of data processed. Use <code class="language-plaintext highlighter-rouge">LIMIT</code> to restrict the number of rows returned for sampling or testing.</li>
  <li><strong>Skewed Data Handling:</strong> If data is unevenly distributed (skewed) in join or aggregation keys, it can lead to performance bottlenecks. Hive provides mechanisms to handle skewed joins and aggregations.</li>
  <li><strong>Resource Tuning:</strong> Adjusting the resources allocated to Hive and the underlying execution engine (e.g., memory for containers) can impact performance.</li>
</ul>

<p><strong>7. Hive Use Cases and Examples:</strong></p>

<ul>
  <li><strong>Data Warehousing:</strong> Building a scalable data warehouse for storing and analyzing large volumes of structured and semi-structured data.</li>
  <li><strong>Business Intelligence (BI):</strong> Performing data summarization, reporting, and analysis to gain insights for business decision-making. Hive integrates with various BI tools like Tableau, Power BI, and Looker.</li>
  <li><strong>ETL (Extract, Transform, Load):</strong> Transforming and preparing large datasets for downstream analysis or loading into other systems.</li>
  <li><strong>Log Analysis:</strong> Analyzing web server logs, application logs, and other machine-generated data to identify trends, patterns, and anomalies.</li>
  <li><strong>Clickstream Analysis:</strong> Analyzing user interactions on websites or applications to understand user behavior.</li>
  <li><strong>Financial Analysis:</strong> Analyzing large-scale financial data for fraud detection, risk management, and other purposes.</li>
  <li><strong>Machine Learning Data Preprocessing:</strong> Preparing and transforming large datasets for training machine learning models.</li>
</ul>

<p><strong>Example HQL Queries:</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Create a database named 'mydatabase'</span>
<span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">mydatabase</span><span class="p">;</span>

<span class="c1">-- Use the 'mydatabase'</span>
<span class="n">USE</span> <span class="n">mydatabase</span><span class="p">;</span>

<span class="c1">-- Create an external table named 'users'</span>
<span class="k">CREATE</span> <span class="k">EXTERNAL</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">users</span> <span class="p">(</span>
    <span class="n">user_id</span> <span class="nb">INT</span><span class="p">,</span>
    <span class="n">username</span> <span class="n">STRING</span><span class="p">,</span>
    <span class="n">age</span> <span class="nb">INT</span><span class="p">,</span>
    <span class="n">country</span> <span class="n">STRING</span>
<span class="p">)</span>
<span class="k">ROW</span> <span class="n">FORMAT</span> <span class="n">DELIMITED</span> <span class="n">FIELDS</span> <span class="n">TERMINATED</span> <span class="k">BY</span> <span class="s1">','</span>
<span class="k">LOCATION</span> <span class="s1">'/hdfs/user/hive/warehouse/users'</span><span class="p">;</span>

<span class="c1">-- Load data into the 'users' table from an HDFS path</span>
<span class="k">LOAD</span> <span class="k">DATA</span> <span class="n">INPATH</span> <span class="s1">'/hdfs/raw_data/user_data.csv'</span> <span class="k">INTO</span> <span class="k">TABLE</span> <span class="n">users</span><span class="p">;</span>

<span class="c1">-- Query users from a specific country</span>
<span class="k">SELECT</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">age</span>
<span class="k">FROM</span> <span class="n">users</span>
<span class="k">WHERE</span> <span class="n">country</span> <span class="o">=</span> <span class="s1">'China'</span><span class="p">;</span>

<span class="c1">-- Group users by country and count the number of users in each country</span>
<span class="k">SELECT</span> <span class="n">country</span><span class="p">,</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">AS</span> <span class="n">user_count</span>
<span class="k">FROM</span> <span class="n">users</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">country</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">user_count</span> <span class="k">DESC</span><span class="p">;</span>

<span class="c1">-- Create a partitioned table 'orders' partitioned by order_date</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="n">orders</span> <span class="p">(</span>
    <span class="n">order_id</span> <span class="nb">INT</span><span class="p">,</span>
    <span class="n">user_id</span> <span class="nb">INT</span><span class="p">,</span>
    <span class="n">product</span> <span class="n">STRING</span><span class="p">,</span>
    <span class="n">amount</span> <span class="nb">DOUBLE</span>
<span class="p">)</span>
<span class="n">PARTITIONED</span> <span class="k">BY</span> <span class="p">(</span><span class="n">order_date</span> <span class="nb">DATE</span><span class="p">)</span>
<span class="k">ROW</span> <span class="n">FORMAT</span> <span class="n">DELIMITED</span> <span class="n">FIELDS</span> <span class="n">TERMINATED</span> <span class="k">BY</span> <span class="s1">','</span><span class="p">;</span>

<span class="c1">-- Load data into a specific partition of the 'orders' table</span>
<span class="k">LOAD</span> <span class="k">DATA</span> <span class="n">INPATH</span> <span class="s1">'/hdfs/raw_data/orders_2025-03-31.csv'</span> <span class="k">INTO</span> <span class="k">TABLE</span> <span class="n">orders</span> <span class="k">PARTITION</span> <span class="p">(</span><span class="n">order_date</span><span class="o">=</span><span class="s1">'2025-03-31'</span><span class="p">);</span>

<span class="c1">-- Query orders for a specific date</span>
<span class="k">SELECT</span> <span class="n">order_id</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">amount</span>
<span class="k">FROM</span> <span class="n">orders</span>
<span class="k">WHERE</span> <span class="n">order_date</span> <span class="o">=</span> <span class="s1">'2025-03-31'</span><span class="p">;</span>
</code></pre></div></div>

<p>This guide provides a comprehensive overview of Apache Hive. By understanding its architecture, query language, data handling capabilities, and optimization techniques, you can effectively leverage Hive for large-scale data analysis in your big data projects. Remember to consult the official Apache Hive documentation for the most up-to-date information and advanced features.</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
