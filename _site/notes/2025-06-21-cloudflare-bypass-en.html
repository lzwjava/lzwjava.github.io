<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Selenium Script for Cloudflare Bypass</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Selenium Script for Cloudflare Bypass | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Selenium Script for Cloudflare Bypass" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-06-21-cloudflare-bypass-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-06-21-cloudflare-bypass-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Selenium Script for Cloudflare Bypass" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"Selenium Script for Cloudflare Bypass","url":"https://lzwjava.github.io/notes/2025-06-21-cloudflare-bypass-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=5a4a4c40e25f56933078ff8cb308dac692af4faf">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=5a4a4c40e25f56933078ff8cb308dac692af4faf" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Selenium Script for Cloudflare Bypass | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-06-21-cloudflare-bypass-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-06-21-cloudflare-bypass-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/cloudflare-bypass-en" selected>English</option>
        <option value="/cloudflare-bypass-zh" >中文</option>
        <option value="/cloudflare-bypass-ja" >日本語</option>
        <option value="/cloudflare-bypass-es" >Español</option>
        <option value="/cloudflare-bypass-hi" >हिंदी</option>
        <option value="/cloudflare-bypass-fr" >Français</option>
        <option value="/cloudflare-bypass-de" >Deutsch</option>
        <option value="/cloudflare-bypass-ar" >العربية</option>
        <option value="/cloudflare-bypass-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>Your Selenium script is designed to interact with “https://grok.com” using Firefox and a specific profile, but it’s encountering a Cloudflare bot detection challenge, specifically the “Verify you are human” checkbox. Even after clicking the checkbox, the script seems to struggle to bypass the verification, preventing access to the main content (e.g., the textarea). Cloudflare employs sophisticated methods to detect automated browsers, such as HTTP header analysis, TLS fingerprinting, and behavioral checks, which can make bypassing this challenge tricky with Selenium alone. However, there are strategies you can try to pass the Cloudflare test while staying within your current Firefox-based setup. Below are two practical approaches tailored to your script, followed by additional considerations if these don’t suffice.</p>

<hr />

<h3 id="method-1-manual-challenge-completion-with-profile-reuse"><strong>Method 1: Manual Challenge Completion with Profile Reuse</strong></h3>
<p>Since your script uses a specific Firefox profile (<code class="language-plaintext highlighter-rouge">/home/lzw/.mozilla/firefox/wzfodx6v.default</code>), you can leverage this to store session data after manually passing the Cloudflare challenge. Here’s how to do it:</p>

<ol>
  <li><strong>Manually Open Firefox with the Profile</strong>:
    <ul>
      <li>Launch Firefox using the same profile specified in your script. You can do this via the command line:
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>firefox <span class="nt">--profile</span> <span class="s2">"/home/lzw/.mozilla/firefox/wzfodx6v.default"</span>
</code></pre></div>        </div>
      </li>
      <li>Alternatively, use Firefox’s profile manager (<code class="language-plaintext highlighter-rouge">firefox --ProfileManager</code>) to select <code class="language-plaintext highlighter-rouge">wzfodx6v.default</code>.</li>
    </ul>
  </li>
  <li><strong>Navigate and Pass the Challenge</strong>:
    <ul>
      <li>Go to “https://grok.com” in the browser.</li>
      <li>When prompted with the Cloudflare “Verify you are human” checkbox, click it and complete any additional verification steps if they appear.</li>
      <li>Wait until you reach the main page (e.g., where the textarea with <code class="language-plaintext highlighter-rouge">aria-label="Ask Grok anything"</code> is visible).</li>
    </ul>
  </li>
  <li><strong>Close the Browser</strong>:
    <ul>
      <li>Exit Firefox to ensure the profile saves the session cookies, including any Cloudflare clearance tokens (like <code class="language-plaintext highlighter-rouge">cf_clearance</code>).</li>
    </ul>
  </li>
  <li><strong>Run Your Selenium Script</strong>:
    <ul>
      <li>Execute your script as is. Since it uses the same profile, it should inherit the stored cookies and session data, potentially allowing it to bypass the challenge.</li>
    </ul>
  </li>
</ol>

<p><strong>Why This Might Work</strong>: Cloudflare often relies on cookies to remember that a browser has passed its test. By pre-authenticating the profile manually, your automated session may appear as a continuation of a verified visit.</p>

<p><strong>Limitations</strong>: If Cloudflare performs additional checks on each page load (e.g., detecting Selenium’s automation fingerprints), this method might fail. In that case, try the next approach.</p>

<hr />

<h3 id="method-2-extract-and-set-cookies-in-the-script"><strong>Method 2: Extract and Set Cookies in the Script</strong></h3>
<p>If reusing the profile doesn’t work, you can manually extract the cookies after passing the challenge and inject them into your Selenium driver. Here’s the step-by-step process:</p>

<ol>
  <li><strong>Manually Pass the Challenge</strong>:
    <ul>
      <li>Follow steps 1 and 2 from Method 1 to reach the main page of “https://grok.com”.</li>
    </ul>
  </li>
  <li><strong>Extract Cookies</strong>:
    <ul>
      <li>Open Firefox’s Developer Tools (F12 or right-click &gt; Inspect).</li>
      <li>Go to the <strong>Storage</strong> tab (or <strong>Network</strong> tab, then reload the page to inspect cookies).</li>
      <li>Look for cookies associated with <code class="language-plaintext highlighter-rouge">.grok.com</code>, especially <code class="language-plaintext highlighter-rouge">cf_clearance</code> (Cloudflare’s verification cookie).</li>
      <li>Note the <code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">value</code>, and <code class="language-plaintext highlighter-rouge">domain</code> of each relevant cookie. For example:
        <ul>
          <li>Name: <code class="language-plaintext highlighter-rouge">cf_clearance</code>, Value: <code class="language-plaintext highlighter-rouge">abc123...</code>, Domain: <code class="language-plaintext highlighter-rouge">.grok.com</code></li>
          <li>Other cookies like <code class="language-plaintext highlighter-rouge">__cfduid</code> or session-specific ones might also be present.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Modify Your Script</strong>:
    <ul>
      <li>Add the cookies to your Selenium driver before navigating to the URL. Update your code like this:
        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ... (existing imports and setup remain unchanged)
</span>
<span class="c1"># Set up geckodriver service
</span><span class="n">service</span> <span class="o">=</span> <span class="n">Service</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s">"/home/lzw/bin/geckodriver"</span><span class="p">)</span>
<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Firefox</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">service</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">firefox_options</span><span class="p">)</span>

<span class="c1"># Open a blank page first to set cookies (cookies can only be set after a page load)
</span><span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"about:blank"</span><span class="p">)</span>

<span class="c1"># Add the cookies you extracted
</span><span class="n">cookies</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s">"name"</span><span class="p">:</span> <span class="s">"cf_clearance"</span><span class="p">,</span> <span class="s">"value"</span><span class="p">:</span> <span class="s">"abc123..."</span><span class="p">,</span> <span class="s">"domain"</span><span class="p">:</span> <span class="s">".grok.com"</span><span class="p">},</span>
    <span class="c1"># Add other cookies as needed, e.g.:
</span>    <span class="c1"># {"name": "__cfduid", "value": "xyz789...", "domain": ".grok.com"},
</span><span class="p">]</span>
<span class="k">for</span> <span class="n">cookie</span> <span class="ow">in</span> <span class="n">cookies</span><span class="p">:</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">add_cookie</span><span class="p">(</span><span class="n">cookie</span><span class="p">)</span>

<span class="c1"># Now navigate to the target URL
</span><span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"https://grok.com"</span><span class="p">)</span>

<span class="c1"># Print the title of the page
</span><span class="k">print</span><span class="p">(</span><span class="s">"Title of the page:"</span><span class="p">,</span> <span class="n">driver</span><span class="p">.</span><span class="n">title</span><span class="p">)</span>

<span class="c1"># ... (rest of your script remains the same)
</span></code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li><strong>Test the Script</strong>:
    <ul>
      <li>Run the modified script. The pre-set cookies should signal to Cloudflare that the browser has already passed the challenge.</li>
    </ul>
  </li>
</ol>

<p><strong>Why This Might Work</strong>: Explicitly setting the <code class="language-plaintext highlighter-rouge">cf_clearance</code> cookie mimics a verified session, potentially bypassing the need to interact with the checkbox.</p>

<p><strong>Limitations</strong>: Cookies might be tied to browser fingerprints (e.g., user agent, IP, or TLS settings). If Selenium’s fingerprint differs from the manual session, Cloudflare might reject the cookies or re-challenge the browser.</p>

<hr />

<h3 id="additional-debugging-and-enhancements"><strong>Additional Debugging and Enhancements</strong></h3>
<p>If neither method fully resolves the issue, consider these adjustments to your script to ensure it’s interacting with the Cloudflare challenge correctly:</p>

<ul>
  <li><strong>Check for Iframes</strong>: The “Verify you are human” checkbox might be inside an iframe. Modify your checkbox-clicking code to switch to the iframe first:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span><span class="p">:</span>
    <span class="n">wait</span> <span class="o">=</span> <span class="n">WebDriverWait</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">iframe</span> <span class="o">=</span> <span class="n">wait</span><span class="p">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="p">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="p">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s">"//iframe[contains(@src, 'cloudflare')]"</span><span class="p">)))</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">switch_to</span><span class="p">.</span><span class="n">frame</span><span class="p">(</span><span class="n">iframe</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">wait</span><span class="p">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="p">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="p">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s">"//label[@class='cb-lb']"</span><span class="p">)))</span>
    <span class="n">checkbox</span> <span class="o">=</span> <span class="n">label</span><span class="p">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="p">.</span><span class="n">TAG_NAME</span><span class="p">,</span> <span class="s">"input"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Checkbox found:"</span><span class="p">,</span> <span class="n">checkbox</span><span class="p">.</span><span class="n">is_displayed</span><span class="p">())</span>
    <span class="n">checkbox</span><span class="p">.</span><span class="n">click</span><span class="p">()</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">switch_to</span><span class="p">.</span><span class="n">default_content</span><span class="p">()</span>  <span class="c1"># Switch back to main content
</span>    <span class="k">print</span><span class="p">(</span><span class="s">"Checkbox clicked."</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Checkbox not found or not clickable:"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Improve Waiting Logic</strong>: After clicking the checkbox, wait for a clear sign the challenge is passed (e.g., the verification page disappearing):
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span><span class="p">:</span>
    <span class="n">wait</span><span class="p">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="p">.</span><span class="n">invisibility_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="p">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s">"//*[contains(text(), 'Verify you are human')]"</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Challenge passed."</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Challenge not passed:"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Mask Automation</strong>: Add JavaScript to hide Selenium’s automation traces:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"Object.defineProperty(navigator, 'webdriver', {get: () =&gt; undefined})"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
</ul>

<hr />

<h3 id="if-all-else-fails-alternative-approaches"><strong>If All Else Fails: Alternative Approaches</strong></h3>
<p>If Cloudflare’s detection persists, it might be due to advanced fingerprinting that your current setup can’t evade. Here are escalation options, though they deviate from your Firefox preference:</p>

<ul>
  <li><strong>Switch to Chrome with Undetected ChromeDriver</strong>:
    <ul>
      <li>Install: <code class="language-plaintext highlighter-rouge">pip install undetected-chromedriver</code></li>
      <li>Modify setup:
        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">undetected_chromedriver</span> <span class="k">as</span> <span class="n">uc</span>
<span class="n">driver</span> <span class="o">=</span> <span class="n">uc</span><span class="p">.</span><span class="n">Chrome</span><span class="p">()</span>
<span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"https://grok.com"</span><span class="p">)</span>
</code></pre></div>        </div>
      </li>
      <li>This library patches Chrome to avoid common detection methods.</li>
    </ul>
  </li>
  <li><strong>Use a Proxy or CAPTCHA Solver</strong>: Services like 2Captcha or residential proxies can handle challenges, but they add complexity and cost.</li>
</ul>

<hr />

<h3 id="recommended-next-steps"><strong>Recommended Next Steps</strong></h3>
<p>Start with <strong>Method 1</strong> (profile reuse) as it’s the simplest and aligns with your script’s setup. If it fails, try <strong>Method 2</strong> (cookie injection) with the iframe check added. These methods maximize your existing Firefox configuration without requiring new tools. Test each approach and monitor the output (e.g., <code class="language-plaintext highlighter-rouge">driver.title</code> and exception messages) to confirm whether the challenge is bypassed. If you still face issues, consider the alternative approaches based on your project’s flexibility.</p>

<p>Let me know if you need help implementing or troubleshooting these solutions!</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
