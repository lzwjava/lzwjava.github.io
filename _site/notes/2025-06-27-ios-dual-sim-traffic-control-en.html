<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Managing Dual SIM Traffic Routing on iOS with GFW Considerations</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Managing Dual SIM Traffic Routing on iOS with GFW Considerations | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Managing Dual SIM Traffic Routing on iOS with GFW Considerations" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-06-27-ios-dual-sim-traffic-control-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-06-27-ios-dual-sim-traffic-control-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Managing Dual SIM Traffic Routing on iOS with GFW Considerations" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"Managing Dual SIM Traffic Routing on iOS with GFW Considerations","url":"https://lzwjava.github.io/notes/2025-06-27-ios-dual-sim-traffic-control-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=c5d028b9ab02583d6ad538650af0548d5ed7a574">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=c5d028b9ab02583d6ad538650af0548d5ed7a574" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Managing Dual SIM Traffic Routing on iOS with GFW Considerations | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-06-27-ios-dual-sim-traffic-control-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-06-27-ios-dual-sim-traffic-control-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/ios-dual-sim-traffic-control-en" selected>English</option>
        <option value="/ios-dual-sim-traffic-control-zh" >中文</option>
        <option value="/ios-dual-sim-traffic-control-ja" >日本語</option>
        <option value="/ios-dual-sim-traffic-control-es" >Español</option>
        <option value="/ios-dual-sim-traffic-control-hi" >हिंदी</option>
        <option value="/ios-dual-sim-traffic-control-fr" >Français</option>
        <option value="/ios-dual-sim-traffic-control-de" >Deutsch</option>
        <option value="/ios-dual-sim-traffic-control-ar" >العربية</option>
        <option value="/ios-dual-sim-traffic-control-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>iOS provides APIs that allow you to manage and separate network traffic for different cellular data plans when using Dual SIM functionality, but there are limitations, and direct control over routing specific traffic to specific SIMs based on the Great Firewall of China (GFW) restrictions is not natively supported at a granular level. However, with a combination of iOS APIs, manual configuration, and potentially third-party tools, you can achieve some level of separation for handling traffic differently for a Macao SIM and a China Telecom SIM. Below, I’ll outline the relevant APIs, configurations, and considerations, including how to address GFW-related challenges.</p>

<h3 id="key-ios-apis-and-features-for-dual-sim-and-traffic-management">Key iOS APIs and Features for Dual SIM and Traffic Management</h3>

<ol>
  <li><strong>CoreTelephony Framework</strong>:
    <ul>
      <li><strong>Purpose</strong>: Provides access to cellular-related information and configuration for Dual SIM devices.</li>
      <li><strong>Key Classes</strong>:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">CTCellularPlanProvisioning</code>: Allows you to add or manage cellular plans (e.g., eSIM or physical SIM).</li>
          <li><code class="language-plaintext highlighter-rouge">CTTelephonyNetworkInfo</code>: Provides information about available cellular plans and their properties, such as the carrier name, mobile country code (MCC), and mobile network code (MNC).</li>
          <li><code class="language-plaintext highlighter-rouge">CTCellularData</code>: Monitors cellular data usage and network state (e.g., whether cellular data is enabled).</li>
        </ul>
      </li>
      <li><strong>Limitations</strong>: CoreTelephony allows you to query and manage cellular plans but does not provide direct control over routing specific app traffic to a particular SIM. You can detect which SIM is active for data but cannot programmatically assign specific traffic (e.g., for a specific app or destination) to a SIM at the API level.</li>
    </ul>
  </li>
  <li><strong>NetworkExtension Framework</strong>:
    <ul>
      <li><strong>Purpose</strong>: Enables advanced network configuration, such as creating custom VPNs or managing network traffic rules.</li>
      <li><strong>Key Features</strong>:
        <ul>
          <li><strong>NEVPNManager</strong>: Allows you to configure and manage VPN connections, which can be used to route traffic through a specific server to bypass GFW restrictions.</li>
          <li><strong>NEPacketTunnelProvider</strong>: For creating custom VPN tunnels, which can be configured to route specific traffic through a Macao SIM to avoid GFW restrictions.</li>
        </ul>
      </li>
      <li><strong>Use Case for GFW</strong>: By setting up a VPN on the Macao SIM (which is not subject to GFW censorship, as Macao’s networks are independent), you can route traffic through a server outside mainland China to access blocked services like Google, WhatsApp, or YouTube.<a href="https://prepaid-data-sim-card.fandom.com/wiki/Macau"></a></li>
      <li><strong>Limitations</strong>: VPN configurations are typically applied at the system level, not per-SIM. You would need to manually switch the active data SIM or use a custom VPN solution to selectively route traffic.</li>
    </ul>
  </li>
  <li><strong>Dual SIM Configuration (Settings-Based)</strong>:
    <ul>
      <li>iOS supports Dual SIM Dual Standby (DSDS) on compatible iPhones (e.g., iPhone XS, XR, or later purchased in regions like Macao or Hong Kong, which support Dual SIM with two nano-SIMs or eSIM). This allows you to:<a href="https://support.apple.com/en-us/109317"></a><a href="https://support.apple.com/en-us/108898"></a>
        <ul>
          <li>Assign a default SIM for cellular data (Settings &gt; Cellular &gt; Cellular Data).</li>
          <li>Enable “Allow Cellular Data Switching” to automatically switch between SIMs based on coverage or availability (Settings &gt; Cellular &gt; Cellular Data &gt; Allow Cellular Data Switching).<a href="https://support.apple.com/en-us/108898"></a></li>
          <li>Label SIMs (e.g., “Macao SIM” for unrestricted access, “China Telecom” for local services) and manually select which SIM handles data for specific tasks.</li>
        </ul>
      </li>
      <li><strong>Manual Traffic Separation</strong>: You can manually switch the active data SIM in Settings to direct all cellular traffic through either the Macao SIM (to bypass GFW) or the China Telecom SIM (for local services subject to GFW). However, iOS does not provide an API to dynamically route traffic to a specific SIM based on app or destination without user intervention.</li>
    </ul>
  </li>
  <li><strong>Per-App VPN (NetworkExtension)</strong>:
    <ul>
      <li>iOS supports per-app VPN configurations through the <code class="language-plaintext highlighter-rouge">NEAppProxyProvider</code> or <code class="language-plaintext highlighter-rouge">NEAppRule</code> classes in the NetworkExtension framework, typically used in enterprise settings (e.g., Managed App Configurations).</li>
      <li><strong>Use Case</strong>: You could configure a per-app VPN to route traffic from specific apps (e.g., YouTube, Google) through a VPN tunnel using the Macao SIM’s data connection to bypass GFW restrictions, while other apps use the China Telecom SIM for local services.</li>
      <li><strong>Requirements</strong>: This requires a custom VPN app or an enterprise Mobile Device Management (MDM) solution, which is complex to implement for individual developers. Additionally, you’d need to ensure the Macao SIM is set as the active data SIM when the VPN is in use.</li>
    </ul>
  </li>
  <li><strong>URLSession and Custom Networking</strong>:
    <ul>
      <li>The <code class="language-plaintext highlighter-rouge">URLSession</code> API allows you to configure network requests with specific cellular interfaces using <code class="language-plaintext highlighter-rouge">allowsCellularAccess</code> or by binding to a specific network interface.</li>
      <li><strong>Use Case</strong>: You can programmatically disable cellular access for certain requests (forcing Wi-Fi or another interface) or use a VPN to route traffic. However, binding specific requests to a particular SIM’s cellular interface is not directly supported; you’d need to rely on the system’s active data SIM setting.</li>
      <li><strong>Workaround</strong>: Combine <code class="language-plaintext highlighter-rouge">URLSession</code> with a VPN configured to use the Macao SIM’s data to route traffic to servers outside China.</li>
    </ul>
  </li>
</ol>

<h3 id="handling-gfw-restrictions-with-dual-sims">Handling GFW Restrictions with Dual SIMs</h3>

<p>The Great Firewall of China (GFW) blocks access to many foreign websites and services (e.g., Google, YouTube, WhatsApp) when using mainland Chinese carriers like China Telecom, as their traffic is routed through China’s censored infrastructure. In contrast, a Macao SIM (e.g., from CTM or Three Macao) routes traffic through Macao’s independent networks, which are not subject to GFW censorship (except for China Telecom Macao, which enforces GFW restrictions). Here’s how you can leverage this with a Macao SIM and a China Telecom SIM:<a href="https://www.getnomad.app/blog/do-esims-work-in-china"></a><a href="https://prepaid-data-sim-card.fandom.com/wiki/China"></a><a href="https://prepaid-data-sim-card.fandom.com/wiki/Macau"></a></p>

<ol>
  <li><strong>Macao SIM for Unrestricted Access</strong>:
    <ul>
      <li>Use the Macao SIM as the default cellular data plan for apps or services blocked by the GFW (e.g., Google, YouTube).</li>
      <li><strong>Configuration</strong>:
        <ul>
          <li>Go to Settings &gt; Cellular &gt; Cellular Data and select the Macao SIM.</li>
          <li>Ensure data roaming is enabled for the Macao SIM when in mainland China, as it will route traffic through Macao’s network, bypassing GFW.<a href="https://www.flyertalk.com/forum/china/2113715-sim-card-bypass-great-firewall.html"></a><a href="https://www.reddit.com/r/shanghai/comments/10c9fqc/can_phone_data_roaming_from_overseas_bypass_the/"></a></li>
          <li>Optionally, configure a VPN (e.g., using <code class="language-plaintext highlighter-rouge">NEVPNManager</code>) to further secure traffic, though a Macao SIM typically doesn’t require a VPN to access blocked services.</li>
        </ul>
      </li>
      <li><strong>API Support</strong>: Use <code class="language-plaintext highlighter-rouge">CTTelephonyNetworkInfo</code> to confirm the Macao SIM is active for data (<code class="language-plaintext highlighter-rouge">dataServiceIdentifier</code> property) and monitor its state.</li>
    </ul>
  </li>
  <li><strong>China Telecom SIM for Local Services</strong>:
    <ul>
      <li>Use the China Telecom SIM for local apps and services (e.g., WeChat, Alipay) that require a Chinese phone number or are optimized for mainland networks.</li>
      <li><strong>Configuration</strong>:
        <ul>
          <li>Manually switch to the China Telecom SIM in Settings &gt; Cellular &gt; Cellular Data when accessing local services.</li>
          <li>Be aware that traffic on this SIM will be subject to GFW restrictions, blocking access to many foreign sites unless a VPN is used.</li>
        </ul>
      </li>
      <li><strong>API Support</strong>: Use <code class="language-plaintext highlighter-rouge">CTCellularData</code> to monitor cellular data usage and ensure the correct SIM is active. You can also use <code class="language-plaintext highlighter-rouge">NEVPNManager</code> to configure a VPN for specific apps to bypass GFW on the China Telecom SIM, though VPN reliability in China is inconsistent due to active blocking.<a href="https://www.flyertalk.com/forum/china/2113715-sim-card-bypass-great-firewall.html"></a></li>
    </ul>
  </li>
  <li><strong>Practical Workflow for Traffic Separation</strong>:
    <ul>
      <li><strong>Manual Switching</strong>: For simplicity, switch the active data SIM in Settings based on the task (e.g., Macao SIM for international apps, China Telecom SIM for local apps). This is the most straightforward approach but requires user intervention.</li>
      <li><strong>VPN for China Telecom SIM</strong>: If you need to access blocked services while using the China Telecom SIM, configure a VPN using <code class="language-plaintext highlighter-rouge">NEVPNManager</code>. Note that many VPNs (e.g., ExpressVPN, NordVPN) may be unreliable in China due to GFW blocking, so test providers like Astrill or custom solutions beforehand. Some eSIM providers (e.g., Holafly, ByteSIM) offer built-in VPNs that can be activated to bypass restrictions.<a href="https://www.flyertalk.com/forum/china/2113715-sim-card-bypass-great-firewall.html"></a><a href="https://www.reddit.com/r/chinalife/comments/1ebjcxi/can_you_use_esims_to_get_around_the_firewall/"></a><a href="https://esim.holafly.com/internet/mobile-internet-china/"></a></li>
      <li><strong>Per-App VPN</strong>: For advanced use, develop a custom app using <code class="language-plaintext highlighter-rouge">NEAppProxyProvider</code> to route specific app traffic through a VPN when the China Telecom SIM is active, while allowing other apps to use the Macao SIM directly.</li>
      <li><strong>Automation Limitations</strong>: iOS does not provide an API to programmatically switch the active data SIM based on app or destination URL. You’d need to rely on user-initiated SIM switching or a VPN to manage traffic routing.</li>
    </ul>
  </li>
</ol>

<h3 id="steps-to-implement-traffic-separation">Steps to Implement Traffic Separation</h3>

<ol>
  <li><strong>Set Up Dual SIM</strong>:
    <ul>
      <li>Ensure your iPhone supports Dual SIM (e.g., iPhone XS or later with iOS 12.1 or later).<a href="https://support.apple.com/en-us/109317"></a></li>
      <li>Insert the Macao SIM and China Telecom SIM (or configure an eSIM for one of them).</li>
      <li>Go to Settings &gt; Cellular, label the plans (e.g., “Macao” and “China Telecom”), and set the default data SIM (e.g., Macao for unrestricted access).<a href="https://support.apple.com/en-us/108898"></a></li>
    </ul>
  </li>
  <li><strong>Configure Cellular Data Settings</strong>:
    <ul>
      <li>Disable “Allow Cellular Data Switching” to prevent automatic SIM switching, giving you manual control over which SIM is used for data (Settings &gt; Cellular &gt; Cellular Data &gt; Allow Cellular Data Switching).<a href="https://support.apple.com/en-us/108898"></a></li>
      <li>Use <code class="language-plaintext highlighter-rouge">CTTelephonyNetworkInfo</code> to programmatically verify which SIM is active for data in your app.</li>
    </ul>
  </li>
  <li><strong>Implement VPN for GFW Bypass</strong>:
    <ul>
      <li>For the China Telecom SIM, configure a VPN using <code class="language-plaintext highlighter-rouge">NEVPNManager</code> or a third-party VPN app (e.g., Astrill, Holafly’s built-in VPN) to bypass GFW restrictions.</li>
      <li>For the Macao SIM, a VPN may not be necessary, as its traffic is routed outside China’s censored infrastructure.<a href="https://prepaid-data-sim-card.fandom.com/wiki/Macau"></a><a href="https://www.reddit.com/r/shanghai/comments/10c9fqc/can_phone_data_roaming_from_overseas_bypass_the/"></a></li>
    </ul>
  </li>
  <li><strong>Monitor and Manage Traffic</strong>:
    <ul>
      <li>Use <code class="language-plaintext highlighter-rouge">CTCellularData</code> to monitor cellular data usage and ensure the correct SIM is being used.</li>
      <li>For advanced routing, explore <code class="language-plaintext highlighter-rouge">NEPacketTunnelProvider</code> to create a custom VPN that selectively routes traffic based on app or destination, though this requires significant development effort.</li>
    </ul>
  </li>
  <li><strong>Test and Optimize</strong>:
    <ul>
      <li>Test connectivity in mainland China with both SIMs to ensure the Macao SIM bypasses GFW as expected and the China Telecom SIM works for local services.</li>
      <li>Verify VPN performance on the China Telecom SIM, as GFW actively blocks many VPN protocols.<a href="https://www.flyertalk.com/forum/china/2113715-sim-card-bypass-great-firewall.html"></a></li>
    </ul>
  </li>
</ol>

<h3 id="limitations-and-challenges">Limitations and Challenges</h3>

<ul>
  <li><strong>No Native API for Dynamic SIM Routing</strong>: iOS does not provide an API to dynamically route traffic to a specific SIM based on app, URL, or destination. You must manually switch the active data SIM or use a VPN to manage traffic.</li>
  <li><strong>GFW VPN Blocking</strong>: The GFW actively blocks many VPN protocols (e.g., IPsec, PPTP), and even SSL-based VPNs may be rate-limited if detected. A Macao SIM is often more reliable for bypassing GFW without a VPN.<a href="https://www.flyertalk.com/forum/china/2113715-sim-card-bypass-great-firewall.html"></a></li>
  <li><strong>China Telecom SIM Restrictions</strong>: China Telecom’s CDMA-based network may have compatibility issues with some foreign phones, though its LTE/5G network is more widely compatible. Additionally, its traffic is subject to GFW censorship, requiring a VPN for blocked services.<a href="https://esim.holafly.com/sim-card/china-sim-card/"></a><a href="https://yesim.app/blog/mobile-internet-and-sim-card-in-china/"></a></li>
  <li><strong>Real-Name Registration</strong>: Both Macao and China Telecom SIMs may require real-name registration (e.g., passport details), which can complicate setup.<a href="https://prepaid-data-sim-card.fandom.com/wiki/Macau"></a><a href="https://prepaid-data-sim-card.fandom.com/wiki/China"></a></li>
  <li><strong>Performance</strong>: Roaming on a Macao SIM in mainland China may result in slower speeds compared to a local China Telecom SIM, especially in rural areas.<a href="https://www.flyertalk.com/forum/china/2113715-sim-card-bypass-great-firewall.html"></a></li>
</ul>

<h3 id="recommendations">Recommendations</h3>

<ul>
  <li><strong>Primary Strategy</strong>: Use the Macao SIM as the default cellular data plan for accessing blocked services, as it naturally bypasses GFW by routing traffic through Macao’s uncensored networks. Switch to the China Telecom SIM for local apps like WeChat or Alipay that require a Chinese number or are optimized for mainland networks.<a href="https://prepaid-data-sim-card.fandom.com/wiki/Macau"></a><a href="https://www.reddit.com/r/shanghai/comments/10c9fqc/can_phone_data_roaming_from_overseas_bypass_the/"></a></li>
  <li><strong>VPN as Backup</strong>: For the China Telecom SIM, use a reliable VPN provider (e.g., Astrill, or eSIMs with built-in VPNs like Holafly or ByteSIM) to access blocked services. Pre-install and test the VPN before entering China, as downloading VPN apps in China may be restricted.<a href="https://esim.holafly.com/internet/mobile-internet-china/"></a><a href="https://bytesim.com/blogs/esim/mobile-internet-china"></a><a href="https://prepaid-data-sim-card.fandom.com/wiki/China"></a></li>
  <li><strong>Development Effort</strong>: If you’re building an app, use <code class="language-plaintext highlighter-rouge">NetworkExtension</code> to implement a custom VPN for selective traffic routing, but note that this is complex and may require enterprise-level permissions. For most users, manual SIM switching combined with a VPN is sufficient.</li>
  <li><strong>Pre-Travel Setup</strong>: Purchase and activate both SIMs (or eSIMs) before arriving in China, as local policies may restrict purchasing eSIMs in mainland China. For example, providers like Nomad or Holafly allow pre-purchase and activation of eSIMs with built-in GFW bypass.<a href="https://www.getnomad.app/blog/do-esims-work-in-china"></a><a href="https://www.getnomad.app/blog/do-esims-work-in-china"></a><a href="https://esim.holafly.com/internet/mobile-internet-china/"></a></li>
</ul>

<h3 id="example-code-snippet">Example Code Snippet</h3>

<p>Below is a basic example of using <code class="language-plaintext highlighter-rouge">CTTelephonyNetworkInfo</code> to check the active cellular plan and <code class="language-plaintext highlighter-rouge">NEVPNManager</code> to configure a VPN for the China Telecom SIM:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">CoreTelephony</span>
<span class="kd">import</span> <span class="kt">NetworkExtension</span>

<span class="c1">// Check active cellular plan</span>
<span class="kd">func</span> <span class="nf">checkActiveCellularPlan</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">networkInfo</span> <span class="o">=</span> <span class="kt">CTTelephonyNetworkInfo</span><span class="p">()</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">dataService</span> <span class="o">=</span> <span class="n">networkInfo</span><span class="o">.</span><span class="n">serviceCurrentRadioAccessTechnology</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">serviceIdentifier</span><span class="p">,</span> <span class="n">rat</span><span class="p">)</span> <span class="k">in</span> <span class="n">dataService</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Service: </span><span class="se">\(</span><span class="n">serviceIdentifier</span><span class="se">)</span><span class="s">, Radio Access Technology: </span><span class="se">\(</span><span class="n">rat</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="c1">// Identify which SIM is active (e.g., Macao or China Telecom)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Configure VPN for China Telecom SIM</span>
<span class="kd">func</span> <span class="nf">setupVPN</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">vpnManager</span> <span class="o">=</span> <span class="kt">NEVPNManager</span><span class="o">.</span><span class="nf">shared</span><span class="p">()</span>
    <span class="n">vpnManager</span><span class="o">.</span><span class="n">loadFromPreferences</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Failed to load VPN preferences: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
        
        <span class="k">let</span> <span class="nv">vpnProtocol</span> <span class="o">=</span> <span class="kt">NEVPNProtocolIKEv2</span><span class="p">()</span>
        <span class="n">vpnProtocol</span><span class="o">.</span><span class="n">serverAddress</span> <span class="o">=</span> <span class="s">"vpn.example.com"</span> <span class="c1">// Replace with your VPN server</span>
        <span class="n">vpnProtocol</span><span class="o">.</span><span class="n">remoteIdentifier</span> <span class="o">=</span> <span class="s">"vpn.example.com"</span>
        <span class="n">vpnProtocol</span><span class="o">.</span><span class="n">authenticationMethod</span> <span class="o">=</span> <span class="o">.</span><span class="n">certificate</span> <span class="c1">// Configure as needed</span>
        
        <span class="n">vpnManager</span><span class="o">.</span><span class="n">protocolConfiguration</span> <span class="o">=</span> <span class="n">vpnProtocol</span>
        <span class="n">vpnManager</span><span class="o">.</span><span class="n">isEnabled</span> <span class="o">=</span> <span class="kc">true</span>
        
        <span class="n">vpnManager</span><span class="o">.</span><span class="n">saveToPreferences</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">error</span> <span class="o">=</span> <span class="n">error</span> <span class="p">{</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"Failed to save VPN preferences: </span><span class="se">\(</span><span class="n">error</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"VPN configured successfully"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="conclusion">Conclusion</h3>

<p>While iOS does not offer a native API to dynamically route traffic to specific SIMs based on app or destination, you can achieve traffic separation by:</p>
<ol>
  <li>Using the Macao SIM for unrestricted access to bypass GFW without a VPN.</li>
  <li>Using the China Telecom SIM for local services, paired with a VPN (configured via <code class="language-plaintext highlighter-rouge">NEVPNManager</code> or a third-party app) to access blocked services.</li>
  <li>Manually switching the active data SIM in Settings for different tasks.</li>
  <li>Optionally, developing a custom VPN solution with <code class="language-plaintext highlighter-rouge">NetworkExtension</code> for per-app traffic routing, though this is complex.</li>
</ol>

<p>For the simplest approach, rely on the Macao SIM for GFW-blocked services and switch to the China Telecom SIM for local needs, pre-installing a reliable VPN for the latter. Always test configurations before traveling to China, as GFW policies and VPN reliability can change rapidly.<a href="https://www.flyertalk.com/forum/china/2113715-sim-card-bypass-great-firewall.html"></a><a href="https://prepaid-data-sim-card.fandom.com/wiki/China"></a></p>

<p>If you need further clarification or assistance with specific API implementations, let me know!</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
