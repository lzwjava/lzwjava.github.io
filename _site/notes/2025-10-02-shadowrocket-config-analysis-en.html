<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Shadowrocket Configuration File Analysis</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Shadowrocket Configuration File Analysis | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Shadowrocket Configuration File Analysis" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-10-02-shadowrocket-config-analysis-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-10-02-shadowrocket-config-analysis-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Shadowrocket Configuration File Analysis" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"Shadowrocket Configuration File Analysis","url":"https://lzwjava.github.io/notes/2025-10-02-shadowrocket-config-analysis-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=b02927194c03e0ffa5c9c53c506e757265427e0f">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=b02927194c03e0ffa5c9c53c506e757265427e0f" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Shadowrocket Configuration File Analysis | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-10-02-shadowrocket-config-analysis-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-10-02-shadowrocket-config-analysis-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/shadowrocket-config-analysis-en" selected>English</option>
        <option value="/shadowrocket-config-analysis-zh" >中文</option>
        <option value="/shadowrocket-config-analysis-ja" >日本語</option>
        <option value="/shadowrocket-config-analysis-es" >Español</option>
        <option value="/shadowrocket-config-analysis-hi" >हिंदी</option>
        <option value="/shadowrocket-config-analysis-fr" >Français</option>
        <option value="/shadowrocket-config-analysis-de" >Deutsch</option>
        <option value="/shadowrocket-config-analysis-ar" >العربية</option>
        <option value="/shadowrocket-config-analysis-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>This appears to be a configuration file for Shadowrocket, a rule-based proxy app for iOS (similar to tools like Surge or Quantumult). It’s structured as a text-based config file that defines how the app routes traffic, handles DNS, applies rules, and performs rewrites or MITM (man-in-the-middle) interception. The file is dated “2025-10-02 20:25:43,” which could be a timestamp or placeholder.</p>

<p>I’ll explain it section by section, breaking down each part, what it does, and why it might be configured this way. This config seems optimized for users in regions with internet restrictions (e.g., China), routing certain global/f blocked services through a proxy server while keeping local/domestic traffic direct for better speed and to avoid unnecessary redirection. It’s not a complete setup— you’d still need to configure a proxy server (e.g., via Shadowsocks, V2Ray, etc.) separately in the app, and this config references external rule-sets that auto-update from GitHub.</p>

<h3 id="key-assumptions-and-notes">Key Assumptions and Notes</h3>
<ul>
  <li><strong>Proxy Setup</strong>: This config assumes you have a working proxy server configured in Shadowrocket (e.g., SOCKS5, HTTP, or encrypted protocols). Without that, “PROXY” rules won’t work.</li>
  <li><strong>Purpose</strong>: It looks like it’s for circumventing censorship (e.g., Great Firewall in China). AI services (like OpenAI/ChatGPT) are proxied, while Chinese domains/IPs go direct to avoid throttling.</li>
  <li><strong>TUN Mode</strong>: References “tun” (tunnel mode) for routing all traffic through the device.</li>
  <li><strong>External Dependencies</strong>: Some rules load from GitHub URLs (e.g., rule lists). Ensure you trust these sources, as they can update automatically.</li>
  <li>If anything’s unclear or you need help applying it, let me know details about your setup.</li>
</ul>

<h3 id="section-breakdown">Section Breakdown</h3>

<h4 id="general"><strong>[General]</strong></h4>
<p>This sets global app behaviors, DNS resolution, and network routing. It’s like the “preferences” or “system settings” for Shadowrocket.</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">bypass-system = true</code>: Ignore iOS’s system proxy settings. Shadowrocket handles all proxying itself instead of relying on system-wide configs.</p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">skip-proxy = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,localhost,*.local,captive.apple.com,*.ccb.com,*.abchina.com.cn,*.psbc.com,www.baidu.com</code>: A comma-separated list of domains/IP ranges to <strong>always route directly</strong> (no proxy). This includes:
    <ul>
      <li>Private networks (e.g., home Wi-Fi IPs like 192.168.x.x).</li>
      <li>Local domains (*.local) and localhost.</li>
      <li>Apple’s captive portal check.</li>
      <li>Chinese bank domains (*.ccb.com for China Construction Bank, *.abchina.com.cn for Agricultural Bank of China, *.psbc.com for Postal Savings Bank).</li>
      <li>Baidu (www.baidu.com), a major Chinese search engine.</li>
      <li><em>Why?</em> Domestic Chinese sites (especially banks and search) are accessible without proxy and might be throttled or flagged if routed through one.</li>
    </ul>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">tun-excluded-routes = 10.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 192.168.0.0/16, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 255.255.255.255/32, 239.255.255.250/32</code>: In tunnel (TUN) mode, these IP ranges are <strong>excluded</strong> from the proxy tunnel. This prevents interference with local/routing traffic like loopback IPs, multicast, and test ranges.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">dns-server = https://doh.pub/dns-query,https://dns.alidns.com/dns-query,223.5.5.5,119.29.29.29</code>: Prioritized list of DNS resolvers for proxy traffic. These are DoH (DNS over HTTPS) servers and plain DNS (Tencent’s 119.29.29.29 and Aliyun’s 223.5.5.5). It starts with encrypted/public ones (doh.pub and alidns.com) for privacy/security.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">fallback-dns-server = system</code>: If the primary DNS fails, fall back to iOS’s system DNS.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">ipv6 = true</code>: Enable IPv6 support. <code class="language-plaintext highlighter-rouge">prefer-ipv6 = false</code>: Prefer IPv4 over IPv6 for connections (e.g., stability or compatibility).</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">dns-direct-system = false</code>: Don’t use system DNS for direct connections—use the configured DNS instead.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">icmp-auto-reply = true</code>: Automatically reply to ICMP (ping) requests. Useful for connectivity checks.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">always-reject-url-rewrite = false</code>: Allow URL rewrites (used later in the config) to be triggered.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">private-ip-answer = true</code>: Allow DNS responses with private IPs (e.g., your router).</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">dns-direct-fallback-proxy = true</code>: If a direct DNS query fails, retry via proxy.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">tun-included-routes = </code>: (Empty) No custom routes included in TUN mode—use defaults.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">always-real-ip = </code>: (Empty) No forced real IP exposure—standard behavior.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">hijack-dns = 8.8.8.8:53,8.8.4.4:53</code>: Intercept DNS traffic from Google’s public DNS (8.8.8.8/8.8.4.4 on port 53) and route it through the proxy. This forcibly uses your configured DNS instead of public ones, which might be blocked or monitored.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">udp-policy-not-supported-behaviour = REJECT</code>: If UDP traffic isn’t supported by a policy, reject it instead of allowing.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">include = </code>: (Empty) No additional config files included.</p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">update-url = </code>: (Empty) No automatic config updates from a URL.</li>
</ul>

<h4 id="rule"><strong>[Rule]</strong></h4>
<p>This defines traffic routing rules, processed in order. It’s like an ACL (access control list) telling Shadowrocket what to proxy, what to send direct, based on domains, keywords, GEOIP, etc. If no rule matches, it falls to <code class="language-plaintext highlighter-rouge">FINAL,DIRECT</code>.</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">DOMAIN-SUFFIX,anthropic.com,PROXY</code>: Route all subdomains of anthropic.com through the proxy (e.g., api.anthropic.com). Anthropic is an AI company—probably to bypass blocks.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">DOMAIN-SUFFIX,chatgpt.com,PROXY</code>: Route ChatGPT domains through proxy. ChatGPT is often restricted in certain regions.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">DOMAIN-SUFFIX,openai.com,PROXY</code>: Route OpenAI domains through proxy (similar reason).</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">DOMAIN-SUFFIX,googleapis.com,PROXY</code>: Route Google’s API services through proxy (might be for accessing Google services indirectly).</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">DOMAIN-SUFFIX,zhs.futbol,DIRECT</code>: Route this specific domain (likely a sports site in Spanish/Chinese) directly.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">RULE-SET,https://github.com/lzwjava/lzwjava.github.io/raw/refs/heads/main/scripts/auto-ss-config/AI.list,PROXY</code>: Load an external rule-set from GitHub (a list of AI-related domains) and proxy them. This auto-updates and expands the AI proxy rules.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Lan/Lan.list,DIRECT</code>: Load a rule-set for local network (LAN) domains and route them direct. Avoids proxying home/internal traffic.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">DOMAIN-KEYWORD,cn,DIRECT</code>: Any domain containing the keyword “cn” (e.g., anything.cn) goes direct. Useful for Chinese sites.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">GEOIP,CN,DIRECT</code>: Any IP geolocated to China (CN) goes direct. Prevents proxying domestic traffic, which is fast and unrestricted.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">FINAL,DIRECT</code>: Default action—if no rules match, route directly. Keeps most traffic unproxied for efficiency.</p>
  </li>
</ul>

<p><em>Overall Effect</em>: This is a “proxy for blocked globals” setup. AI/ChatGPT/OpenAI traffic is forced through VPN/proxy to bypass regional restrictions, while Chinese/local stuff stays direct.</p>

<h4 id="host"><strong>[Host]</strong></h4>
<p>Manual host mappings (like a local hosts file).</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">localhost = 127.0.0.1</code>: Map “localhost” to the loopback IP. Standard—ensures app can connect to local services.</li>
</ul>

<h4 id="url-rewrite"><strong>[URL Rewrite]</strong></h4>
<p>Rewrites incoming URLs before requests are made. Uses regex matching.</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">^https?://(www.)?g.cn https://www.google.com 302</code>: Rewrite any HTTP/HTTPS URL for g.cn (or www.g.cn) to redirect to google.com with a 302 status (temporary redirect). g.cn is Google’s China domain— this bypasses it.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">^https?://(www.)?google.cn https://www.google.com 302</code>: Same for google.cn to google.com. China often blocks or redirects google.com, so this forces a clean redirect.</p>
  </li>
</ul>

<p><em>Why?</em> In censored regions, google.cn might serve altered/banned results. This ensures you hit the global Google site directly.</p>

<h4 id="mitm"><strong>[MITM]</strong></h4>
<p>Man-in-the-middle settings for intercepting and modifying HTTPS traffic (requires a root CA certificate in Shadowrocket).</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">hostname = *.google.cn</code>: Intercept traffic for any subdomain of google.cn. Combined with the URL rewrite, this might decrypt/redirect traffic for Google CN domains.</li>
</ul>

<p><em>Why?</em> This could be to enforce the rewrites or handle certificate pinning issues in China, where google.cn uses different certs.</p>

<h3 id="how-to-use-this-config">How to Use This Config</h3>
<ol>
  <li><strong>Import</strong>: In Shadowrocket, import this as a config file.</li>
  <li><strong>Proxy Server</strong>: Add your actual proxy (e.g., Shadowsocks server) under the “Servers” section—rules like “PROXY” depend on it.</li>
  <li><strong>Enable</strong>: Switch to this config and enable tunnel mode (VPN) if needed.</li>
  <li><strong>CA Cert</strong>: For MITM, install and trust Shadowrocket’s CA if not already done.</li>
  <li><strong>Test</strong>: Check sites like whatismyipaddress.com to see if IPs/routing work as expected. Monitor for slow Chinese sites.</li>
  <li><strong>Troubleshooting</strong>: If rule-sets fail to load, they might be rate-limited or changed. IPv6 prefs might need toggling for connectivity.</li>
</ol>

<h3 id="potential-issuessecurity-notes">Potential Issues/Security Notes</h3>
<ul>
  <li><strong>Privacy</strong>: Exposed rule-sets (GitHub links) could leak what you’re routing. MITM can intercept sensitive traffic—only use trusted CAs.</li>
  <li><strong>Updates</strong>: Rule-sets auto-load; if GitHub is blocked, use a proxy for them.</li>
  <li><strong>Future Date</strong>: The config is labeled Oct 2025—might be a typo or future-proofing, but no features depend on it.</li>
  <li><strong>Legality</strong>: Proxying for censorship evasion is fine in some places but restricted in others—use at your own risk.</li>
  <li>If you share error logs or what you’re trying to achieve, I can refine advice!</li>
</ul>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    
      <p class="model">x-ai/grok-code-fast-1</p>
    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
