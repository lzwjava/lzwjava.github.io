<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Nginx Configuration</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Nginx Configuration | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Nginx Configuration" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-05-18-nginx-config-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-05-18-nginx-config-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Nginx Configuration" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"Nginx Configuration","url":"https://lzwjava.github.io/notes/2025-05-18-nginx-config-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=df5e7e020ae8c11c79863287dafd6241b170e292">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=df5e7e020ae8c11c79863287dafd6241b170e292" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Nginx Configuration | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-05-18-nginx-config-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-05-18-nginx-config-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/nginx-config-en" selected>English</option>
        <option value="/nginx-config-zh" >中文</option>
        <option value="/nginx-config-ja" >日本語</option>
        <option value="/nginx-config-es" >Español</option>
        <option value="/nginx-config-hi" >हिंदी</option>
        <option value="/nginx-config-fr" >Français</option>
        <option value="/nginx-config-de" >Deutsch</option>
        <option value="/nginx-config-ar" >العربية</option>
        <option value="/nginx-config-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>Using <code class="language-plaintext highlighter-rouge">server_name 0.0.0.0</code> in your Nginx configuration is not the correct approach, as <code class="language-plaintext highlighter-rouge">server_name</code> is meant to match domain names or hostnames, not IP addresses. Additionally, <code class="language-plaintext highlighter-rouge">0.0.0.0</code> is a special address that means “listen on all interfaces,” which is handled by the <code class="language-plaintext highlighter-rouge">listen</code> directive, not <code class="language-plaintext highlighter-rouge">server_name</code>. Since the IP address of your laptop (the server) changes dynamically, you need a solution that accommodates this. Below are steps to fix your Nginx configuration and handle the dynamic IP issue effectively.</p>

<h3 id="problem">Problem</h3>
<p>Your laptop’s IP address (e.g., <code class="language-plaintext highlighter-rouge">192.168.1.27</code>) changes due to DHCP, but you want your Nginx server to reliably serve movie files regardless of the IP address. Hardcoding the IP in the <code class="language-plaintext highlighter-rouge">server_name</code> directive or client configuration causes issues when the IP changes.</p>

<h3 id="solution">Solution</h3>
<p>To make your Nginx server work seamlessly despite the changing IP, you can use one or more of the following approaches:</p>

<h4 id="1-use-a-dynamic-dns-ddns-or-local-hostname">1. Use a Dynamic DNS (DDNS) or Local Hostname</h4>
<p>Instead of relying on the IP address, use a hostname for your server. This can be achieved by:</p>
<ul>
  <li><strong>Using the laptop’s hostname</strong>: Most operating systems assign a default hostname (e.g., <code class="language-plaintext highlighter-rouge">mylaptop.local</code> on macOS or <code class="language-plaintext highlighter-rouge">mylaptop</code> on Linux/Windows). You can use this in your Nginx <code class="language-plaintext highlighter-rouge">server_name</code> and access the server via the hostname.</li>
  <li><strong>Setting up a local DNS or mDNS</strong>: Use a service like Avahi (for Linux) or Bonjour (for macOS/Windows) to resolve the laptop’s hostname locally (e.g., <code class="language-plaintext highlighter-rouge">mylaptop.local</code>).</li>
  <li><strong>Using a DDNS service</strong>: If you need access from outside your local network, services like No-IP or DynDNS can assign a domain name (e.g., <code class="language-plaintext highlighter-rouge">mymovies.ddns.net</code>) that tracks your laptop’s IP, even if it changes.</li>
</ul>

<p><strong>Nginx Configuration Example</strong>:</p>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">mylaptop.local</span><span class="p">;</span> <span class="c1"># Use the laptop's hostname or DDNS name</span>
    <span class="kn">root</span> <span class="n">/path/to/movies</span><span class="p">;</span>
    <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
        <span class="kn">try_files</span> <span class="nv">$uri</span> <span class="nv">$uri</span><span class="n">/</span> <span class="n">/index.html</span><span class="p">;</span> <span class="c1"># Adjust as needed for your setup</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<ul>
  <li>Replace <code class="language-plaintext highlighter-rouge">mylaptop.local</code> with your laptop’s actual hostname or DDNS name.</li>
  <li>On clients, access the server via <code class="language-plaintext highlighter-rouge">http://mylaptop.local</code> instead of the IP address.</li>
</ul>

<p><strong>How to Find Your Laptop’s Hostname</strong>:</p>
<ul>
  <li>Linux/macOS: Run <code class="language-plaintext highlighter-rouge">hostname</code> in a terminal.</li>
  <li>Windows: Run <code class="language-plaintext highlighter-rouge">hostname</code> in Command Prompt or check in Settings &gt; System &gt; About.</li>
  <li>Ensure your network supports mDNS (most home routers do via Bonjour/Avahi).</li>
</ul>

<h4 id="2-bind-nginx-to-all-interfaces">2. Bind Nginx to All Interfaces</h4>
<p>If you want Nginx to listen on all available IP addresses (useful when the IP changes), configure the <code class="language-plaintext highlighter-rouge">listen</code> directive to use <code class="language-plaintext highlighter-rouge">0.0.0.0</code> or omit the address entirely (Nginx defaults to all interfaces).</p>

<p><strong>Nginx Configuration Example</strong>:</p>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span> <span class="c1"># Listens on all interfaces (equivalent to 0.0.0.0:80)</span>
    <span class="kn">server_name</span> <span class="s">_</span><span class="p">;</span> <span class="c1"># Matches any hostname or IP</span>
    <span class="kn">root</span> <span class="n">/path/to/movies</span><span class="p">;</span>
    <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
        <span class="kn">try_files</span> <span class="nv">$uri</span> <span class="nv">$uri</span><span class="n">/</span> <span class="n">/index.html</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<ul>
  <li><code class="language-plaintext highlighter-rouge">listen 80</code>: Binds to all interfaces, so the server responds to requests on any IP assigned to the laptop.</li>
  <li><code class="language-plaintext highlighter-rouge">server_name _</code>: A catch-all that matches any hostname or IP used to access the server.</li>
  <li>Clients can access the server using any of the laptop’s current IPs (e.g., <code class="language-plaintext highlighter-rouge">http://192.168.1.27</code> or <code class="language-plaintext highlighter-rouge">http://192.168.1.28</code>) or the hostname.</li>
</ul>

<h4 id="3-assign-a-static-ip-to-the-laptop">3. Assign a Static IP to the Laptop</h4>
<p>To avoid the IP address changing, configure your laptop to use a static IP address within your local network (e.g., <code class="language-plaintext highlighter-rouge">192.168.1.27</code>). This can be done via:</p>
<ul>
  <li><strong>Router settings</strong>: Reserve an IP for your laptop’s MAC address in your router’s DHCP settings (often called “DHCP reservation”).</li>
  <li><strong>Laptop network settings</strong>: Manually set a static IP outside the DHCP range (e.g., <code class="language-plaintext highlighter-rouge">192.168.1.200</code>) in your laptop’s network configuration.</li>
</ul>

<p>Once the IP is static, update your Nginx configuration:</p>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="nf">192.168.1.27</span><span class="p">:</span><span class="mi">80</span><span class="p">;</span> <span class="c1"># Bind to the static IP</span>
    <span class="kn">server_name</span> <span class="mi">192</span><span class="s">.168.1.27</span><span class="p">;</span> <span class="c1"># Optional, if clients use the IP directly</span>
    <span class="kn">root</span> <span class="n">/path/to/movies</span><span class="p">;</span>
    <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
        <span class="kn">try_files</span> <span class="nv">$uri</span> <span class="nv">$uri</span><span class="n">/</span> <span class="n">/index.html</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<ul>
  <li>Clients access the server via <code class="language-plaintext highlighter-rouge">http://192.168.1.27</code>.</li>
</ul>

<h4 id="4-use-a-reverse-proxy-or-load-balancer-advanced">4. Use a Reverse Proxy or Load Balancer (Advanced)</h4>
<p>If you have multiple servers or want a more robust setup, you can set up a reverse proxy (e.g., another Nginx instance) on a device with a static IP that forwards requests to your laptop. The proxy can use the laptop’s hostname or dynamically resolve its IP.</p>

<h3 id="recommended-approach">Recommended Approach</h3>
<p>For simplicity, I recommend <strong>Option 1 (Using the laptop’s hostname)</strong> or <strong>Option 2 (Binding to all interfaces)</strong>:</p>
<ul>
  <li><strong>Option 1</strong> is ideal if your network supports mDNS and you want a user-friendly URL (e.g., <code class="language-plaintext highlighter-rouge">http://mylaptop.local</code>). It requires minimal configuration and works well for local networks.</li>
  <li><strong>Option 2</strong> is best if you don’t want to rely on hostnames and are okay with clients using the current IP (which you can find via <code class="language-plaintext highlighter-rouge">ip addr</code> or <code class="language-plaintext highlighter-rouge">ifconfig</code> on the laptop).</li>
</ul>

<h3 id="steps-to-implement">Steps to Implement</h3>
<ol>
  <li><strong>Edit Nginx Configuration</strong>:
    <ul>
      <li>Open your Nginx config file (e.g., <code class="language-plaintext highlighter-rouge">/etc/nginx/sites-available/default</code> or <code class="language-plaintext highlighter-rouge">/etc/nginx/conf.d/movies.conf</code>).</li>
      <li>Apply one of the configurations above (e.g., use <code class="language-plaintext highlighter-rouge">server_name mylaptop.local</code> or <code class="language-plaintext highlighter-rouge">server_name _</code> with <code class="language-plaintext highlighter-rouge">listen 80</code>).</li>
      <li>Save the file.</li>
    </ul>
  </li>
  <li><strong>Test the Configuration</strong>:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>nginx <span class="nt">-t</span>
</code></pre></div>    </div>
    <p>Ensure there are no syntax errors.</p>
  </li>
  <li><strong>Reload Nginx</strong>:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl reload nginx
</code></pre></div>    </div>
    <p>Or, if <code class="language-plaintext highlighter-rouge">systemctl</code> isn’t available:</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>nginx <span class="nt">-s</span> reload
</code></pre></div>    </div>
  </li>
  <li><strong>Test Access</strong>:
    <ul>
      <li>From a client device, access the server using the hostname (e.g., <code class="language-plaintext highlighter-rouge">http://mylaptop.local</code>) or the laptop’s current IP (e.g., <code class="language-plaintext highlighter-rouge">http://192.168.1.27</code>).</li>
      <li>Verify that movie files are served correctly.</li>
    </ul>
  </li>
  <li><strong>Optional: Check Laptop’s IP</strong>:
If you need to find the laptop’s current IP:
    <ul>
      <li>Linux/macOS: <code class="language-plaintext highlighter-rouge">ip addr show</code> or <code class="language-plaintext highlighter-rouge">ifconfig</code>.</li>
      <li>Windows: <code class="language-plaintext highlighter-rouge">ipconfig</code> in Command Prompt.</li>
    </ul>
  </li>
</ol>

<h3 id="additional-tips">Additional Tips</h3>
<ul>
  <li><strong>Firewall</strong>: Ensure the laptop’s firewall allows HTTP traffic on port 80 (or 443 for HTTPS). For example, on Linux with <code class="language-plaintext highlighter-rouge">ufw</code>:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ufw allow 80/tcp
</code></pre></div>    </div>
  </li>
  <li><strong>File Permissions</strong>: Verify that Nginx has permission to read the movie files:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo chown</span> <span class="nt">-R</span> www-data:www-data /path/to/movies
<span class="nb">sudo chmod</span> <span class="nt">-R</span> 755 /path/to/movies
</code></pre></div>    </div>
    <p>(Adjust <code class="language-plaintext highlighter-rouge">www-data</code> to the user Nginx runs as, e.g., <code class="language-plaintext highlighter-rouge">nginx</code> on some systems.)</p>
  </li>
  <li><strong>HTTPS (Optional)</strong>: For security, consider setting up HTTPS with a self-signed certificate or Let’s Encrypt, especially if accessing the server outside your local network.</li>
  <li><strong>Debugging</strong>: If the server isn’t accessible, check Nginx logs:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo tail</span> <span class="nt">-f</span> /var/log/nginx/error.log
<span class="nb">sudo tail</span> <span class="nt">-f</span> /var/log/nginx/access.log
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="why-server_name-0000-doesnt-work">Why <code class="language-plaintext highlighter-rouge">server_name 0.0.0.0</code> Doesn’t Work</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">server_name</code> is used to match the <code class="language-plaintext highlighter-rouge">Host</code> header in HTTP requests, not to specify the listening interface. Setting <code class="language-plaintext highlighter-rouge">server_name 0.0.0.0</code> would expect clients to send a <code class="language-plaintext highlighter-rouge">Host: 0.0.0.0</code> header, which they won’t.</li>
  <li>To listen on all interfaces, use <code class="language-plaintext highlighter-rouge">listen 0.0.0.0:80</code> (or just <code class="language-plaintext highlighter-rouge">listen 80</code>), and to match any hostname, use <code class="language-plaintext highlighter-rouge">server_name _</code>.</li>
</ul>

<h3 id="final-configuration-example-simplest">Final Configuration Example (Simplest)</h3>
<p>For a local movie server that works regardless of IP changes:</p>
<div class="language-nginx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">server</span> <span class="p">{</span>
    <span class="kn">listen</span> <span class="mi">80</span><span class="p">;</span>
    <span class="kn">server_name</span> <span class="s">_</span><span class="p">;</span>
    <span class="kn">root</span> <span class="n">/path/to/movies</span><span class="p">;</span>
    <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
        <span class="kn">autoindex</span> <span class="no">on</span><span class="p">;</span> <span class="c1"># Enables directory listing for easy browsing</span>
        <span class="kn">try_files</span> <span class="nv">$uri</span> <span class="nv">$uri</span><span class="n">/</span> <span class="n">/index.html</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<ul>
  <li>Save, test, and reload Nginx as described above.</li>
  <li>Access via <code class="language-plaintext highlighter-rouge">http://&lt;laptop-ip&gt;</code> or <code class="language-plaintext highlighter-rouge">http://&lt;laptop-hostname&gt;</code>.</li>
</ul>

<p>This setup ensures your movie server remains accessible even when the laptop’s IP changes, without relying on a specific IP in the configuration.</p>

<p>If you have further details (e.g., your current Nginx config, OS, or network setup), I can tailor the solution further. Let me know!</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
