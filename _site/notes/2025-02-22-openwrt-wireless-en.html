<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Configuring OpenWRT as a Wireless Bridge</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Configuring OpenWRT as a Wireless Bridge | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Configuring OpenWRT as a Wireless Bridge" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-02-22-openwrt-wireless-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-02-22-openwrt-wireless-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Configuring OpenWRT as a Wireless Bridge" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Zhiwei Li"},"description":"李智维","headline":"Configuring OpenWRT as a Wireless Bridge","url":"https://lzwjava.github.io/notes/2025-02-22-openwrt-wireless-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=78a21ab62037d9586f0a43ba85b64b7dfe7ac0e1">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=78a21ab62037d9586f0a43ba85b64b7dfe7ac0e1" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Configuring OpenWRT as a Wireless Bridge | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-02-22-openwrt-wireless-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-02-22-openwrt-wireless-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/openwrt-wireless-en" selected>English</option>
        <option value="/openwrt-wireless-zh" >中文</option>
        <option value="/openwrt-wireless-ja" >日本語</option>
        <option value="/openwrt-wireless-es" >Español</option>
        <option value="/openwrt-wireless-hi" >हिंदी</option>
        <option value="/openwrt-wireless-fr" >Français</option>
        <option value="/openwrt-wireless-de" >Deutsch</option>
        <option value="/openwrt-wireless-ar" >العربية</option>
        <option value="/openwrt-wireless-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>With the help of Grok, I am still trying to work on the following.</p>

<hr />

<p>To address your query, “is it right?” regarding the steps to configure OpenWRT as a wireless bridge, and to provide the correct ways to achieve this, I’ll evaluate the steps you provided and refine them based on best practices for OpenWRT. Your goal is to set up your OpenWRT router (e.g., Xiaomi Mi Router 4C with OpenWRT 24.10.0) as a wireless bridge—connecting wirelessly to an existing Wi-Fi network as a client and sharing that connection via its own Wi-Fi access point (AP) or Ethernet ports, keeping all devices on the same subnet as the main router.</p>

<p>Your provided steps are mostly accurate but miss a critical adjustment to ensure proper bridging and avoid IP conflicts. Below, I’ll first assess your configuration and then present the correct, complete steps to achieve a wireless bridge in OpenWRT using the simple bridge method (client + AP on the same bridge), which aligns with your intent. I’ll also briefly mention an alternative using <code class="language-plaintext highlighter-rouge">relayd</code> for cases where the simple method fails, though your setup likely supports the simpler approach.</p>

<hr />

<h3 id="evaluation-of-your-provided-steps"><strong>Evaluation of Your Provided Steps</strong></h3>

<p>Your steps aim to:</p>
<ol>
  <li>Connect the OpenWRT router as a client to an existing Wi-Fi network.</li>
  <li>Set up an AP to broadcast a new Wi-Fi network.</li>
  <li>Bridge the client and AP interfaces to share the internet.</li>
</ol>

<p>Here’s a quick review:</p>
<ul>
  <li><strong>Step 1: Log In to LuCI</strong> - Correct, accessing the web interface is the starting point.</li>
  <li><strong>Step 2: Configure the Wireless Client</strong> - Joining the target Wi-Fi and assigning it to the <code class="language-plaintext highlighter-rouge">lan</code> network is a good start, but the default <code class="language-plaintext highlighter-rouge">lan</code> configuration in OpenWRT (static IP, typically 192.168.1.1) could conflict with the main router if it uses the same IP. This needs adjustment.</li>
  <li><strong>Step 3: Configure the Wireless AP</strong> - Setting up an AP and assigning it to <code class="language-plaintext highlighter-rouge">lan</code> is correct for bridging, but relies on the <code class="language-plaintext highlighter-rouge">lan</code> interface being properly configured.</li>
  <li><strong>Step 4: Bridge the Networks</strong> - Assigning both interfaces to <code class="language-plaintext highlighter-rouge">lan</code> theoretically bridges them, but without disabling the DHCP server or adjusting the IP settings, it may not work seamlessly.</li>
  <li><strong>Step 5: Test the Setup</strong> - Testing is essential, but success depends on earlier steps being fully correct.</li>
</ul>

<p><strong>What’s Missing or Wrong?</strong></p>
<ul>
  <li>By default, OpenWRT’s <code class="language-plaintext highlighter-rouge">lan</code> interface has a static IP (e.g., 192.168.1.1) and runs a DHCP server. If the main router is also 192.168.1.1, this causes an IP conflict. You need to set the <code class="language-plaintext highlighter-rouge">lan</code> interface to DHCP client mode to obtain an IP from the main router and disable the local DHCP server to let the main router assign IPs to all devices.</li>
  <li>The firewall zone assignment to <code class="language-plaintext highlighter-rouge">lan</code> is fine for simplicity, but the IP configuration is critical.</li>
</ul>

<p>With this in mind, your steps are “mostly right” but incomplete without adjusting the <code class="language-plaintext highlighter-rouge">lan</code> interface settings. Below are the corrected steps.</p>

<hr />

<h3 id="correct-steps-to-configure-openwrt-as-a-wireless-bridge-simple-bridge-method"><strong>Correct Steps to Configure OpenWRT as a Wireless Bridge (Simple Bridge Method)</strong></h3>

<p>This method sets up your OpenWRT router to connect to an existing Wi-Fi network as a client and share that connection via its own AP or Ethernet ports, all on the same subnet as the main router (e.g., 192.168.1.x). Here’s how to do it via the LuCI web interface:</p>

<h4 id="prerequisites"><strong>Prerequisites</strong></h4>
<ul>
  <li>OpenWRT is installed (e.g., version 24.10.0 on Xiaomi Mi Router 4C).</li>
  <li>You have the SSID, password, and encryption type (e.g., WPA2-PSK) of the main Wi-Fi network.</li>
  <li>Access to LuCI at <code class="language-plaintext highlighter-rouge">http://192.168.1.1</code> (or the current IP) and your admin credentials.</li>
</ul>

<h4 id="step-1-log-in-to-luci"><strong>Step 1: Log In to LuCI</strong></h4>
<ul>
  <li>Open a browser and navigate to <code class="language-plaintext highlighter-rouge">http://192.168.1.1</code>.</li>
  <li>Log in with your OpenWRT username (default: <code class="language-plaintext highlighter-rouge">root</code>) and password (set during installation).</li>
</ul>

<h4 id="step-2-configure-the-wireless-client"><strong>Step 2: Configure the Wireless Client</strong></h4>
<ul>
  <li><strong>Navigate to Wireless Settings:</strong>
    <ul>
      <li>Go to <strong>Network &gt; Wireless</strong>.</li>
    </ul>
  </li>
  <li><strong>Scan for Networks:</strong>
    <ul>
      <li>Locate your radio (e.g., <code class="language-plaintext highlighter-rouge">radio0</code> for 2.4 GHz on the Mi Router 4C).</li>
      <li>Click <strong>Scan</strong> to list available Wi-Fi networks.</li>
    </ul>
  </li>
  <li><strong>Join the Main Wi-Fi Network:</strong>
    <ul>
      <li>Find the SSID of your main router’s Wi-Fi.</li>
      <li>Click <strong>Join Network</strong>.</li>
    </ul>
  </li>
  <li><strong>Configure Client Settings:</strong>
    <ul>
      <li><strong>Wi-Fi Key:</strong> Enter the password for the main Wi-Fi.</li>
      <li><strong>Network:</strong> Select or set to <code class="language-plaintext highlighter-rouge">lan</code> (this adds the client interface to the <code class="language-plaintext highlighter-rouge">br-lan</code> bridge).</li>
      <li><strong>Firewall Zone:</strong> Assign to <code class="language-plaintext highlighter-rouge">lan</code> (this simplifies traffic rules for bridging).</li>
      <li><strong>Interface Name:</strong> LuCI may suggest <code class="language-plaintext highlighter-rouge">wwan</code>; you can leave it or rename it to <code class="language-plaintext highlighter-rouge">client</code> for clarity, but ensure it’s tied to <code class="language-plaintext highlighter-rouge">lan</code>.</li>
    </ul>
  </li>
  <li><strong>Save &amp; Apply:</strong>
    <ul>
      <li>Click <strong>Save &amp; Apply</strong> to connect to the main Wi-Fi.</li>
    </ul>
  </li>
</ul>

<h4 id="step-3-adjust-the-lan-interface-to-dhcp-client"><strong>Step 3: Adjust the LAN Interface to DHCP Client</strong></h4>
<ul>
  <li><strong>Go to Interfaces:</strong>
    <ul>
      <li>Navigate to <strong>Network &gt; Interfaces</strong>.</li>
    </ul>
  </li>
  <li><strong>Edit the LAN Interface:</strong>
    <ul>
      <li>Click <strong>Edit</strong> next to the <code class="language-plaintext highlighter-rouge">lan</code> interface.</li>
    </ul>
  </li>
  <li><strong>Set Protocol to DHCP Client:</strong>
    <ul>
      <li>In the <strong>Protocol</strong> dropdown, select <strong>DHCP client</strong>.</li>
      <li>This allows the <code class="language-plaintext highlighter-rouge">br-lan</code> bridge (which now includes the wireless client) to obtain an IP address from the main router’s DHCP server (e.g., 192.168.1.x).</li>
    </ul>
  </li>
  <li><strong>Disable DHCP Server:</strong>
    <ul>
      <li>Since <code class="language-plaintext highlighter-rouge">lan</code> is now a DHCP client, the local DHCP server is automatically disabled. Verify this under <strong>Advanced Settings</strong> or <strong>DHCP and DNS</strong>—ensure “Ignore interface” is checked if the option appears.</li>
    </ul>
  </li>
  <li><strong>Save &amp; Apply:</strong>
    <ul>
      <li>Click <strong>Save &amp; Apply</strong>. The router will now request an IP from the main router.</li>
    </ul>
  </li>
</ul>

<h4 id="step-4-configure-the-wireless-access-point"><strong>Step 4: Configure the Wireless Access Point</strong></h4>
<ul>
  <li><strong>Add a New Wireless Network:</strong>
    <ul>
      <li>Go back to <strong>Network &gt; Wireless</strong>.</li>
      <li>Click <strong>Add</strong> under the same radio (e.g., <code class="language-plaintext highlighter-rouge">radio0</code>) to create a new wireless interface.</li>
    </ul>
  </li>
  <li><strong>Set Up the AP:</strong>
    <ul>
      <li><strong>ESSID:</strong> Choose a name for your Wi-Fi (e.g., <code class="language-plaintext highlighter-rouge">OpenWRT_AP</code>).</li>
      <li><strong>Mode:</strong> Set to <strong>Access Point (AP)</strong>.</li>
      <li><strong>Network:</strong> Assign to <code class="language-plaintext highlighter-rouge">lan</code> (this bridges it with the client interface and Ethernet ports).</li>
    </ul>
  </li>
  <li><strong>Configure Security:</strong>
    <ul>
      <li>Go to the <strong>Wireless Security</strong> tab.</li>
      <li><strong>Encryption:</strong> Select <strong>WPA2-PSK</strong> (recommended).</li>
      <li><strong>Key:</strong> Set a strong password for your AP.</li>
    </ul>
  </li>
  <li><strong>Save &amp; Apply:</strong>
    <ul>
      <li>Click <strong>Save &amp; Apply</strong>. Your router will now broadcast its own Wi-Fi.</li>
    </ul>
  </li>
</ul>

<h4 id="step-5-verify-the-bridge"><strong>Step 5: Verify the Bridge</strong></h4>
<ul>
  <li><strong>Check Interfaces:</strong>
    <ul>
      <li>Go to <strong>Network &gt; Interfaces</strong>.</li>
      <li>Ensure the <code class="language-plaintext highlighter-rouge">lan</code> interface lists both the wireless client (e.g., <code class="language-plaintext highlighter-rouge">wlan0</code>) and AP (e.g., <code class="language-plaintext highlighter-rouge">wlan0-1</code>) under the <code class="language-plaintext highlighter-rouge">br-lan</code> bridge.</li>
    </ul>
  </li>
  <li><strong>Check IP Assignment:</strong>
    <ul>
      <li>Go to <strong>Status &gt; Overview</strong>.</li>
      <li>Note the IP address assigned to the <code class="language-plaintext highlighter-rouge">lan</code> interface by the main router (e.g., <code class="language-plaintext highlighter-rouge">192.168.1.100</code>).</li>
    </ul>
  </li>
</ul>

<h4 id="step-6-test-the-setup"><strong>Step 6: Test the Setup</strong></h4>
<ul>
  <li><strong>Test Wi-Fi:</strong>
    <ul>
      <li>Connect a device to the <code class="language-plaintext highlighter-rouge">OpenWRT_AP</code> Wi-Fi.</li>
      <li>Verify it receives an IP from the main router (e.g., <code class="language-plaintext highlighter-rouge">192.168.1.x</code>) and has internet access.</li>
    </ul>
  </li>
  <li><strong>Test Ethernet (if applicable):</strong>
    <ul>
      <li>Plug a device into one of the router’s LAN ports.</li>
      <li>Confirm it gets an IP from the main router and connects to the internet.</li>
    </ul>
  </li>
  <li><strong>Access LuCI:</strong>
    <ul>
      <li>Use the new IP address (e.g., <code class="language-plaintext highlighter-rouge">http://192.168.1.100</code>) to access the OpenWRT interface.</li>
    </ul>
  </li>
</ul>

<hr />

<h3 id="why-this-works"><strong>Why This Works</strong></h3>
<ul>
  <li>Assigning both the client and AP interfaces to the <code class="language-plaintext highlighter-rouge">lan</code> network adds them to the <code class="language-plaintext highlighter-rouge">br-lan</code> bridge, allowing layer 2 traffic to flow between them and the main router.</li>
  <li>Setting <code class="language-plaintext highlighter-rouge">lan</code> to DHCP client ensures the OpenWRT router gets a unique IP from the main router, avoiding conflicts (e.g., with <code class="language-plaintext highlighter-rouge">192.168.1.1</code>), and disables the local DHCP server so the main router manages all IP assignments.</li>
  <li>Devices connected to the AP or Ethernet ports appear on the same subnet as the main network (e.g., <code class="language-plaintext highlighter-rouge">192.168.1.x</code>), fulfilling the wireless bridge requirement.</li>
</ul>

<hr />

<h3 id="alternative-method-using-relayd-pseudo-bridge"><strong>Alternative Method: Using relayd (Pseudo-Bridge)</strong></h3>
<p>If the simple bridge method fails (e.g., due to wireless driver limitations), you can use the <code class="language-plaintext highlighter-rouge">relayd</code> package for a pseudo-bridge. This creates a routed setup where the OpenWRT router’s clients are on a different subnet, but it’s more reliable on some hardware. Here’s a brief overview:</p>

<ol>
  <li><strong>Install relayd:</strong>
    <ul>
      <li>Go to <strong>System &gt; Software</strong>, search for <code class="language-plaintext highlighter-rouge">relayd</code>, and install it.</li>
    </ul>
  </li>
  <li><strong>Configure Wireless Client:</strong>
    <ul>
      <li>Join the main Wi-Fi, but assign it to a new interface (e.g., <code class="language-plaintext highlighter-rouge">wwan</code>) set to DHCP client.</li>
    </ul>
  </li>
  <li><strong>Configure LAN:</strong>
    <ul>
      <li>Set <code class="language-plaintext highlighter-rouge">lan</code> to a static IP (e.g., <code class="language-plaintext highlighter-rouge">192.168.2.1</code>) with its own DHCP server.</li>
    </ul>
  </li>
  <li><strong>Set Up relayd:</strong>
    <ul>
      <li>Configure <code class="language-plaintext highlighter-rouge">relayd</code> via SSH or LuCI (under <strong>Network &gt; Hostnames</strong>) to relay between <code class="language-plaintext highlighter-rouge">wwan</code> and <code class="language-plaintext highlighter-rouge">lan</code>.</li>
    </ul>
  </li>
  <li><strong>Configure AP:</strong>
    <ul>
      <li>Set the AP on the <code class="language-plaintext highlighter-rouge">lan</code> network.</li>
    </ul>
  </li>
  <li><strong>Test:</strong>
    <ul>
      <li>Devices on <code class="language-plaintext highlighter-rouge">OpenWRT_AP</code> will be on <code class="language-plaintext highlighter-rouge">192.168.2.x</code>, with internet relayed from the main router.</li>
    </ul>
  </li>
</ol>

<p><strong>Note:</strong> This isn’t a true bridge (different subnets), so use it only if the simple method doesn’t work. For your Xiaomi Mi Router 4C with OpenWRT 24.10.0, the simple bridge should suffice.</p>

<hr />

<h3 id="conclusion"><strong>Conclusion</strong></h3>
<p>Your original steps are <strong>mostly correct</strong> but incomplete without setting the <code class="language-plaintext highlighter-rouge">lan</code> interface to DHCP client mode to avoid IP conflicts and ensure proper bridging. The corrected steps above provide a reliable way to configure OpenWRT as a wireless bridge. If you follow them, your router will connect to the main Wi-Fi and share that connection seamlessly via its AP or Ethernet ports, all on the same subnet. Test the setup, and if issues arise (rare with modern OpenWRT), consider the <code class="language-plaintext highlighter-rouge">relayd</code> alternative.</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
