<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>JaCoCo Coverage Strategy for Python Tests</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>JaCoCo Coverage Strategy for Python Tests | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="JaCoCo Coverage Strategy for Python Tests" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="李智维" />
<meta property="og:description" content="李智维" />
<link rel="canonical" href="https://lzwjava.github.io/notes/2025-09-08-jacoco-python-coverage-en" />
<meta property="og:url" content="https://lzwjava.github.io/notes/2025-09-08-jacoco-python-coverage-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-09-08T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="JaCoCo Coverage Strategy for Python Tests" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2025-09-08T00:00:00+08:00","datePublished":"2025-09-08T00:00:00+08:00","description":"李智维","headline":"JaCoCo Coverage Strategy for Python Tests","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/notes/2025-09-08-jacoco-python-coverage-en"},"url":"https://lzwjava.github.io/notes/2025-09-08-jacoco-python-coverage-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=d66c28abfa5a877fa50828b94257da140924d149">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=d66c28abfa5a877fa50828b94257da140924d149" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       JaCoCo Coverage Strategy for Python Tests | Generated by AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="notes/2025-09-08-jacoco-python-coverage-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>notes2025-09-08-jacoco-python-coverage-en.md</span> -->
      

      <!-- <span></span> -->

      
        <a href="#" class="button">2025.10</a>
      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/jacoco-python-coverage-en" selected>English</option>
        <option value="/jacoco-python-coverage-zh" >中文</option>
        <option value="/jacoco-python-coverage-ja" >日本語</option>
        <option value="/jacoco-python-coverage-es" >Español</option>
        <option value="/jacoco-python-coverage-hi" >हिंदी</option>
        <option value="/jacoco-python-coverage-fr" >Français</option>
        <option value="/jacoco-python-coverage-de" >Deutsch</option>
        <option value="/jacoco-python-coverage-ar" >العربية</option>
        <option value="/jacoco-python-coverage-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <h1 id="analysis-and-strategy-for-jacoco-coverage-with-python-integration-tests">Analysis and Strategy for JaCoCo Coverage with Python Integration Tests</h1>

<h2 id="current-situation-analysis">Current Situation Analysis</h2>

<p>You’ve set up a multi-module Maven project with:</p>
<ul>
  <li>Parent POM (<code class="language-plaintext highlighter-rouge">PlaygroundLib</code>)</li>
  <li><code class="language-plaintext highlighter-rouge">PlaygroundUtils</code> module (JAR with utility classes)</li>
  <li><code class="language-plaintext highlighter-rouge">PlaygroundWeb</code> module (WAR with Spring MVC controllers)</li>
</ul>

<p>Your goal is to use Python’s <code class="language-plaintext highlighter-rouge">unittest</code> to test API endpoints and generate coverage reports for the Java code. The challenge is that Python tests live outside the Java project, and you need to run Jetty to serve the application during testing.</p>

<h2 id="problems-with-the-current-approach">Problems with the Current Approach</h2>

<ol>
  <li>
    <p><strong>Multiple Runs Issue</strong>: You’re running <code class="language-plaintext highlighter-rouge">PlaygroundWeb</code> multiple times to generate separate coverage reports for different modules, which is inefficient.</p>
  </li>
  <li>
    <p><strong>Scalability Concern</strong>: This approach won’t scale well with more modules. For a project with 10 modules, you’d need 10 separate runs.</p>
  </li>
  <li>
    <p><strong>Coverage Fragmentation</strong>: Per-module reports make it harder to get a holistic view of coverage across the entire application.</p>
  </li>
</ol>

<h2 id="recommended-strategy">Recommended Strategy</h2>

<h3 id="1-consolidated-coverage-collection-approach">1. Consolidated Coverage Collection Approach</h3>

<p>Instead of running the application multiple times, I recommend:</p>

<ol>
  <li><strong>Run the web application once</strong> with JaCoCo agent attached</li>
  <li><strong>Execute all Python integration tests</strong> against this single instance</li>
  <li><strong>Generate a consolidated coverage report</strong> that includes all modules</li>
</ol>

<p>This approach is more efficient and provides a unified view of coverage across your entire application.</p>

<h3 id="2-implementation-steps">2. Implementation Steps</h3>

<h4 id="parent-pom-playgroundlib-modifications">Parent POM (<code class="language-plaintext highlighter-rouge">PlaygroundLib</code>) Modifications</h4>

<p>Add a profile for integration testing with JaCoCo:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;profiles&gt;</span>
    <span class="nt">&lt;profile&gt;</span>
        <span class="nt">&lt;id&gt;</span>integration-test<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;build&gt;</span>
            <span class="nt">&lt;plugins&gt;</span>
                <span class="nt">&lt;plugin&gt;</span>
                    <span class="nt">&lt;groupId&gt;</span>org.jacoco<span class="nt">&lt;/groupId&gt;</span>
                    <span class="nt">&lt;artifactId&gt;</span>jacoco-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
                    <span class="nt">&lt;executions&gt;</span>
                        <span class="nt">&lt;execution&gt;</span>
                            <span class="nt">&lt;id&gt;</span>merge<span class="nt">&lt;/id&gt;</span>
                            <span class="nt">&lt;phase&gt;</span>post-integration-test<span class="nt">&lt;/phase&gt;</span>
                            <span class="nt">&lt;goals&gt;</span>
                                <span class="nt">&lt;goal&gt;</span>merge<span class="nt">&lt;/goal&gt;</span>
                            <span class="nt">&lt;/goals&gt;</span>
                            <span class="nt">&lt;configuration&gt;</span>
                                <span class="nt">&lt;fileSets&gt;</span>
                                    <span class="nt">&lt;fileSet&gt;</span>
                                        <span class="nt">&lt;directory&gt;</span>${project.basedir}<span class="nt">&lt;/directory&gt;</span>
                                        <span class="nt">&lt;includes&gt;</span>
                                            <span class="nt">&lt;include&gt;</span>*/target/jacoco-it.exec<span class="nt">&lt;/include&gt;</span>
                                        <span class="nt">&lt;/includes&gt;</span>
                                    <span class="nt">&lt;/fileSet&gt;</span>
                                <span class="nt">&lt;/fileSets&gt;</span>
                                <span class="nt">&lt;destFile&gt;</span>${project.build.directory}/jacoco-merged.exec<span class="nt">&lt;/destFile&gt;</span>
                            <span class="nt">&lt;/configuration&gt;</span>
                        <span class="nt">&lt;/execution&gt;</span>
                        <span class="nt">&lt;execution&gt;</span>
                            <span class="nt">&lt;id&gt;</span>report-merged<span class="nt">&lt;/id&gt;</span>
                            <span class="nt">&lt;phase&gt;</span>verify<span class="nt">&lt;/phase&gt;</span>
                            <span class="nt">&lt;goals&gt;</span>
                                <span class="nt">&lt;goal&gt;</span>report<span class="nt">&lt;/goal&gt;</span>
                            <span class="nt">&lt;/goals&gt;</span>
                            <span class="nt">&lt;configuration&gt;</span>
                                <span class="nt">&lt;dataFile&gt;</span>${project.build.directory}/jacoco-merged.exec<span class="nt">&lt;/dataFile&gt;</span>
                                <span class="nt">&lt;outputDirectory&gt;</span>${project.reporting.outputDirectory}/jacoco-merged<span class="nt">&lt;/outputDirectory&gt;</span>
                            <span class="nt">&lt;/configuration&gt;</span>
                        <span class="nt">&lt;/execution&gt;</span>
                    <span class="nt">&lt;/executions&gt;</span>
                <span class="nt">&lt;/plugin&gt;</span>
            <span class="nt">&lt;/plugins&gt;</span>
        <span class="nt">&lt;/build&gt;</span>
    <span class="nt">&lt;/profile&gt;</span>
<span class="nt">&lt;/profiles&gt;</span>
</code></pre></div></div>

<h4 id="playgroundweb-pom-modifications">PlaygroundWeb POM Modifications</h4>

<p>Modify the JaCoCo agent configuration to include all modules:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.eclipse.jetty<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>jetty-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;executions&gt;</span>
        <span class="nt">&lt;execution&gt;</span>
            <span class="nt">&lt;id&gt;</span>start-jetty<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;phase&gt;</span>pre-integration-test<span class="nt">&lt;/phase&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
                <span class="nt">&lt;goal&gt;</span>start<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
                <span class="nt">&lt;daemon&gt;</span>true<span class="nt">&lt;/daemon&gt;</span>
                <span class="nt">&lt;jvmArgs&gt;</span>
                    -javaagent:${settings.localRepository}/org/jacoco/org.jacoco.agent/${jacoco.version}/org.jacoco.agent-${jacoco.version}-runtime.jar=destfile=${project.build.directory}/jacoco-it.exec,includes=org.lzw.*
                <span class="nt">&lt;/jvmArgs&gt;</span>
                <span class="c">&lt;!-- Rest of configuration remains the same --&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
        <span class="nt">&lt;/execution&gt;</span>
        <span class="c">&lt;!-- Rest of executions remain the same --&gt;</span>
    <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</code></pre></div></div>

<p>Note the addition of <code class="language-plaintext highlighter-rouge">includes=org.lzw.*</code> in the JaCoCo agent configuration. This ensures that all classes in the <code class="language-plaintext highlighter-rouge">org.lzw</code> package (across all modules) are included in the coverage report.</p>

<h3 id="3-execution-flow">3. Execution Flow</h3>

<p>The recommended execution flow would be:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Build all modules</span>
mvn clean <span class="nb">install</span>

<span class="c"># Run integration tests with coverage</span>
mvn verify <span class="nt">-Pintegration-test</span>
</code></pre></div></div>

<p>This will:</p>
<ol>
  <li>Compile all modules</li>
  <li>Start Jetty with JaCoCo agent attached</li>
  <li>Run Python integration tests</li>
  <li>Stop Jetty</li>
  <li>Generate a merged coverage report for all modules</li>
</ol>

<h3 id="4-scaling-to-larger-projects">4. Scaling to Larger Projects</h3>

<p>For a larger project with ten modules:</p>

<ol>
  <li><strong>Web modules</strong> (like <code class="language-plaintext highlighter-rouge">PlaygroundWeb</code>) would be configured to run the application with JaCoCo agent attached.</li>
  <li><strong>Utility modules</strong> (like <code class="language-plaintext highlighter-rouge">PlaygroundUtils</code>) would not need special configuration.</li>
  <li>The parent POM would handle merging coverage data from all modules.</li>
</ol>

<p>If you have multiple web modules that need to be tested independently, you could create separate Maven profiles for each web module and run integration tests for each separately, then merge all coverage data at the parent level.</p>

<h3 id="5-addressing-jacoco-complexity">5. Addressing JaCoCo Complexity</h3>

<p>To manage JaCoCo’s complexity:</p>

<ol>
  <li><strong>Encapsulate configuration</strong> in Maven profiles to keep the main POM clean</li>
  <li><strong>Document the process</strong> clearly so team members understand how to run tests and generate reports</li>
  <li><strong>Consider CI/CD automation</strong> to reduce manual complexity for developers</li>
</ol>

<h2 id="summary">Summary</h2>

<p>The recommended approach consolidates coverage collection by running the web application once with JaCoCo agent attached, executing all Python integration tests against this instance, and generating a consolidated coverage report. This approach is more efficient, scalable, and provides a unified view of coverage across your entire application.</p>

<p>This strategy should solve your current challenges and scale well as your project grows, while also simplifying the management of JaCoCo’s complexity.</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
