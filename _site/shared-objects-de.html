<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Gemeinsame Objekte in Mehreren Threads</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Gemeinsame Objekte in Mehreren Threads | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Gemeinsame Objekte in Mehreren Threads" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="de" />
<meta name="description" content="Lektion" />
<meta property="og:description" content="Lektion" />
<link rel="canonical" href="https://lzwjava.github.io/shared-objects-de" />
<meta property="og:url" content="https://lzwjava.github.io/shared-objects-de" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-28T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Gemeinsame Objekte in Mehreren Threads" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2025-01-28T00:00:00+08:00","datePublished":"2025-01-28T00:00:00+08:00","description":"Lektion","headline":"Gemeinsame Objekte in Mehreren Threads","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/shared-objects-de"},"url":"https://lzwjava.github.io/shared-objects-de"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=e277cad28da48c1929c214b7bfa87a0209f6e31c">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=e277cad28da48c1929c214b7bfa87a0209f6e31c" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Gemeinsame Objekte in Mehreren Threads | Original, von KI übersetzt
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/de/2025-01-28-shared-objects-de.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsde2025-01-28-shared-objects-de.md</span> -->
      

      <!-- <span>2025-01-28-shared-objects-de.md</span> -->

      
        

        
          
          <a href="#" class="button">2025.01</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/shared-objects-en" >English</option>
        <option value="/shared-objects-zh" >中文</option>
        <option value="/shared-objects-ja" >日本語</option>
        <option value="/shared-objects-es" >Español</option>
        <option value="/shared-objects-hi" >हिंदी</option>
        <option value="/shared-objects-fr" >Français</option>
        <option value="/shared-objects-de" selected>Deutsch</option>
        <option value="/shared-objects-ar" >العربية</option>
        <option value="/shared-objects-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <h2 id="lektion">Lektion</h2>

<p>Der Code zeigt einen intermittierenden Fehler, der sich unkonsistent manifestiert. Seine sporadische Natur macht es schwierig, ihn reproduzierbar und effektiv zu debuggen.</p>

<p>Dieses intermittierende Verhalten hängt damit zusammen, wie die <code class="language-plaintext highlighter-rouge">translate_markdown_file</code>-Funktion, insbesondere die <code class="language-plaintext highlighter-rouge">translate_front_matter</code>-Funktion, geteilte Daten behandelt. Diese Funktionen könnten geteilte Datenstrukturen, wie Wörterbücher oder Listen, ohne ordnungsgemäße Synchronisation lesen und ändern.</p>

<p>Wenn mehrere Threads gleichzeitig auf die gleichen Daten zugreifen und diese ändern, kann dies zu Rennenbedingungen führen. Rennenbedingungen treten auf, wenn der finale Zustand der Daten von der unvorhersehbaren Reihenfolge abhängt, in der die Threads ausgeführt werden. Dies kann zu Datenkorruption, unerwartetem Programmverhalten und den intermittierenden Fehlern führen, die Sie beobachten.</p>

<p>Um dies zu beheben, sollten Sie entweder vermeiden, zwischen Threads mutable Daten zu teilen, oder ordnungsgemäße Synchronisierungsmechanismen, wie Sperren, verwenden, um geteilte Daten zu schützen. In diesem Fall wird <code class="language-plaintext highlighter-rouge">front_matter_dict</code> in place geändert, was nicht thread-sicher ist. Die Lösung besteht darin, eine Kopie des Wörterbuchs vor dem Ändern zu erstellen. Dies wird bereits im Code durchgeführt, es ist jedoch wichtig zu verstehen, warum dies erforderlich ist.</p>

<h2 id="kontext">Kontext</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">with</span> <span class="n">concurrent</span><span class="p">.</span><span class="n">futures</span><span class="p">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">MAX_THREADS</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="n">futures</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">changed_files</span><span class="p">:</span>
            <span class="n">input_file</span> <span class="o">=</span> <span class="n">filename</span>

            <span class="k">for</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">languages</span><span class="p">:</span>

                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Übermittlung der Übersetzungsaufgabe für </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s"> an </span><span class="si">{</span><span class="n">lang</span><span class="si">}</span><span class="s">..."</span><span class="p">)</span>
                <span class="n">future</span> <span class="o">=</span> <span class="n">executor</span><span class="p">.</span><span class="n">submit</span><span class="p">(</span><span class="n">translate_markdown_file</span><span class="p">,</span> <span class="n">input_file</span><span class="p">,</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s">"_posts/</span><span class="si">{</span><span class="n">lang</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">".md"</span><span class="p">,</span> <span class="sa">f</span><span class="s">"-</span><span class="si">{</span><span class="n">lang</span><span class="si">}</span><span class="s">.md"</span><span class="p">)),</span> <span class="n">lang</span><span class="p">,</span> <span class="n">dry_run</span><span class="p">)</span>
                <span class="n">futures</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">concurrent</span><span class="p">.</span><span class="n">futures</span><span class="p">.</span><span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">future</span><span class="p">.</span><span class="n">result</span><span class="p">()</span>
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Ein Thread ist fehlgeschlagen: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="vorher">Vorher</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">translate_front_matter</span><span class="p">(</span><span class="n">front_matter</span><span class="p">,</span> <span class="n">target_language</span><span class="p">,</span> <span class="n">input_file</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Übersetzung der Frontmatter für: </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">front_matter</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Keine Frontmatter für: </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s"> gefunden"</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">front_matter_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">front_matter</span><span class="p">:</span>
            <span class="n">front_matter_dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="p">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">front_matter</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Frontmatter nach safe_load: </span><span class="si">{</span><span class="n">front_matter_dict</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">'title'</span> <span class="ow">in</span> <span class="n">front_matter_dict</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Übersetzung des Titels: </span><span class="si">{</span><span class="n">front_matter_dict</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">input_file</span> <span class="o">==</span> <span class="s">'original/2025-01-11-resume-en.md'</span> <span class="ow">and</span> <span class="n">target_language</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'zh'</span><span class="p">,</span> <span class="s">'fr'</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">front_matter_dict</span><span class="p">[</span><span class="s">'title'</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">translated_title</span> <span class="o">=</span> <span class="n">translate_text</span><span class="p">(</span><span class="n">front_matter_dict</span><span class="p">[</span><span class="s">'title'</span><span class="p">],</span> <span class="n">target_language</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">translated_title</span><span class="p">:</span>
                        <span class="n">translated_title</span> <span class="o">=</span> <span class="n">translated_title</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">translated_title</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="p">:</span>
                            <span class="n">translated_title</span> <span class="o">=</span> <span class="n">translated_title</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">front_matter_dict</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span> <span class="o">=</span> <span class="n">translated_title</span>
                        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Titelübersetzung abgeschlossen: </span><span class="si">{</span><span class="n">translated_title</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Übersetzung des Titels fehlgeschlagen für: </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Titel ist kein String, Übersetzung wird für: </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s"> übersprungen"</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Übersetzung des Titels für </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s"> zu </span><span class="si">{</span><span class="n">target_language</span><span class="si">}</span><span class="s"> wird übersprungen"</span><span class="p">)</span>
        <span class="c1"># Sprache immer auf target_language setzen
</span>
        <span class="c1"># Ermitteln, ob die Datei eine Übersetzung ist
</span>        <span class="n">original_lang</span> <span class="o">=</span> <span class="s">'en'</span> <span class="c1"># Standardmäßig Englisch
</span>        <span class="k">if</span> <span class="s">'lang'</span> <span class="ow">in</span> <span class="n">front_matter_dict</span><span class="p">:</span>
            <span class="n">original_lang</span> <span class="o">=</span> <span class="n">front_matter_dict</span><span class="p">[</span><span class="s">'lang'</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">target_language</span> <span class="o">!=</span> <span class="n">original_lang</span><span class="p">:</span>
            <span class="n">front_matter_dict</span><span class="p">[</span><span class="s">'lang'</span><span class="p">]</span> <span class="o">=</span> <span class="n">target_language</span>
            <span class="n">front_matter_dict</span><span class="p">[</span><span class="s">'translated'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Als übersetzt markiert: </span><span class="si">{</span><span class="n">target_language</span><span class="si">}</span><span class="s"> für: </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">front_matter_dict</span><span class="p">[</span><span class="s">'translated'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Nicht als übersetzt markiert für: </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="s">"---</span><span class="se">\n</span><span class="s">"</span> <span class="o">+</span> <span class="n">yaml</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">front_matter_dict</span><span class="p">,</span> <span class="n">allow_unicode</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="o">+</span> <span class="s">"---"</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Übersetzung der Frontmatter abgeschlossen für: </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">except</span> <span class="n">yaml</span><span class="p">.</span><span class="n">YAMLError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Fehler beim Parsen der Frontmatter: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">front_matter</span>
</code></pre></div></div>

<h2 id="danach">Danach</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">translate_front_matter</span><span class="p">(</span><span class="n">front_matter</span><span class="p">,</span> <span class="n">target_language</span><span class="p">,</span> <span class="n">input_file</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Übersetzung der Frontmatter für: </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">front_matter</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Keine Frontmatter für: </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s"> gefunden"</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">front_matter_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">front_matter</span><span class="p">:</span>
            <span class="n">front_matter_dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="p">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">front_matter</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Frontmatter nach safe_load: </span><span class="si">{</span><span class="n">front_matter_dict</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

        <span class="n">front_matter_dict_copy</span> <span class="o">=</span> <span class="n">front_matter_dict</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="s">'title'</span> <span class="ow">in</span> <span class="n">front_matter_dict_copy</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Übersetzung des Titels: </span><span class="si">{</span><span class="n">front_matter_dict_copy</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">input_file</span> <span class="o">==</span> <span class="s">'original/2025-01-11-resume-en.md'</span> <span class="ow">and</span> <span class="n">target_language</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'zh'</span><span class="p">,</span> <span class="s">'fr'</span><span class="p">]):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">front_matter_dict_copy</span><span class="p">[</span><span class="s">'title'</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">translated_title</span> <span class="o">=</span> <span class="n">translate_text</span><span class="p">(</span><span class="n">front_matter_dict_copy</span><span class="p">[</span><span class="s">'title'</span><span class="p">],</span> <span class="n">target_language</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">translated_title</span><span class="p">:</span>
                        <span class="n">translated_title</span> <span class="o">=</span> <span class="n">translated_title</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">translated_title</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">300</span><span class="p">:</span>
                            <span class="n">translated_title</span> <span class="o">=</span> <span class="n">translated_title</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">front_matter_dict_copy</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span> <span class="o">=</span> <span class="n">translated_title</span>
                        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Titelübersetzung abgeschlossen: </span><span class="si">{</span><span class="n">translated_title</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Übersetzung des Titels fehlgeschlagen für: </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Titel ist kein String, Übersetzung wird für: </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s"> übersprungen"</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Übersetzung des Titels für </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s"> zu </span><span class="si">{</span><span class="n">target_language</span><span class="si">}</span><span class="s"> wird übersprungen"</span><span class="p">)</span>
        <span class="c1"># Sprache immer auf target_language setzen
</span>
        <span class="n">front_matter_dict_copy</span><span class="p">[</span><span class="s">'lang'</span><span class="p">]</span> <span class="o">=</span> <span class="n">target_language</span>
        <span class="n">front_matter_dict_copy</span><span class="p">[</span><span class="s">'translated'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">result</span> <span class="o">=</span> <span class="s">"---</span><span class="se">\n</span><span class="s">"</span> <span class="o">+</span> <span class="n">yaml</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">front_matter_dict_copy</span><span class="p">,</span> <span class="n">allow_unicode</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="o">+</span> <span class="s">"---"</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Übersetzung der Frontmatter abgeschlossen für: </span><span class="si">{</span><span class="n">input_file</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">except</span> <span class="n">yaml</span><span class="p">.</span><span class="n">YAMLError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Fehler beim Parsen der Frontmatter: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">front_matter</span>
</code></pre></div></div>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-de" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
