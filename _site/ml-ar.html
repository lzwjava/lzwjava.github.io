<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>## مقدمة إلى تعلم الآلة</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>مقدمة إلى تعلم الآلة | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="مقدمة إلى تعلم الآلة" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="ar" />
<meta name="description" content="بما أننا نتعلم Python، فلا بد أن نتحدث أيضًا عن تعلم الآلة. لأن العديد من مكتباتها مكتوبة بلغة Python. لنبدأ بتثبيتها واللعب بها قليلاً." />
<meta property="og:description" content="بما أننا نتعلم Python، فلا بد أن نتحدث أيضًا عن تعلم الآلة. لأن العديد من مكتباتها مكتوبة بلغة Python. لنبدأ بتثبيتها واللعب بها قليلاً." />
<link rel="canonical" href="https://lzwjava.github.io/ml-ar" />
<meta property="og:url" content="https://lzwjava.github.io/ml-ar" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-12T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="مقدمة إلى تعلم الآلة" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2021-03-12T00:00:00+08:00","datePublished":"2021-03-12T00:00:00+08:00","description":"بما أننا نتعلم Python، فلا بد أن نتحدث أيضًا عن تعلم الآلة. لأن العديد من مكتباتها مكتوبة بلغة Python. لنبدأ بتثبيتها واللعب بها قليلاً.","headline":"مقدمة إلى تعلم الآلة","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/ml-ar"},"url":"https://lzwjava.github.io/ml-ar"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=e8544ebb8cd270e46ba5d6942d874dd40bd87619">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=e8544ebb8cd270e46ba5d6942d874dd40bd87619" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       ## مقدمة إلى تعلم الآلة | أصلي، ترجم بواسطة AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/ar/2021-03-12-ml-ar.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsar2021-03-12-ml-ar.md</span> -->
      

      <!-- <span>2021-03-12-ml-ar.md</span> -->

      
        

        
          
          <a href="#" class="button">2021.03</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/ml-en" >English</option>
        <option value="/ml-zh" >中文</option>
        <option value="/ml-ja" >日本語</option>
        <option value="/ml-es" >Español</option>
        <option value="/ml-hi" >हिंदी</option>
        <option value="/ml-fr" >Français</option>
        <option value="/ml-de" >Deutsch</option>
        <option value="/ml-ar" selected>العربية</option>
        <option value="/ml-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>بما أننا نتعلم <code class="language-plaintext highlighter-rouge">Python</code>، فلا بد أن نتحدث أيضًا عن تعلم الآلة. لأن العديد من مكتباتها مكتوبة بلغة Python. لنبدأ بتثبيتها واللعب بها قليلاً.</p>

<h2 id="tensorflow">Tensorflow</h2>

<p>قم بالتثبيت.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pip <span class="nb">install </span>tensorflow
ERROR: Could not find a version that satisfies the requirement tensorflow
ERROR: No matching distribution found <span class="k">for </span>tensorflow
</code></pre></div></div>

<p><strong>ترجمة:</strong></p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pip <span class="nb">install </span>tensorflow
خطأ: تعذر العثور على إصدار يتوافق مع المتطلب tensorflow
خطأ: لم يتم العثور على توزيع متطابق لـ tensorflow
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">type </span>python
python هو اسم مستعار لـ <span class="sb">`</span>/usr/local/Cellar/python@3.9/3.9.1_6/bin/python3<span class="s1">'
</span></code></pre></div></div>

<p>ومع ذلك، فإن <code class="language-plaintext highlighter-rouge">Tensorflow 2</code> يدعم فقط إصدارات <code class="language-plaintext highlighter-rouge">Python 3.5–3.8</code>. بينما نستخدم نحن الإصدار <code class="language-plaintext highlighter-rouge">3.9</code>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% <span class="nb">type </span>python3
python3 هو /usr/bin/python3
% python3 <span class="nt">-V</span>
Python 3.8.2
</code></pre></div></div>

<p>لاحظت أن الإصدار <code class="language-plaintext highlighter-rouge">3.8.2</code> من <code class="language-plaintext highlighter-rouge">python3</code> مثبت على نظامي. أين يتم تثبيت <code class="language-plaintext highlighter-rouge">pip</code> المقابل لهذا الإصدار من Python؟</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% python3 <span class="nt">-m</span> pip <span class="nt">-V</span>
pip 21.0.1 من /Users/lzw/Library/Python/3.8/lib/python/site-packages/pip <span class="o">(</span>python 3.8<span class="o">)</span>
</code></pre></div></div>

<p>النسخة المقابلة من <code class="language-plaintext highlighter-rouge">pip</code> موجودة هنا. لذا سأقوم بتعديل ملف <code class="language-plaintext highlighter-rouge">.zprofile</code>. مؤخرًا قمت بتغيير <code class="language-plaintext highlighter-rouge">shell</code> الخاص بي. ملف <code class="language-plaintext highlighter-rouge">.zprofile</code> يعادل ملف <code class="language-plaintext highlighter-rouge">.bash_profile</code> السابق. سأقوم بإضافة سطر.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">alias </span><span class="nv">pip3</span><span class="o">=</span>/Users/lzw/Library/Python/3.8/bin/pip3
</code></pre></div></div>

<p><strong>ملاحظة:</strong> النص أعلاه هو أمر في سطر الأوامر (shell command) يستخدم لإنشاء اسم مختصر (alias) لتنفيذ أمر <code class="language-plaintext highlighter-rouge">pip3</code> من مسار محدد. لا يحتاج هذا النص إلى ترجمة حيث أنه جزء من التعليمات البرمجية.</p>

<p>بهذه الطريقة، نستخدم <code class="language-plaintext highlighter-rouge">python3</code> و <code class="language-plaintext highlighter-rouge">pip3</code> للعب مع <code class="language-plaintext highlighter-rouge">Tensorflow</code>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% pip3 <span class="nb">install </span>tensorflow
...
تم تثبيت بنجاح: absl-py-0.12.0 astunparse-1.6.3 cachetools-4.2.1 certifi-2020.12.5 chardet-4.0.0 flatbuffers-1.12 gast-0.3.3 google-auth-1.27.1 google-auth-oauthlib-0.4.3 google-pasta-0.2.0 grpcio-1.32.0 h5py-2.10.0 idna-2.10 keras-preprocessing-1.1.2 markdown-3.3.4 numpy-1.19.5 oauthlib-3.1.0 opt-einsum-3.3.0 protobuf-3.15.6 pyasn1-0.4.8 pyasn1-modules-0.2.8 requests-2.25.1 requests-oauthlib-1.3.0 rsa-4.7.2 tensorboard-2.4.1 tensorboard-plugin-wit-1.8.0 tensorflow-2.4.1 tensorflow-estimator-2.4.0 termcolor-1.1.0 typing-extensions-3.7.4.3 urllib3-1.26.3 werkzeug-1.0.1 wheel-0.36.2 wrapt-1.12.1
</code></pre></div></div>

<p>تم تثبيت العديد من المكتبات. واستخدمت مثالًا من الموقع الرسمي.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
</code></pre></div></div>

<p>mnist = tf.keras.datasets.mnist</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="p">.</span><span class="n">load_data</span><span class="p">()</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span> <span class="o">=</span> <span class="n">x_train</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">x_test</span> <span class="o">/</span> <span class="mf">255.0</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">models</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="p">])</span>
</code></pre></div></div>

<p>تمثل الكود أعلاه بناء نموذج تسلسلي (Sequential) باستخدام مكتبة TensorFlow و Keras. النموذج يتكون من:</p>

<ol>
  <li><strong>طبقة Flatten</strong>: تقوم بتحويل البيانات ذات الشكل (28, 28) إلى مصفوفة أحادية البعد (784,).</li>
  <li><strong>طبقة Dense</strong>: طبقة عصبية كاملة الاتصال تحتوي على 128 عصبون وتستخدم دالة التنشيط ReLU.</li>
  <li><strong>طبقة Dropout</strong>: تقوم بإسقاط 20% من الوحدات العصبية بشكل عشوائي أثناء التدريب لمنع الإفراط في التخصيص (overfitting).</li>
  <li><strong>طبقة Dense</strong>: طبقة عصبية كاملة الاتصال تحتوي على 10 عصبونات (عادةً ما تستخدم للتصنيف إلى 10 فئات).</li>
</ol>

<p>هذا النموذج يمكن استخدامه لمهام مثل تصنيف الصور في مجموعة بيانات MNIST.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x_train</span><span class="p">[:</span><span class="mi">1</span><span class="p">]).</span><span class="n">numpy</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
قم بتشغيله.

```shell
$ /usr/bin/python3 tf.py
جارٍ تنزيل البيانات من https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
11493376/11490434 [==============================] - 10s 1us/step
[[ 0.15477428 -0.3877643   0.0994779   0.07474922 -0.26219758 -0.03550266
   0.32226565 -0.37141111  0.10925996 -0.0115255 ]]
</code></pre></div></div>

<p>تم تنزيل مجموعة البيانات بنجاح، ثم تم عرض النتائج.</p>

<p>لنلقِ نظرة الآن على مثال تصنيف الصور.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># TensorFlow و tf.keras
</span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
</code></pre></div></div>

<h1 id="مكتبات-مساعدة">مكتبات مساعدة</h1>
<p>import numpy as np
import matplotlib.pyplot as plt</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">__version__</span><span class="p">)</span>
</code></pre></div></div>

<p>خطأ.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ModuleNotFoundError: لا يوجد وحدة باسم <span class="s1">'matplotlib'</span>
</code></pre></div></div>

<p>قم بالتثبيت.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% pip3 <span class="nb">install </span>matplotlib
</code></pre></div></div>

<p>تم التصحيح.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>/usr/bin/python3 image.py
2.4.1
</code></pre></div></div>

<p>إليك مثال على كيفية نسخ ولصق كود:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># هذا مثال بسيط لنسخ ولصق كود في Python
</span>
<span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"مرحبًا، </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">!"</span><span class="p">)</span>

<span class="c1"># استدعاء الدالة
</span><span class="n">greet</span><span class="p">(</span><span class="s">"علي"</span><span class="p">)</span>
</code></pre></div></div>

<p>يمكنك نسخ هذا الكود ولصقه في محرر نصوص أو بيئة تطوير متكاملة (IDE) لتشغيله.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># TensorFlow و tf.keras
</span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># مكتبات مساعدة
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fashion_mnist</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">datasets</span><span class="p">.</span><span class="n">fashion_mnist</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">),</span> <span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">)</span> <span class="o">=</span> <span class="n">fashion_mnist</span><span class="p">.</span><span class="n">load_data</span><span class="p">()</span>
</code></pre></div></div>

<p>تم تحميل بيانات Fashion MNIST وتقسيمها إلى مجموعتين:</p>
<ul>
  <li><strong>مجموعة التدريب</strong>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">train_images</code>: تحتوي على صور الملابس المستخدمة للتدريب.</li>
      <li><code class="language-plaintext highlighter-rouge">train_labels</code>: تحتوي على التصنيفات المقابلة لصور التدريب.</li>
    </ul>
  </li>
  <li><strong>مجموعة الاختبار</strong>:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">test_images</code>: تحتوي على صور الملابس المستخدمة للاختبار.</li>
      <li><code class="language-plaintext highlighter-rouge">test_labels</code>: تحتوي على التصنيفات المقابلة لصور الاختبار.</li>
    </ul>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">'T-shirt/top'</span><span class="p">,</span> <span class="s">'Trouser'</span><span class="p">,</span> <span class="s">'Pullover'</span><span class="p">,</span> <span class="s">'Dress'</span><span class="p">,</span> <span class="s">'Coat'</span><span class="p">,</span>
               <span class="s">'Sandal'</span><span class="p">,</span> <span class="s">'Shirt'</span><span class="p">,</span> <span class="s">'Sneaker'</span><span class="p">,</span> <span class="s">'Bag'</span><span class="p">,</span> <span class="s">'Ankle boot'</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">train_images</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_labels</span><span class="p">))</span>
</code></pre></div></div>

<p>تم إخراج النتائج. لاحظ هنا وجود <code class="language-plaintext highlighter-rouge">train_images</code> و <code class="language-plaintext highlighter-rouge">train_labels</code> و <code class="language-plaintext highlighter-rouge">test_images</code> و <code class="language-plaintext highlighter-rouge">test_labels</code>. وهي مقسمة إلى مجموعات بيانات التدريب واختبار البيانات.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span>60000, 28, 28<span class="o">)</span>
60000
</code></pre></div></div>

<p>لنجرب بعد ذلك طباعة الصورة.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div>

<p>لنلقِ نظرة على النتائج.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[[</span>  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 <span class="o">[</span>  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 <span class="o">[</span>  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0]
 <span class="o">[</span>  0   0   0   0   0   0   0   0   0   0   0   0   1   0   0  13  73   0
    0   1   4   0   0   0   0   1   1   0]
 <span class="o">[</span>  0   0   0   0   0   0   0   0   0   0   0   0   3   0  36 136 127  62
   54   0   0   0   1   3   4   0   0   3]
 <span class="o">[</span>  0   0   0   0   0   0   0   0   0   0   0   0   6   0 102 204 176 134
  144 123  23   0   0   0   0  12  10   0]
 <span class="o">[</span>  0   0   0   0   0   0   0   0   0   0   0   0   0   0 155 236 207 178
  107 156 161 109  64  23  77 130  72  15]
 <span class="o">[</span>  0   0   0   0   0   0   0   0   0   0   0   1   0  69 207 223 218 216
  216 163 127 121 122 146 141  88 172  66]]
  ....
</code></pre></div></div>

<p>هنا مقتطفات من بعض النتائج.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
</code></pre></div></div>

<p>الإخراج هو <code class="language-plaintext highlighter-rouge">28</code>. لذلك من الواضح أن هذه مصفوفة بعرض 28. تابع الطباعة.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">TypeError</span><span class="p">:</span> <span class="nb">object</span> <span class="n">of</span> <span class="nb">type</span> <span class="s">'numpy.uint8'</span> <span class="n">has</span> <span class="n">no</span> <span class="nb">len</span><span class="p">()</span>
</code></pre></div></div>

<p>الترجمة:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">TypeError</span><span class="p">:</span> <span class="n">الكائن</span> <span class="n">من</span> <span class="n">النوع</span> <span class="s">'numpy.uint8'</span> <span class="n">لا</span> <span class="n">يحتوي</span> <span class="n">على</span> <span class="n">دالة</span> <span class="nb">len</span><span class="p">()</span>
</code></pre></div></div>

<p>لذلك، من الواضح جدًا. كل صورة هي مصفوفة من <code class="language-plaintext highlighter-rouge">28*28*3</code>. البعد الأخير من المصفوفة يحفظ قيم RGB. ومع ذلك، اكتشفنا أن فكرتنا قد تكون خاطئة.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">20</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
</code></pre></div></div>

<p>كل صورة عبارة عن مصفوفة بحجم 28*28. بعد بعض التجارب، اكتشفنا السر أخيرًا.</p>

<p>لنبدأ أولاً بإلقاء نظرة على الصورة الناتجة.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><strong>ملاحظة:</strong> الكود أعلاه مكتوب بلغة Python ويستخدم مكتبة <code class="language-plaintext highlighter-rouge">matplotlib</code> لعرض صورة من مجموعة بيانات التدريب. لا يحتاج الكود إلى ترجمة حيث أن الأوامر والمتغيرات مكتوبة بالإنجليزية وهي جزء من لغة البرمجة.</p>

<p><img src="/assets/images/ml/tf.png" alt="tf" style="zoom:30%;" /></p>

<p>هل ترى شريط الألوان على اليمين؟ من <code class="language-plaintext highlighter-rouge">0</code> إلى <code class="language-plaintext highlighter-rouge">250</code>. في الأصل، هذا تدرج بين لونين. لكن كيف يعرف أي لونين؟ أين أخبرناه بذلك؟</p>

<p>ثم نقوم بطباعة الصورة الثانية أيضًا.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/plt.png" alt="plt" style="zoom:30%;" /></p>

<p>مثير للاهتمام. هل هذا هو الإعداد الافتراضي لمكتبة <code class="language-plaintext highlighter-rouge">pyplot</code> التابعة؟ دعنا نواصل تشغيل الكود المقدم من الموقع الرسمي.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">binary</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">train_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/tf2.png" alt="tf2" style="zoom:20%;" /></p>

<p>لاحظ هنا أن الصور وفئاتها معروضة. أخيرًا، عرفنا معلمة <code class="language-plaintext highlighter-rouge">cmp</code>. إذا لم نكتب أي شيء في <code class="language-plaintext highlighter-rouge">cmp</code>، فسيكون بالتأكيد باللون الذي رأيناه سابقًا. بالفعل.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    plt.imshow<span class="o">(</span>train_images[i]<span class="o">)</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/cmap.png" alt="cmap" style="zoom:20%;" /></p>

<p>هذه المرة سنبحث عن <code class="language-plaintext highlighter-rouge">pyplot cmap</code>. لقد وجدنا بعض المصادر.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    plt.imshow<span class="o">(</span>train_images[i], <span class="nv">cmap</span><span class="o">=</span>plt.cm.PiYG<span class="o">)</span>
</code></pre></div></div>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"/assets/images/ml/cmap1.png"</span> <span class="na">alt=</span><span class="s">"cmap1"</span> <span class="na">style=</span><span class="s">"zoom:20%;"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p>لقد قمت بتعديل الكود. إليك النسخة المعدلة:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>   <span class="c1">## تم تعديل هذه السطر
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">Blues</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">train_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p>في السطر الذي تم تعديله، قمت بتغيير <code class="language-plaintext highlighter-rouge">2,5</code> إلى <code class="language-plaintext highlighter-rouge">5,5</code> لجعل الشبكة تحتوي على 5 صفوف و5 أعمدة بدلاً من 2 صفوف و5 أعمدة. هذا سيسمح بعرض 25 صورة في شبكة 5x5.</p>

<p>ومع ذلك، حدث خطأ.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ValueError: يجب أن يكون num بين 1 و 10، وليس 11
</code></pre></div></div>

<p>ماذا يعني هذا؟ ما الذي تعنيه <code class="language-plaintext highlighter-rouge">5,5,i+1</code> السابقة بالضبط؟ ولماذا لا تعمل عند تغييرها إلى <code class="language-plaintext highlighter-rouge">2</code>؟ على الرغم من أننا نعرف بشكل حدسي أنها ربما تعني 5 صفوف و5 أعمدة، إلا لماذا يظهر هذا الخطأ؟ كيف تم حساب <code class="language-plaintext highlighter-rouge">11</code>؟ وما معنى <code class="language-plaintext highlighter-rouge">num</code>؟ وما معنى <code class="language-plaintext highlighter-rouge">10</code>؟ لاحظ أن <code class="language-plaintext highlighter-rouge">2*5=10</code>. لذا ربما حدث الخطأ عندما كانت <code class="language-plaintext highlighter-rouge">i=11</code>. عند تغييرها إلى <code class="language-plaintext highlighter-rouge">for i in range(10):</code>، حصلنا على النتيجة التالية.</p>

<p><img src="/assets/images/ml/plot3.png" alt="plot3" style="zoom:20%;" /></p>

<p>بالنظر قليلاً إلى الوثائق، نجد أن <code class="language-plaintext highlighter-rouge">subplot(nrows, ncols, index, **kwargs)</code>. حسنًا، حتى الآن أصبح الأمر واضحًا لنا.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># plt.xticks([])
</span>    <span class="n">plt</span><span class="p">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">train_images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">Blues</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">train_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/plot_xticks.png" alt="plot_xticks" style="zoom:30%;" /></p>

<p>لاحظ أن <code class="language-plaintext highlighter-rouge">0 25</code> هذا النوع يسمى <code class="language-plaintext highlighter-rouge">xticks</code>. عندما نقوم بتكبير أو تصغير هذا الإطار، ستظهر أشكال مختلفة.</p>

<p><img src="assets/images/ml/plot_scale.png" alt="plot_scale" /></p>

<p>لاحظ أن مربع التكبير والتصغير، <code class="language-plaintext highlighter-rouge">xticks</code> و <code class="language-plaintext highlighter-rouge">xlabels</code> سيكون لها عرض مختلف.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="p">])</span>
</code></pre></div></div>

<p><strong>ترجمة الكود إلى العربية:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">نموذج</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="p">])</span>
</code></pre></div></div>

<p>في هذا الكود، يتم إنشاء نموذج تسلسلي باستخدام مكتبة TensorFlow وKeras. النموذج يتكون من ثلاث طبقات:</p>

<ol>
  <li><strong>Flatten</strong>: تقوم بتحويل البيانات ثنائية الأبعاد (28x28) إلى مصفوفة أحادية البعد.</li>
  <li><strong>Dense</strong>: طبقة عصبية كثيفة تحتوي على 128 عصبون وتستخدم دالة التنشيط ReLU.</li>
  <li><strong>Dense</strong>: طبقة عصبية كثيفة تحتوي على 10 عصبونات (عادةً ما تستخدم في تصنيف الصور إلى 10 فئات).</li>
</ol>

<p>هذا النموذج بسيط ويستخدم عادةً في مهام تصنيف الصور مثل MNIST.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">losses</span><span class="p">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_loss</span><span class="p">,</span> <span class="n">test_acc</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">دقة الاختبار:'</span><span class="p">,</span> <span class="n">test_acc</span><span class="p">)</span>
</code></pre></div></div>

<p>لاحظت هنا الطريقة التي يتم بها تعريف النموذج باستخدام الفئة <code class="language-plaintext highlighter-rouge">Sequential</code>. لاحظ هذه المعلمات: <code class="language-plaintext highlighter-rouge">28,28</code>، <code class="language-plaintext highlighter-rouge">128</code>، <code class="language-plaintext highlighter-rouge">relu</code>، <code class="language-plaintext highlighter-rouge">10</code>. لاحظ الحاجة إلى <code class="language-plaintext highlighter-rouge">compile</code> و <code class="language-plaintext highlighter-rouge">fit</code>. <code class="language-plaintext highlighter-rouge">fit</code> تعني التوفيق أو الملاءمة. لاحظ أن <code class="language-plaintext highlighter-rouge">28,28</code> هو حجم الصورة.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Epoch 1/10
1875/1875 <span class="o">[==============================]</span> - 2s 928us/step - loss: 0.6331 - accuracy: 0.7769
Epoch 2/10
1875/1875 <span class="o">[==============================]</span> - 2s 961us/step - loss: 0.3860 - accuracy: 0.8615
Epoch 3/10
1875/1875 <span class="o">[==============================]</span> - 2s 930us/step - loss: 0.3395 - accuracy: 0.8755
Epoch 4/10
1875/1875 <span class="o">[==============================]</span> - 2s 1ms/step - loss: 0.3071 - accuracy: 0.8890
Epoch 5/10
1875/1875 <span class="o">[==============================]</span> - 2s 1ms/step - loss: 0.2964 - accuracy: 0.8927
Epoch 6/10
1875/1875 <span class="o">[==============================]</span> - 2s 985us/step - loss: 0.2764 - accuracy: 0.8955
Epoch 7/10
1875/1875 <span class="o">[==============================]</span> - 2s 961us/step - loss: 0.2653 - accuracy: 0.8996
Epoch 8/10
1875/1875 <span class="o">[==============================]</span> - 2s 1ms/step - loss: 0.2549 - accuracy: 0.9052
Epoch 9/10
1875/1875 <span class="o">[==============================]</span> - 2s 1ms/step - loss: 0.2416 - accuracy: 0.9090
Epoch 10/10
1875/1875 <span class="o">[==============================]</span> - 2s 1ms/step - loss: 0.2372 - accuracy: 0.9086
313/313 - 0s - loss: 0.3422 - accuracy: 0.8798
</code></pre></div></div>

<p>دقة الاختبار: 0.879800021648407</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
تم تدريب النموذج. لنقم بتعديل المعلمات.

```shell
model = tf.keras.Sequential([
    tf.keras.layers.Flatten(input_shape=(28, 28)),
    tf.keras.layers.Dense(28, activation='relu'),    # 128 -&gt; 28
    tf.keras.layers.Dense(10)
])
</code></pre></div></div>

<p>قم بتعديل المعلمة الأولى لـ <code class="language-plaintext highlighter-rouge">Dense</code>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Epoch 1/10
1875/1875 <span class="o">[==============================]</span> - 2s 714us/step - loss: 6.9774 - accuracy: 0.3294
Epoch 2/10
1875/1875 <span class="o">[==============================]</span> - 1s 715us/step - loss: 1.3038 - accuracy: 0.4831
Epoch 3/10
1875/1875 <span class="o">[==============================]</span> - 1s 747us/step - loss: 1.0160 - accuracy: 0.6197
Epoch 4/10
1875/1875 <span class="o">[==============================]</span> - 1s 800us/step - loss: 0.7963 - accuracy: 0.6939
Epoch 5/10
1875/1875 <span class="o">[==============================]</span> - 2s 893us/step - loss: 0.7006 - accuracy: 0.7183
Epoch 6/10
1875/1875 <span class="o">[==============================]</span> - 1s 747us/step - loss: 0.6675 - accuracy: 0.7299
Epoch 7/10
1875/1875 <span class="o">[==============================]</span> - 1s 694us/step - loss: 0.6681 - accuracy: 0.7330
Epoch 8/10
1875/1875 <span class="o">[==============================]</span> - 1s 702us/step - loss: 0.6675 - accuracy: 0.7356
Epoch 9/10
1875/1875 <span class="o">[==============================]</span> - 1s 778us/step - loss: 0.6508 - accuracy: 0.7363
Epoch 10/10
1875/1875 <span class="o">[==============================]</span> - 1s 732us/step - loss: 0.6532 - accuracy: 0.7350
313/313 - 0s - loss: 0.6816 - accuracy: 0.7230
</code></pre></div></div>

<p>دقة الاختبار: 0.7229999899864197</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
لاحظ التغيير في `Test accuracy` قبل وبعد. `Epoch` هي سجلات يتم إخراجها بواسطة دالة `fit`. لاحظ أنه عندما كان الحجم `128`، تغيرت `accuracy` من `0.7769` إلى `0.9086`. وعندما كان الحجم `28`، تغيرت `accuracy` من `0.3294` إلى `0.7350`. يمكن ملاحظة أننا استخدمنا مجموعة التدريب أولاً لضبط `loss` و `accuracy`. ثم استخدمنا مجموعة الاختبار للاختبار. دعونا نلقي نظرة أولاً على `train_labels`.

```python
print(train_labels)
[9 0 0 ... 3 0 5]
print(len(train_labels))
60000
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">train_labels</span><span class="p">)</span>
<span class="p">[</span><span class="mi">9</span> <span class="mi">0</span> <span class="mi">0</span> <span class="p">...</span> <span class="mi">3</span> <span class="mi">0</span> <span class="mi">5</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">train_labels</span><span class="p">))</span>
<span class="mi">60000</span>
</code></pre></div></div>

<p>هذا يعني استخدام الأرقام من <code class="language-plaintext highlighter-rouge">0 إلى 9</code> لتمثيل هذه الفئات. وبالصدفة، فإن <code class="language-plaintext highlighter-rouge">class_names</code> يحتوي أيضًا على 10 عناصر.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class_names <span class="o">=</span> <span class="o">[</span><span class="s1">'T-shirt/top'</span>, <span class="s1">'Trouser'</span>, <span class="s1">'Pullover'</span>, <span class="s1">'Dress'</span>, <span class="s1">'Coat'</span>,
               <span class="s1">'Sandal'</span>, <span class="s1">'Shirt'</span>, <span class="s1">'Sneaker'</span>, <span class="s1">'Bag'</span>, <span class="s1">'Ankle boot'</span><span class="o">]</span>
</code></pre></div></div>

<p>دعونا نجري بعض التعديلات مرة أخرى.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>   <span class="c1"># 10 -&gt; 5
</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">losses</span><span class="p">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<p>حدث خطأ.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensorflow.python.framework.errors_impl.InvalidArgumentError: تم استقبال قيمة تسمية 9 وهي خارج النطاق الصحيح <span class="o">[</span>0, 5<span class="o">)</span><span class="nb">.</span> قيم التسميات: 4 3 2 9 4 1 6 0 7 9 1 6 5 2 3 8 6 3 8 0 3 5 6 1 2 6 3 6 8 4 8 4
         <span class="o">[[</span>node sparse_categorical_crossentropy/SparseSoftmaxCrossEntropyWithLogits/SparseSoftmaxCrossEntropyWithLogits <span class="o">(</span>محدد في /curiosity-courses/ml/tf/image.py:53<span class="o">)</span> <span class="o">]]</span> <span class="o">[</span>Op:__inference_train_function_538]
</code></pre></div></div>

<p>مكدس استدعاء الدوال:
train_function</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
قم بتغيير المعلمة الثالثة لـ `Sequential` وهي `Dense` إلى `15` وسيكون ذلك كافيًا. النتيجة لن تختلف كثيرًا. جرب تغيير `Epoch` أيضًا.

```python
model = tf.keras.Sequential([
    tf.keras.layers.Flatten(input_shape=(28, 28)),
    tf.keras.layers.Dense(28, activation='relu'),
    tf.keras.layers.Dense(15)
])
</code></pre></div></div>

<p><strong>ترجمة الكود إلى العربية:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">نموذج</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="p">])</span>
</code></pre></div></div>

<p>في هذا الكود، يتم إنشاء نموذج تسلسلي باستخدام مكتبة TensorFlow (tf.keras). يتكون النموذج من ثلاث طبقات:</p>

<ol>
  <li><strong>Flatten</strong>: تقوم هذه الطبقة بتحويل البيانات ثنائية الأبعاد (28x28) إلى بيانات أحادية البعد (784 عنصرًا).</li>
  <li><strong>Dense</strong>: طبقة عصبية كاملة الاتصال تحتوي على 28 عصبونًا وتستخدم دالة التنشيط ReLU.</li>
  <li><strong>Dense</strong>: طبقة عصبية كاملة الاتصال تحتوي على 15 عصبونًا (بدون تحديد دالة تنشيط).</li>
</ol>

<p>هذا النموذج بسيط ويستخدم عادةً في مهام التصنيف أو التنبؤ.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">losses</span><span class="p">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
</code></pre></div></div>

<p>تم ترجمة الكود أعلاه إلى:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">losses</span><span class="p">.</span><span class="n">SparseCategoricalCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
</code></pre></div></div>

<p>في هذا الكود، يتم استخدام الدالة <code class="language-plaintext highlighter-rouge">compile</code> لتهيئة النموذج (model) للتدريب. يتم تحديد المُحسِّن (optimizer) على أنه <code class="language-plaintext highlighter-rouge">adam</code>، ودالة الخسارة (loss) على أنها <code class="language-plaintext highlighter-rouge">SparseCategoricalCrossentropy</code> مع المعلمة <code class="language-plaintext highlighter-rouge">from_logits=True</code>، والمقياس (metric) المستخدم لتقييم الأداء هو الدقة (<code class="language-plaintext highlighter-rouge">accuracy</code>).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>  <span class="c1"># 10 -&gt; 15
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_loss</span><span class="p">,</span> <span class="n">test_acc</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">دقة الاختبار:'</span><span class="p">,</span> <span class="n">test_acc</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Epoch 1/15
1875/1875 <span class="o">[==============================]</span> - 2s 892us/step - loss: 6.5778 - accuracy: 0.3771
Epoch 2/15
1875/1875 <span class="o">[==============================]</span> - 2s 872us/step - loss: 1.3121 - accuracy: 0.4910
Epoch 3/15
1875/1875 <span class="o">[==============================]</span> - 2s 909us/step - loss: 1.0900 - accuracy: 0.5389
Epoch 4/15
1875/1875 <span class="o">[==============================]</span> - 1s 730us/step - loss: 1.0422 - accuracy: 0.5577
Epoch 5/15
1875/1875 <span class="o">[==============================]</span> - 1s 709us/step - loss: 0.9529 - accuracy: 0.5952
Epoch 6/15
1875/1875 <span class="o">[==============================]</span> - 1s 714us/step - loss: 0.9888 - accuracy: 0.5950
Epoch 7/15
1875/1875 <span class="o">[==============================]</span> - 1s 767us/step - loss: 0.8678 - accuracy: 0.6355
Epoch 8/15
1875/1875 <span class="o">[==============================]</span> - 1s 715us/step - loss: 0.8247 - accuracy: 0.6611
Epoch 9/15
1875/1875 <span class="o">[==============================]</span> - 1s 721us/step - loss: 0.8011 - accuracy: 0.6626
Epoch 10/15
1875/1875 <span class="o">[==============================]</span> - 1s 711us/step - loss: 0.8024 - accuracy: 0.6622
Epoch 11/15
1875/1875 <span class="o">[==============================]</span> - 1s 781us/step - loss: 0.7777 - accuracy: 0.6696
Epoch 12/15
1875/1875 <span class="o">[==============================]</span> - 1s 724us/step - loss: 0.7764 - accuracy: 0.6728
Epoch 13/15
1875/1875 <span class="o">[==============================]</span> - 1s 731us/step - loss: 0.7688 - accuracy: 0.6767
Epoch 14/15
1875/1875 <span class="o">[==============================]</span> - 1s 715us/step - loss: 0.7592 - accuracy: 0.6793
Epoch 15/15
1875/1875 <span class="o">[==============================]</span> - 1s 786us/step - loss: 0.7526 - accuracy: 0.6792
313/313 - 0s - loss: 0.8555 - accuracy: 0.6418
</code></pre></div></div>

<p>دقة الاختبار: 0.6417999863624573</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
لاحظ أن التغيير إلى 15. الفرق ليس كبيرًا. `tf.keras.layers.Dense(88, activation='relu')` مهم. حاول تغيير 128 إلى 88. حصلت على `Test accuracy: 0.824999988079071`. عندما كانت 128، كانت `0.879800021648407`. عندما كانت 28، كانت `0.7229999899864197`. هل الأكبر دائمًا أفضل؟ ومع ذلك، عند تغييرها إلى `256`، كانت `Test accuracy: 0.8409000039100647`. هذا يجعلنا نفكر في معنى `loss` و `accuracy`.

```python
probability_model = tf.keras.Sequential([model, 
                                         tf.keras.layers.Softmax()])
</code></pre></div></div>

<p><strong>ترجمة:</strong></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">probability_model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span><span class="n">model</span><span class="p">,</span> 
                                         <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Softmax</span><span class="p">()])</span>
</code></pre></div></div>

<p>في هذا الكود، يتم إنشاء نموذج احتمالي باستخدام <code class="language-plaintext highlighter-rouge">tf.keras.Sequential</code> الذي يتكون من النموذج الأساسي <code class="language-plaintext highlighter-rouge">model</code> وطبقة <code class="language-plaintext highlighter-rouge">Softmax</code> التي تُستخدم لتحويل المخرجات إلى احتمالات.</p>

<p>لنقم بالتنبؤ الآن. لاحظ أن <code class="language-plaintext highlighter-rouge">Sequential</code> هو نفسه كما في الأعلى. لاحظ المعلمات <code class="language-plaintext highlighter-rouge">model</code> و <code class="language-plaintext highlighter-rouge">tf.keras.layers.Softmax()</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">probability_model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span><span class="n">model</span><span class="p">,</span> 
                                         <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Softmax</span><span class="p">()])</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">probability_model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_images</span><span class="p">)</span>
</code></pre></div></div>

<p>تمثل الكود أعلاه إنشاء نموذج احتمالي باستخدام <code class="language-plaintext highlighter-rouge">tf.keras.Sequential</code> والذي يتكون من النموذج الأساسي (<code class="language-plaintext highlighter-rouge">model</code>) متبوعًا بطبقة <code class="language-plaintext highlighter-rouge">Softmax</code>. ثم يتم استخدام هذا النموذج للتنبؤ بالنتائج (<code class="language-plaintext highlighter-rouge">predictions</code>) بناءً على بيانات الاختبار (<code class="language-plaintext highlighter-rouge">test_images</code>).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">predictions_array</span><span class="p">,</span> <span class="n">true_label</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
  <span class="n">true_label</span><span class="p">,</span> <span class="n">img</span> <span class="o">=</span> <span class="n">true_label</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">img</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">([])</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">yticks</span><span class="p">([])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">binary</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predicted_label</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions_array</span><span class="p">)</span>
<span class="k">if</span> <span class="n">predicted_label</span> <span class="o">==</span> <span class="n">true_label</span><span class="p">:</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s">'blue'</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"{} {:2.0f}% ({})"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">predicted_label</span><span class="p">],</span>
                                <span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">predictions_array</span><span class="p">),</span>
                                <span class="n">class_names</span><span class="p">[</span><span class="n">true_label</span><span class="p">]),</span>
                                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</code></pre></div></div>

<p>تمت ترجمة الكود أعلاه إلى:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"{} {:2.0f}% ({})"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">predicted_label</span><span class="p">],</span>
                                <span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">predictions_array</span><span class="p">),</span>
                                <span class="n">class_names</span><span class="p">[</span><span class="n">true_label</span><span class="p">]),</span>
                                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</code></pre></div></div>

<p>في هذا الكود، يتم تعيين تسمية المحور السيني (x-axis) باستخدام <code class="language-plaintext highlighter-rouge">plt.xlabel</code>. النص المعروض يتضمن اسم الفئة المتوقعة (<code class="language-plaintext highlighter-rouge">predicted_label</code>)، ونسبة الثقة في التوقع (<code class="language-plaintext highlighter-rouge">predictions_array</code>)، واسم الفئة الحقيقية (<code class="language-plaintext highlighter-rouge">true_label</code>). اللون (<code class="language-plaintext highlighter-rouge">color</code>) يتم تعيينه أيضًا بناءً على ما إذا كان التوقع صحيحًا أم لا.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_value_array</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">predictions_array</span><span class="p">,</span> <span class="n">true_label</span><span class="p">):</span>
  <span class="n">true_label</span> <span class="o">=</span> <span class="n">true_label</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">yticks</span><span class="p">([])</span>
  <span class="n">thisplot</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">predictions_array</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"#777777"</span><span class="p">)</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
  <span class="n">predicted_label</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions_array</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>ترجمة الكود إلى العربية:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_value_array</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">predictions_array</span><span class="p">,</span> <span class="n">true_label</span><span class="p">):</span>
  <span class="n">true_label</span> <span class="o">=</span> <span class="n">true_label</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>  <span class="c1"># إزالة الشبكة من الرسم البياني
</span>  <span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>  <span class="c1"># تعيين التقسيمات على المحور السيني من 0 إلى 9
</span>  <span class="n">plt</span><span class="p">.</span><span class="n">yticks</span><span class="p">([])</span>  <span class="c1"># إزالة التقسيمات من المحور الصادي
</span>  <span class="n">thisplot</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">predictions_array</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"#777777"</span><span class="p">)</span>  <span class="c1"># رسم الأعمدة للتنبؤات
</span>  <span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># تحديد حدود المحور الصادي من 0 إلى 1
</span>  <span class="n">predicted_label</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions_array</span><span class="p">)</span>  <span class="c1"># الحصول على التصنيف المتوقع
</span></code></pre></div></div>

<p><strong>ملاحظة:</strong> تمت ترجمة الشروحات الموجودة في الكود إلى العربية مع الحفاظ على الكود الأصلي كما هو.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">thisplot</span><span class="p">[</span><span class="n">predicted_label</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="s">'red'</span><span class="p">)</span>
<span class="n">thisplot</span><span class="p">[</span><span class="n">true_label</span><span class="p">].</span><span class="n">set_color</span><span class="p">(</span><span class="s">'blue'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plot_image</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">test_images</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot_value_array</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>  <span class="n">test_labels</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/pred.png" alt="pred" style="zoom:50%;" /></p>

<p>هذا يعني أن هناك احتمال بنسبة 99% أن تكون هذه الصورة عبارة عن <code class="language-plaintext highlighter-rouge">Ankle boot</code>. لاحظ أن <code class="language-plaintext highlighter-rouge">plot_image</code> يعرض الصورة على اليسار، بينما <code class="language-plaintext highlighter-rouge">plot_value_array</code> يخرج الرسم البياني على اليمين.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">num_rows</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">num_images</span> <span class="o">=</span> <span class="n">num_rows</span><span class="o">*</span><span class="n">num_cols</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">num_cols</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">num_rows</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_images</span><span class="p">):</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">num_cols</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">plot_image</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">test_images</span><span class="p">)</span>
  <span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">num_cols</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">plot_value_array</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test_labels</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/ml/pred1.png" alt="pred1" style="zoom:50%;" /></p>

<p>لاحظ أن هذا فقط يعرض المزيد من نتائج الاختبار. لذا، فإن عملية الاستخدام واضحة إلى حد كبير بالنسبة لنا. لذلك، نحن لا نعرف حتى الآن كيف يتم الحساب في الخلفية. لكننا نعرف كيفية استخدامها. في الخلفية، هناك حساب التفاضل والتكامل. كيف نفهم حساب التفاضل والتكامل؟</p>

<p>لنفترض أن هناك رقمًا بين 1 و100 يجب عليك تخمينه. في كل مرة تخمن فيها رقمًا، سأخبرك إذا كان الرقم أصغر أو أكبر. تخمن 50. أقول لك إنه أصغر. تخمن 80. أقول لك إنه أكبر. تخمن 65. أقول لك إنه أكبر. تخمن 55. أقول لك إنه أصغر. تخمن 58. أقول لك، حسنًا، لقد خمنت بشكل صحيح.</p>

<p>التعلم الآلي يعمل على محاكاة عملية مشابهة في الخلفية، لكنها أكثر تعقيدًا. قد يكون هناك العديد من الأرقام من <code class="language-plaintext highlighter-rouge">1 إلى 100</code>، ويجب تخمين العديد من الأرقام. في نفس الوقت، كل تخمين يتطلب إجراء العديد من العمليات الحسابية. بالإضافة إلى ذلك، كل مرة يتم فيها تحديد ما إذا كان الرقم أكبر أو أصغر، يتطلب ذلك حسابًا كبيرًا.</p>

<h2 id="pytorch">PyTorch</h2>

<p>PyTorch هي مكتبة تعلم آلي مفتوحة المصدر تعتمد على لغة البرمجة Python، وتُستخدم بشكل أساسي في تطبيقات مثل الرؤية الحاسوبية ومعالجة اللغة الطبيعية. تم تطويرها من قبل فريق أبحاث الذكاء الاصطناعي في Facebook (الآن Meta)، وتُعتبر واحدة من أكثر أدوات التعلم العميق شعبية بين الباحثين والمطورين.</p>

<h3 id="مميزات-pytorch">مميزات PyTorch:</h3>
<ol>
  <li><strong>مرونة عالية</strong>: تسمح PyTorch بإنشاء وتعديل النماذج الديناميكية بسهولة، مما يجعلها مثالية للبحث والتجريب.</li>
  <li><strong>حسابات تلقائية (Autograd)</strong>: تدعم PyTorch حساب التدرجات تلقائيًا، مما يسهل عملية تدريب النماذج.</li>
  <li><strong>توافق مع Python</strong>: تتمتع PyTorch بتكامل سلس مع مكتبات Python الأخرى مثل NumPy وSciPy.</li>
  <li><strong>مجتمع نشط</strong>: يوجد مجتمع كبير وداعم حول PyTorch، مما يجعل العثور على المساعدة والمصادر التعليمية أسهل.</li>
</ol>

<h3 id="مثال-بسيط-باستخدام-pytorch">مثال بسيط باستخدام PyTorch:</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># إنشاء موتر (Tensor)
</span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># عملية حسابية بسيطة
</span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>

<span class="c1"># حساب التدرج
</span><span class="n">y</span><span class="p">.</span><span class="n">backward</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>

<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">grad</span><span class="p">)</span>  <span class="c1"># الإخراج: tensor([2., 2., 2.])
</span></code></pre></div></div>

<p>في هذا المثال، نقوم بإنشاء موتر (Tensor) وإجراء عملية حسابية بسيطة عليه، ثم نحسب التدرج باستخدام خاصية <code class="language-plaintext highlighter-rouge">backward</code>.</p>

<p>PyTorch تُعتبر أداة قوية وفعالة لأي شخص يعمل في مجال التعلم العميق، سواء كان باحثًا أو مطورًا.</p>

<p>قم بتثبيته. هذا يدعم إصدار <code class="language-plaintext highlighter-rouge">3.9</code> من Python.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pip <span class="nb">install </span>torch torchvision
جمع حزمة torch
  تنزيل torch-1.8.0-cp39-none-macosx_10_9_x86_64.whl <span class="o">(</span>120.6 ميجابايت<span class="o">)</span>
     |████████████████████████████████| 120.6 ميجابايت 224 كيلوبايت/ثانية
جمع حزمة torchvision
  تنزيل torchvision-0.9.0-cp39-cp39-macosx_10_9_x86_64.whl <span class="o">(</span>13.1 ميجابايت<span class="o">)</span>
     |████████████████████████████████| 13.1 ميجابايت 549 كيلوبايت/ثانية
تم تلبية المتطلب numpy بالفعل في /usr/local/lib/python3.9/site-packages <span class="o">(</span>من torch<span class="o">)</span> <span class="o">(</span>1.20.1<span class="o">)</span>
جمع حزمة typing-extensions
  تنزيل typing_extensions-3.7.4.3-py3-none-any.whl <span class="o">(</span>22 كيلوبايت<span class="o">)</span>
تم تلبية المتطلب pillow&gt;<span class="o">=</span>4.1.1 بالفعل في /usr/local/lib/python3.9/site-packages <span class="o">(</span>من torchvision<span class="o">)</span> <span class="o">(</span>8.0.1<span class="o">)</span>
تثبيت الحزم المجمعة: typing-extensions, torch, torchvision
تم تثبيت torch-1.8.0 و torchvision-0.9.0 و typing-extensions-3.7.4.3 بنجاح
</code></pre></div></div>

<p>لنجرب ذلك.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></div>

<p>حدث خطأ.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"torch.py"</span>, line 1, <span class="k">in</span> &lt;module&gt;
    import torch
  File <span class="s2">"torch.py"</span>, line 2, <span class="k">in</span> &lt;module&gt;
    x <span class="o">=</span> torch.rand<span class="o">(</span>5, 3<span class="o">)</span>
AttributeError: الوحدة <span class="s1">'torch'</span> غير مهيأة بالكامل وليس لديها السمة <span class="s1">'rand'</span> <span class="o">(</span>على الأرجح بسبب استيراد دائري<span class="o">)</span>
</code></pre></div></div>

<p>بحثت عن رسالة الخطأ هذه على Google. اتضح أن المشكلة كانت بسبب أن ملفنا كان يُسمى أيضًا <code class="language-plaintext highlighter-rouge">torch</code>. تغيير الاسم حل المشكلة وأصبح كل شيء يعمل بشكل صحيح.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor<span class="o">([[</span>0.5520, 0.9446, 0.5543],
        <span class="o">[</span>0.6192, 0.0908, 0.8726],
        <span class="o">[</span>0.0223, 0.7685, 0.9814],
        <span class="o">[</span>0.4019, 0.5406, 0.3861],
        <span class="o">[</span>0.5485, 0.6040, 0.2387]]<span class="o">)</span>
</code></pre></div></div>

<p>العثور على مثال.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># -*- coding: utf-8 -*-
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nb">float</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">device</span><span class="p">(</span><span class="s">"cpu"</span><span class="p">)</span>
<span class="c1"># device = torch.device("cuda:0") # قم بإلغاء التعليق لتشغيل الكود على GPU
</span></code></pre></div></div>

<h1 id="إنشاء-بيانات-عشوائية-للإدخال-والإخراج">إنشاء بيانات عشوائية للإدخال والإخراج</h1>
<p>x = torch.linspace(-math.pi, math.pi, 2000, device=device, dtype=dtype)
y = torch.sin(x)</p>

<h1 id="تهيئة-الأوزان-بشكل-عشوائي">تهيئة الأوزان بشكل عشوائي</h1>
<p>a = torch.randn((), device=device, dtype=dtype)
b = torch.randn((), device=device, dtype=dtype)
c = torch.randn((), device=device, dtype=dtype)
d = torch.randn((), device=device, dtype=dtype)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>
    <span class="c1"># التمرير الأمامي: حساب القيمة المتوقعة لـ y
</span>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">3</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># حساب وطباعة الخسارة
loss = (y_pred - y).pow(2).sum().item()
if t % 100 == 99:
    print(t, loss)

# الانتشار العكسي لحساب تدرجات a, b, c, d بالنسبة للخسارة
grad_y_pred = 2.0 * (y_pred - y)
grad_a = grad_y_pred.sum()
grad_b = (grad_y_pred * x).sum()
grad_c = (grad_y_pred * x ** 2).sum()
grad_d = (grad_y_pred * x ** 3).sum()
</code></pre></div></div>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    # تحديث الأوزان باستخدام النزول التدرجي
    a -= learning_rate <span class="err">*</span> grad_a
    b -= learning_rate <span class="err">*</span> grad_b
    c -= learning_rate <span class="err">*</span> grad_c
    d -= learning_rate <span class="err">*</span> grad_d
print(f'النتيجة: y = {a.item()} + {b.item()} x + {c.item()} x^2 + {d.item()} x^3')
</code></pre></div></div>

<p>قم بتشغيله.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>99 1273.537353515625
199 849.24853515625
299 567.4786987304688
399 380.30291748046875
499 255.92752075195312
599 173.2559814453125
699 118.2861328125
799 81.72274780273438
899 57.39331817626953
999 41.198158264160156
1099 30.41307830810547
1199 23.227672576904297
1299 18.438262939453125
1399 15.244369506835938
1499 13.113286972045898
1599 11.690631866455078
1699 10.740333557128906
1799 10.105220794677734
1899 9.6804780960083
1999 9.39621353149414
النتيجة: y <span class="o">=</span> <span class="nt">-0</span>.011828352697193623 + 0.8360244631767273 x + 0.002040589228272438 x^2 + <span class="nt">-0</span>.09038365632295609 x^3
</code></pre></div></div>

<p>لنلقِ نظرة على الكود باستخدام مكتبة <code class="language-plaintext highlighter-rouge">numpy</code> فقط.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># -*- coding: utf-8 -*-
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">math</span>
</code></pre></div></div>

<h1 id="إنشاء-بيانات-إدخال-وإخراج-عشوائية">إنشاء بيانات إدخال وإخراج عشوائية</h1>
<p>x = np.linspace(-math.pi, math.pi, 2000)
y = np.sin(x)</p>

<h1 id="تهيئة-الأوزان-بشكل-عشوائي-1">تهيئة الأوزان بشكل عشوائي</h1>
<p>a = np.random.randn()
b = np.random.randn()
c = np.random.randn()
d = np.random.randn()</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>
    <span class="c1"># التمرير الأمامي: حساب القيمة المتوقعة لـ y
</span>    <span class="c1"># y = a + b x + c x^2 + d x^3
</span>    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">3</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># حساب وطباعة الخسارة
loss = np.square(y_pred - y).sum()
if t % 100 == 99:
    print(t, loss)

# الانتشار العكسي لحساب تدرجات a, b, c, d بالنسبة للخسارة
grad_y_pred = 2.0 * (y_pred - y)
grad_a = grad_y_pred.sum()
grad_b = (grad_y_pred * x).sum()
grad_c = (grad_y_pred * x ** 2).sum()
grad_d = (grad_y_pred * x ** 3).sum()

# تحديث الأوزان
a -= learning_rate * grad_a
b -= learning_rate * grad_b
c -= learning_rate * grad_c
d -= learning_rate * grad_d
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'النتيجة: y = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s"> + </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s"> x + </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s"> x^2 + </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s"> x^3'</span><span class="p">)</span>
</code></pre></div></div>

<p>لاحظ أن هذه طريقتان مختلفتان للحساب.</p>

<p>في هذين المثالين، تم أولاً إنشاء مجموعة من قيم <code class="language-plaintext highlighter-rouge">x</code> و <code class="language-plaintext highlighter-rouge">y</code>. ثم تم افتراض أن العلاقة بينهما هي معادلة من الدرجة الثالثة. بعد ذلك، تم استخدام بعض الطرق لحساب المعاملات بشكل تكراري. كيف تعمل هذه الخوارزميات؟ لاحظ أنه تم تكرار العملية <code class="language-plaintext highlighter-rouge">2000</code> مرة، وفي كل مرة يتم تحسين الدقة بشكل أكبر. سنترك التفاصيل الدقيقة لهذه العملية جانبًا في الوقت الحالي.</p>

<h2 id="الختام">الختام</h2>

<p>حاليًا، نحن لا نفهم كيفية حساب التعلم الآلي في الخلفية. ومع ذلك، هذا ليس مهمًا في الوقت الحالي. يمكننا بالفعل القيام بالكثير من الأشياء باستخدام المعرفة المشابهة لما ذكرناه أعلاه. يمكننا أيضًا استخدام التعلم الآلي لمعالجة النصوص والصوت وما إلى ذلك. عندما نختبر عشرات الأمثلة، يمكننا تعلم المبادئ لاحقًا.</p>

<h2 id="التمرين">التمرين</h2>

<ul>
  <li>يقوم الطلاب بالاستكشاف كما هو موضح أعلاه.</li>
</ul>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-ar" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
