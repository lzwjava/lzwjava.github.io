<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>NYTimes Nachrichten (CN) Artikelaktualisierung Auslöser</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>NYTimes Nachrichten (CN) Artikelaktualisierung Auslöser | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="NYTimes Nachrichten (CN) Artikelaktualisierung Auslöser" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="de" />
<meta name="description" content="Klicken Sie auf die Schaltfläche unten, um die NYTimes CN Artikel zu aktualisieren." />
<meta property="og:description" content="Klicken Sie auf die Schaltfläche unten, um die NYTimes CN Artikel zu aktualisieren." />
<link rel="canonical" href="https://lzwjava.github.io/nytimes-update-de" />
<meta property="og:url" content="https://lzwjava.github.io/nytimes-update-de" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-03-16T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="NYTimes Nachrichten (CN) Artikelaktualisierung Auslöser" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2025-03-16T00:00:00+08:00","datePublished":"2025-03-16T00:00:00+08:00","description":"Klicken Sie auf die Schaltfläche unten, um die NYTimes CN Artikel zu aktualisieren.","headline":"NYTimes Nachrichten (CN) Artikelaktualisierung Auslöser","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/nytimes-update-de"},"url":"https://lzwjava.github.io/nytimes-update-de"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=134275dfd5e0307e2691e56027c2f6239b430290">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=134275dfd5e0307e2691e56027c2f6239b430290" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       NYTimes Nachrichten (CN) Artikelaktualisierung Auslöser | Von KI generiert und übersetzt
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/de/2025-03-16-nytimes-update-de.md">PDF</a> -->

    <!-- Audio Button -->



    <!-- 
    <a href="#" id="playAudioButton" class="button audio-button" data-file-path="_posts/de/2025-03-16-nytimes-update-de.md">Audio</a>
     -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsde2025-03-16-nytimes-update-de.md</span> -->
      

      <!-- <span>2025-03-16-nytimes-update-de.md</span> -->

      
        

        
          
          <a href="#" class="button">2025.03</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/nytimes-update-en" >English</option>
        <option value="/nytimes-update-zh" >中文</option>
        <option value="/nytimes-update-ja" >日本語</option>
        <option value="/nytimes-update-es" >Español</option>
        <option value="/nytimes-update-hi" >हिंदी</option>
        <option value="/nytimes-update-fr" >Français</option>
        <option value="/nytimes-update-de" selected>Deutsch</option>
        <option value="/nytimes-update-ar" >العربية</option>
        <option value="/nytimes-update-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>Klicken Sie auf die Schaltfläche unten, um die <a href="./nytimes-en">NYTimes CN Artikel</a> zu aktualisieren.</p>

<script async="" src="../assets/js/nytimes.js"></script>

<div class="nytimes"></div>

<p>Diese Seite ermöglicht es Ihnen, eine Aktualisierung der NYTimes CN Artikel auszulösen. Durch Klicken auf die Schaltfläche wird ein Workflow gestartet, der die neuesten Artikel abruft, sie übersetzt und den Inhalt auf dieser Website aktualisiert. Bitte beachten Sie, dass es einige Minuten dauern kann, bis die Änderungen nach dem Auslösen der Aktualisierung sichtbar werden.</p>

<p>Python-Code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">ssl</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">load_dotenv</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">call_mistral_api</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s">"mistral-small-2501"</span><span class="p">):</span>
    <span class="s">"""Ruft die Mistral-API auf, um Text zu übersetzen."""</span>
    <span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"MISTRAL_API_KEY"</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">api_key</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Fehler: Die Umgebungsvariable MISTRAL_API_KEY ist nicht gesetzt."</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.mistral.ai/v1/chat/completions"</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"Content-Type"</span><span class="p">:</span> <span class="s">"application/json"</span><span class="p">,</span>
        <span class="s">"Accept"</span><span class="p">:</span> <span class="s">"application/json"</span><span class="p">,</span>
        <span class="s">"Authorization"</span><span class="p">:</span> <span class="sa">f</span><span class="s">"Bearer </span><span class="si">{</span><span class="n">api_key</span><span class="si">}</span><span class="s">"</span>
    <span class="p">}</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"model"</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span>
        <span class="s">"messages"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s">"role"</span><span class="p">:</span> <span class="s">"user"</span><span class="p">,</span>
                <span class="s">"content"</span><span class="p">:</span> <span class="n">prompt</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Mistral-API mit Modell aufrufen: </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Gesendete Eingabeaufforderung: </span><span class="si">{</span><span class="n">prompt</span><span class="p">[</span><span class="si">:</span><span class="mi">1000</span><span class="p">]</span><span class="si">}</span><span class="s">..."</span><span class="p">)</span>  <span class="c1"># Die ersten 1000 Zeichen der Eingabeaufforderung ausgeben
</span>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
        <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="n">response_json</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">json</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Mistral-API-Antwort: </span><span class="si">{</span><span class="n">response_json</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response_json</span> <span class="ow">and</span> <span class="n">response_json</span><span class="p">[</span><span class="s">'choices'</span><span class="p">]:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">response_json</span><span class="p">[</span><span class="s">'choices'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">'message'</span><span class="p">][</span><span class="s">'content'</span><span class="p">]</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Mistral-API-Inhalt: </span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">content</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Mistral-API-Fehler: Ungültiges Antwortformat: </span><span class="si">{</span><span class="n">response_json</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
    <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Mistral-API-Fehler: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">e</span><span class="p">.</span><span class="n">response</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Statuscode der Antwort: </span><span class="si">{</span><span class="n">e</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Inhalt der Antwort: </span><span class="si">{</span><span class="n">e</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">fetch_html_content</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="s">"""Holt den HTML-Inhalt einer bestimmten URL."""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Erstellen eines unverifizierten SSL-Kontexts
</span>        <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="p">.</span><span class="n">_create_unverified_context</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"HTML-Inhalt von abrufen: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">response</span><span class="p">.</span><span class="n">raise_for_status</span><span class="p">()</span>  <span class="c1"># HTTPError für schlechte Antworten (4xx oder 5xx) auslösen
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"HTML-Inhalt erfolgreich von abgerufen: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span>
    <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"URL konnte nicht abgerufen werden: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s"> - </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">extract_links</span><span class="p">(</span><span class="n">html</span><span class="p">):</span>
    <span class="s">"""Extrahiert Links von der Hauptseite von cn.nytimes.com."""</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>
    <span class="n">links</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">,</span> <span class="n">href</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="s">'href'</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">url</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">'https://cn.nytimes.com/'</span><span class="p">):</span>
            <span class="n">links</span><span class="p">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s">'url'</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
                <span class="s">'text'</span><span class="p">:</span> <span class="n">a</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="p">})</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">links</span><span class="p">)</span><span class="si">}</span><span class="s"> Links von der Hauptseite extrahiert."</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">links</span>

<span class="k">def</span> <span class="nf">translate_title</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
    <span class="s">"""Übersetzt den Titel von Chinesisch in Englisch mit Mistral."""</span>
    <span class="n">base_prompt</span> <span class="o">=</span> <span class="s">"Übersetzen Sie den folgenden Titel in {target_language}. Geben Sie nur den übersetzten Titel an, ohne zusätzliche Hinweise oder Erklärungen. Wiederholen oder erwähnen Sie den Eingabetext nicht.</span><span class="se">\n</span><span class="s">"</span>
    <span class="n">prompt</span> <span class="o">=</span> <span class="n">base_prompt</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">target_language</span><span class="o">=</span><span class="s">"English"</span><span class="p">)</span> <span class="o">+</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s">"</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Titel übersetzen: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="n">translated_title</span> <span class="o">=</span> <span class="n">call_mistral_api</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">translated_title</span><span class="p">:</span>
        <span class="n">translated_title</span> <span class="o">=</span> <span class="n">translated_title</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Übersetzter Titel: </span><span class="si">{</span><span class="n">translated_title</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">translated_title</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s">"Titelübersetzung fehlgeschlagen: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">summarize_article</span><span class="p">(</span><span class="n">html</span><span class="p">):</span>
    <span class="s">"""Zusammenfassung des Artikelinhalts mit der Mistral-API auf Englisch."""</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">)</span>
    <span class="n">title_element</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">select_one</span><span class="p">(</span><span class="s">'.article-area .article-content .article-header header h1'</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">title_element</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">title_element</span> <span class="k">else</span> <span class="s">''</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Titel extrahiert: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

    <span class="c1"># Hauptartikeltext extrahieren
</span>    <span class="n">article_area</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'article-area'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">article_area</span><span class="p">:</span>
        <span class="n">article_text</span> <span class="o">=</span> <span class="n">article_area</span><span class="p">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">separator</span><span class="o">=</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">strip</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">article_text</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">article_text</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Artikeltext konnte nicht extrahiert werden."</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>

    <span class="c1"># Erstellen einer Eingabeaufforderung für Mistral, um zusammenzufassen
</span>    <span class="n">prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"Fassen Sie den folgenden Artikel in Englisch zusammen, indem Sie sich auf die Hauptpunkte konzentrieren und einleitende Phrasen wie 'Zusammenfassung:' oder 'Dieser Artikel handelt von:' vermeiden.</span><span class="se">\n\n</span><span class="si">{</span><span class="n">article_text</span><span class="p">[</span><span class="si">:</span><span class="mi">30000</span><span class="p">]</span><span class="si">}</span><span class="se">\n\n</span><span class="s">"</span>  <span class="c1"># Artikeltext auf 30000 Zeichen begrenzen
</span>    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Zusammenfassung für Titel erstellen: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="n">call_mistral_api</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">summary</span><span class="p">:</span>
        <span class="c1"># Zusammenfassung bereinigen, indem führende "Zusammenfassung:" oder ähnliche Phrasen entfernt werden
</span>        <span class="n">summary</span> <span class="o">=</span> <span class="n">summary</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"Zusammenfassung:"</span><span class="p">,</span> <span class="s">""</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Erstellte Zusammenfassung: </span><span class="si">{</span><span class="n">summary</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">title</span><span class="p">,</span> <span class="n">summary</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Zusammenfassung für Titel konnte nicht erstellt werden: </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">generate_markdown_list</span><span class="p">(</span><span class="n">articles</span><span class="p">):</span>
    <span class="s">"""Erstellt eine Markdown-Liste aus einer Liste von Artikelzusammenfassungen."""</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">articles</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">'* Keine Artikel gefunden.</span><span class="se">\n</span><span class="s">'</span>

    <span class="n">markdown_list</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">for</span> <span class="n">article</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">:</span>
        <span class="n">title</span><span class="p">,</span> <span class="n">summary</span> <span class="o">=</span> <span class="n">article</span>
        <span class="n">translated_title</span> <span class="o">=</span> <span class="n">translate_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">markdown_list</span> <span class="o">+=</span> <span class="sa">f</span><span class="s">'## </span><span class="si">{</span><span class="n">translated_title</span><span class="si">}</span><span class="se">\n\n</span><span class="si">{</span><span class="n">summary</span><span class="si">}</span><span class="se">\n\n</span><span class="s">'</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Markdown-Liste erstellt."</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">markdown_list</span>

<span class="k">def</span> <span class="nf">update_markdown_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">markdown_content</span><span class="p">):</span>
    <span class="s">"""Aktualisiert eine Markdown-Datei mit dem angegebenen Inhalt."""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Lesen des bestehenden Inhalts der Datei
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Lese bestehenden Inhalt von </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">existing_content</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>

        <span class="c1"># Finden der Start- und Endpositionen des Inhalts nach den anfänglichen Metadaten
</span>        <span class="n">start_index</span> <span class="o">=</span> <span class="n">existing_content</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'---'</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span>  <span class="c1"># Finden des zweiten '---' und darüber hinausgehen
</span>        <span class="n">end_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">existing_content</span><span class="p">)</span>

        <span class="c1"># Konstruieren des aktualisierten Inhalts
</span>        <span class="n">updated_content</span> <span class="o">=</span> <span class="n">existing_content</span><span class="p">[:</span><span class="n">start_index</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n\n</span><span class="s">'</span>  <span class="c1"># Metadaten beibehalten und eine neue Zeile hinzufügen
</span>        <span class="n">updated_content</span> <span class="o">+=</span> <span class="n">markdown_content</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span>  <span class="c1"># Neue Markdown-Liste hinzufügen
</span>        <span class="c1"># updated_content += existing_content[end_index:].strip() # Alles nach der Liste anhängen, falls vorhanden
</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'w'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">updated_content</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s"> erfolgreich aktualisiert"</span><span class="p">)</span>
        <span class="n">markdown_changed</span> <span class="o">=</span> <span class="n">existing_content</span> <span class="o">!=</span> <span class="n">updated_content</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Markdown geändert: </span><span class="si">{</span><span class="n">markdown_changed</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">markdown_changed</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Fehler beim Aktualisieren von </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="s">"""Hauptfunktion zum Abrufen, Verarbeiten und Aktualisieren der Markdown-Datei."""</span>
    <span class="n">nytimes_url</span> <span class="o">=</span> <span class="s">'https://m.cn.nytimes.com'</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'NYTimes-Links von abrufen: </span><span class="si">{</span><span class="n">nytimes_url</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>

    <span class="n">html_content</span> <span class="o">=</span> <span class="n">fetch_html_content</span><span class="p">(</span><span class="n">nytimes_url</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">html_content</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Hauptseiteninhalt konnte nicht abgerufen werden."</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">links</span> <span class="o">=</span> <span class="n">extract_links</span><span class="p">(</span><span class="n">html_content</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">links</span><span class="p">)</span><span class="si">}</span><span class="s"> Links auf der Hauptseite gefunden. Links extrahieren...'</span><span class="p">)</span>

    <span class="n">all_articles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">links</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">link</span><span class="p">[</span><span class="s">"url"</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">'/dual/'</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">'/'</span><span class="p">):</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s">'/dual/'</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s">'dual/'</span>

        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Verarbeiten von Link </span><span class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s"> von </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">links</span><span class="p">)</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
        <span class="n">article_html</span> <span class="o">=</span> <span class="n">fetch_html_content</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">article_html</span><span class="p">:</span>
            <span class="n">title</span><span class="p">,</span> <span class="n">summary</span> <span class="o">=</span> <span class="n">summarize_article</span><span class="p">(</span><span class="n">article_html</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">title</span> <span class="ow">and</span> <span class="n">summary</span><span class="p">:</span>
                <span class="n">all_articles</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">title</span><span class="p">,</span> <span class="n">summary</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Inhalt von </span><span class="si">{</span><span class="n">link</span><span class="p">[</span><span class="s">"url"</span><span class="p">]</span><span class="si">}</span><span class="s"> konnte nicht abgerufen werden'</span><span class="p">)</span>

    <span class="n">markdown_list</span> <span class="o">=</span> <span class="n">generate_markdown_list</span><span class="p">(</span><span class="n">all_articles</span><span class="p">)</span>

    <span class="n">filename</span> <span class="o">=</span> <span class="s">'original/2025-03-14-nytimes-en.md'</span>
    <span class="n">markdown_changed</span> <span class="o">=</span> <span class="n">update_markdown_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">markdown_list</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">markdown_changed</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Die Markdown-Datei wurde mit neuen Links aktualisiert."</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Die Markdown-Datei wurde nicht aktualisiert (keine Änderungen)."</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<p>Frontend-Code:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">nytimesDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">.nytimes</span><span class="dl">'</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">nytimesDiv</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">updateButton</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">button</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">updateButton</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">NYTimes Artikel aktualisieren</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">nytimesDiv</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">updateButton</span><span class="p">);</span>

    <span class="nx">updateButton</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://api.github.com/repos/lzwjava/lzwjava.github.io/actions/workflows/nytimes.yml/dispatches</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
            <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
                <span class="dl">'</span><span class="s1">Accept</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/vnd.github+json</span><span class="dl">'</span><span class="p">,</span>
                <span class="dl">'</span><span class="s1">Authorization</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bearer token</span><span class="dl">'</span><span class="p">,</span>
                <span class="dl">'</span><span class="s1">X-GitHub-Api-Version</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">2022-11-28</span><span class="dl">'</span><span class="p">,</span>
                <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span>
            <span class="p">},</span>
            <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="na">ref</span><span class="p">:</span> <span class="dl">'</span><span class="s1">main</span><span class="dl">'</span> <span class="p">})</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">204</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">Aktualisierung erfolgreich ausgelöst! Bitte warten Sie einige Minuten, um das Ergebnis zu sehen.</span><span class="dl">'</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">alert</span><span class="p">(</span><span class="s2">`Aktualisierung fehlgeschlagen. Statuscode: </span><span class="p">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Aktualisierung fehlgeschlagen:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">response</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">Aktualisierung fehlgeschlagen. Überprüfen Sie die Konsole auf Fehler.</span><span class="dl">'</span><span class="p">);</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Fehler beim Auslösen der Aktualisierung:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">"</span><span class="s2">nytimes div nicht gefunden!</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-de" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
