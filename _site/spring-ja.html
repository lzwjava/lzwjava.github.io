<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Spring Framework 総合ガイド</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Spring Framework 総合ガイド | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Spring Framework 総合ガイド" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="ja" />
<meta name="description" content="このブログ記事は、ChatGPT-4oの助けを借りて書かれました。" />
<meta property="og:description" content="このブログ記事は、ChatGPT-4oの助けを借りて書かれました。" />
<link rel="canonical" href="https://lzwjava.github.io/spring-ja" />
<meta property="og:url" content="https://lzwjava.github.io/spring-ja" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-07T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Spring Framework 総合ガイド" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2023-02-07T00:00:00+08:00","datePublished":"2023-02-07T00:00:00+08:00","description":"このブログ記事は、ChatGPT-4oの助けを借りて書かれました。","headline":"Spring Framework 総合ガイド","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/spring-ja"},"url":"https://lzwjava.github.io/spring-ja"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=9d33c9625b310542b63d0f8fe7f13cb8b17857dd">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=9d33c9625b310542b63d0f8fe7f13cb8b17857dd" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Spring Framework 総合ガイド | オリジナル、AI翻訳
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/ja/2023-02-07-spring-ja.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsja2023-02-07-spring-ja.md</span> -->
      

      <!-- <span>2023-02-07-spring-ja.md</span> -->

      
        

        
          
          <a href="#" class="button">2023.02</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/spring-en" >English</option>
        <option value="/spring-zh" >中文</option>
        <option value="/spring-ja" selected>日本語</option>
        <option value="/spring-es" >Español</option>
        <option value="/spring-hi" >हिंदी</option>
        <option value="/spring-fr" >Français</option>
        <option value="/spring-de" >Deutsch</option>
        <option value="/spring-ar" >العربية</option>
        <option value="/spring-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p><em>このブログ記事は、ChatGPT-4oの助けを借りて書かれました。</em></p>

<hr />

<h3 id="目次">目次</h3>
<ul>
  <li><a href="#introduction">はじめに</a></li>
  <li><a href="#spring-boot-framework">Spring Boot フレームワーク</a>
    <ul>
      <li><a href="#getting-started-with-spring-boot">Spring Boot の始め方</a></li>
      <li><a href="#dependency-injection">依存性注入</a></li>
      <li><a href="#events-in-spring">Spring のイベント</a></li>
    </ul>
  </li>
  <li><a href="#data-management-with-spring">Spring でのデータ管理</a>
    <ul>
      <li><a href="#spring-data-jdbc">Spring Data JDBC</a></li>
      <li><a href="#spring-data-jpa">Spring Data JPA</a></li>
      <li><a href="#spring-data-redis">Spring Data Redis</a></li>
      <li><a href="#transactions-and-dao-support">トランザクションと DAO サポート</a></li>
      <li><a href="#jdbc-and-orm">JDBC と ORM</a></li>
    </ul>
  </li>
  <li><a href="#building-restful-services">RESTful サービスの構築</a>
    <ul>
      <li><a href="#spring-rest-clients">Spring REST クライアント</a></li>
      <li><a href="#feignclient">FeignClient</a></li>
    </ul>
  </li>
  <li><a href="#email-tasks-and-scheduling">メール、タスク、スケジューリング</a>
    <ul>
      <li><a href="#email-support">メールサポート</a></li>
      <li><a href="#task-execution-and-scheduling">タスク実行とスケジューリング</a></li>
    </ul>
  </li>
  <li><a href="#testing-in-spring">Spring でのテスト</a>
    <ul>
      <li><a href="#testing-with-mockito">Mockito を使ったテスト</a></li>
      <li><a href="#testing-with-mockmvc">MockMvc を使ったテスト</a></li>
    </ul>
  </li>
  <li><a href="#monitoring-and-management">監視と管理</a>
    <ul>
      <li><a href="#spring-boot-actuator">Spring Boot Actuator</a></li>
    </ul>
  </li>
  <li><a href="#advanced-topics">高度なトピック</a>
    <ul>
      <li><a href="#spring-advice-api">Spring Advice API</a></li>
    </ul>
  </li>
  <li><a href="#conclusion">結論</a></li>
</ul>

<hr />

<h3 id="はじめに">はじめに</h3>

<p>Springは、Javaでエンタープライズグレードのアプリケーションを構築するための最も人気のあるフレームワークの一つです。Javaアプリケーションの開発に包括的なインフラストラクチャサポートを提供します。このブログでは、Spring Boot、データ管理、RESTfulサービスの構築、スケジューリング、テスト、そしてSpring Advice APIのような高度な機能など、Springエコシステムのさまざまな側面をカバーします。</p>

<hr />

<h3 id="spring-boot-フレームワーク">Spring Boot フレームワーク</h3>

<h4 id="spring-bootの始め方">Spring Bootの始め方</h4>

<p>Spring Bootは、スタンドアロンで本番環境に対応したSpringベースのアプリケーションを簡単に作成できるようにします。Springプラットフォームとサードパーティのライブラリに対して一定の見解を持ち、最小限の設定で始められるように設計されています。</p>

<ul>
  <li><strong>初期設定</strong>: まず、Spring Initializrを使用して新しいSpring Bootプロジェクトを作成します。Spring Web、Spring Data JPA、Spring Boot Actuatorなど、必要な依存関係を選択できます。</li>
  <li><strong>アノテーション</strong>: <code class="language-plaintext highlighter-rouge">@SpringBootApplication</code>のような主要なアノテーションについて学びます。これは<code class="language-plaintext highlighter-rouge">@Configuration</code>、<code class="language-plaintext highlighter-rouge">@EnableAutoConfiguration</code>、<code class="language-plaintext highlighter-rouge">@ComponentScan</code>を組み合わせたものです。</li>
  <li><strong>組み込みサーバー</strong>: Spring Bootは、Tomcat、Jetty、またはUndertowなどの組み込みサーバーを使用してアプリケーションを実行するため、外部サーバーにWARファイルをデプロイする必要はありません。</li>
</ul>

<h4 id="依存性注入">依存性注入</h4>

<p>依存性注入（Dependency Injection、略してDI）は、Springの核となる原則です。これにより、疎結合なコンポーネントの作成が可能になり、コードがよりモジュール化され、テストが容易になります。</p>

<ul>
  <li>@Autowired: このアノテーションは、依存関係を自動的に注入するために使用されます。コンストラクタ、フィールド、メソッドに適用できます。Springの依存性注入機能により、協調するビーンが自動的に解決され、あなたのビーンに注入されます。</li>
</ul>

<p>フィールドインジェクションの例:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Component</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>
      
      <span class="nd">@Autowired</span>
      <span class="kd">private</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
      
      <span class="c1">// ビジネスメソッド</span>
  <span class="o">}</span>
</code></pre></div></div>

<p>コンストラクタインジェクションの例:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Component</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>
      
      <span class="kd">private</span> <span class="kd">final</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">public</span> <span class="nf">UserService</span><span class="o">(</span><span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">userRepository</span> <span class="o">=</span> <span class="n">userRepository</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// ビジネスメソッド</span>
<span class="o">}</span>
</code></pre></div></div>

<p>メソッドインジェクションの例：</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Component</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>
      
      <span class="kd">private</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUserRepository</span><span class="o">(</span><span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">userRepository</span> <span class="o">=</span> <span class="n">userRepository</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">// ビジネスメソッド</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>
    <p>@Component, @Service, @Repository: これらは<code class="language-plaintext highlighter-rouge">@Component</code>アノテーションの特殊化で、クラスがSpringのBeanであることを示すために使用されます。また、アノテーションが付けられたクラスがどの役割を果たすかのヒントとしても機能します。</p>

    <ul>
      <li>
        <p>@Component: これは、Springが管理する任意のコンポーネントに対する汎用的なステレオタイプです。任意のクラスをSpringのbeanとしてマークするために使用できます。</p>

        <p>例:</p>
        <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmailValidator</span> <span class="o">{</span>
        
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// 検証ロジック</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>
    <p>@Service: このアノテーションは <code class="language-plaintext highlighter-rouge">@Component</code> の特殊化であり、クラスをサービスとしてマークするために使用されます。通常、ビジネスロジックを実装するサービス層で使用されます。</p>

    <p>例:</p>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Service</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>
        
      <span class="nd">@Autowired</span>
      <span class="kd">private</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">public</span> <span class="nc">User</span> <span class="nf">findUserById</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">).</span><span class="na">orElse</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>
    <p>@Repository: このアノテーションも<code class="language-plaintext highlighter-rouge">@Component</code>の特殊化です。このアノテーションは、クラスがオブジェクトの保存、取得、検索、更新、削除操作のメカニズムを提供することを示すために使用されます。また、永続化例外をSpringのDataAccessException階層に変換します。</p>

    <p>例:</p>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="c1">// カスタムクエリメソッド</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>これらのアノテーションは、Springの設定をより読みやすく簡潔にし、Springフレームワークが異なるビーン間の依存関係を管理し、接続するのに役立ちます。</p>

<h4 id="springでのイベント">Springでのイベント</h4>

<p>Springのイベントメカニズムを使用すると、アプリケーションイベントを作成し、それらをリスニングすることができます。</p>

<ul>
  <li>カスタムイベント: <code class="language-plaintext highlighter-rouge">ApplicationEvent</code>を拡張してカスタムイベントを作成します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyCustomEvent</span> <span class="kd">extends</span> <span class="nc">ApplicationEvent</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">message</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nf">MyCustomEvent</span><span class="o">(</span><span class="nc">Object</span> <span class="n">source</span><span class="o">,</span> <span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">(</span><span class="n">source</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>このコードは、<code class="language-plaintext highlighter-rouge">MyCustomEvent</code>というカスタムイベントクラスのコンストラクタを定義しています。このコンストラクタは、<code class="language-plaintext highlighter-rouge">source</code>と<code class="language-plaintext highlighter-rouge">message</code>という2つの引数を受け取り、<code class="language-plaintext highlighter-rouge">source</code>を親クラスのコンストラクタに渡し、<code class="language-plaintext highlighter-rouge">message</code>をインスタンス変数に設定します。</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>イベントリスナー: イベントを処理するために <code class="language-plaintext highlighter-rouge">@EventListener</code> を使用するか、<code class="language-plaintext highlighter-rouge">ApplicationListener</code> を実装します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyEventListener</span> <span class="o">{</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EventListener</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleMyCustomEvent</span><span class="o">(</span><span class="nc">MyCustomEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Springのカスタムイベントを受信しました - "</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>イベントの発行: <code class="language-plaintext highlighter-rouge">ApplicationEventPublisher</code>を使用してイベントを発行します。例えば：
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyEventPublisher</span> <span class="o">{</span>
      
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">ApplicationEventPublisher</span> <span class="n">applicationEventPublisher</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">publishCustomEvent</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"カスタムイベントを発行します。"</span><span class="o">);</span>
    <span class="nc">MyCustomEvent</span> <span class="n">customEvent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyCustomEvent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
    <span class="n">applicationEventPublisher</span><span class="o">.</span><span class="na">publishEvent</span><span class="o">(</span><span class="n">customEvent</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<hr />

<h3 id="springを使ったデータ管理">Springを使ったデータ管理</h3>

<h4 id="spring-data-jdbc">Spring Data JDBC</h4>

<p>Spring Data JDBCは、シンプルで効果的なJDBCアクセスを提供します。</p>

<ul>
  <li>リポジトリ: CRUD操作を実行するためのリポジトリを定義します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserRepository</span> <span class="kd">extends</span> <span class="nc">CrudRepository</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>クエリ: <code class="language-plaintext highlighter-rouge">@Query</code>アノテーションを使用してカスタムクエリを定義します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Query</span><span class="o">(</span><span class="s">"SELECT * FROM users WHERE username = :username"</span><span class="o">)</span>
<span class="nc">User</span> <span class="nf">findByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="spring-data-jpa">Spring Data JPA</h4>

<p>Spring Data JPAは、Java Persistence API (JPA)を使用してリレーショナルデータベースとのやり取りを簡素化するためのフレームワークです。Spring Data JPAは、リポジトリ抽象化を提供し、開発者がデータアクセス層を簡単に実装できるようにします。これにより、ボイラープレートコードを削減し、データベース操作をより直感的に行うことができます。</p>

<p>以下は、Spring Data JPAを使用して簡単なエンティティとリポジトリを定義する例です。</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">javax.persistence.Entity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.GeneratedValue</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.GenerationType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.Id</span><span class="o">;</span>

<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">AUTO</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>

    <span class="c1">// Getters and Setters</span>
<span class="o">}</span>

<span class="kn">import</span> <span class="nn">org.springframework.data.jpa.repository.JpaRepository</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nc">User</span> <span class="nf">findByEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>この例では、<code class="language-plaintext highlighter-rouge">User</code>エンティティと<code class="language-plaintext highlighter-rouge">UserRepository</code>インターフェースを定義しています。<code class="language-plaintext highlighter-rouge">UserRepository</code>は<code class="language-plaintext highlighter-rouge">JpaRepository</code>を拡張しており、<code class="language-plaintext highlighter-rouge">findByEmail</code>メソッドを提供しています。Spring Data JPAは、このメソッドの実装を自動的に生成し、指定されたメールアドレスに基づいてユーザーを検索します。</p>

<p>Spring Data JPAを使用することで、データベース操作を簡単に実装し、保守性の高いコードを書くことができます。</p>

<p>Spring Data JPAは、JPAベースのリポジトリを簡単に実装できるようにします。</p>

<ul>
  <li>エンティティマッピング: <code class="language-plaintext highlighter-rouge">@Entity</code>を使用してエンティティを定義し、データベーステーブルにマッピングします。例えば：
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>
    <span class="c1">// getters and setters</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>リポジトリ: <code class="language-plaintext highlighter-rouge">JpaRepository</code>を拡張してリポジトリインターフェースを作成します。例えば：
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>クエリメソッド: データベース操作を実行するためにクエリメソッドを使用します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">findByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="spring-data-redis">Spring Data Redis</h4>

<p>Spring Data Redisは、Redisベースのデータアクセスのためのインフラストラクチャを提供します。</p>

<ul>
  <li>RedisTemplate: Redisとやり取りするために<code class="language-plaintext highlighter-rouge">RedisTemplate</code>を使用します。例えば：
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">RedisTemplate</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">redisTemplate</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">set</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>このメソッドは、指定されたキーと値をRedisに保存するためのものです。<code class="language-plaintext highlighter-rouge">redisTemplate.opsForValue().set(key, value)</code>を使用して、Redisのキーと値を設定しています。</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">find</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>リポジトリ: <code class="language-plaintext highlighter-rouge">@Repository</code>を使用してRedisリポジトリを作成します。例：
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">RedisRepository</span> <span class="kd">extends</span> <span class="nc">CrudRepository</span><span class="o">&lt;</span><span class="nc">RedisEntity</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="トランザクションとdaoサポート">トランザクションとDAOサポート</h4>

<p>Springは、トランザクション管理とDAO（データアクセスオブジェクト）のサポートを簡素化します。</p>

<ul>
  <li>トランザクション管理: トランザクションを管理するために <code class="language-plaintext highlighter-rouge">@Transactional</code> を使用します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">saveUser</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">userRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>DAOパターン: 永続化ロジックを分離するためにDAOパターンを実装します。例えば：
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDao</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">JdbcTemplate</span> <span class="n">jdbcTemplate</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">User</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">queryForObject</span><span class="o">(</span><span class="s">"SELECT * FROM users WHERE id = ?"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[]{</span><span class="n">id</span><span class="o">},</span> <span class="k">new</span> <span class="nc">UserRowMapper</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
#### JDBCとORM

Springは、JDBCおよびORM（オブジェクトリレーショナルマッピング）に対する包括的なサポートを提供しています。

- JdbcTemplate: `JdbcTemplate`を使用してJDBC操作を簡素化します。例：
  ```java
  @Autowired
  private JdbcTemplate jdbcTemplate;
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="s">"SELECT * FROM users"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">UserRowMapper</span><span class="o">());</span>
  <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>Hibernate: Springと統合してORMサポートを提供します。例えば：
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>
    <span class="c1">// getters and setters</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<hr />

<h3 id="restfulサービスの構築">RESTfulサービスの構築</h3>

<h4 id="spring-restクライアント">Spring RESTクライアント</h4>

<p>Springは、RESTfulクライアントを簡単に構築できるようにします。</p>

<ul>
  <li>RestTemplate: HTTPリクエストを行うために<code class="language-plaintext highlighter-rouge">RestTemplate</code>を使用します。例：
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">RestTemplate</span> <span class="n">restTemplate</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getUserInfo</span><span class="o">(</span><span class="nc">String</span> <span class="n">userId</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">restTemplate</span><span class="o">.</span><span class="na">getForObject</span><span class="o">(</span><span class="s">"https://api.example.com/users/"</span> <span class="o">+</span> <span class="n">userId</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>WebClient: 非ブロッキングリクエストにはリアクティブな <code class="language-plaintext highlighter-rouge">WebClient</code> を使用します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">WebClient</span><span class="o">.</span><span class="na">Builder</span> <span class="n">webClientBuilder</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getUserInfo</span><span class="o">(</span><span class="nc">String</span> <span class="n">userId</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">webClientBuilder</span><span class="o">.</span><span class="na">build</span><span class="o">()</span>
              <span class="o">.</span><span class="na">get</span><span class="o">()</span>
              <span class="o">.</span><span class="na">uri</span><span class="o">(</span><span class="s">"https://api.example.com/users/"</span> <span class="o">+</span> <span class="n">userId</span><span class="o">)</span>
              <span class="o">.</span><span class="na">retrieve</span><span class="o">()</span>
              <span class="o">.</span><span class="na">bodyToMono</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div>

<p>このコードは、指定されたユーザーIDに基づいて、外部APIからユーザー情報を取得するためのメソッドです。<code class="language-plaintext highlighter-rouge">webClientBuilder</code>を使用してHTTP GETリクエストを送信し、レスポンスを<code class="language-plaintext highlighter-rouge">Mono&lt;String&gt;</code>として返します。</p>

<h4 id="feignclient">FeignClient</h4>

<p>FeignClientは、Spring Cloudで提供される宣言型のRESTクライアントです。これを使用することで、HTTPリクエストを簡単に作成し、他のマイクロサービスと通信することができます。FeignClientは、インターフェースにアノテーションを付けるだけで、REST APIの呼び出しを抽象化し、コードを簡潔に保つことができます。</p>

<p>以下は、FeignClientの基本的な使用例です：</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@FeignClient</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"example-service"</span><span class="o">,</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"http://localhost:8080"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ExampleServiceClient</span> <span class="o">{</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/api/resource"</span><span class="o">)</span>
    <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getResource</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>この例では、<code class="language-plaintext highlighter-rouge">ExampleServiceClient</code>インターフェースが<code class="language-plaintext highlighter-rouge">example-service</code>という名前のサービスと通信するためのFeignクライアントとして定義されています。<code class="language-plaintext highlighter-rouge">@GetMapping</code>アノテーションを使用して、<code class="language-plaintext highlighter-rouge">/api/resource</code>エンドポイントにGETリクエストを送信し、レスポンスを<code class="language-plaintext highlighter-rouge">ResponseEntity&lt;String&gt;</code>として受け取ります。</p>

<p>FeignClientを使用することで、HTTPリクエストの詳細を気にすることなく、シンプルで読みやすいコードを書くことができます。また、Spring Cloudの他の機能（例えば、サービスディスカバリやロードバランシング）と統合することで、さらに強力なマイクロサービスアーキテクチャを構築することが可能です。</p>

<p>Feignは宣言型のウェブサービスクライアントです。</p>

<ul>
  <li>セットアップ: プロジェクトにFeignを追加し、<code class="language-plaintext highlighter-rouge">@FeignClient</code>アノテーションを付けたインターフェースを作成します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@FeignClient</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"user-service"</span><span class="o">,</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.example.com"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserServiceClient</span> <span class="o">{</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/users/{id}"</span><span class="o">)</span>
    <span class="nc">String</span> <span class="nf">getUserInfo</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">userId</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>設定: インターセプターとエラーデコーダーを使用してFeignクライアントをカスタマイズします。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Bean</span>
<span class="kd">public</span> <span class="nc">RequestInterceptor</span> <span class="nf">requestInterceptor</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">requestTemplate</span> <span class="o">-&gt;</span> <span class="n">requestTemplate</span><span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="s">"Bearer token"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<hr />

<h3 id="メールタスクスケジューリング">メール、タスク、スケジューリング</h3>

<h4 id="メールサポート">メールサポート</h4>

<p>Springはメール送信のサポートを提供しています。</p>

<ul>
  <li>JavaMailSender: メールを送信するために <code class="language-plaintext highlighter-rouge">JavaMailSender</code> を使用します。例えば：
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">JavaMailSender</span> <span class="n">mailSender</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">sendEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">to</span><span class="o">,</span> <span class="nc">String</span> <span class="n">subject</span><span class="o">,</span> <span class="nc">String</span> <span class="n">body</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">SimpleMailMessage</span> <span class="n">message</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleMailMessage</span><span class="o">();</span>
      <span class="n">message</span><span class="o">.</span><span class="na">setTo</span><span class="o">(</span><span class="n">to</span><span class="o">);</span>
      <span class="n">message</span><span class="o">.</span><span class="na">setSubject</span><span class="o">(</span><span class="n">subject</span><span class="o">);</span>
      <span class="n">message</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">body</span><span class="o">);</span>
      <span class="n">mailSender</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>MimeMessage: 添付ファイルやHTMLコンテンツを含むリッチなメールを作成します。例：
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">JavaMailSender</span> <span class="n">mailSender</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">sendRichEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">to</span><span class="o">,</span> <span class="nc">String</span> <span class="n">subject</span><span class="o">,</span> <span class="nc">String</span> <span class="n">body</span><span class="o">,</span> <span class="nc">File</span> <span class="n">attachment</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">MessagingException</span> <span class="o">{</span>
      <span class="nc">MimeMessage</span> <span class="n">message</span> <span class="o">=</span> <span class="n">mailSender</span><span class="o">.</span><span class="na">createMimeMessage</span><span class="o">();</span>
      <span class="nc">MimeMessageHelper</span> <span class="n">helper</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MimeMessageHelper</span><span class="o">(</span><span class="n">message</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
      <span class="n">helper</span><span class="o">.</span><span class="na">setTo</span><span class="o">(</span><span class="n">to</span><span class="o">);</span>
      <span class="n">helper</span><span class="o">.</span><span class="na">setSubject</span><span class="o">(</span><span class="n">subject</span><span class="o">);</span>
      <span class="n">helper</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">body</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
      <span class="n">helper</span><span class="o">.</span><span class="na">addAttachment</span><span class="o">(</span><span class="n">attachment</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">attachment</span><span class="o">);</span>
      <span class="n">mailSender</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div>

<h4 id="タスクの実行とスケジューリング">タスクの実行とスケジューリング</h4>

<p>Springのタスク実行およびスケジューリングサポートにより、タスクを簡単に実行できます。</p>

<ul>
  <li>@Scheduled: <code class="language-plaintext highlighter-rouge">@Scheduled</code>を使用してタスクをスケジュールします。例えば：
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Scheduled</span><span class="o">(</span><span class="n">fixedRate</span> <span class="o">=</span> <span class="mi">5000</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">performTask</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"5秒ごとに実行されるスケジュールタスク"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>Async Tasks: <code class="language-plaintext highlighter-rouge">@Async</code>を使用してタスクを非同期で実行します。例：
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Async</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">performAsyncTask</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"バックグラウンドで非同期タスクを実行中"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<hr />

<h3 id="springでのテスト">Springでのテスト</h3>

<h4 id="mockitoを使ったテスト">Mockitoを使ったテスト</h4>

<p>Mockitoは、テストのための強力なモックライブラリです。</p>

<ul>
  <li>依存関係のモック化: <code class="language-plaintext highlighter-rouge">@Mock</code> と <code class="language-plaintext highlighter-rouge">@InjectMocks</code> を使用してモックオブジェクトを作成します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RunWith</span><span class="o">(</span><span class="nc">MockitoJUnitRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserServiceTest</span> <span class="o">{</span>
    <span class="nd">@Mock</span>
    <span class="kd">private</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@InjectMocks</span>
<span class="kd">private</span> <span class="nc">UserService</span> <span class="n">userService</span><span class="o">;</span>
</code></pre></div></div>

<p>このコードは、<code class="language-plaintext highlighter-rouge">UserService</code>クラスのインスタンスをモックオブジェクトに注入するために使用されます。<code class="language-plaintext highlighter-rouge">@InjectMocks</code>アノテーションは、テスト対象のクラス（この場合は<code class="language-plaintext highlighter-rouge">UserService</code>）にモックオブジェクトを自動的に注入するために使用されます。これにより、テスト中にモックオブジェクトを使用して依存関係をシミュレートすることができます。</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testFindUserById</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="o">();</span>
    <span class="n">user</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="mi">1L</span><span class="o">);</span>
    <span class="nc">Mockito</span><span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">userRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="mi">1L</span><span class="o">)).</span><span class="na">thenReturn</span><span class="o">(</span><span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">user</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>          <span class="nc">User</span> <span class="n">result</span> <span class="o">=</span> <span class="n">userService</span><span class="o">.</span><span class="na">findUserById</span><span class="o">(</span><span class="mi">1L</span><span class="o">);</span>
          <span class="n">assertNotNull</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
          <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1L</span><span class="o">,</span> <span class="n">result</span><span class="o">.</span><span class="na">getId</span><span class="o">().</span><span class="na">longValue</span><span class="o">());</span>
      <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>動作検証: モックオブジェクトとの相互作用を検証します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Mockito</span><span class="o">.</span><span class="na">verify</span><span class="o">(</span><span class="n">userRepository</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">findById</span><span class="o">(</span><span class="mi">1L</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="mockmvcを使ったテスト">MockMvcを使ったテスト</h4>

<p>MockMvcを使用すると、Spring MVCコントローラーのテストを行うことができます。</p>

<ul>
  <li>セットアップ: テストクラスでMockMvcを設定します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RunWith</span><span class="o">(</span><span class="nc">SpringRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@WebMvcTest</span><span class="o">(</span><span class="nc">UserController</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserControllerTest</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGetUser</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/users/1"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">content</span><span class="o">().</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">))</span>
        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.id"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>リクエストビルダー: HTTPリクエストをシミュレートするためにリクエストビルダーを使用します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/users"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
    <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="s">"{\"username\":\"john\",\"password\":\"secret\"}"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isCreated</span><span class="o">());</span>
</code></pre></div>    </div>
  </li>
</ul>

<hr />

<h3 id="監視と管理">監視と管理</h3>

<h4 id="spring-boot-actuator">Spring Boot Actuator</h4>

<p>Spring Boot Actuatorは、アプリケーションの監視と管理のための本番環境対応の機能を提供します。</p>

<ul>
  <li>エンドポイント: アプリケーションの健全性やメトリクスを監視するために、<code class="language-plaintext highlighter-rouge">/actuator/health</code> や <code class="language-plaintext highlighter-rouge">/actuator/metrics</code> などのエンドポイントを使用します。例えば:
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl http://localhost:8080/actuator/health
</code></pre></div>    </div>
  </li>
  <li>カスタムエンドポイント: カスタムのアクチュエーターエンドポイントを作成します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/actuator"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomEndpoint</span> <span class="o">{</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/custom"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="nf">customEndpoint</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">response</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"status"</span><span class="o">,</span> <span class="s">"カスタムアクチュエーターエンドポイント"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<hr />

<h3 id="高度なトピック">高度なトピック</h3>

<h4 id="spring-advice-api">Spring Advice API</h4>

<p>SpringのAdvice APIは、高度なAOP（アスペクト指向プログラミング）機能を提供します。</p>

<ul>
  <li>@Aspect: <code class="language-plaintext highlighter-rouge">@Aspect</code>を使用してアスペクトを定義します。例えば：
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Aspect</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoggingAspect</span> <span class="o">{</span>
    <span class="nd">@Before</span><span class="o">(</span><span class="s">"execution(* com.example.service.*.*(..))"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">logBefore</span><span class="o">(</span><span class="nc">JoinPoint</span> <span class="n">joinPoint</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"メソッドの前: "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@After</span><span class="o">(</span><span class="s">"execution(* com.example.service.*.*(..))"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">logAfter</span><span class="o">(</span><span class="nc">JoinPoint</span> <span class="n">joinPoint</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"メソッドの後: "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>

<p>このコードは、<code class="language-plaintext highlighter-rouge">com.example.service</code>パッケージ内のすべてのメソッドが実行された後に、そのメソッド名を出力するAOP（Aspect-Oriented Programming）のアスペクトを定義しています。<code class="language-plaintext highlighter-rouge">@After</code>アノテーションは、指定されたポイントカット（この場合は<code class="language-plaintext highlighter-rouge">execution(* com.example.service.*.*(..))</code>）にマッチするメソッドが実行された後に、<code class="language-plaintext highlighter-rouge">logAfter</code>メソッドを実行することを示しています。<code class="language-plaintext highlighter-rouge">JoinPoint</code>オブジェクトは、実行されたメソッドに関する情報を提供します。</p>

<ul>
  <li>結合ポイント（Join Points）: アスペクトを適用する場所を定義するために結合ポイントを使用します。例えば:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Pointcut</span><span class="o">(</span><span class="s">"execution(* com.example.service.*.*(..))"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">serviceMethods</span><span class="o">()</span> <span class="o">{}</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Around</span><span class="o">(</span><span class="s">"serviceMethods()"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">logAround</span><span class="o">(</span><span class="nc">ProceedingJoinPoint</span> <span class="n">joinPoint</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"メソッドの前: "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
      <span class="nc">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">proceed</span><span class="o">();</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"メソッドの後: "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
      <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
  <span class="o">}</span>
</code></pre></div></div>

<hr />

<h3 id="結論">結論</h3>

<p>Springは、エンタープライズレベルのアプリケーション開発を簡素化する強力で多機能なフレームワークです。Spring Boot、Spring Data、Spring REST、およびその他のSpringプロジェクトの機能を活用することで、開発者は堅牢でスケーラブル、かつ保守性の高いアプリケーションを効率的に構築できます。Spring Boot Actuatorやテストフレームワークなどのツールを追加することで、アプリケーションが本番環境に対応し、十分にテストされていることを保証できます。</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-ja" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
