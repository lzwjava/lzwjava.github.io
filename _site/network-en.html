<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Cloud IPs, Network Interface and WiFi Optimization</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Cloud IPs, Network Interface and WiFi Optimization | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Cloud IPs, Network Interface and WiFi Optimization" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="Table of Contents" />
<meta property="og:description" content="Table of Contents" />
<link rel="canonical" href="https://lzwjava.github.io/network-en" />
<meta property="og:url" content="https://lzwjava.github.io/network-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-02-08T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Cloud IPs, Network Interface and WiFi Optimization" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2025-02-08T00:00:00+08:00","datePublished":"2025-02-08T00:00:00+08:00","description":"Table of Contents","headline":"Cloud IPs, Network Interface and WiFi Optimization","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/network-en"},"url":"https://lzwjava.github.io/network-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=eb1c6983ab5bd692b0cfe0d27b6a7db985d443c7">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=eb1c6983ab5bd692b0cfe0d27b6a7db985d443c7" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Cloud IPs, Network Interface and WiFi Optimization | Original
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/en/2025-02-08-network-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsen2025-02-08-network-en.md</span> -->
      

      <!-- <span>2025-02-08-network-en.md</span> -->

      
        

        
          
          <a href="#" class="button">2025.02</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/network-en" selected>English</option>
        <option value="/network-zh" >中文</option>
        <option value="/network-ja" >日本語</option>
        <option value="/network-es" >Español</option>
        <option value="/network-hi" >हिंदी</option>
        <option value="/network-fr" >Français</option>
        <option value="/network-de" >Deutsch</option>
        <option value="/network-ar" >العربية</option>
        <option value="/network-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <h3 id="table-of-contents">Table of Contents</h3>

<ol>
  <li><a href="#floating-ips-in-hetzner-cloud">Floating IPs in Hetzner Cloud</a>
    <ul>
      <li>IP Configuration Commands</li>
      <li>Netplan Configuration Setup</li>
      <li>Network Configuration Files</li>
    </ul>
  </li>
  <li><a href="#network-interface-management">Network Interface Management</a>
    <ul>
      <li>Deleting TUN Interfaces</li>
      <li>Interface Status Monitoring</li>
      <li>Network Troubleshooting</li>
    </ul>
  </li>
  <li><a href="#lan-ip-scanner">LAN IP Scanner</a>
    <ul>
      <li>Python Network Scanning Script</li>
      <li>Multithreaded Host Discovery</li>
      <li>Port Scanning Capabilities</li>
      <li>Device Identification on Local Networks</li>
    </ul>
  </li>
  <li><a href="#bypassing-local-ips">Bypassing Local IPs</a>
    <ul>
      <li>Proxy Configuration for Local Networks</li>
      <li>Subnet Mask Calculations</li>
      <li>Network Range Planning</li>
    </ul>
  </li>
  <li><a href="#ssh-connection-using-ipv6-address">SSH Connection using IPv6 Address</a>
    <ul>
      <li>IPv6 SSH Configuration</li>
      <li>SSH Config File Management</li>
      <li>Proxy Command Setup for Different Address Types</li>
      <li>Performance Optimization</li>
    </ul>
  </li>
  <li><a href="#improving-wifi-speed">Improving Wifi Speed</a>
    <ul>
      <li>Old vs New Modem Performance</li>
      <li>Network Setup Configurations</li>
      <li>Wired vs Wireless Bridge Modes</li>
      <li>Troubleshooting Network Bottlenecks</li>
    </ul>
  </li>
  <li><a href="#openwrt-reset">OpenWrt Reset</a>
    <ul>
      <li>Web Interface Reset Methods</li>
      <li>Command Line Reset Procedures</li>
      <li>Factory Default Restoration</li>
    </ul>
  </li>
</ol>

<h2 id="floating-ips-in-hetzner-cloud">Floating IPs in Hetzner Cloud</h2>

<h3 id="ip">IP</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>ip addr add 78.47.144.0 dev eth0
</code></pre></div></div>

<h3 id="netplan">Netplan</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">touch</span> /etc/netplan/60-floating-ip.yaml
nano /etc/netplan/60-floating-ip.yaml
</code></pre></div></div>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">network</span><span class="pi">:</span>
   <span class="na">version</span><span class="pi">:</span> <span class="m">2</span>
   <span class="na">renderer</span><span class="pi">:</span> <span class="s">networkd</span>
   <span class="na">ethernets</span><span class="pi">:</span>
     <span class="na">eth0</span><span class="pi">:</span>
       <span class="na">addresses</span><span class="pi">:</span>
       <span class="pi">-</span> <span class="s">78.47.144.0/32</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>netplan apply
</code></pre></div></div>

<hr />

<h2 id="network-interface-management">Network Interface Management</h2>

<p>Delete the <code class="language-plaintext highlighter-rouge">tun</code> interface.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nv">$ </span>ipconfig

outline-tun0: <span class="nv">flags</span><span class="o">=</span>4305&lt;UP,POINTOPOINT,RUNNING,NOARP,MULTICAST&gt;  mtu 1500
        inet 10.0.85.1  netmask 255.255.255.255  destination 10.0.85.1
        unspec 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  txqueuelen 500  <span class="o">(</span>UNSPEC<span class="o">)</span>
        RX packets 208  bytes 8712 <span class="o">(</span>8.7 KB<span class="o">)</span>
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 385  bytes 23322 <span class="o">(</span>23.3 KB<span class="o">)</span>
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

<span class="nv">$ </span><span class="nb">sudo </span>ip <span class="nb">link </span>delete outline-tun0

</code></pre></div></div>

<hr />

<h2 id="lan-ip-scanner">LAN IP Scanner</h2>

<p>This Python script scans a local network for active IP addresses. It uses the <code class="language-plaintext highlighter-rouge">ping</code> command to check if a host is reachable and employs multithreading to speed up the scanning process.  A semaphore limits the number of concurrent threads to avoid overwhelming the system. The script takes a network address (e.g., “192.168.1.0/24”) as input and prints whether each IP address in the network is up or down.</p>

<p>This script helps identify devices on the network, such as a TP-LINK mesh router operating in wired bridge mode, by scanning for active IP addresses.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">ipaddress</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">argparse</span>

<span class="n">MAX_THREADS</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Maximum number of threads to use
</span>
<span class="k">def</span> <span class="nf">is_host_up</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="s">"""
    Checks if a host is up using ping or telnet.
    If port is specified, uses telnet to check if the port is open.
    Otherwise, uses ping.
    Returns True if the host is up, False otherwise.
    """</span>
    <span class="k">if</span> <span class="n">port</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="p">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="p">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="p">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
            <span class="n">sock</span><span class="p">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">sock</span><span class="p">.</span><span class="n">connect_ex</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span>
        <span class="k">except</span> <span class="n">socket</span><span class="p">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">sock</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># -c 1: Send only 1 packet
</span>            <span class="c1"># -W 1: Wait 1 second for a response
</span>            <span class="n">subprocess</span><span class="p">.</span><span class="n">check_output</span><span class="p">([</span><span class="s">"ping"</span><span class="p">,</span> <span class="s">"-c"</span><span class="p">,</span> <span class="s">"1"</span><span class="p">,</span> <span class="s">"-W"</span><span class="p">,</span> <span class="s">"1"</span><span class="p">,</span> <span class="n">host</span><span class="p">],</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">except</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">except</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">TimeoutExpired</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">scan_ip</span><span class="p">(</span><span class="n">ip_str</span><span class="p">,</span> <span class="n">up_ips</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="s">"""
    Scans a single IP address and prints its status.
    """</span>
    <span class="k">if</span> <span class="n">is_host_up</span><span class="p">(</span><span class="n">ip_str</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">ip_str</span><span class="si">}</span><span class="s"> is up"</span><span class="p">)</span>
        <span class="n">up_ips</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">ip_str</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">ip_str</span><span class="si">}</span><span class="s"> is down"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">scan_network</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="s">"""
    Scans a network for live hosts using threads, limiting the number of concurrent threads.
    """</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Scanning network: </span><span class="si">{</span><span class="n">network</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="n">threads</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">semaphore</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Semaphore</span><span class="p">(</span><span class="n">MAX_THREADS</span><span class="p">)</span>  <span class="c1"># Limit the number of concurrent threads
</span>    <span class="n">up_ips</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">scan_ip_with_semaphore</span><span class="p">(</span><span class="n">ip_str</span><span class="p">):</span>
        <span class="n">semaphore</span><span class="p">.</span><span class="n">acquire</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">scan_ip</span><span class="p">(</span><span class="n">ip_str</span><span class="p">,</span> <span class="n">up_ips</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">semaphore</span><span class="p">.</span><span class="n">release</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">ipaddress</span><span class="p">.</span><span class="n">IPv4Network</span><span class="p">(</span><span class="n">network</span><span class="p">):</span>
        <span class="n">ip_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
        <span class="n">thread</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">scan_ip_with_semaphore</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">ip_str</span><span class="p">,))</span>
        <span class="n">threads</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">thread</span><span class="p">)</span>
        <span class="n">thread</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">thread</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
        <span class="n">thread</span><span class="p">.</span><span class="n">join</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">up_ips</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">"Scan a network for live hosts."</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"network"</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s">'?'</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">"192.168.1.0/24"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"The network to scan (e.g., 192.168.1.0/24)"</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"-p"</span><span class="p">,</span> <span class="s">"--port"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"The port to check (optional)"</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">network_to_scan</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">network</span>
    <span class="n">port_to_scan</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">port</span>

    <span class="n">up_ips</span> <span class="o">=</span> <span class="n">scan_network</span><span class="p">(</span><span class="n">network_to_scan</span><span class="p">,</span> <span class="n">port_to_scan</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Live IPs:"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">up_ips</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>


</code></pre></div></div>

<h2 id="bypassing-local-ips">Bypassing Local IPs</h2>

<p>The script identifies active IP addresses. To ensure proper network communication, verify that proxy settings are configured to bypass these local IPs.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,127.0.0.1,localhost,<span class="k">*</span>.local,timestamp.apple.com,sequoia.apple.com,seed-sequoia.siri.apple.com, 192.168.1.0/16
</code></pre></div></div>

<h2 id="subnet-masks">Subnet Masks</h2>

<p>My second machine is usually at 192.168.1.16.</p>

<p>So it works using the command below.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python scripts/ip_scan.py 192.168.1.0/27 <span class="nt">-p</span> 22
</code></pre></div></div>

<p>because 32 - 27 = 5, 2^5 = 32, so it will try <code class="language-plaintext highlighter-rouge">192.168.1.0</code> to <code class="language-plaintext highlighter-rouge">192.168.1.31</code>.</p>

<p>But it doesn’t work when using <code class="language-plaintext highlighter-rouge">192.168.1.0/28</code>, because 2^4 = 16, so it will try <code class="language-plaintext highlighter-rouge">192.168.1.0</code> to <code class="language-plaintext highlighter-rouge">192.168.1.15</code>, which doesn’t cover <code class="language-plaintext highlighter-rouge">192.168.1.16</code>.</p>

<hr />

<h2 id="ssh-connection-using-ipv6-address">SSH connection using IPv6 address</h2>

<p>I’m trying to connect to a machine in Hetzner Cloud using IPv6. <code class="language-plaintext highlighter-rouge">ssh 2a01:4f8:c17:2000::/64</code> doesn’t work, but <code class="language-plaintext highlighter-rouge">ssh root@2a01:4f8:c17:2000::1</code> does.</p>

<p>The IPv6 address was copied from the Hetzner Cloud console.</p>

<p>The <code class="language-plaintext highlighter-rouge">~/.ssh/config</code> file can be configured to apply different proxy rules for IPv4 and IPv6 addresses. This setup allows you to specify a proxy command for IPv4 addresses while handling IPv6 addresses differently.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Host 192.168.1.<span class="k">*</span>
    UseKeychain <span class="nb">yes
    </span>AddKeysToAgent <span class="nb">yes
    </span>IdentityFile ~/.ssh/id_rsa 
Host <span class="k">*</span>.<span class="k">*</span>.<span class="k">*</span>.<span class="k">*</span>
    UseKeychain <span class="nb">yes
    </span>AddKeysToAgent <span class="nb">yes
    </span>IdentityFile ~/.ssh/id_rsa
    ProxyCommand corkscrew localhost 7890 %h %p
Host <span class="k">*</span>
    UseKeychain <span class="nb">yes
    </span>AddKeysToAgent <span class="nb">yes
    </span>IdentityFile ~/.ssh/id_rsa   
</code></pre></div></div>

<p>When running <code class="language-plaintext highlighter-rouge">ssh root@192.168.1.3</code>, the following output shows the SSH client applying configuration options from the <code class="language-plaintext highlighter-rouge">~/.ssh/config</code> file:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>debug1: Reading configuration data /Users/lzwjava/.ssh/config
debug1: /Users/lzwjava/.ssh/config line 1: Applying options <span class="k">for </span>192.168.1.<span class="k">*</span>
debug1: /Users/lzwjava/.ssh/config line 5: Applying options <span class="k">for</span> <span class="k">*</span>.<span class="k">*</span>.<span class="k">*</span>.<span class="k">*</span>
debug2: add_identity_file: ignoring duplicate key ~/.ssh/id_rsa
debug1: /Users/lzwjava/.ssh/config line 10: Applying options <span class="k">for</span> <span class="k">*</span>
debug2: add_identity_file: ignoring duplicate key ~/.ssh/id_rsa
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 21: include /etc/ssh/ssh_config.d/<span class="k">*</span> matched no files
debug1: /etc/ssh/ssh_config line 54: Applying options <span class="k">for</span> <span class="k">*</span>
debug2: resolve_canonicalize: <span class="nb">hostname </span>192.168.1.3 is address
debug3: expanded UserKnownHostsFile <span class="s1">'~/.ssh/known_hosts'</span> -&gt; <span class="s1">'/Users/lzwjava/.ssh/known_hosts'</span>
debug3: expanded UserKnownHostsFile <span class="s1">'~/.ssh/known_hosts2'</span> -&gt; <span class="s1">'/Users/lzwjava/.ssh/known_hosts2'</span>
debug1: Authenticator provider <span class="nv">$SSH_SK_PROVIDER</span> did not resolve<span class="p">;</span> disabling
debug3: channel_clear_timeouts: clearing
debug1: Executing proxy <span class="nb">command</span>: <span class="nb">exec </span>corkscrew localhost 7890 192.168.1.3 22
</code></pre></div></div>

<p>The SSH connection speed was noticeably slow, so I reverted to the following simpler configuration:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Host 192.168.1.<span class="k">*</span>
    UseKeychain <span class="nb">yes
    </span>AddKeysToAgent <span class="nb">yes
    </span>IdentityFile ~/.ssh/id_rsa 
Host <span class="k">*</span>
    UseKeychain <span class="nb">yes
    </span>AddKeysToAgent <span class="nb">yes
    </span>IdentityFile ~/.ssh/id_rsa  
    ProxyCommand corkscrew localhost 7890 %h %p 
</code></pre></div></div>

<p>The issue arises when using IPv6 addresses with the <code class="language-plaintext highlighter-rouge">ProxyCommand corkscrew localhost 7890 %h %p</code> directive, as this proxy command may not handle IPv6 addresses correctly.</p>

<p>The configuration above is still not working. However, the one below is fine.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Host 192.168.1.<span class="k">*</span>
    UseKeychain <span class="nb">yes
    </span>AddKeysToAgent <span class="nb">yes
    </span>IdentityFile ~/.ssh/id_rsa 
Host <span class="o">!</span>192.<span class="k">*</span>.<span class="k">*</span>.<span class="k">*</span>
    UseKeychain <span class="nb">yes
    </span>AddKeysToAgent <span class="nb">yes
    </span>IdentityFile ~/.ssh/id_rsa  
    ProxyCommand corkscrew localhost 7890 %h %p 
Host <span class="k">*</span>
    UseKeychain <span class="nb">yes
    </span>AddKeysToAgent <span class="nb">yes
    </span>IdentityFile ~/.ssh/id_rsa  
</code></pre></div></div>

<hr />

<h2 id="improving-wifi-speed">Improving Wifi Speed</h2>

<h3 id="old-modem-issues">Old Modem Issues</h3>

<p>In my parent’s house, the modem is quite old, likely around 10 years old. The initial network setup was:</p>

<p>modem -&gt; 3m wireless -&gt; TP-Link AX3000 (wireless bridge mode) -&gt; 2m, a wall, wireless -&gt; Laptop</p>

<p>This resulted in a low download speed, with a Speedtest result of only 10 Mbps.</p>

<p>An improved setup involved using a wired connection:</p>

<p>modem -&gt; 2m cable -&gt; TP-Link AX3000 (wired bridge mode) -&gt; 4m wireless, a wall -&gt; Laptop</p>

<p>This improved the download speed to up to 90 Mbps.</p>

<h3 id="new-modem-performance">New Modem Performance</h3>

<p>In my own house, the modem is new, and the TP-Link router performs well in wireless bridge mode. The network setup is:</p>

<p>modem -&gt; 4m wireless -&gt; TP-Link AX3000 (wireless bridge mode) -&gt; 2m wireless -&gt; Laptop</p>

<p>The network quality is good.</p>

<h3 id="troubleshooting-tips">Troubleshooting Tips</h3>

<p>There isn’t a single solution to improve Wi-Fi speed. A good approach is to use a cable to test each part of your network to identify bottlenecks. Compare speeds when using a wired connection versus Wi-Fi. Also, try connecting devices directly with a cable to see if that improves performance.</p>

<hr />

<h2 id="openwrt-reset">OpenWrt Reset</h2>

<h3 id="resetting-via-the-web-interface">Resetting via the Web Interface</h3>

<p>It’s recommended to connect to the router via an ethernet cable. After a reset, the Wi-Fi SSID will revert to its default settings, which may not be what you expect.</p>

<h3 id="resetting-via-command-line-ssh">Resetting via Command Line (SSH)</h3>

<p>You can reset OpenWrt to its default settings using the command line interface (SSH). Here’s how:</p>

<ol>
  <li>Connect to your OpenWrt router via SSH.</li>
  <li>
    <p>Run the following command:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@OpenWrt:~# firstboot
This will erase all settings and remove any installed packages. Are you sure? <span class="o">[</span>N/y]
y
/dev/ubi0_1 is mounted as /overlay, only erasing files
root@OpenWrt:~# reboot
</code></pre></div>    </div>
  </li>
  <li>The router will reboot with default settings.</li>
</ol>

<p><strong>Explanation of the commands:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">firstboot</code>: This command initiates the reset process, erasing all configurations and installed packages.</li>
  <li><code class="language-plaintext highlighter-rouge">reboot</code>: This command restarts the router, applying the reset.</li>
</ul>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
