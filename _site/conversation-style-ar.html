<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>توليد الصوت للمحادثات</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>توليد الصوت للمحادثات | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="توليد الصوت للمحادثات" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="ar" />
<meta name="description" content="مستوحى من مقطع فيديو على YouTube يتضمن مناقشة حول DeepSeek-V3، كنت أجرب محادثات تم إنشاؤها بواسطة الذكاء الاصطناعي. هدفي هو إنشاء حوارات صوتية واقعية باستخدام Google Text-to-Speech و ffmpeg لتوليد وتسلسل الصوت. يوضح الكود التالي نهجي الحالي لمحاكاة محادثة طبيعية بين شخصين." />
<meta property="og:description" content="مستوحى من مقطع فيديو على YouTube يتضمن مناقشة حول DeepSeek-V3، كنت أجرب محادثات تم إنشاؤها بواسطة الذكاء الاصطناعي. هدفي هو إنشاء حوارات صوتية واقعية باستخدام Google Text-to-Speech و ffmpeg لتوليد وتسلسل الصوت. يوضح الكود التالي نهجي الحالي لمحاكاة محادثة طبيعية بين شخصين." />
<link rel="canonical" href="https://lzwjava.github.io/conversation-style-ar" />
<meta property="og:url" content="https://lzwjava.github.io/conversation-style-ar" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-17T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="توليد الصوت للمحادثات" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2025-01-17T00:00:00+08:00","datePublished":"2025-01-17T00:00:00+08:00","description":"مستوحى من مقطع فيديو على YouTube يتضمن مناقشة حول DeepSeek-V3، كنت أجرب محادثات تم إنشاؤها بواسطة الذكاء الاصطناعي. هدفي هو إنشاء حوارات صوتية واقعية باستخدام Google Text-to-Speech و ffmpeg لتوليد وتسلسل الصوت. يوضح الكود التالي نهجي الحالي لمحاكاة محادثة طبيعية بين شخصين.","headline":"توليد الصوت للمحادثات","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/conversation-style-ar"},"url":"https://lzwjava.github.io/conversation-style-ar"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=d11a1c9012b08a748e44afbb37e18cdffe50975a">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=d11a1c9012b08a748e44afbb37e18cdffe50975a" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       توليد الصوت للمحادثات | أصلي، ترجم بواسطة AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/ar/2025-01-17-conversation-style-ar.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsar2025-01-17-conversation-style-ar.md</span> -->
      

      <!-- <span>2025-01-17-conversation-style-ar.md</span> -->

      
        

        
          
          <a href="#" class="button">2025.01</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/conversation-style-en" >English</option>
        <option value="/conversation-style-zh" >中文</option>
        <option value="/conversation-style-ja" >日本語</option>
        <option value="/conversation-style-es" >Español</option>
        <option value="/conversation-style-hi" >हिंदी</option>
        <option value="/conversation-style-fr" >Français</option>
        <option value="/conversation-style-de" >Deutsch</option>
        <option value="/conversation-style-ar" selected>العربية</option>
        <option value="/conversation-style-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>مستوحى من مقطع فيديو على YouTube يتضمن مناقشة حول DeepSeek-V3، كنت أجرب محادثات تم إنشاؤها بواسطة الذكاء الاصطناعي. هدفي هو إنشاء حوارات صوتية واقعية باستخدام Google Text-to-Speech و ffmpeg لتوليد وتسلسل الصوت. يوضح الكود التالي نهجي الحالي لمحاكاة محادثة طبيعية بين شخصين.</p>

<h2 id="المهمة">المهمة</h2>

<blockquote>
  <p>قم بإنشاء محادثة طبيعية وممتدة بين خبيرين، A و B، تتكون من 100 دور على الأقل. يجب أن يناقش الخبيران موضوعًا محددًا بعمق، مع تدفق المحادثة ذهابًا وإيابًا. يجب أن يطرح المشاركون أسئلة، ويشاركون رؤى، ويستكشفون تفاصيل الموضوع. يجب أن يكون التنسيق كما يلي:</p>
</blockquote>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"speaker"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"line"</span><span class="p">:</span><span class="w"> </span><span class="s2">"مرحبًا، لقد سمعت الكثير عن تعلم الآلة (ML)، والتعلم العميق (DL)، و GPT مؤخرًا. هل يمكنك توضيح ذلك لي؟"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"speaker"</span><span class="p">:</span><span class="w"> </span><span class="s2">"B"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"line"</span><span class="p">:</span><span class="w"> </span><span class="s2">"بالتأكيد! لنبدأ بالأساسيات. تعلم الآلة هو مجال من مجالات علوم الكمبيوتر حيث تتعلم الأنظمة من البيانات لتحسين أدائها دون أن تكون مبرمجة بشكل صريح. فكر في الأمر على أنه تعليم الكمبيوتر للتعرف على الأنماط."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<h2 id="الكود">الكود</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">texttospeech</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">argparse</span>

<span class="c1"># دليل الإخراج الثابت للمحادثات
</span><span class="n">OUTPUT_DIRECTORY</span> <span class="o">=</span> <span class="s">"assets/conversations"</span>
<span class="n">INPUT_DIRECTORY</span> <span class="o">=</span> <span class="s">"scripts/conversation"</span>

<span class="k">def</span> <span class="nf">text_to_speech</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">output_filename</span><span class="p">,</span> <span class="n">voice_name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"جارٍ توليد الصوت لـ: </span><span class="si">{</span><span class="n">output_filename</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">texttospeech</span><span class="p">.</span><span class="n">TextToSpeechClient</span><span class="p">()</span>
        <span class="n">synthesis_input</span> <span class="o">=</span> <span class="n">texttospeech</span><span class="p">.</span><span class="n">SynthesisInput</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
        <span class="n">voice</span> <span class="o">=</span> <span class="n">texttospeech</span><span class="p">.</span><span class="n">VoiceSelectionParams</span><span class="p">(</span><span class="n">language_code</span><span class="o">=</span><span class="s">"en-US"</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">voice_name</span><span class="p">)</span>
        <span class="n">audio_config</span> <span class="o">=</span> <span class="n">texttospeech</span><span class="p">.</span><span class="n">AudioConfig</span><span class="p">(</span>
            <span class="n">audio_encoding</span><span class="o">=</span><span class="n">texttospeech</span><span class="p">.</span><span class="n">AudioEncoding</span><span class="p">.</span><span class="n">MP3</span><span class="p">,</span>
            <span class="n">effects_profile_id</span><span class="o">=</span><span class="p">[</span><span class="s">"small-bluetooth-speaker-class-device"</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="n">retries</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">retries</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">synthesize_speech</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">synthesis_input</span><span class="p">,</span> <span class="n">voice</span><span class="o">=</span><span class="n">voice</span><span class="p">,</span> <span class="n">audio_config</span><span class="o">=</span><span class="n">audio_config</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_filename</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
                    <span class="n">out</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">audio_content</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"تم كتابة المحتوى الصوتي في </span><span class="si">{</span><span class="n">output_filename</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">True</span>
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"حدث خطأ في المحاولة </span><span class="si">{</span><span class="n">attempt</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">attempt</span> <span class="o">==</span> <span class="n">retries</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"فشل توليد الصوت بعد </span><span class="si">{</span><span class="n">retries</span><span class="si">}</span><span class="s"> محاولات."</span><span class="p">)</span>
                    <span class="k">return</span> <span class="bp">False</span>
                <span class="n">wait_time</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">attempt</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"إعادة المحاولة بعد </span><span class="si">{</span><span class="n">wait_time</span><span class="si">}</span><span class="s"> ثوانٍ..."</span><span class="p">)</span>
                <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">wait_time</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"حدث خطأ أثناء توليد الصوت لـ </span><span class="si">{</span><span class="n">output_filename</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">process_conversation</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">INPUT_DIRECTORY</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">output_filename</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTPUT_DIRECTORY</span><span class="p">,</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">".mp3"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_filename</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"ملف الصوت موجود بالفعل: </span><span class="si">{</span><span class="n">output_filename</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">conversation</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"حدث خطأ أثناء تحميل ملف المحادثة </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">temp_files</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">voice_options</span> <span class="o">=</span> <span class="p">[</span><span class="s">"en-US-Journey-D"</span><span class="p">,</span> <span class="s">"en-US-Journey-F"</span><span class="p">,</span> <span class="s">"en-US-Journey-O"</span><span class="p">]</span>
    <span class="n">voice_name_A</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">voice_options</span><span class="p">)</span>
    <span class="n">voice_name_B</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">voice_options</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">voice_name_A</span> <span class="o">==</span> <span class="n">voice_name_B</span><span class="p">:</span>
        <span class="n">voice_name_B</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">voice_options</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">line_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">conversation</span><span class="p">):</span>
        <span class="n">speaker</span> <span class="o">=</span> <span class="n">line_data</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"speaker"</span><span class="p">)</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line_data</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"line"</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">temp_file</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTPUT_DIRECTORY</span><span class="p">,</span> <span class="sa">f</span><span class="s">"temp_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s">.mp3"</span><span class="p">)</span>
        <span class="n">temp_files</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_file</span><span class="p">)</span>
        
        <span class="n">voice_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">speaker</span> <span class="o">==</span> <span class="s">"A"</span><span class="p">:</span>
            <span class="n">voice_name</span> <span class="o">=</span> <span class="n">voice_name_A</span>
        <span class="k">elif</span> <span class="n">speaker</span> <span class="o">==</span> <span class="s">"B"</span><span class="p">:</span>
            <span class="n">voice_name</span> <span class="o">=</span> <span class="n">voice_name_B</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">text_to_speech</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">temp_file</span><span class="p">,</span> <span class="n">voice_name</span><span class="o">=</span><span class="n">voice_name</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"فشل توليد الصوت للسطر </span><span class="si">{</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s"> من </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="c1"># تنظيف الملفات المؤقتة
</span>            <span class="k">for</span> <span class="n">temp_file_to_remove</span> <span class="ow">in</span> <span class="n">temp_files</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">temp_file_to_remove</span><span class="p">):</span>
                    <span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">temp_file_to_remove</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">temp_files</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"لم يتم توليد أي صوت لـ </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># التسلسل باستخدام ffmpeg
</span>    <span class="n">concat_file</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTPUT_DIRECTORY</span><span class="p">,</span> <span class="s">"concat.txt"</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">concat_file</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">temp_file</span> <span class="ow">in</span> <span class="n">temp_files</span><span class="p">:</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"file '</span><span class="si">{</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">temp_file</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span>
            <span class="p">[</span><span class="s">'ffmpeg'</span><span class="p">,</span> <span class="s">'-f'</span><span class="p">,</span> <span class="s">'concat'</span><span class="p">,</span> <span class="s">'-safe'</span><span class="p">,</span> <span class="s">'0'</span><span class="p">,</span> <span class="s">'-i'</span><span class="p">,</span> <span class="n">concat_file</span><span class="p">,</span> <span class="s">'-c'</span><span class="p">,</span> <span class="s">'copy'</span><span class="p">,</span> <span class="n">output_filename</span><span class="p">],</span>
            <span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
            <span class="n">capture_output</span><span class="o">=</span><span class="bp">True</span>
        <span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"تم تسلسل الصوت بنجاح إلى </span><span class="si">{</span><span class="n">output_filename</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"حدث خطأ أثناء تسلسل الصوت: </span><span class="si">{</span><span class="n">e</span><span class="p">.</span><span class="n">stderr</span><span class="p">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">concat_file</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">temp_file</span> <span class="ow">in</span> <span class="n">temp_files</span><span class="p">:</span>
            <span class="n">os</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">temp_file</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">"معالجة ملفات JSON للمحادثات لتوليد الصوت."</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">OUTPUT_DIRECTORY</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">INPUT_DIRECTORY</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">".json"</span><span class="p">):</span>
            <span class="n">process_conversation</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="الغلاف">الغلاف</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffmpeg <span class="nt">-i</span> deepseek.jpg <span class="nt">-vf</span> <span class="s2">"crop=854:480"</span> deepseek_480p_cropped.jpg
</code></pre></div></div>

<h2 id="الفيديو">الفيديو</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffmpeg <span class="nt">-loop</span> 1 <span class="nt">-i</span> deepseek.jpg <span class="nt">-i</span> deepseek.mp3 <span class="nt">-c</span>:v libx264 <span class="nt">-tune</span> stillimage <span class="nt">-c</span>:a aac <span class="nt">-b</span>:a 192k <span class="nt">-shortest</span> output_video.mp4
</code></pre></div></div>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-ar" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
