<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>## الدليل الشامل لإطار عمل Spring</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>الدليل الشامل لإطار عمل Spring | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="الدليل الشامل لإطار عمل Spring" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="ar" />
<meta name="description" content="تمت كتابة هذه المدونة بمساعدة ChatGPT-4o." />
<meta property="og:description" content="تمت كتابة هذه المدونة بمساعدة ChatGPT-4o." />
<link rel="canonical" href="https://lzwjava.github.io/spring-ar" />
<meta property="og:url" content="https://lzwjava.github.io/spring-ar" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-07T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="الدليل الشامل لإطار عمل Spring" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2023-02-07T00:00:00+08:00","datePublished":"2023-02-07T00:00:00+08:00","description":"تمت كتابة هذه المدونة بمساعدة ChatGPT-4o.","headline":"الدليل الشامل لإطار عمل Spring","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/spring-ar"},"url":"https://lzwjava.github.io/spring-ar"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=217b5807d3dcb3895de1580ed55a7aa2b1eac031">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=217b5807d3dcb3895de1580ed55a7aa2b1eac031" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       ## الدليل الشامل لإطار عمل Spring | أصلي، ترجم بواسطة AI
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/ar/2023-02-07-spring-ar.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsar2023-02-07-spring-ar.md</span> -->
      

      <!-- <span>2023-02-07-spring-ar.md</span> -->

      
        

        
          
          <a href="#" class="button">2023.02</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/spring-en" >English</option>
        <option value="/spring-zh" >中文</option>
        <option value="/spring-ja" >日本語</option>
        <option value="/spring-es" >Español</option>
        <option value="/spring-hi" >हिंदी</option>
        <option value="/spring-fr" >Français</option>
        <option value="/spring-de" >Deutsch</option>
        <option value="/spring-ar" selected>العربية</option>
        <option value="/spring-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p><em>تمت كتابة هذه المدونة بمساعدة ChatGPT-4o.</em></p>

<hr />

<h3 id="جدول-المحتويات">جدول المحتويات</h3>
<ul>
  <li><a href="#introduction">مقدمة</a></li>
  <li><a href="#spring-boot-framework">إطار عمل Spring Boot</a>
    <ul>
      <li><a href="#getting-started-with-spring-boot">البدء مع Spring Boot</a></li>
      <li><a href="#dependency-injection">حقن التبعيات</a></li>
      <li><a href="#events-in-spring">الأحداث في Spring</a></li>
    </ul>
  </li>
  <li><a href="#data-management-with-spring">إدارة البيانات مع Spring</a>
    <ul>
      <li><a href="#spring-data-jdbc">Spring Data JDBC</a></li>
      <li><a href="#spring-data-jpa">Spring Data JPA</a></li>
      <li><a href="#spring-data-redis">Spring Data Redis</a></li>
      <li><a href="#transactions-and-dao-support">المعاملات ودعم DAO</a></li>
      <li><a href="#jdbc-and-orm">JDBC و ORM</a></li>
    </ul>
  </li>
  <li><a href="#building-restful-services">بناء خدمات RESTful</a>
    <ul>
      <li><a href="#spring-rest-clients">عملاء REST في Spring</a></li>
      <li><a href="#feignclient">FeignClient</a></li>
    </ul>
  </li>
  <li><a href="#email-tasks-and-scheduling">البريد الإلكتروني، المهام، والجدولة</a>
    <ul>
      <li><a href="#email-support">دعم البريد الإلكتروني</a></li>
      <li><a href="#task-execution-and-scheduling">تنفيذ المهام والجدولة</a></li>
    </ul>
  </li>
  <li><a href="#testing-in-spring">الاختبار في Spring</a>
    <ul>
      <li><a href="#testing-with-mockito">الاختبار باستخدام Mockito</a></li>
      <li><a href="#testing-with-mockmvc">الاختبار باستخدام MockMvc</a></li>
    </ul>
  </li>
  <li><a href="#monitoring-and-management">المراقبة والإدارة</a>
    <ul>
      <li><a href="#spring-boot-actuator">Spring Boot Actuator</a></li>
    </ul>
  </li>
  <li><a href="#advanced-topics">موضوعات متقدمة</a>
    <ul>
      <li><a href="#spring-advice-api">واجهة برمجة التطبيقات Spring Advice</a></li>
    </ul>
  </li>
  <li><a href="#conclusion">الخاتمة</a></li>
</ul>

<hr />

<h3 id="مقدمة">مقدمة</h3>

<p>Spring هو أحد أكثر الأطر شيوعًا لبناء تطبيقات على مستوى المؤسسات باستخدام لغة Java. يوفر دعمًا بنيويًا شاملاً لتطوير تطبيقات Java. في هذه المدونة، سنغطي جوانب مختلفة من نظام Spring البيئي، بما في ذلك Spring Boot، وإدارة البيانات، وبناء خدمات RESTful، والجدولة، والاختبار، والميزات المتقدمة مثل Spring Advice API.</p>

<hr />

<h3 id="إطار-عمل-spring-boot">إطار عمل Spring Boot</h3>

<p>Spring Boot هو إطار عمل مفتوح المصدر يعتمد على لغة Java، مصمم لتبسيط عملية تطوير تطبيقات Spring. يوفر Spring Boot بيئة عمل سريعة وسهلة التكوين، مما يسمح للمطورين بإنشاء تطبيقات قائمة بذاتها بسرعة وسهولة. يتميز Spring Boot بدمج العديد من المكتبات والأدوات التي تسهل عملية التطوير، مثل Tomcat المدمج، وإدارة التبعيات عبر Maven أو Gradle، والتكوين التلقائي للتطبيقات.</p>

<h4 id="المميزات-الرئيسية-لـ-spring-boot">المميزات الرئيسية لـ Spring Boot:</h4>
<ol>
  <li><strong>سهولة التكوين</strong>: يوفر Spring Boot تكوينًا تلقائيًا للعديد من الإعدادات، مما يقلل من الحاجة إلى تكوين يدوي.</li>
  <li><strong>تطبيقات قائمة بذاتها</strong>: يمكنك تشغيل تطبيقات Spring Boot كتطبيقات مستقلة دون الحاجة إلى خوادم خارجية.</li>
  <li><strong>إدارة التبعيات</strong>: يدعم Spring Boot إدارة التبعيات عبر Maven وGradle، مما يسهل عملية إضافة المكتبات المطلوبة.</li>
  <li><strong>مراقبة وصيانة</strong>: يوفر Spring Boot أدوات لمراقبة وصيانة التطبيقات، مثل Actuator.</li>
  <li><strong>تكامل مع Spring Ecosystem</strong>: يتكامل Spring Boot بسلاسة مع باقي إطار عمل Spring، مثل Spring MVC وSpring Data وSpring Security.</li>
</ol>

<h4 id="مثال-بسيط-لتطبيق-spring-boot">مثال بسيط لتطبيق Spring Boot:</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>

<span class="nd">@SpringBootApplication</span>
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloWorldApplication</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">HelloWorldApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"Hello, World!"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>في هذا المثال، يتم إنشاء تطبيق Spring Boot بسيط يعرض رسالة “Hello, World!” عند الوصول إلى المسار الرئيسي (<code class="language-plaintext highlighter-rouge">/</code>).</p>

<h4 id="كيفية-تشغيل-التطبيق">كيفية تشغيل التطبيق:</h4>
<ol>
  <li>قم بتنزيل المشروع أو إنشائه باستخدام Spring Initializr.</li>
  <li>افتح المشروع في بيئة التطوير الخاصة بك (مثل IntelliJ IDEA أو Eclipse).</li>
  <li>قم بتشغيل التطبيق عن طريق تنفيذ الأمر <code class="language-plaintext highlighter-rouge">mvn spring-boot:run</code> في سطر الأوامر.</li>
  <li>افتح المتصفح واذهب إلى <code class="language-plaintext highlighter-rouge">http://localhost:8080</code> لرؤية الرسالة “Hello, World!”.</li>
</ol>

<p>Spring Boot يعد خيارًا مثاليًا لتطوير تطبيقات الويب والخدمات المصغرة (Microservices) بسرعة وكفاءة.</p>

<h4 id="البدء-مع-spring-boot">البدء مع Spring Boot</h4>

<p>Spring Boot يجعل من السهل إنشاء تطبيقات Spring قائمة بذاتها وجاهزة للإنتاج. يأخذ وجهة نظر محددة حول منصة Spring والمكتبات الخارجية، مما يسمح لك بالبدء بأقل قدر من التهيئة.</p>

<ul>
  <li><strong>الإعداد الأولي</strong>: ابدأ بإنشاء مشروع Spring Boot جديد باستخدام Spring Initializr. يمكنك اختيار التبعيات التي تحتاجها، مثل Spring Web، وSpring Data JPA، وSpring Boot Actuator.</li>
  <li><strong>الشرح التوضيحي (Annotations)</strong>: تعرف على الشرح التوضيحي الرئيسي مثل <code class="language-plaintext highlighter-rouge">@SpringBootApplication</code>، والذي هو مزيج من <code class="language-plaintext highlighter-rouge">@Configuration</code>، و<code class="language-plaintext highlighter-rouge">@EnableAutoConfiguration</code>، و<code class="language-plaintext highlighter-rouge">@ComponentScan</code>.</li>
  <li><strong>الخادم المدمج</strong>: يستخدم Spring Boot خوادم مدمجة مثل Tomcat، أو Jetty، أو Undertow لتشغيل تطبيقك، لذلك لا تحتاج إلى نشر ملفات WAR على خادم خارجي.</li>
</ul>

<h4 id="حقن-التبعيات-dependency-injection">حقن التبعيات (Dependency Injection)</h4>

<p>حقن التبعيات (Dependency Injection أو DI) هو مبدأ أساسي في إطار عمل Spring. يسمح بإنشاء مكونات ذات اقتران ضعيف، مما يجعل الكود الخاص بك أكثر نمطية وأسهل في الاختبار.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@Autowired</code>: تُستخدم هذه الشرحة لحقن التبعيات تلقائيًا. يمكن تطبيقها على المُنشئات (constructors)، الحقول (fields)، والطرق (methods). ستقوم ميزة حقن التبعيات في Spring بحل وحقن الحبوب (beans) المتعاونة تلقائيًا في حبتك (bean).</li>
</ul>

<p>مثال على حقن الحقول:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Component</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>
      
      <span class="nd">@Autowired</span>
      <span class="kd">private</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
      
      <span class="c1">// طرق الأعمال</span>
  <span class="o">}</span>
</code></pre></div></div>

<p>مثال على حقن المُنشئ:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Component</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>
      
      <span class="kd">private</span> <span class="kd">final</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="nd">@Autowired</span>
      <span class="kd">public</span> <span class="nf">UserService</span><span class="o">(</span><span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">this</span><span class="o">.</span><span class="na">userRepository</span> <span class="o">=</span> <span class="n">userRepository</span><span class="o">;</span>
      <span class="o">}</span>
      
      <span class="c1">// طرق الأعمال</span>
  <span class="o">}</span>
</code></pre></div></div>

<p>مثال على حقن الأسلوب (Method Injection):</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nd">@Component</span>
  <span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>
      
      <span class="kd">private</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="nd">@Autowired</span>
      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUserRepository</span><span class="o">(</span><span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">this</span><span class="o">.</span><span class="na">userRepository</span> <span class="o">=</span> <span class="n">userRepository</span><span class="o">;</span>
      <span class="o">}</span>
      
      <span class="c1">// طرق الأعمال</span>
  <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@Component</code>, <code class="language-plaintext highlighter-rouge">@Service</code>, <code class="language-plaintext highlighter-rouge">@Repository</code>: هذه هي تخصيصات لـ <code class="language-plaintext highlighter-rouge">@Component</code> annotation، تُستخدم للإشارة إلى أن الفصل هو Spring bean. كما أنها تعمل كتلميحات لدور الفصل الذي تم تعليقه.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@Component</code>: هذا نمط عام لأي مكون يتم إدارته بواسطة Spring. يمكن استخدامه لوضع علامة على أي فئة كـ bean في Spring.</p>
  </li>
</ul>

<p>مثال:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmailValidator</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// منطق التحقق</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@Service</code>: هذه الشرح هي تخصيص لـ <code class="language-plaintext highlighter-rouge">@Component</code> وتُستخدم لتمييز الفئة كخدمة. تُستخدم عادةً في طبقة الخدمة، حيث يتم تنفيذ منطق الأعمال.</li>
</ul>

<p>مثال:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>
    
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">User</span> <span class="nf">findUserById</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">).</span><span class="na">orElse</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ترجمة الكود إلى العربية:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">User</span> <span class="nf">findUserById</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">).</span><span class="na">orElse</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ملاحظة: الكود يبقى كما هو لأنه مكتوب بلغة برمجية (Java) ولا يتم ترجمته. الترجمة تكون فقط للنصوص التوضيحية أو الشروحات المرافقة للكود.</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">@Repository</code>: هذه التعليمة هي أيضًا تخصيص للتعليمة <code class="language-plaintext highlighter-rouge">@Component</code>. تُستخدم للإشارة إلى أن الفئة توفر آلية لتخزين واسترجاع والبحث وتحديث وحذف الكائنات. كما تقوم بترجمة استثناءات الاستمرارية إلى التسلسل الهرمي لاستثناءات الوصول إلى البيانات في Spring.</p>

    <p>مثال:</p>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="c1">// طرق الاستعلام المخصصة</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>هذه التعليقات التوضيحية تجعل تكوين Spring الخاص بك أكثر قابلية للقراءة وإيجازًا، وتساعد إطار عمل Spring في إدارة وربط التبعيات بين الحبوب (beans) المختلفة.</p>

<h4 id="الأحداث-في-spring">الأحداث في Spring</h4>

<p>في إطار عمل Spring، تُعتبر الأحداث (Events) وسيلة للتواصل بين مكونات التطبيق بطريقة غير مباشرة. تسمح هذه الآلية للمكونات بإرسال إشعارات حول حدوث شيء ما، بينما يمكن لمكونات أخرى الاستماع إلى هذه الإشعارات والاستجابة لها. يتم تنفيذ هذا النموذج باستخدام <code class="language-plaintext highlighter-rouge">ApplicationEvent</code> و <code class="language-plaintext highlighter-rouge">ApplicationListener</code>.</p>

<h5 id="كيفية-عمل-الأحداث-في-spring">كيفية عمل الأحداث في Spring</h5>

<ol>
  <li>
    <p><strong>إنشاء حدث مخصص</strong>:
يمكنك إنشاء حدث مخصص عن طريق توسيع الفئة <code class="language-plaintext highlighter-rouge">ApplicationEvent</code>.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomEvent</span> <span class="kd">extends</span> <span class="nc">ApplicationEvent</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">message</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">CustomEvent</span><span class="o">(</span><span class="nc">Object</span> <span class="n">source</span><span class="o">,</span> <span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">source</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>نشر الحدث</strong>:
يمكن نشر الحدث باستخدام <code class="language-plaintext highlighter-rouge">ApplicationEventPublisher</code>.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">ApplicationEventPublisher</span> <span class="n">publisher</span><span class="o">;</span>

<span class="kd">public</span> <span class="kt">void</span> <span class="nf">publishCustomEvent</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">CustomEvent</span> <span class="n">customEvent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CustomEvent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
    <span class="n">publisher</span><span class="o">.</span><span class="na">publishEvent</span><span class="o">(</span><span class="n">customEvent</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>الاستماع إلى الحدث</strong>:
يمكنك الاستماع إلى الحدث عن طريق تنفيذ واجهة <code class="language-plaintext highlighter-rouge">ApplicationListener</code>.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomEventListener</span> <span class="kd">implements</span> <span class="nc">ApplicationListener</span><span class="o">&lt;</span><span class="nc">CustomEvent</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onApplicationEvent</span><span class="o">(</span><span class="nc">CustomEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Received custom event - "</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ol>

<h5 id="استخدام-الأحداث-في-spring">استخدام الأحداث في Spring</h5>

<p>تُستخدم الأحداث في Spring لتحقيق فصل المهام (Separation of Concerns) وتحسين قابلية الصيانة. على سبيل المثال، يمكن استخدامها لإرسال إشعارات عبر البريد الإلكتروني بعد تسجيل مستخدم جديد، أو لتحديث ذاكرة التخزين المؤقت بعد تغيير البيانات.</p>

<h5 id="مثال-عملي">مثال عملي</h5>

<p>لنفترض أن لديك تطبيقًا لإدارة المستخدمين، وتريد إرسال بريد إلكتروني ترحيبي عند تسجيل مستخدم جديد.</p>

<ol>
  <li>
    <p><strong>إنشاء حدث تسجيل المستخدم</strong>:</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserRegisteredEvent</span> <span class="kd">extends</span> <span class="nc">ApplicationEvent</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">UserRegisteredEvent</span><span class="o">(</span><span class="nc">Object</span> <span class="n">source</span><span class="o">,</span> <span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">source</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">email</span> <span class="o">=</span> <span class="n">email</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getEmail</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">email</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>نشر الحدث عند تسجيل المستخدم</strong>:</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">ApplicationEventPublisher</span> <span class="n">publisher</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">registerUser</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Logic to register user</span>
        <span class="n">publisher</span><span class="o">.</span><span class="na">publishEvent</span><span class="o">(</span><span class="k">new</span> <span class="nc">UserRegisteredEvent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">email</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>الاستماع إلى الحدث وإرسال البريد الإلكتروني</strong>:</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmailService</span> <span class="kd">implements</span> <span class="nc">ApplicationListener</span><span class="o">&lt;</span><span class="nc">UserRegisteredEvent</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onApplicationEvent</span><span class="o">(</span><span class="nc">UserRegisteredEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">sendWelcomeEmail</span><span class="o">(</span><span class="n">event</span><span class="o">.</span><span class="na">getEmail</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">sendWelcomeEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Logic to send email</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Sending welcome email to "</span> <span class="o">+</span> <span class="n">email</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>بهذه الطريقة، يتم فصل منطق إرسال البريد الإلكتروني عن منطق تسجيل المستخدم، مما يجعل الكود أكثر تنظيماً وسهولة في الصيانة.</p>

<p>تتيح لك آلية الأحداث في Spring إنشاء الأحداث في التطبيق والاستماع إليها.</p>

<ul>
  <li>الأحداث المخصصة: يمكنك إنشاء أحداث مخصصة عن طريق توسيع الفئة <code class="language-plaintext highlighter-rouge">ApplicationEvent</code>. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyCustomEvent</span> <span class="kd">extends</span> <span class="nc">ApplicationEvent</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">message</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nf">MyCustomEvent</span><span class="o">(</span><span class="nc">Object</span> <span class="n">source</span><span class="o">,</span> <span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">(</span><span class="n">source</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>تمت ترجمة الكود أعلاه إلى:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nf">MyCustomEvent</span><span class="o">(</span><span class="nc">Object</span> <span class="n">source</span><span class="o">,</span> <span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">(</span><span class="n">source</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>في هذا الكود، يتم تعريف مُنشئ (constructor) لفئة <code class="language-plaintext highlighter-rouge">MyCustomEvent</code> يأخذ كمعاملات <code class="language-plaintext highlighter-rouge">Object source</code> و <code class="language-plaintext highlighter-rouge">String message</code>. يتم استدعاء المُنشئ الأساسي (super constructor) باستخدام <code class="language-plaintext highlighter-rouge">super(source)</code>، ثم يتم تعيين القيمة الممررة للمعامل <code class="language-plaintext highlighter-rouge">message</code> إلى المتغير <code class="language-plaintext highlighter-rouge">this.message</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
      <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>مستمعو الأحداث: استخدم <code class="language-plaintext highlighter-rouge">@EventListener</code> أو قم بتنفيذ <code class="language-plaintext highlighter-rouge">ApplicationListener</code> للتعامل مع الأحداث. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyEventListener</span> <span class="o">{</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EventListener</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleMyCustomEvent</span><span class="o">(</span><span class="nc">MyCustomEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"تم استقبال حدث Spring مخصص - "</span> <span class="o">+</span> <span class="n">event</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>نشر الأحداث: يمكنك نشر الأحداث باستخدام <code class="language-plaintext highlighter-rouge">ApplicationEventPublisher</code>. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyEventPublisher</span> <span class="o">{</span>
      
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">ApplicationEventPublisher</span> <span class="n">applicationEventPublisher</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">publishCustomEvent</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"جاري نشر حدث مخصص. "</span><span class="o">);</span>
    <span class="nc">MyCustomEvent</span> <span class="n">customEvent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyCustomEvent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
    <span class="n">applicationEventPublisher</span><span class="o">.</span><span class="na">publishEvent</span><span class="o">(</span><span class="n">customEvent</span><span class="o">);</span>
<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<hr />

<h3 id="إدارة-البيانات-باستخدام-spring">إدارة البيانات باستخدام Spring</h3>

<h4 id="spring-data-jdbc">Spring Data JDBC</h4>

<p>Spring Data JDBC هي جزء من مشروع Spring Data الذي يهدف إلى تبسيط الوصول إلى قواعد البيانات العلائقية باستخدام JDBC. يوفر Spring Data JDBC طبقة تجريدية فوق JDBC التقليدي، مما يجعل من السهل تنفيذ عمليات CRUD (إنشاء، قراءة، تحديث، حذف) دون الحاجة إلى كتابة الكثير من الكود المتكرر.</p>

<h5 id="المميزات-الرئيسية">المميزات الرئيسية:</h5>
<ol>
  <li><strong>تبسيط الكود</strong>: يقلل من الحاجة إلى كتابة كود JDBC تقليدي متكرر.</li>
  <li><strong>دعم الكيانات البسيطة</strong>: يدعم الكيانات البسيطة التي تعكس جداول قاعدة البيانات.</li>
  <li><strong>استعلامات مخصصة</strong>: يسمح بكتابة استعلامات SQL مخصصة بسهولة.</li>
  <li><strong>تكامل مع Spring</strong>: يتكامل بسلاسة مع إطار عمل Spring، مما يسهل إدارة الكيانات والتبعيات.</li>
</ol>

<h5 id="مثال-بسيط">مثال بسيط:</h5>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.springframework.data.annotation.Id</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.relational.core.mapping.Table</span><span class="o">;</span>

<span class="nd">@Table</span><span class="o">(</span><span class="s">"users"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>

    <span class="c1">// Getters and Setters</span>
<span class="o">}</span>

<span class="kn">import</span> <span class="nn">org.springframework.data.repository.CrudRepository</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserRepository</span> <span class="kd">extends</span> <span class="nc">CrudRepository</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nc">User</span> <span class="nf">findByEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>في هذا المثال، يتم تعريف كيان <code class="language-plaintext highlighter-rouge">User</code> الذي يعكس جدول <code class="language-plaintext highlighter-rouge">users</code> في قاعدة البيانات. يتم استخدام <code class="language-plaintext highlighter-rouge">UserRepository</code> للوصول إلى البيانات وتنفيذ عمليات CRUD بسهولة.</p>

<h5 id="الخلاصة">الخلاصة:</h5>
<p>Spring Data JDBC هو أداة قوية لتبسيط الوصول إلى قواعد البيانات العلائقية باستخدام JDBC، مع الحفاظ على البساطة والمرونة.</p>

<p>يوفر Spring Data JDBC وصولًا بسيطًا وفعالًا إلى JDBC.</p>

<ul>
  <li><strong>المستودعات (Repositories):</strong> قم بتعريف المستودعات لإجراء عمليات CRUD (إنشاء، قراءة، تحديث، حذف). على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserRepository</span> <span class="kd">extends</span> <span class="nc">CrudRepository</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>الاستعلامات: استخدم التعليقات التوضيحية مثل <code class="language-plaintext highlighter-rouge">@Query</code> لتحديد استعلامات مخصصة. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Query</span><span class="o">(</span><span class="s">"SELECT * FROM users WHERE username = :username"</span><span class="o">)</span>
<span class="nc">User</span> <span class="nf">findByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="spring-data-jpa">Spring Data JPA</h4>

<p>Spring Data JPA هو جزء من مشروع Spring Data الذي يهدف إلى تبسيط تطوير تطبيقات Java التي تعتمد على تقنيات الوصول إلى البيانات. يوفر Spring Data JPA طبقة تجريدية فوق JPA (Java Persistence API)، مما يسهل عملية تنفيذ عمليات الوصول إلى البيانات دون الحاجة إلى كتابة الكثير من الكود المتكرر.</p>

<h3 id="الميزات-الرئيسية-لـ-spring-data-jpa">الميزات الرئيسية لـ Spring Data JPA</h3>

<ol>
  <li>
    <p><strong>تقليل الكود المتكرر</strong>: يوفر Spring Data JPA واجهات برمجية جاهزة للاستخدام للتعامل مع الكيانات (Entities) وعمليات CRUD (إنشاء، قراءة، تحديث، حذف) دون الحاجة إلى كتابة الكود يدويًا.</p>
  </li>
  <li>
    <p><strong>الاستعلامات المخصصة</strong>: يمكنك كتابة استعلامات مخصصة باستخدام لغة JPQL (Java Persistence Query Language) أو عن طريق استخدام أسماء الطرق في الواجهات البرمجية.</p>
  </li>
  <li>
    <p><strong>التكامل مع Spring</strong>: Spring Data JPA يتكامل بسلاسة مع إطار عمل Spring، مما يسمح باستخدام ميزات مثل إدارة المعاملات (Transaction Management) وحقن التبعيات (Dependency Injection).</p>
  </li>
  <li>
    <p><strong>الدعم للاستعلامات الديناميكية</strong>: يمكنك إنشاء استعلامات ديناميكية باستخدام <code class="language-plaintext highlighter-rouge">Specification</code> و <code class="language-plaintext highlighter-rouge">Criteria API</code>.</p>
  </li>
  <li>
    <p><strong>التقسيم (Pagination) والفرز (Sorting)</strong>: يوفر Spring Data JPA دعمًا مدمجًا للتقسيم والفرز، مما يسهل التعامل مع مجموعات كبيرة من البيانات.</p>
  </li>
</ol>

<h3 id="مثال-بسيط-1">مثال بسيط</h3>

<p>لنفترض أن لديك كيان <code class="language-plaintext highlighter-rouge">User</code> وتريد تنفيذ عمليات CRUD عليه. يمكنك إنشاء واجهة برمجية تمتد <code class="language-plaintext highlighter-rouge">JpaRepository</code> كما يلي:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.springframework.data.jpa.repository.JpaRepository</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="c1">// يمكنك إضافة طرق مخصصة هنا</span>
<span class="o">}</span>
</code></pre></div></div>

<p>بعد ذلك، يمكنك استخدام هذه الواجهة في خدمة (Service) أو وحدة تحكم (Controller) للتعامل مع البيانات:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Service</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserService</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">getAllUsers</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">User</span> <span class="nf">getUserById</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">).</span><span class="na">orElse</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">User</span> <span class="nf">saveUser</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteUser</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">userRepository</span><span class="o">.</span><span class="na">deleteById</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="الخلاصة-1">الخلاصة</h3>

<p>Spring Data JPA يوفر طريقة فعالة وسهلة للتعامل مع قواعد البيانات في تطبيقات Java باستخدام Spring. بفضل طبقة التجريد التي يوفرها، يمكنك التركيز على كتابة منطق الأعمال بدلاً من القلق بشأن تفاصيل تنفيذ الوصول إلى البيانات.</p>

<p>Spring Data JPA يجعل من السهل تنفيذ مستودعات تعتمد على JPA.</p>

<ul>
  <li>تعيين الكيانات: قم بتعريف الكيانات باستخدام <code class="language-plaintext highlighter-rouge">@Entity</code> وقم بتعيينها إلى جداول قاعدة البيانات. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>
    <span class="c1">// getters and setters</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li><strong>المستودعات (Repositories)</strong>: أنشئ واجهات المستودعات عن طريق توسيع <code class="language-plaintext highlighter-rouge">JpaRepository</code>. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>طرق الاستعلام: استخدم طرق الاستعلام لإجراء عمليات قاعدة البيانات. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">findByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="spring-data-redis">Spring Data Redis</h4>

<p>Spring Data Redis هو جزء من مشروع Spring Data الذي يهدف إلى تبسيط الوصول إلى قواعد البيانات NoSQL، وتحديدًا Redis. Redis هو مخزن بيانات مفتوح المصدر يعتمد على الذاكرة، ويستخدم كقاعدة بيانات، وذاكرة تخزين مؤقت، ووسيط للرسائل. يوفر Spring Data Redis طبقة تجريدية تسمح للمطورين بالتفاعل مع Redis بسهولة باستخدام واجهات برمجية مألوفة في Spring.</p>

<h3 id="الميزات-الرئيسية">الميزات الرئيسية</h3>

<ol>
  <li><strong>التكامل السلس مع Spring</strong>: يمكن دمج Spring Data Redis بسهولة مع تطبيقات Spring الأخرى، مما يوفر تجربة تطوير متسقة.</li>
  <li><strong>دعم للأنواع المختلفة من البيانات</strong>: يدعم Spring Data Redis أنواعًا مختلفة من البيانات مثل Strings, Hashes, Lists, Sets, و Sorted Sets.</li>
  <li><strong>التعامل مع الاتصالات</strong>: يوفر إدارة اتصالات Redis عبر <code class="language-plaintext highlighter-rouge">RedisConnectionFactory</code>، مما يسهل تكوين وإدارة الاتصالات.</li>
  <li><strong>دعم للتعامل مع الكيانات</strong>: يمكن تعيين الكيانات (Entities) إلى هياكل بيانات Redis باستخدام <code class="language-plaintext highlighter-rouge">RedisTemplate</code> أو <code class="language-plaintext highlighter-rouge">Repository</code> interfaces.</li>
  <li><strong>دعم للاستعلامات</strong>: يوفر دعمًا للاستعلامات باستخدام معايير بسيطة، مما يسمح بالبحث عن البيانات المخزنة في Redis.</li>
</ol>

<h3 id="مثال-بسيط-2">مثال بسيط</h3>

<p>فيما يلي مثال بسيط يوضح كيفية تكوين واستخدام Spring Data Redis في تطبيق Spring Boot:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SpringBootApplication</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RedisExampleApplication</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">RedisExampleApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">RedisTemplate</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="nf">redisTemplate</span><span class="o">(</span><span class="nc">RedisConnectionFactory</span> <span class="n">connectionFactory</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">RedisTemplate</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">template</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RedisTemplate</span><span class="o">&lt;&gt;();</span>
        <span class="n">template</span><span class="o">.</span><span class="na">setConnectionFactory</span><span class="o">(</span><span class="n">connectionFactory</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">template</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RedisService</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">RedisTemplate</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">redisTemplate</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setValue</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">set</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">getValue</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>في هذا المثال، نقوم بتكوين <code class="language-plaintext highlighter-rouge">RedisTemplate</code> واستخدامه لتخزين واسترجاع البيانات من Redis.</p>

<h3 id="الخلاصة-2">الخلاصة</h3>

<p>Spring Data Redis يوفر طريقة قوية وسهلة للتفاعل مع Redis في تطبيقات Spring. سواء كنت تقوم ببناء تطبيق جديد أو تحسين تطبيق موجود، فإن Spring Data Redis يمكن أن يساعدك على تحقيق أهدافك بفعالية.</p>

<p>يوفر Spring Data Redis البنية التحتية للوصول إلى البيانات المعتمدة على Redis.</p>

<ul>
  <li>RedisTemplate: استخدم <code class="language-plaintext highlighter-rouge">RedisTemplate</code> للتفاعل مع Redis. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">RedisTemplate</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">redisTemplate</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">set</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>الترجمة:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">set</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>في هذه الدالة، يتم حفظ قيمة معينة (<code class="language-plaintext highlighter-rouge">value</code>) في قاعدة بيانات Redis باستخدام مفتاح محدد (<code class="language-plaintext highlighter-rouge">key</code>). يتم استخدام <code class="language-plaintext highlighter-rouge">redisTemplate</code> للوصول إلى عمليات Redis وحفظ القيمة.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">find</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div>

<p>تمت ترجمة الكود أعلاه إلى:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">find</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div>

<p>ملاحظة: الكود لم يتغير لأنه مكتوب بلغة برمجية (Java) ولا يتم ترجمته.</p>

<ul>
  <li>المستودعات: قم بإنشاء مستودعات Redis باستخدام <code class="language-plaintext highlighter-rouge">@Repository</code>. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">RedisRepository</span> <span class="kd">extends</span> <span class="nc">CrudRepository</span><span class="o">&lt;</span><span class="nc">RedisEntity</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="المعاملات-ودعم-dao">المعاملات ودعم DAO</h4>

<p>يُسهل Spring إدارة المعاملات (Transactions) ودعم DAO (كائن الوصول إلى البيانات).</p>

<ul>
  <li>إدارة المعاملات: استخدم <code class="language-plaintext highlighter-rouge">@Transactional</code> لإدارة المعاملات. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Transactional</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">saveUser</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">userRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>نمط DAO: قم بتنفيذ نمط DAO لفصل منطق التخزين. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDao</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">JdbcTemplate</span> <span class="n">jdbcTemplate</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">User</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">queryForObject</span><span class="o">(</span><span class="s">"SELECT * FROM users WHERE id = ?"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[]{</span><span class="n">id</span><span class="o">},</span> <span class="k">new</span> <span class="nc">UserRowMapper</span><span class="o">());</span>     
<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ترجمة الكود إلى العربية:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">User</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">queryForObject</span><span class="o">(</span><span class="s">"SELECT * FROM users WHERE id = ?"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[]{</span><span class="n">id</span><span class="o">},</span> <span class="k">new</span> <span class="nc">UserRowMapper</span><span class="o">());</span>     
<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ملاحظة: الكود يبقى كما هو لأنه مكتوب بلغة برمجية (Java) ولا يتم ترجمته.</p>

<h4 id="jdbc-و-orm">JDBC و ORM</h4>

<p><strong>JDBC (Java Database Connectivity)</strong> هي واجهة برمجة تطبيقات (API) تُستخدم في لغة Java للتفاعل مع قواعد البيانات. تسمح JDBC للتطبيقات بتنفيذ استعلامات SQL وإدارة البيانات في قواعد البيانات العلائقية. توفر JDBC مجموعة من الواجهات والفئات التي تمكن المطورين من الاتصال بقاعدة البيانات، وإرسال استعلامات SQL، ومعالجة النتائج.</p>

<p><strong>ORM (Object-Relational Mapping)</strong> هي تقنية تُستخدم لتحويل البيانات بين نظام أنواع غير متوافق في لغات البرمجة الموجهة للكائنات (مثل Java) وقواعد البيانات العلائقية. تُسهل ORM على المطورين العمل مع قواعد البيانات باستخدام الكائنات بدلاً من كتابة استعلامات SQL مباشرة. من أشهر أدوات ORM في Java هي Hibernate و JPA (Java Persistence API).</p>

<p><strong>الفرق بين JDBC و ORM:</strong></p>
<ul>
  <li><strong>JDBC</strong>: يتطلب كتابة استعلامات SQL يدويًا وإدارة الاتصالات والنتائج بشكل صريح.</li>
  <li><strong>ORM</strong>: يُخفف من الحاجة إلى كتابة استعلامات SQL يدويًا عن طريق تعيين الكائنات إلى جداول قاعدة البيانات تلقائيًا.</li>
</ul>

<p><strong>مثال بسيط باستخدام JDBC:</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.sql.Connection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.DriverManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.Statement</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JdbcExample</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="nc">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="s">"jdbc:mysql://localhost:3306/mydb"</span><span class="o">,</span> <span class="s">"user"</span><span class="o">,</span> <span class="s">"password"</span><span class="o">);</span>
            <span class="nc">Statement</span> <span class="n">statement</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">createStatement</span><span class="o">();</span>
            <span class="nc">ResultSet</span> <span class="n">resultSet</span> <span class="o">=</span> <span class="n">statement</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">(</span><span class="s">"SELECT * FROM users"</span><span class="o">);</span>

            <span class="k">while</span> <span class="o">(</span><span class="n">resultSet</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">resultSet</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"username"</span><span class="o">));</span>
            <span class="o">}</span>

            <span class="n">resultSet</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="n">statement</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="n">connection</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>مثال بسيط باستخدام ORM (Hibernate):</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.hibernate.Session</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hibernate.SessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.hibernate.cfg.Configuration</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HibernateExample</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SessionFactory</span> <span class="n">sessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Configuration</span><span class="o">().</span><span class="na">configure</span><span class="o">().</span><span class="na">buildSessionFactory</span><span class="o">();</span>
        <span class="nc">Session</span> <span class="n">session</span> <span class="o">=</span> <span class="n">sessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
        <span class="n">session</span><span class="o">.</span><span class="na">beginTransaction</span><span class="o">();</span>

        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="o">();</span>
        <span class="n">user</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">"john_doe"</span><span class="o">);</span>
        <span class="n">session</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>

        <span class="n">session</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">().</span><span class="na">commit</span><span class="o">();</span>
        <span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">sessionFactory</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>في المثالين أعلاه، يمكنك أن ترى كيف أن ORM يُبسط عملية التفاعل مع قاعدة البيانات مقارنة بـ JDBC.</p>

<p>يوفر Spring دعمًا شاملاً لـ JDBC و ORM (تعيين الكائنات إلى العلاقات).</p>

<ul>
  <li>JdbcTemplate: تبسيط عمليات JDBC باستخدام <code class="language-plaintext highlighter-rouge">JdbcTemplate</code>. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">JdbcTemplate</span> <span class="n">jdbcTemplate</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="s">"SELECT * FROM users"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">UserRowMapper</span><span class="o">());</span>
  <span class="o">}</span>
</code></pre></div></div>

<p>ترجمة الكود أعلاه إلى العربية:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">jdbcTemplate</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="s">"SELECT * FROM users"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">UserRowMapper</span><span class="o">());</span>
  <span class="o">}</span>
</code></pre></div></div>

<p>في هذا الكود، يتم تعريف دالة <code class="language-plaintext highlighter-rouge">findAll</code> التي تقوم بإرجاع قائمة من الكائنات من نوع <code class="language-plaintext highlighter-rouge">User</code>. يتم استخدام <code class="language-plaintext highlighter-rouge">jdbcTemplate.query</code> لتنفيذ استعلام SQL يقوم بجلب جميع السجلات من جدول <code class="language-plaintext highlighter-rouge">users</code>، ويتم تحويل النتائج إلى كائنات <code class="language-plaintext highlighter-rouge">User</code> باستخدام <code class="language-plaintext highlighter-rouge">UserRowMapper</code>.</p>

<ul>
  <li>Hibernate: قم بدمج Hibernate مع Spring لدعم ORM. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>
    <span class="c1">// getters and setters</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<hr />

<h3 id="بناء-خدمات-restful">بناء خدمات RESTful</h3>

<h4 id="عملاء-rest-في-spring">عملاء REST في Spring</h4>

<p>يوفر Spring عدة خيارات لإنشاء عملاء REST للتفاعل مع خدمات الويب. فيما يلي بعض الأدوات الرئيسية التي يمكن استخدامها:</p>

<ol>
  <li>
    <p><strong>RestTemplate</strong>:<br />
<code class="language-plaintext highlighter-rouge">RestTemplate</code> هو أداة كلاسيكية في Spring لتنفيذ طلبات HTTP. إنه متزامن (synchronous) ويوفر واجهة برمجية بسيطة لإرسال الطلبات واستقبال الاستجابات.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">RestTemplate</span> <span class="n">restTemplate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RestTemplate</span><span class="o">();</span>
<span class="nc">String</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.example.com/resource"</span><span class="o">;</span>
<span class="nc">String</span> <span class="n">response</span> <span class="o">=</span> <span class="n">restTemplate</span><span class="o">.</span><span class="na">getForObject</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">response</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>WebClient</strong>:<br />
<code class="language-plaintext highlighter-rouge">WebClient</code> هو بديل غير متزامن (asynchronous) لـ <code class="language-plaintext highlighter-rouge">RestTemplate</code> ويعتمد على Reactive Programming. إنه مناسب للتطبيقات التي تحتاج إلى التعامل مع طلبات غير متزامنة.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">WebClient</span> <span class="n">webClient</span> <span class="o">=</span> <span class="nc">WebClient</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">"https://api.example.com"</span><span class="o">);</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">response</span> <span class="o">=</span> <span class="n">webClient</span><span class="o">.</span><span class="na">get</span><span class="o">()</span>
    <span class="o">.</span><span class="na">uri</span><span class="o">(</span><span class="s">"/resource"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">retrieve</span><span class="o">()</span>
    <span class="o">.</span><span class="na">bodyToMono</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">response</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>RestClient</strong>:<br />
<code class="language-plaintext highlighter-rouge">RestClient</code> هو واجهة برمجية جديدة في Spring 6 تهدف إلى تبسيط إنشاء عملاء REST. إنه يوفر واجهة برمجية أكثر حداثة ومرونة.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">RestClient</span> <span class="n">restClient</span> <span class="o">=</span> <span class="nc">RestClient</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
<span class="nc">String</span> <span class="n">response</span> <span class="o">=</span> <span class="n">restClient</span><span class="o">.</span><span class="na">get</span><span class="o">()</span>
    <span class="o">.</span><span class="na">uri</span><span class="o">(</span><span class="s">"https://api.example.com/resource"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">retrieve</span><span class="o">()</span>
    <span class="o">.</span><span class="na">body</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">response</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Feign Client</strong>:<br />
<code class="language-plaintext highlighter-rouge">Feign</code> هو مكتبة تسمح بإنشاء عملاء REST بطريقة إعلانية (declarative). يمكن استخدامها مع Spring Cloud لإنشاء عملاء REST بسهولة.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@FeignClient</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"exampleClient"</span><span class="o">,</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.example.com"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ExampleClient</span> <span class="o">{</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/resource"</span><span class="o">)</span>
    <span class="nc">String</span> <span class="nf">getResource</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>RestEasy Client</strong>:<br />
<code class="language-plaintext highlighter-rouge">RestEasy</code> هو مكتبة أخرى يمكن استخدامها لإنشاء عملاء REST. إنها توفر واجهة برمجية قوية لتنفيذ طلبات HTTP.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">ResteasyClient</span> <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ResteasyClientBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>
<span class="nc">ResteasyWebTarget</span> <span class="n">target</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">"https://api.example.com/resource"</span><span class="o">);</span>
<span class="nc">String</span> <span class="n">response</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">request</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">response</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>اختيار الأداة المناسبة يعتمد على احتياجات التطبيق الخاص بك. إذا كنت تعمل في بيئة متزامنة، فقد يكون <code class="language-plaintext highlighter-rouge">RestTemplate</code> خيارًا جيدًا. أما إذا كنت بحاجة إلى معالجة غير متزامنة، فإن <code class="language-plaintext highlighter-rouge">WebClient</code> هو الخيار الأفضل.</p>

<p>Spring يجعل من السهل بناء عملاء RESTful.</p>

<ul>
  <li>RestTemplate: استخدم <code class="language-plaintext highlighter-rouge">RestTemplate</code> لإجراء طلبات HTTP. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">RestTemplate</span> <span class="n">restTemplate</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getUserInfo</span><span class="o">(</span><span class="nc">String</span> <span class="n">userId</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">restTemplate</span><span class="o">.</span><span class="na">getForObject</span><span class="o">(</span><span class="s">"https://api.example.com/users/"</span> <span class="o">+</span> <span class="n">userId</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div>

<p>تمت ترجمة الكود أعلاه إلى:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getUserInfo</span><span class="o">(</span><span class="nc">String</span> <span class="n">userId</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">restTemplate</span><span class="o">.</span><span class="na">getForObject</span><span class="o">(</span><span class="s">"https://api.example.com/users/"</span> <span class="o">+</span> <span class="n">userId</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div>

<p>ملاحظة: الكود لم يتغير لأنه مكتوب بلغة برمجية (Java) ولا يتم ترجمته.</p>

<ul>
  <li>WebClient: استخدم <code class="language-plaintext highlighter-rouge">WebClient</code> التفاعلي للطلبات غير المتزامنة. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">WebClient</span><span class="o">.</span><span class="na">Builder</span> <span class="n">webClientBuilder</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getUserInfo</span><span class="o">(</span><span class="nc">String</span> <span class="n">userId</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">webClientBuilder</span><span class="o">.</span><span class="na">build</span><span class="o">()</span>
              <span class="o">.</span><span class="na">get</span><span class="o">()</span>
              <span class="o">.</span><span class="na">uri</span><span class="o">(</span><span class="s">"https://api.example.com/users/"</span> <span class="o">+</span> <span class="n">userId</span><span class="o">)</span>
              <span class="o">.</span><span class="na">retrieve</span><span class="o">()</span>
              <span class="o">.</span><span class="na">bodyToMono</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div>

<h4 id="feignclient">FeignClient</h4>

<p>FeignClient هي مكتبة تُستخدم في تطبيقات Spring Cloud لتبسيط عملية استدعاء خدمات RESTful. تُوفر واجهة برمجية سهلة الاستخدام لإنشاء عميل HTTP، مما يسمح للمطورين بالتفاعل مع خدمات الويب دون الحاجة إلى كتابة كود HTTP يدويًا. باستخدام FeignClient، يمكنك تعريف واجهة برمجية مع التعليقات التوضيحية (annotations) التي تصف كيفية استدعاء خدمة معينة، وتقوم المكتبة بإنشاء التنفيذ المناسب تلقائيًا.</p>

<p>مثال بسيط لاستخدام FeignClient:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@FeignClient</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"example-service"</span><span class="o">,</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.example.com"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ExampleServiceClient</span> <span class="o">{</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/example-endpoint"</span><span class="o">)</span>
    <span class="nc">String</span> <span class="nf">getExampleData</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>في هذا المثال، يتم تعريف واجهة برمجية <code class="language-plaintext highlighter-rouge">ExampleServiceClient</code> التي تستخدم التعليق التوضيحي <code class="language-plaintext highlighter-rouge">@FeignClient</code> لتحديد اسم الخدمة وعنوان URL الخاص بها. الطريقة <code class="language-plaintext highlighter-rouge">getExampleData</code> تستخدم التعليق التوضيحي <code class="language-plaintext highlighter-rouge">@GetMapping</code> لتحديد نقطة النهاية التي سيتم استدعاؤها. عند استدعاء هذه الطريقة، سيقوم FeignClient تلقائيًا بإجراء طلب HTTP GET إلى <code class="language-plaintext highlighter-rouge">https://api.example.com/example-endpoint</code> وإرجاع النتيجة.</p>

<p>FeignClient يدعم أيضًا العديد من الميزات المتقدمة مثل التوازن التلقائي للتحميل (load balancing)، والتعامل مع الأخطاء، والتشفير، وغيرها.</p>

<p>Feign هو عميل خدمة ويب تصريحي.</p>

<ul>
  <li>الإعداد: أضف Feign إلى مشروعك وأنشئ واجهات مع التعليقات التوضيحية باستخدام <code class="language-plaintext highlighter-rouge">@FeignClient</code>. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@FeignClient</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"user-service"</span><span class="o">,</span> <span class="n">url</span> <span class="o">=</span> <span class="s">"https://api.example.com"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserServiceClient</span> <span class="o">{</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/users/{id}"</span><span class="o">)</span>
    <span class="nc">String</span> <span class="nf">getUserInfo</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">userId</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>التهيئة: تخصيص عملاء Feign باستخدام المُعترضات (interceptors) وفك تشفير الأخطاء (error decoders). على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Bean</span>
<span class="kd">public</span> <span class="nc">RequestInterceptor</span> <span class="nf">requestInterceptor</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">requestTemplate</span> <span class="o">-&gt;</span> <span class="n">requestTemplate</span><span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">"Authorization"</span><span class="o">,</span> <span class="s">"Bearer token"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<hr />

<h3 id="البريد-الإلكتروني-المهام-والجدولة">البريد الإلكتروني، المهام، والجدولة</h3>

<h4 id="دعم-البريد-الإلكتروني">دعم البريد الإلكتروني</h4>

<p>يوفر Spring دعمًا لإرسال البريد الإلكتروني.</p>

<ul>
  <li>JavaMailSender: استخدم <code class="language-plaintext highlighter-rouge">JavaMailSender</code> لإرسال البريد الإلكتروني. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">JavaMailSender</span> <span class="n">mailSender</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">sendEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">to</span><span class="o">,</span> <span class="nc">String</span> <span class="n">subject</span><span class="o">,</span> <span class="nc">String</span> <span class="n">body</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">SimpleMailMessage</span> <span class="n">message</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleMailMessage</span><span class="o">();</span>
      <span class="n">message</span><span class="o">.</span><span class="na">setTo</span><span class="o">(</span><span class="n">to</span><span class="o">);</span>
      <span class="n">message</span><span class="o">.</span><span class="na">setSubject</span><span class="o">(</span><span class="n">subject</span><span class="o">);</span>
      <span class="n">message</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">body</span><span class="o">);</span>
      <span class="n">mailSender</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>MimeMessage: إنشاء رسائل بريد إلكتروني غنية بالمرفقات ومحتوى HTML. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">JavaMailSender</span> <span class="n">mailSender</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">sendRichEmail</span><span class="o">(</span><span class="nc">String</span> <span class="n">to</span><span class="o">,</span> <span class="nc">String</span> <span class="n">subject</span><span class="o">,</span> <span class="nc">String</span> <span class="n">body</span><span class="o">,</span> <span class="nc">File</span> <span class="n">attachment</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">MessagingException</span> <span class="o">{</span>
      <span class="nc">MimeMessage</span> <span class="n">message</span> <span class="o">=</span> <span class="n">mailSender</span><span class="o">.</span><span class="na">createMimeMessage</span><span class="o">();</span>
      <span class="nc">MimeMessageHelper</span> <span class="n">helper</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MimeMessageHelper</span><span class="o">(</span><span class="n">message</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
      <span class="n">helper</span><span class="o">.</span><span class="na">setTo</span><span class="o">(</span><span class="n">to</span><span class="o">);</span>
      <span class="n">helper</span><span class="o">.</span><span class="na">setSubject</span><span class="o">(</span><span class="n">subject</span><span class="o">);</span>
      <span class="n">helper</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">body</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
      <span class="n">helper</span><span class="o">.</span><span class="na">addAttachment</span><span class="o">(</span><span class="n">attachment</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">attachment</span><span class="o">);</span>
      <span class="n">mailSender</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
  <span class="o">}</span>
</code></pre></div></div>

<h4 id="تنفيذ-المهام-والجدولة">تنفيذ المهام والجدولة</h4>

<p>دعم Spring لتنفيذ المهام وجدولتها يجعل من السهل تشغيل المهام.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@Scheduled</code>: جدولة المهام باستخدام <code class="language-plaintext highlighter-rouge">@Scheduled</code>. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Scheduled</span><span class="o">(</span><span class="n">fixedRate</span> <span class="o">=</span> <span class="mi">5000</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">performTask</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Scheduled task running every 5 seconds"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>المهام غير المتزامنة: تشغيل المهام بشكل غير متزامن باستخدام <code class="language-plaintext highlighter-rouge">@Async</code>. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Async</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">performAsyncTask</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Async task running in background"</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<hr />

<h3 id="الاختبار-في-spring">الاختبار في Spring</h3>

<p>عند العمل مع إطار عمل Spring، يعد الاختبار جانبًا مهمًا لضمان جودة الكود وسلوك التطبيق كما هو متوقع. يوفر Spring مجموعة من الأدوات والمكتبات التي تسهل كتابة الاختبارات للفئات والمكونات المختلفة.</p>

<h4 id="أنواع-الاختبارات-في-spring">أنواع الاختبارات في Spring</h4>

<ol>
  <li>
    <p><strong>Unit Testing (اختبار الوحدة)</strong>: يتم اختبار كل وحدة (عادةً ما تكون كلاس) بشكل منفصل عن باقي التطبيق. يمكن استخدام إطار عمل مثل JUnit لكتابة هذه الاختبارات.</p>
  </li>
  <li>
    <p><strong>Integration Testing (اختبار التكامل)</strong>: يتم اختبار تفاعل عدة وحدات معًا للتأكد من أنها تعمل بشكل صحيح معًا. يوفر Spring إمكانية اختبار تكامل المكونات مع بعضها البعض.</p>
  </li>
  <li>
    <p><strong>End-to-End Testing (اختبار من البداية إلى النهاية)</strong>: يتم اختبار التطبيق بأكمله من البداية إلى النهاية، عادةً باستخدام أدوات مثل Selenium أو Spring Boot Test.</p>
  </li>
</ol>

<h4 id="أدوات-الاختبار-في-spring">أدوات الاختبار في Spring</h4>

<ul>
  <li><strong>JUnit</strong>: إطار عمل شائع لكتابة الاختبارات في Java.</li>
  <li><strong>Mockito</strong>: مكتبة لإنشاء كائنات وهمية (Mocks) لاختبار التفاعلات بين الكائنات.</li>
  <li><strong>Spring Test</strong>: يوفر Spring إطار عمل خاص للاختبار يتكامل مع JUnit ويوفر ميزات مثل تحميل سياق التطبيق (ApplicationContext) للاختبارات.</li>
</ul>

<h4 id="مثال-على-اختبار-وحدة-باستخدام-junit-و-mockito">مثال على اختبار وحدة باستخدام JUnit و Mockito</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">mockito</span><span class="o">.</span><span class="na">Mockito</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">jupiter</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">Assertions</span><span class="o">.*;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mockito.InjectMocks</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mockito.Mock</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mockito.MockitoAnnotations</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyServiceTest</span> <span class="o">{</span>

    <span class="nd">@Mock</span>
    <span class="kd">private</span> <span class="nc">MyRepository</span> <span class="n">myRepository</span><span class="o">;</span>

    <span class="nd">@InjectMocks</span>
    <span class="kd">private</span> <span class="nc">MyService</span> <span class="n">myService</span><span class="o">;</span>

    <span class="nd">@BeforeEach</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUp</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">MockitoAnnotations</span><span class="o">.</span><span class="na">openMocks</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGetData</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">when</span><span class="o">(</span><span class="n">myRepository</span><span class="o">.</span><span class="na">findData</span><span class="o">()).</span><span class="na">thenReturn</span><span class="o">(</span><span class="s">"Mocked Data"</span><span class="o">);</span>

        <span class="nc">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">myService</span><span class="o">.</span><span class="na">getData</span><span class="o">();</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Mocked Data"</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
        <span class="n">verify</span><span class="o">(</span><span class="n">myRepository</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">findData</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>في هذا المثال، يتم اختبار <code class="language-plaintext highlighter-rouge">MyService</code> باستخدام <code class="language-plaintext highlighter-rouge">MyRepository</code> ككائن وهمي (Mock). يتم التحقق من أن <code class="language-plaintext highlighter-rouge">getData()</code> يعيد القيمة المتوقعة وأن <code class="language-plaintext highlighter-rouge">findData()</code> يتم استدعاؤها مرة واحدة فقط.</p>

<h4 id="اختبار-التكامل-باستخدام-spring-boot-test">اختبار التكامل باستخدام Spring Boot Test</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">request</span><span class="o">.</span><span class="na">MockMvcRequestBuilders</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">servlet</span><span class="o">.</span><span class="na">result</span><span class="o">.</span><span class="na">MockMvcResultMatchers</span><span class="o">.*;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.context.SpringBootTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.test.web.servlet.MockMvc</span><span class="o">;</span>

<span class="nd">@SpringBootTest</span>
<span class="nd">@AutoConfigureMockMvc</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyControllerTest</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGetEndpoint</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/my-endpoint"</span><span class="o">))</span>
               <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
               <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">content</span><span class="o">().</span><span class="na">string</span><span class="o">(</span><span class="s">"Expected Response"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>في هذا المثال، يتم اختبار نقطة نهاية (endpoint) في <code class="language-plaintext highlighter-rouge">MyController</code> باستخدام <code class="language-plaintext highlighter-rouge">MockMvc</code> للتحقق من أن الاستجابة هي كما هو متوقع.</p>

<h4 id="الخلاصة-3">الخلاصة</h4>

<p>الاختبار في Spring هو عملية أساسية لضمان جودة التطبيق وسلوكه الصحيح. باستخدام الأدوات المناسبة مثل JUnit و Mockito و Spring Test، يمكنك كتابة اختبارات فعالة تغطي مختلف جوانب التطبيق.</p>

<h4 id="الاختبار-باستخدام-mockito">الاختبار باستخدام Mockito</h4>

<p>Mockito هي مكتبة شائعة في عالم Java تُستخدم لإنشاء كائنات وهمية (mocks) في اختبارات الوحدة. تُسهل Mockito عملية اختبار الكود عن طريق السماح لك بمحاكاة سلوك الكائنات المعقدة أو الخارجية، مما يجعل الاختبارات أكثر تركيزًا وسرعة.</p>

<h5 id="لماذا-نستخدم-mockito">لماذا نستخدم Mockito؟</h5>

<ol>
  <li><strong>عزل الكود</strong>: تسمح لك Mockito باختبار الكود بشكل معزول عن التبعيات الخارجية مثل قواعد البيانات أو خدمات الويب.</li>
  <li><strong>التحكم في السلوك</strong>: يمكنك تحديد السلوك المتوقع للكائنات الوهمية، مما يسمح لك باختبار سيناريوهات مختلفة بسهولة.</li>
  <li><strong>التحقق من التفاعلات</strong>: يمكنك التحقق من أن الكود الذي تقوم باختباره يتفاعل مع الكائنات الوهمية بالطريقة المتوقعة.</li>
</ol>

<h5 id="مثال-بسيط-3">مثال بسيط</h5>

<p>لنفترض أن لديك فئة <code class="language-plaintext highlighter-rouge">UserService</code> تعتمد على <code class="language-plaintext highlighter-rouge">UserRepository</code> لاسترداد بيانات المستخدم. يمكنك استخدام Mockito لإنشاء كائن وهمي لـ <code class="language-plaintext highlighter-rouge">UserRepository</code> واختبار <code class="language-plaintext highlighter-rouge">UserService</code> دون الحاجة إلى قاعدة بيانات حقيقية.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">mockito</span><span class="o">.</span><span class="na">Mockito</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">Assert</span><span class="o">.*;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserServiceTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGetUser</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// إنشاء كائن وهمي لـ UserRepository</span>
        <span class="nc">UserRepository</span> <span class="n">userRepository</span> <span class="o">=</span> <span class="n">mock</span><span class="o">(</span><span class="nc">UserRepository</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="c1">// تعريف السلوك المتوقع للكائن الوهمي</span>
        <span class="n">when</span><span class="o">(</span><span class="n">userRepository</span><span class="o">.</span><span class="na">findUserById</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">thenReturn</span><span class="o">(</span><span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">"John Doe"</span><span class="o">));</span>

        <span class="c1">// إنشاء كائن UserService مع الكائن الوهمي</span>
        <span class="nc">UserService</span> <span class="n">userService</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UserService</span><span class="o">(</span><span class="n">userRepository</span><span class="o">);</span>

        <span class="c1">// اختبار طريقة getUser</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">userService</span><span class="o">.</span><span class="na">getUser</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

        <span class="c1">// التحقق من النتيجة</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"John Doe"</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>في هذا المثال:</p>
<ul>
  <li>قمنا بإنشاء كائن وهمي لـ <code class="language-plaintext highlighter-rouge">UserRepository</code> باستخدام <code class="language-plaintext highlighter-rouge">mock(UserRepository.class)</code>.</li>
  <li>قمنا بتعريف السلوك المتوقع للكائن الوهمي باستخدام <code class="language-plaintext highlighter-rouge">when(...).thenReturn(...)</code>.</li>
  <li>قمنا باختبار طريقة <code class="language-plaintext highlighter-rouge">getUser</code> في <code class="language-plaintext highlighter-rouge">UserService</code> والتحقق من النتيجة باستخدام <code class="language-plaintext highlighter-rouge">assertEquals</code>.</li>
</ul>

<h5 id="الخلاصة-4">الخلاصة</h5>

<p>Mockito هي أداة قوية لاختبار الوحدة في Java، حيث تسمح لك بإنشاء كائنات وهمية والتحكم في سلوكها بسهولة. باستخدام Mockito، يمكنك عزل الكود الذي تريد اختباره والتحقق من تفاعلاته مع التبعيات الأخرى بشكل فعال.</p>

<p>Mockito هي مكتبة قوية لإنشاء الكائنات الوهمية (mocks) لأغراض الاختبار.</p>

<ul>
  <li>محاكاة التبعيات: استخدم <code class="language-plaintext highlighter-rouge">@Mock</code> و <code class="language-plaintext highlighter-rouge">@InjectMocks</code> لإنشاء كائنات وهمية. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RunWith</span><span class="o">(</span><span class="nc">MockitoJUnitRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserServiceTest</span> <span class="o">{</span>
    <span class="nd">@Mock</span>
    <span class="kd">private</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@InjectMocks
private UserService userService;
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testFindUserById</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="o">();</span>
    <span class="n">user</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="mi">1L</span><span class="o">);</span>
    <span class="nc">Mockito</span><span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">userRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="mi">1L</span><span class="o">)).</span><span class="na">thenReturn</span><span class="o">(</span><span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">user</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>ترجمة:</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testFindUserById</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="o">();</span>
    <span class="n">user</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="mi">1L</span><span class="o">);</span>
    <span class="nc">Mockito</span><span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">userRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="mi">1L</span><span class="o">)).</span><span class="na">thenReturn</span><span class="o">(</span><span class="nc">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">user</span><span class="o">));</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>ملاحظة:</strong> الكود الموجود في الكتلة البرمجية لم يتم ترجمته لأنه يحتوي على أسماء دوال ومتغيرات بالإنجليزية، وهي أمور لا يتم ترجمتها عادةً في البرمجة.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>          <span class="nc">User</span> <span class="n">result</span> <span class="o">=</span> <span class="n">userService</span><span class="o">.</span><span class="na">findUserById</span><span class="o">(</span><span class="mi">1L</span><span class="o">);</span>
          <span class="n">assertNotNull</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
          <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1L</span><span class="o">,</span> <span class="n">result</span><span class="o">.</span><span class="na">getId</span><span class="o">().</span><span class="na">longValue</span><span class="o">());</span>
      <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div></div>

<p>تم ترجمة الكود أعلاه إلى:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>          <span class="nc">User</span> <span class="n">result</span> <span class="o">=</span> <span class="n">userService</span><span class="o">.</span><span class="na">findUserById</span><span class="o">(</span><span class="mi">1L</span><span class="o">);</span>
          <span class="n">assertNotNull</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
          <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1L</span><span class="o">,</span> <span class="n">result</span><span class="o">.</span><span class="na">getId</span><span class="o">().</span><span class="na">longValue</span><span class="o">());</span>
      <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div></div>

<p>ملاحظة: الكود لم يتم ترجمته لأنه يحتوي على أسماء متغيرات ووظائف بالإنجليزية، وهي عادةً لا تُترجم في البرمجة.</p>

<ul>
  <li>التحقق من السلوك: التحقق من التفاعلات مع الكائنات الوهمية (mock objects). على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Mockito</span><span class="o">.</span><span class="na">verify</span><span class="o">(</span><span class="n">userRepository</span><span class="o">,</span> <span class="n">times</span><span class="o">(</span><span class="mi">1</span><span class="o">)).</span><span class="na">findById</span><span class="o">(</span><span class="mi">1L</span><span class="o">);</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="الاختبار-باستخدام-mockmvc">الاختبار باستخدام MockMvc</h4>

<p>MockMvc يتيح لك اختبار وحدات تحكم Spring MVC.</p>

<ul>
  <li>الإعداد: قم بتكوين <code class="language-plaintext highlighter-rouge">MockMvc</code> في فئات الاختبار الخاصة بك. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RunWith</span><span class="o">(</span><span class="nc">SpringRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@WebMvcTest</span><span class="o">(</span><span class="nc">UserController</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserControllerTest</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">MockMvc</span> <span class="n">mockMvc</span><span class="o">;</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGetUser</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/users/1"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">content</span><span class="o">().</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">))</span>
        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.id"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>تمت ترجمة الكود أعلاه إلى:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGetUser</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/users/1"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isOk</span><span class="o">())</span>
        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">content</span><span class="o">().</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">))</span>
        <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">jsonPath</span><span class="o">(</span><span class="s">"$.id"</span><span class="o">).</span><span class="na">value</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ملاحظة: الكود لم يتغير لأنه يحتوي على أسماء وظائف ومتغيرات بالإنجليزية، وهي أسماء تقنية لا يتم ترجمتها عادةً.</p>

<ul>
  <li>بناة الطلبات: استخدم بناة الطلبات لمحاكاة طلبات HTTP. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/users"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
    <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="s">"{\"username\":\"john\",\"password\":\"secret\"}"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">andExpect</span><span class="o">(</span><span class="n">status</span><span class="o">().</span><span class="na">isCreated</span><span class="o">());</span>
</code></pre></div>    </div>
  </li>
</ul>

<hr />

<h3 id="المراقبة-والإدارة">المراقبة والإدارة</h3>

<h4 id="spring-boot-actuator">Spring Boot Actuator</h4>

<p>Spring Boot Actuator هو جزء من إطار عمل Spring Boot الذي يوفر ميزات لمراقبة وإدارة تطبيقاتك. يمكنك استخدامه لجمع مقاييس مختلفة، وفحص صحة التطبيق، وعرض معلومات التكوين، وغير ذلك الكثير. يتم تفعيل هذه الميزات عن طريق إضافة التبعيات المناسبة إلى ملف <code class="language-plaintext highlighter-rouge">pom.xml</code> أو <code class="language-plaintext highlighter-rouge">build.gradle</code>، ثم تكوينها حسب الحاجة.</p>

<p>على سبيل المثال، لإضافة Actuator إلى مشروع Spring Boot باستخدام Maven، يمكنك إضافة التبعية التالية إلى ملف <code class="language-plaintext highlighter-rouge">pom.xml</code>:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-actuator<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<p>وبعد ذلك، يمكنك الوصول إلى نقاط النهاية المختلفة التي يوفرها Actuator عبر HTTP. على سبيل المثال، يمكنك الوصول إلى معلومات الصحة عن طريق طلب GET إلى <code class="language-plaintext highlighter-rouge">/actuator/health</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl http://localhost:8080/actuator/health
</code></pre></div></div>

<p>سيتم إرجاع استجابة JSON تحتوي على حالة صحة التطبيق.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UP"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>يمكنك أيضًا تكوين نقاط النهاية التي تريد تفعيلها وتعطيلها عبر ملف <code class="language-plaintext highlighter-rouge">application.properties</code> أو <code class="language-plaintext highlighter-rouge">application.yml</code>. على سبيل المثال:</p>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">management.endpoints.web.exposure.include</span><span class="p">=</span><span class="s">health,info</span>
<span class="py">management.endpoint.health.show-details</span><span class="p">=</span><span class="s">always</span>
</code></pre></div></div>

<p>هذا التكوين سيسمح فقط بنقاط النهاية <code class="language-plaintext highlighter-rouge">/actuator/health</code> و <code class="language-plaintext highlighter-rouge">/actuator/info</code> بالظهور، وسيعرض تفاصيل الصحة دائمًا.</p>

<p>Spring Boot Actuator يوفر مجموعة واسعة من الميزات التي يمكن أن تساعدك في إدارة ومراقبة تطبيقاتك بفعالية.</p>

<p>يوفر Spring Boot Actuator ميزات جاهزة للإنتاج لمراقبة وإدارة تطبيقك.</p>

<ul>
  <li>النقاط الطرفية (Endpoints): استخدم نقاطًا طرفية مثل <code class="language-plaintext highlighter-rouge">/actuator/health</code> و <code class="language-plaintext highlighter-rouge">/actuator/metrics</code> لمراقبة صحة التطبيق والمقاييس. على سبيل المثال:
    <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl http://localhost:8080/actuator/health
</code></pre></div>    </div>
  </li>
  <li>نقاط النهاية المخصصة: قم بإنشاء نقاط نهاية مخصصة للـ actuator. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/actuator"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomEndpoint</span> <span class="o">{</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/custom"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="nf">customEndpoint</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">response</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"status"</span><span class="o">,</span> <span class="s">"نقطة نهاية مخصصة للـ actuator"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<hr />

<h3 id="مواضيع-متقدمة">مواضيع متقدمة</h3>

<h4 id="spring-advice-api">Spring Advice API</h4>

<p>Spring Advice API هي جزء من إطار عمل Spring AOP (Aspect-Oriented Programming) الذي يُستخدم لتطبيق السلوكيات المشتركة عبر تطبيقات Spring. الـ Advice هو الإجراء الذي يتم تنفيذه عند نقطة معينة في تنفيذ البرنامج، مثل قبل أو بعد استدعاء طريقة معينة.</p>

<p>هناك عدة أنواع من الـ Advice في Spring:</p>

<ol>
  <li><strong>Before Advice</strong>: يتم تنفيذه قبل استدعاء طريقة معينة.</li>
  <li><strong>After Returning Advice</strong>: يتم تنفيذه بعد استدعاء طريقة معينة بنجاح (بدون استثناءات).</li>
  <li><strong>After Throwing Advice</strong>: يتم تنفيذه إذا تم رمي استثناء أثناء استدعاء طريقة معينة.</li>
  <li><strong>After (Finally) Advice</strong>: يتم تنفيذه بعد استدعاء طريقة معينة بغض النظر عن النتيجة (سواء تم بنجاح أو مع استثناء).</li>
  <li><strong>Around Advice</strong>: يتم تنفيذه حول استدعاء طريقة معينة، مما يسمح بالتحكم في تنفيذ الطريقة بشكل كامل.</li>
</ol>

<h3 id="مثال-على-استخدام-before-advice">مثال على استخدام Before Advice</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.Aspect</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.Before</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>

<span class="nd">@Aspect</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoggingAspect</span> <span class="o">{</span>

    <span class="nd">@Before</span><span class="o">(</span><span class="s">"execution(* com.example.service.*.*(..))"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">logBefore</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Method is about to be called."</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>في هذا المثال، يتم تنفيذ الـ <code class="language-plaintext highlighter-rouge">logBefore</code> قبل استدعاء أي طريقة في الحزمة <code class="language-plaintext highlighter-rouge">com.example.service</code>.</p>

<h3 id="مثال-على-استخدام-around-advice">مثال على استخدام Around Advice</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.aspectj.lang.ProceedingJoinPoint</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.Around</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.Aspect</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>

<span class="nd">@Aspect</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TimingAspect</span> <span class="o">{</span>

    <span class="nd">@Around</span><span class="o">(</span><span class="s">"execution(* com.example.service.*.*(..))"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">measureExecutionTime</span><span class="o">(</span><span class="nc">ProceedingJoinPoint</span> <span class="n">joinPoint</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>
        <span class="kt">long</span> <span class="n">startTime</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
        <span class="nc">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">proceed</span><span class="o">();</span>
        <span class="kt">long</span> <span class="n">endTime</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Method execution time: "</span> <span class="o">+</span> <span class="o">(</span><span class="n">endTime</span> <span class="o">-</span> <span class="n">startTime</span><span class="o">)</span> <span class="o">+</span> <span class="s">"ms"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>في هذا المثال، يتم قياس وقت تنفيذ أي طريقة في الحزمة <code class="language-plaintext highlighter-rouge">com.example.service</code> وإخراج الوقت المستغرق.</p>

<p>Spring Advice API يوفر مرونة كبيرة في إدارة السلوكيات المشتركة عبر التطبيق، مما يجعل الكود أكثر نظافة وسهولة في الصيانة.</p>

<p>واجهة برمجة التطبيقات (API) الخاصة بـ Spring تُوفر إمكانيات متقدمة للبرمجة الموجهة نحو الجوانب (AOP).</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@Aspect</code>: قم بتعريف الجوانب باستخدام <code class="language-plaintext highlighter-rouge">@Aspect</code>. على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Aspect</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoggingAspect</span> <span class="o">{</span>
    <span class="nd">@Before</span><span class="o">(</span><span class="s">"execution(* com.example.service.*.*(..))"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">logBefore</span><span class="o">(</span><span class="nc">JoinPoint</span> <span class="n">joinPoint</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"قبل تنفيذ الدالة: "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@After</span><span class="o">(</span><span class="s">"execution(* com.example.service.*.*(..))"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">logAfter</span><span class="o">(</span><span class="nc">JoinPoint</span> <span class="n">joinPoint</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"بعد تنفيذ الدالة: "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>نقاط الالتحاق (Join Points): استخدم نقاط الالتحاق لتحديد الأماكن التي يجب أن تُطبق فيها الجوانب (Aspects). على سبيل المثال:
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Pointcut</span><span class="o">(</span><span class="s">"execution(* com.example.service.*.*(..))"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">serviceMethods</span><span class="o">()</span> <span class="o">{}</span>
</code></pre></div>    </div>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Around</span><span class="o">(</span><span class="s">"serviceMethods()"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">Object</span> <span class="nf">logAround</span><span class="o">(</span><span class="nc">ProceedingJoinPoint</span> <span class="n">joinPoint</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"قبل تنفيذ الدالة: "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="nc">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">proceed</span><span class="o">();</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"بعد تنفيذ الدالة: "</span> <span class="o">+</span> <span class="n">joinPoint</span><span class="o">.</span><span class="na">getSignature</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<hr />

<h3 id="الخلاصة-5">الخلاصة</h3>

<p>Spring هو إطار عمل قوي ومتعدد الاستخدامات يمكنه تبسيط تطوير التطبيقات على مستوى المؤسسات. من خلال الاستفادة من ميزات Spring Boot وSpring Data وSpring REST وغيرها من مشاريع Spring، يمكن للمطورين بناء تطبيقات قوية وقابلة للتوسع وسهلة الصيانة بكفاءة. مع إضافة أدوات مثل Spring Boot Actuator وأطر اختبار، يمكنك التأكد من أن تطبيقاتك جاهزة للإنتاج ومختَبرة بشكل جيد.</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-ar" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
