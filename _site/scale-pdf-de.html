<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Skalieren von PDF-Inhalten für den Druck</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Skalieren von PDF-Inhalten für den Druck | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Skalieren von PDF-Inhalten für den Druck" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="de" />
<meta name="description" content="Ich muss Dokumente drucken, und mir ist aufgefallen, dass der Weißraum um den Inhalt oft zu groß ist, was Papier verschwendet und den Text kleiner erscheinen lässt, als er sein sollte. Dieses Skript hilft dabei, den PDF-Inhalt automatisch so zu skalieren, dass er besser auf die Seite passt, indem es den Inhaltsbereich erkennt und ihn vergrößert, um die Seite zu füllen, während ein kleiner Rand eingehalten wird." />
<meta property="og:description" content="Ich muss Dokumente drucken, und mir ist aufgefallen, dass der Weißraum um den Inhalt oft zu groß ist, was Papier verschwendet und den Text kleiner erscheinen lässt, als er sein sollte. Dieses Skript hilft dabei, den PDF-Inhalt automatisch so zu skalieren, dass er besser auf die Seite passt, indem es den Inhaltsbereich erkennt und ihn vergrößert, um die Seite zu füllen, während ein kleiner Rand eingehalten wird." />
<link rel="canonical" href="https://lzwjava.github.io/scale-pdf-de" />
<meta property="og:url" content="https://lzwjava.github.io/scale-pdf-de" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-18T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Skalieren von PDF-Inhalten für den Druck" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2025-01-18T00:00:00+08:00","datePublished":"2025-01-18T00:00:00+08:00","description":"Ich muss Dokumente drucken, und mir ist aufgefallen, dass der Weißraum um den Inhalt oft zu groß ist, was Papier verschwendet und den Text kleiner erscheinen lässt, als er sein sollte. Dieses Skript hilft dabei, den PDF-Inhalt automatisch so zu skalieren, dass er besser auf die Seite passt, indem es den Inhaltsbereich erkennt und ihn vergrößert, um die Seite zu füllen, während ein kleiner Rand eingehalten wird.","headline":"Skalieren von PDF-Inhalten für den Druck","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/scale-pdf-de"},"url":"https://lzwjava.github.io/scale-pdf-de"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=b723421028b8526c972158efc52ea9e8c5663d17">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=b723421028b8526c972158efc52ea9e8c5663d17" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Skalieren von PDF-Inhalten für den Druck | Original, von KI übersetzt
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/de/2025-01-18-scale-pdf-de.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsde2025-01-18-scale-pdf-de.md</span> -->
      

      <!-- <span>2025-01-18-scale-pdf-de.md</span> -->

      
        

        
          
          <a href="#" class="button">2025.01</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/scale-pdf-en" >English</option>
        <option value="/scale-pdf-zh" >中文</option>
        <option value="/scale-pdf-ja" >日本語</option>
        <option value="/scale-pdf-es" >Español</option>
        <option value="/scale-pdf-hi" >हिंदी</option>
        <option value="/scale-pdf-fr" >Français</option>
        <option value="/scale-pdf-de" selected>Deutsch</option>
        <option value="/scale-pdf-ar" >العربية</option>
        <option value="/scale-pdf-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>Ich muss Dokumente drucken, und mir ist aufgefallen, dass der Weißraum um den Inhalt oft zu groß ist, was Papier verschwendet und den Text kleiner erscheinen lässt, als er sein sollte. Dieses Skript hilft dabei, den PDF-Inhalt automatisch so zu skalieren, dass er besser auf die Seite passt, indem es den Inhaltsbereich erkennt und ihn vergrößert, um die Seite zu füllen, während ein kleiner Rand eingehalten wird.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">pdf2image</span> <span class="kn">import</span> <span class="n">convert_from_path</span>

<span class="n">MARGIN_PERCENT</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">DPI</span> <span class="o">=</span> <span class="mi">72</span>

<span class="k">def</span> <span class="nf">convert_pixels_to_points</span><span class="p">(</span><span class="n">pixels</span><span class="p">,</span> <span class="n">dpi</span><span class="p">):</span>
    <span class="s">"""Konvertiert Pixel in Punkte."""</span>
    <span class="k">return</span> <span class="n">pixels</span> <span class="o">*</span> <span class="mi">72</span> <span class="o">/</span> <span class="n">dpi</span>

<span class="k">def</span> <span class="nf">get_image_dimensions</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="s">"""Ermittelt die Bildabmessungen in Pixel und Punkten."""</span>
    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">image</span><span class="p">.</span><span class="n">size</span>
    <span class="n">dpi</span> <span class="o">=</span> <span class="n">image</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'dpi'</span><span class="p">,</span> <span class="p">(</span><span class="n">DPI</span><span class="p">,</span> <span class="n">DPI</span><span class="p">))</span>
    <span class="n">width_points</span> <span class="o">=</span> <span class="n">convert_pixels_to_points</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">dpi</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">height_points</span> <span class="o">=</span> <span class="n">convert_pixels_to_points</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">dpi</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width_points</span><span class="p">,</span> <span class="n">height_points</span><span class="p">,</span> <span class="n">dpi</span>

<span class="k">def</span> <span class="nf">analyze_whitespace</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
    <span class="s">"""Analysiert den Weißraum, um den Begrenzungsrahmen des Inhalts zu finden."""</span>
    <span class="n">left_margin_px</span> <span class="o">=</span> <span class="n">width</span>
    <span class="n">right_margin_px</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">top_margin_px</span> <span class="o">=</span> <span class="n">height</span>
    <span class="n">bottom_margin_px</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">found_content</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">):</span>
            <span class="n">pixel</span> <span class="o">=</span> <span class="n">image</span><span class="p">.</span><span class="n">getpixel</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pixel</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">c</span> <span class="o">&lt;</span> <span class="mi">250</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">pixel</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">found_content</span><span class="p">:</span>
                        <span class="n">left_margin_px</span> <span class="o">=</span> <span class="n">x</span>
                        <span class="n">top_margin_px</span> <span class="o">=</span> <span class="n">y</span>
                        <span class="n">found_content</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">right_margin_px</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">right_margin_px</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
                    <span class="n">bottom_margin_px</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bottom_margin_px</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">pixel</span> <span class="o">&lt;</span> <span class="mi">250</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">found_content</span><span class="p">:</span>
                    <span class="n">left_margin_px</span> <span class="o">=</span> <span class="n">x</span>
                    <span class="n">top_margin_px</span> <span class="o">=</span> <span class="n">y</span>
                    <span class="n">found_content</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="n">right_margin_px</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">right_margin_px</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
                <span class="n">bottom_margin_px</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">bottom_margin_px</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">found_content</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
    
    <span class="n">right_margin_px</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="n">right_margin_px</span>
    <span class="n">bottom_margin_px</span> <span class="o">=</span> <span class="n">height</span> <span class="o">-</span> <span class="n">bottom_margin_px</span>
    <span class="k">return</span> <span class="n">left_margin_px</span><span class="p">,</span> <span class="n">right_margin_px</span><span class="p">,</span> <span class="n">top_margin_px</span><span class="p">,</span> <span class="n">bottom_margin_px</span>

<span class="k">def</span> <span class="nf">calculate_scale_factor</span><span class="p">(</span><span class="n">input_pdf</span><span class="p">):</span>
    <span class="s">"""
    Ermittelt die Abmessungen der ersten Seite eines PDFs, analysiert den Weißraum
    und berechnet den Skalierungsfaktor basierend auf dem PDF-Inhalt und den Zielabmessungen im A4-Format mit Rändern.
    Gibt den Skalierungsfaktor zurück oder None, falls ein Fehler auftritt.
    """</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Berechne Skalierungsfaktor für: </span><span class="si">{</span><span class="n">input_pdf</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">images</span> <span class="o">=</span> <span class="n">convert_from_path</span><span class="p">(</span><span class="n">input_pdf</span><span class="p">,</span> <span class="n">first_page</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">last_page</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">images</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"  Konnte PDF nicht in ein Bild konvertieren."</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
        
        <span class="n">image</span> <span class="o">=</span> <span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width_points</span><span class="p">,</span> <span class="n">height_points</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="n">get_image_dimensions</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        
        <span class="n">margins</span> <span class="o">=</span> <span class="n">analyze_whitespace</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">margins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"  Konnte den Begrenzungsrahmen des Inhalts nicht bestimmen."</span><span class="p">)</span>
            <span class="n">left_margin_points</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">right_margin_points</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">top_margin_points</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">bottom_margin_points</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">left_margin_px</span><span class="p">,</span> <span class="n">right_margin_px</span><span class="p">,</span> <span class="n">top_margin_px</span><span class="p">,</span> <span class="n">bottom_margin_px</span> <span class="o">=</span> <span class="n">margins</span>
            <span class="n">content_width_px</span> <span class="o">=</span> <span class="n">right_margin_px</span> <span class="o">-</span> <span class="n">left_margin_px</span>
            <span class="n">content_height_px</span> <span class="o">=</span> <span class="n">bottom_margin_px</span> <span class="o">-</span> <span class="n">top_margin_px</span>
            
            <span class="n">left_margin_points</span> <span class="o">=</span> <span class="n">convert_pixels_to_points</span><span class="p">(</span><span class="n">left_margin_px</span><span class="p">,</span> <span class="n">dpi</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">right_margin_points</span> <span class="o">=</span> <span class="n">convert_pixels_to_points</span><span class="p">(</span><span class="n">right_margin_px</span><span class="p">,</span> <span class="n">dpi</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">top_margin_points</span> <span class="o">=</span> <span class="n">convert_pixels_to_points</span><span class="p">(</span><span class="n">top_margin_px</span><span class="p">,</span> <span class="n">dpi</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">bottom_margin_points</span> <span class="o">=</span> <span class="n">convert_pixels_to_points</span><span class="p">(</span><span class="n">bottom_margin_px</span><span class="p">,</span> <span class="n">dpi</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Inhaltsrahmen: links=</span><span class="si">{</span><span class="n">left_margin_px</span><span class="si">}</span><span class="s">, oben=</span><span class="si">{</span><span class="n">top_margin_px</span><span class="si">}</span><span class="s">, rechts=</span><span class="si">{</span><span class="n">right_margin_px</span><span class="si">}</span><span class="s">, unten=</span><span class="si">{</span><span class="n">bottom_margin_px</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Inhaltsabmessungen (Pixel): Breite=</span><span class="si">{</span><span class="n">content_width_px</span><span class="si">}</span><span class="s">, Höhe=</span><span class="si">{</span><span class="n">content_height_px</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Ränder (Punkte): links=</span><span class="si">{</span><span class="n">left_margin_points</span><span class="si">}</span><span class="s">, rechts=</span><span class="si">{</span><span class="n">right_margin_points</span><span class="si">}</span><span class="s">, oben=</span><span class="si">{</span><span class="n">top_margin_points</span><span class="si">}</span><span class="s">, unten=</span><span class="si">{</span><span class="n">bottom_margin_points</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Erkannte Abmessungen: Breite=</span><span class="si">{</span><span class="n">width_points</span><span class="si">}</span><span class="s">, Höhe=</span><span class="si">{</span><span class="n">height_points</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

        <span class="n">width_margin_points</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">left_margin_points</span><span class="p">,</span> <span class="n">right_margin_points</span><span class="p">)</span>
        <span class="n">height_margin_points</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">top_margin_points</span><span class="p">,</span> <span class="n">bottom_margin_points</span><span class="p">)</span>        
        
        <span class="n">content_width</span> <span class="o">=</span> <span class="n">width_points</span> <span class="o">-</span> <span class="n">width_margin_points</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="n">content_height</span> <span class="o">=</span> <span class="n">height_points</span> <span class="o">-</span> <span class="n">height_margin_points</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="n">target_width</span> <span class="o">=</span> <span class="n">width_points</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">MARGIN_PERCENT</span><span class="p">)</span>
        <span class="n">target_height</span> <span class="o">=</span> <span class="n">height_points</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">MARGIN_PERCENT</span><span class="p">)</span>

        <span class="n">width_scale</span> <span class="o">=</span> <span class="n">target_width</span> <span class="o">/</span> <span class="n">content_width</span>
        <span class="n">height_scale</span> <span class="o">=</span> <span class="n">target_height</span> <span class="o">/</span> <span class="n">content_height</span>

        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Inhaltsabmessungen (Punkte): Breite=</span><span class="si">{</span><span class="n">content_width</span><span class="si">}</span><span class="s">, Höhe=</span><span class="si">{</span><span class="n">content_height</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">content_width</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">content_height</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Fehler: Konnte die Inhaltsabmessungen nicht bestimmen."</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
        
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Zielabmessungen: Breite=</span><span class="si">{</span><span class="n">target_width</span><span class="si">}</span><span class="s">, Höhe=</span><span class="si">{</span><span class="n">target_height</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Berechnete Breitenskala: </span><span class="si">{</span><span class="n">width_scale</span><span class="si">}</span><span class="s">, Höhenskala: </span><span class="si">{</span><span class="n">height_scale</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="n">scale_factor</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">width_scale</span><span class="p">,</span> <span class="n">height_scale</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Endgültiger Skalierungsfaktor: </span><span class="si">{</span><span class="n">scale_factor</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">scale_factor</span>

    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Fehler beim Ermitteln der PDF-Abmessungen oder beim Berechnen des Skalierungsfaktors: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">scale_pdf</span><span class="p">(</span><span class="n">input_pdf</span><span class="p">,</span> <span class="n">output_pdf</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">):</span>
    <span class="s">"""Skaliert ein PDF mit pdfjam."""</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Skaliere </span><span class="si">{</span><span class="n">input_pdf</span><span class="si">}</span><span class="s"> zu </span><span class="si">{</span><span class="n">output_pdf</span><span class="si">}</span><span class="s"> mit Skalierungsfaktor: </span><span class="si">{</span><span class="n">scale_factor</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s">"pdfjam"</span><span class="p">,</span>
                <span class="s">"--scale"</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">scale_factor</span><span class="p">),</span>
                <span class="n">input_pdf</span><span class="p">,</span>
                <span class="s">"--outfile"</span><span class="p">,</span>
                <span class="n">output_pdf</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Erfolgreich skaliert </span><span class="si">{</span><span class="n">input_pdf</span><span class="si">}</span><span class="s"> zu </span><span class="si">{</span><span class="n">output_pdf</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Fehler beim Skalieren des PDFs: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Fehler: pdfjam-Befehl nicht gefunden. Bitte stellen Sie sicher, dass es installiert ist und sich im PATH Ihres Systems befindet."</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Verwendung: python scale-pdf.py &lt;input_pdf&gt; &lt;output_pdf&gt;"</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">input_pdf</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">output_pdf</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Eingabe-PDF: </span><span class="si">{</span><span class="n">input_pdf</span><span class="si">}</span><span class="s">, Ausgabe-PDF: </span><span class="si">{</span><span class="n">output_pdf</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">input_pdf</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Fehler: Eingabe-PDF-Datei nicht gefunden: </span><span class="si">{</span><span class="n">input_pdf</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">scale_factor</span> <span class="o">=</span> <span class="n">calculate_scale_factor</span><span class="p">(</span><span class="n">input_pdf</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">scale_factor</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">scale_pdf</span><span class="p">(</span><span class="n">input_pdf</span><span class="p">,</span> <span class="n">output_pdf</span><span class="p">,</span> <span class="n">scale_factor</span><span class="p">)</span>

</code></pre></div></div>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-de" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
