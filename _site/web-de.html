<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>Web-Programmierung für Anfänger</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Web-Programmierung für Anfänger | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Web-Programmierung für Anfänger" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="de" />
<meta name="description" content="In der letzten Folge haben wir die Fibonacci-Folgen-Funktion in eine objektorientierte Version umgeschrieben und eine Terminal-Schnittstelle implementiert." />
<meta property="og:description" content="In der letzten Folge haben wir die Fibonacci-Folgen-Funktion in eine objektorientierte Version umgeschrieben und eine Terminal-Schnittstelle implementiert." />
<link rel="canonical" href="https://lzwjava.github.io/web-de" />
<meta property="og:url" content="https://lzwjava.github.io/web-de" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-07T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Web-Programmierung für Anfänger" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2021-03-07T00:00:00+08:00","datePublished":"2021-03-07T00:00:00+08:00","description":"In der letzten Folge haben wir die Fibonacci-Folgen-Funktion in eine objektorientierte Version umgeschrieben und eine Terminal-Schnittstelle implementiert.","headline":"Web-Programmierung für Anfänger","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/web-de"},"url":"https://lzwjava.github.io/web-de"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=5e5db392484e789d995aa62863bd537c5c1f073a">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=5e5db392484e789d995aa62863bd537c5c1f073a" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       Web-Programmierung für Anfänger | Original, von KI übersetzt
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/de/2021-03-07-web-de.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsde2021-03-07-web-de.md</span> -->
      

      <!-- <span>2021-03-07-web-de.md</span> -->

      
        

        
          
          <a href="#" class="button">2021.03</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/web-en" >English</option>
        <option value="/web-zh" >中文</option>
        <option value="/web-ja" >日本語</option>
        <option value="/web-es" >Español</option>
        <option value="/web-hi" >हिंदी</option>
        <option value="/web-fr" >Français</option>
        <option value="/web-de" selected>Deutsch</option>
        <option value="/web-ar" >العربية</option>
        <option value="/web-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>In der letzten Folge haben wir die Fibonacci-Folgen-Funktion in eine objektorientierte Version umgeschrieben und eine Terminal-Schnittstelle implementiert.</p>

<p><code class="language-plaintext highlighter-rouge">server.py</code>：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">BaseHandler</span><span class="p">:</span>
  <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Server</span><span class="p">:</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handlerClass</span><span class="p">):</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">handlerClass</span> <span class="o">=</span> <span class="n">handlerClass</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>    
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
      <span class="n">request</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">handlerClass</span><span class="p">().</span><span class="n">handle</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">fib_handle.py</code>：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">fib</span> <span class="kn">import</span> <span class="n">f</span>
<span class="kn">from</span> <span class="nn">server</span> <span class="kn">import</span> <span class="n">BaseHandler</span><span class="p">,</span> <span class="n">Server</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">FibHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'f(n)='</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">pass</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">(</span><span class="n">FibHandler</span><span class="p">)</span>
<span class="n">server</span><span class="p">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div></div>
<h2 id="einfacher-web-server">Einfacher Web-Server</h2>

<p>Wie kann man es in eine <code class="language-plaintext highlighter-rouge">Web</code>-Schnittstelle umwandeln?</p>

<p>Wir können den obigen <code class="language-plaintext highlighter-rouge">Server</code> durch einen <code class="language-plaintext highlighter-rouge">Server</code> des <code class="language-plaintext highlighter-rouge">HTTP-Protokolls</code> ersetzen. Schauen wir uns zunächst an, wie ein <code class="language-plaintext highlighter-rouge">HTTP-Server</code> in Python aussieht.</p>

<p>Die Standardbibliothek von Python bietet einen Webserver.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python -m http.server
</code></pre></div></div>

<p>Führen Sie es im Terminal aus.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python <span class="nt">-m</span> http.server
HTTP-Server läuft auf :: Port 8000 <span class="o">(</span>http://[::]:8000/<span class="o">)</span> ...
</code></pre></div></div>

<p>Im Browser öffnen, um die Ergebnisse zu sehen.</p>

<p><img src="/assets/images/web/webserver.png" alt="webserver" style="zoom:50%;" /></p>

<p>Dies listet das aktuelle Verzeichnis auf. Wenn Sie dann diese Webseite durchsuchen und zurück zum Terminal schauen, wird es sehr interessant.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python <span class="nt">-m</span> http.server
Serving HTTP on :: port 8000 <span class="o">(</span>http://[::]:8000/<span class="o">)</span> ...
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] <span class="s2">"GET / HTTP/1.1"</span> 200 -
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] code 404, message File not found
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] <span class="s2">"GET /favicon.ico HTTP/1.1"</span> 404 -
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] code 404, message File not found
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] <span class="s2">"GET /apple-touch-icon-precomposed.png HTTP/1.1"</span> 404 -
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] code 404, message File not found
::1 - - <span class="o">[</span>07/Mar/2021 15:30:35] <span class="s2">"GET /apple-touch-icon.png HTTP/1.1"</span> 404 -
::1 - - <span class="o">[</span>07/Mar/2021 15:30:38] <span class="s2">"GET / HTTP/1.1"</span> 200 -
</code></pre></div></div>

<p>Dies ist ein Zugriffsprotokoll einer Webseite. Dabei steht <code class="language-plaintext highlighter-rouge">GET</code> für eine Art von Datenabrufoperation im Webdienst. <code class="language-plaintext highlighter-rouge">HTTP/1.1</code> zeigt an, dass das Protokoll der Version <code class="language-plaintext highlighter-rouge">1.1</code> von <code class="language-plaintext highlighter-rouge">HTTP</code> verwendet wurde.</p>

<p>Wie man es verwenden kann, um unseren Fibonacci-Sequenz-Service zu erstellen. Zuerst suchen wir online nach Beispielcode, passen ihn leicht an und schreiben den einfachsten Web-Server:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">http.server</span> <span class="kn">import</span> <span class="n">SimpleHTTPRequestHandler</span><span class="p">,</span> <span class="n">HTTPServer</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Handler</span><span class="p">(</span><span class="n">SimpleHTTPRequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">send_header</span><span class="p">(</span><span class="s">'Content-type'</span><span class="p">,</span> <span class="s">'text'</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">end_headers</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="s">"hi"</span><span class="p">,</span> <span class="s">"utf-8"</span><span class="p">))</span>
</code></pre></div></div>

<p>server = HTTPServer((“127.0.0.1”, 8000), Handler)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">server</span><span class="p">.</span><span class="n">serve_forever</span><span class="p">()</span>
</code></pre></div></div>

<p>Das kommt Ihnen sicher bekannt vor. Es ist fast dasselbe wie bei der Verwendung von <code class="language-plaintext highlighter-rouge">Server</code> oben. Beachten Sie, dass <code class="language-plaintext highlighter-rouge">SimpleHTTPRequestHandler</code> keine Basisklasse ist, sondern es gibt eine Klasse namens <code class="language-plaintext highlighter-rouge">BaseHTTPRequestHandler</code>. Der <code class="language-plaintext highlighter-rouge">SimpleHTTPRequestHandler</code> verarbeitet im Vergleich dazu ein paar zusätzliche Dinge. Die Integration der Fibonacci-Folge-Funktionalität ist damit einfach.</p>

<p>Hier steht <code class="language-plaintext highlighter-rouge">127.0.0.1</code> für die Adresse des lokalen Rechners, und <code class="language-plaintext highlighter-rouge">8000</code> repräsentiert den Port des lokalen Rechners. Wie kann man sich einen Port vorstellen? Es ist wie ein Fenster in einem Haus, ein Kommunikationskanal zwischen dem Haus und der Außenwelt. <code class="language-plaintext highlighter-rouge">bytes</code> bedeutet, dass der String in Bytes umgewandelt wird. <code class="language-plaintext highlighter-rouge">utf-8</code> ist eine Art der Zeichenkodierung. <code class="language-plaintext highlighter-rouge">send_response</code>, <code class="language-plaintext highlighter-rouge">send_header</code> und <code class="language-plaintext highlighter-rouge">end_headers</code> sind alle dafür da, Inhalte auszugeben, die vom <code class="language-plaintext highlighter-rouge">HTTP</code>-Protokoll vorgeschrieben sind, damit sie vom Browser verstanden werden können. So sehen wir auf der Webseite das Wort <code class="language-plaintext highlighter-rouge">hi</code>.</p>

<p><img src="/assets/images/web/hi.png" alt="hi" style="zoom:50%;" /></p>

<p>Versuchen wir als Nächstes, die Parameter aus der Anfrage zu erhalten.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">http.server</span> <span class="kn">import</span> <span class="n">SimpleHTTPRequestHandler</span><span class="p">,</span> <span class="n">HTTPServer</span>
<span class="kn">from</span> <span class="nn">fib</span> <span class="kn">import</span> <span class="n">f</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span><span class="p">,</span> <span class="n">parse_qs</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Handler</span><span class="p">(</span><span class="n">SimpleHTTPRequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">send_header</span><span class="p">(</span><span class="s">'Content-type'</span><span class="p">,</span> <span class="s">'text'</span><span class="p">)</span>      
        <span class="bp">self</span><span class="p">.</span><span class="n">end_headers</span><span class="p">()</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">path</span><span class="p">)</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="n">parse_qs</span><span class="p">(</span><span class="n">parsed</span><span class="p">.</span><span class="n">query</span><span class="p">)</span>      
        <span class="n">result</span> <span class="o">=</span> <span class="s">""</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="n">qs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>          
                <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s">"utf-8"</span><span class="p">))</span>
</code></pre></div></div>

<p><strong>Übersetzung:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Handler</span><span class="p">(</span><span class="n">SimpleHTTPRequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">send_header</span><span class="p">(</span><span class="s">'Content-type'</span><span class="p">,</span> <span class="s">'text'</span><span class="p">)</span>      
        <span class="bp">self</span><span class="p">.</span><span class="n">end_headers</span><span class="p">()</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">path</span><span class="p">)</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="n">parse_qs</span><span class="p">(</span><span class="n">parsed</span><span class="p">.</span><span class="n">query</span><span class="p">)</span>      
        <span class="n">result</span> <span class="o">=</span> <span class="s">""</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="n">qs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>          
                <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s">"utf-8"</span><span class="p">))</span>
</code></pre></div></div>

<p><strong>Erklärung:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Handler</code> ist eine Klasse, die von <code class="language-plaintext highlighter-rouge">SimpleHTTPRequestHandler</code> erbt.</li>
  <li>Die Methode <code class="language-plaintext highlighter-rouge">do_GET</code> wird aufgerufen, wenn eine GET-Anfrage an den Server gesendet wird.</li>
  <li>Der Server sendet eine Antwort mit dem Statuscode 200 (OK) und dem Content-Type “text”.</li>
  <li>Die Anfrage-URL wird analysiert, um die Abfrageparameter zu extrahieren.</li>
  <li>Wenn Abfrageparameter vorhanden sind, wird der erste Parameter in eine Ganzzahl umgewandelt und die Funktion <code class="language-plaintext highlighter-rouge">f(n)</code> aufgerufen.</li>
  <li>Das Ergebnis wird in eine Zeichenkette umgewandelt und als Antwort an den Client gesendet.</li>
</ul>

<p>server = HTTPServer((“127.0.0.1”, 8000), Handler)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">server</span><span class="p">.</span><span class="n">serve_forever</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/web/n10.png" alt="n10" style="zoom:50%;" /></p>

<p>Es ist ein bisschen kompliziert. Hier geht es darum, einige Parameter zu analysieren.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>self.path<span class="o">=</span>/?n<span class="o">=</span>3
<span class="nv">parsed</span><span class="o">=</span>ParseResult<span class="o">(</span><span class="nv">scheme</span><span class="o">=</span><span class="s1">''</span>, <span class="nv">netloc</span><span class="o">=</span><span class="s1">''</span>, <span class="nv">path</span><span class="o">=</span><span class="s1">'/'</span>, <span class="nv">params</span><span class="o">=</span><span class="s1">''</span>, <span class="nv">query</span><span class="o">=</span><span class="s1">'n=3'</span>, <span class="nv">fragment</span><span class="o">=</span><span class="s1">''</span><span class="o">)</span>
<span class="nv">qs</span><span class="o">={</span><span class="s1">'n'</span>: <span class="o">[</span><span class="s1">'3'</span><span class="o">]}</span>
<span class="nv">ns</span><span class="o">=[</span><span class="s1">'3'</span><span class="o">]</span>
<span class="nv">n</span><span class="o">=</span>3
</code></pre></div></div>

<p><em>Hinweis: Der Codeblock wurde nicht übersetzt, da er technischer Natur ist und in der Regel nicht übersetzt wird.</em></p>

<h2 id="fortgeschrittene-rekursion">Fortgeschrittene Rekursion</h2>

<p>Lassen Sie uns den Code ein wenig umstrukturieren.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">http.server</span> <span class="kn">import</span> <span class="n">SimpleHTTPRequestHandler</span><span class="p">,</span> <span class="n">HTTPServer</span>
<span class="kn">from</span> <span class="nn">fib</span> <span class="kn">import</span> <span class="n">f</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span><span class="p">,</span> <span class="n">parse_qs</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Handler</span><span class="p">(</span><span class="n">SimpleHTTPRequestHandler</span><span class="p">):</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">def</span> <span class="nf">parse_n</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
      <span class="n">parsed</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
      <span class="n">qs</span> <span class="o">=</span> <span class="n">parse_qs</span><span class="p">(</span><span class="n">parsed</span><span class="p">.</span><span class="n">query</span><span class="p">)</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="n">qs</span><span class="p">[</span><span class="s">'n'</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
          <span class="k">return</span> <span class="n">n</span>
      <span class="k">return</span> <span class="bp">None</span>
      
    <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">send_header</span><span class="p">(</span><span class="s">'Content-type'</span><span class="p">,</span> <span class="s">'text'</span><span class="p">)</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">end_headers</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="n">result</span> <span class="o">=</span> <span class="s">""</span>
      <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">parse_n</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">path</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
              
      <span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s">"utf-8"</span><span class="p">))</span>
      <span class="bp">self</span><span class="p">.</span><span class="n">wfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s">"utf-8"</span><span class="p">))</span>
</code></pre></div></div>

<p>server = HTTPServer((“127.0.0.1”, 8000), Handler)</p>

<p>server.serve_forever()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Fügen Sie die Funktion `parse_n` hinzu, um das Extrahieren von `n` aus dem Anfragepfad zu kapseln.

现在程序有这样的问题。小王请求了斐波那契数列的第10000位，过了一些天，小明又请求了斐波那契数列的第10000位。两次，小王和小明都等待了半天，才得到结果。我们该如何提高这个`Web服务`的效率呢。

---

**解决方案：**

为了提高这个`Web服务`的效率，我们可以考虑以下几种方法：

1. **缓存结果**：由于斐波那契数列的计算是确定性的，相同的输入总是会产生相同的输出。因此，我们可以将已经计算过的斐波那契数列的结果缓存起来。当有新的请求时，首先检查缓存中是否已经存在该结果。如果存在，则直接返回缓存中的结果，而不需要重新计算。

2. **优化算法**：斐波那契数列的计算可以通过多种算法实现，有些算法的效率更高。例如，使用矩阵快速幂算法或动态规划算法，可以显著减少计算时间。

3. **异步处理**：如果计算斐波那契数列的过程非常耗时，可以考虑将计算任务放入后台异步处理。当用户请求时，立即返回一个任务ID，并在计算完成后通过WebSocket或其他方式通知用户结果。

4. **分布式计算**：如果计算量非常大，可以考虑将计算任务分布到多个服务器上进行并行计算，从而加快计算速度。

5. **预计算**：如果某些斐波那契数列的结果是经常被请求的，可以提前计算并存储这些结果，以减少实时计算的压力。

通过以上方法，我们可以显著提高`Web服务`的效率，减少用户等待时间。

Beachte, dass der Wert von `f(n)` immer gleich ist, wenn `n` gleich ist. Wir haben einige Experimente durchgeführt.

```shell
127.0.0.1 - - [10/Mar/2021 00:33:01] "GET /?n=1000 HTTP/1.1" 200 -
----------------------------------------
Exception occurred during processing of request from ('127.0.0.1', 50783)
Traceback (most recent call last):
    ...
    if v[n] != -1:
IndexError: list index out of range
</code></pre></div></div>

<p><strong>Übersetzung:</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1 - - <span class="o">[</span>10/Mar/2021 00:33:01] <span class="s2">"GET /?n=1000 HTTP/1.1"</span> 200 -
<span class="nt">----------------------------------------</span>
Exception occurred during processing of request from <span class="o">(</span><span class="s1">'127.0.0.1'</span>, 50783<span class="o">)</span>
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
    ...
    <span class="k">if </span>v[n] <span class="o">!=</span> <span class="nt">-1</span>:
IndexError: list index out of range
</code></pre></div></div>

<p><strong>Erklärung:</strong></p>
<ul>
  <li>Der Text wurde nicht übersetzt, da es sich um einen Codeblock und eine Fehlermeldung handelt, die in der Regel in der Originalsprache belassen werden, um die technische Integrität zu wahren.</li>
</ul>

<p>Wenn das ursprüngliche Array nicht groß genug ist, dann ändern wir das <code class="language-plaintext highlighter-rouge">v</code>-Array auf 10000.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
   <span class="n">v</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>(Der Code bleibt auf Englisch, da es sich um eine Programmiersprache handelt und keine Übersetzung erforderlich ist.)</p>

<p>Allerdings trat ein Fehler aufgrund der Rekursionstiefenüberschreitung auf, als <code class="language-plaintext highlighter-rouge">n</code> den Wert <code class="language-plaintext highlighter-rouge">2000</code> hatte:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1 - - <span class="o">[</span>10/Mar/2021 00:34:00] <span class="s2">"GET /?n=2000 HTTP/1.1"</span> 200 -
<span class="nt">----------------------------------------</span>
Exception occurred during processing of request from <span class="o">(</span><span class="s1">'127.0.0.1'</span>, 50821<span class="o">)</span>
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
    ...
    <span class="k">if </span>v[n] <span class="o">!=</span> <span class="nt">-1</span>:
RecursionError: maximale Rekursionstiefe beim Vergleich überschritten
</code></pre></div></div>

<p>Allerdings ging das alles ziemlich schnell.</p>

<p>Warum? Weil <code class="language-plaintext highlighter-rouge">f(1)</code> bis <code class="language-plaintext highlighter-rouge">f(1000)</code> jeweils nur einmal berechnet werden müssen. Das bedeutet, dass beim Berechnen von <code class="language-plaintext highlighter-rouge">f(1000)</code> die <code class="language-plaintext highlighter-rouge">+</code>-Operation vielleicht nur etwa 1000 Mal ausgeführt wird. Wir wissen, dass die Rekursionstiefe von <code class="language-plaintext highlighter-rouge">Python</code> bei etwa 1000 liegt. Das bedeutet, dass wir das Programm so optimieren können, dass wir, wenn wir <code class="language-plaintext highlighter-rouge">2000</code> berechnen wollen, zuerst <code class="language-plaintext highlighter-rouge">1000</code> berechnen. Nein, so könnte immer noch ein <code class="language-plaintext highlighter-rouge">Rekursionstiefenüberlauffehler</code> auftreten. Wenn wir 2000 berechnen wollen, berechnen wir zuerst 1200. Wenn wir 1200 berechnen wollen, berechnen wir zuerst 400.</p>

<p>Nachdem Sie 400 und 1200 berechnet haben, berechnen Sie 2000. Die Rekursionstiefe liegt dann bei etwa 800, und es wird kein Rekursionstiefenüberlauffehler auftreten.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>
   <span class="n">v</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fplus</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">800</span><span class="p">:</span>         
      <span class="n">fplus</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">800</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">n</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</code></pre></div></div>

<p>Die Funktion <code class="language-plaintext highlighter-rouge">fplus</code> wurde hinzugefügt.</p>

<p>Es lässt einen jedoch darüber nachdenken, was passiert, wenn <code class="language-plaintext highlighter-rouge">fplus</code> 1000 Mal rekursiv aufgerufen wird. 1000 * 800 = 800000. Als ich n auf 800.000 setzte, trat erneut ein Rekursionstiefenfehler auf. Nach einigen weiteren Versuchen stellte ich fest, dass die Sache noch komplizierter ist. Nach dieser Optimierung ist die Berechnung von 2000 jedoch sehr einfach.</p>

<h2 id="datei-lese--und-schreibvorgänge">Datei-Lese- und Schreibvorgänge</h2>

<p>Es scheint, als hätten wir das Thema abgelenkt. Kehren wir zum Thema Webentwicklung zurück. Beim ersten Aufruf von <code class="language-plaintext highlighter-rouge">f(400)</code> und beim zweiten Aufruf von <code class="language-plaintext highlighter-rouge">f(600)</code> können wir die Werte des <code class="language-plaintext highlighter-rouge">v</code>-Arrays, die durch den ersten Aufruf erzeugt wurden, beim zweiten Aufruf verwenden. Wenn wir jedoch das Programm beenden und neu starten, können wir diese Werte nicht mehr verwenden. Nach unserer Methode ist die Berechnung der Fibonacci-Folge sehr schnell. Aber was wäre, wenn sie langsam wäre? Besonders wenn wir das <code class="language-plaintext highlighter-rouge">v</code>-Array nicht eingeführt hätten, gäbe es viele redundante Berechnungen. In diesem Fall möchten wir die mühsam erzielten Ergebnisse speichern.</p>

<p>Hier kommt das Konzept des <code class="language-plaintext highlighter-rouge">Caches</code> ins Spiel. Das Array <code class="language-plaintext highlighter-rouge">v</code> dient hier als Cache. Allerdings existiert es nur während der Laufzeit des Programms. Sobald das Programm beendet wird, verschwindet es. Was können wir also tun? Natürlich liegt der Gedanke nahe, die Daten in einer Datei zu speichern.</p>

<p>Wie kann man das v-Array in einer Datei speichern?</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0 0
1 1
2 1
3 2
4 3
...
</code></pre></div></div>

<p>Unser <code class="language-plaintext highlighter-rouge">v</code>-Array kann auf diese Weise gespeichert werden. Jede Zeile wird als <code class="language-plaintext highlighter-rouge">n f(n)</code> gespeichert. Da <code class="language-plaintext highlighter-rouge">n</code> natürlich wächst, könnten wir vielleicht nur die <code class="language-plaintext highlighter-rouge">f(n)</code>-Werte speichern.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
1
1
2
3
...
</code></pre></div></div>

<p>Probieren Sie es aus.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"demofile2.txt"</span><span class="p">,</span> <span class="s">"a"</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"Now the file has more content!"</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>(Anmerkung: Der Code wurde nicht übersetzt, da es sich um eine Programmiersprache handelt, die in der Regel nicht übersetzt wird. Der Text innerhalb der Anführungszeichen könnte übersetzt werden, aber da es sich um eine Zeichenkette handelt, die möglicherweise in einem spezifischen Kontext verwendet wird, wurde sie ebenfalls nicht übersetzt.)</p>

<h1 id="öffnen-und-lesen-der-datei-nach-dem-anhängen">Öffnen und Lesen der Datei nach dem Anhängen:</h1>
<p>f = open(“demofile2.txt”, “r”)
print(f.read())</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Der zweite Parameter von `open` kann `a` sein, was bedeutet, dass der Inhalt an das Ende der Datei angehängt wird, oder `w`, was bedeutet, dass der Inhalt der Datei überschrieben wird.

```python
file = open('fib_v', 'a')
file.write('hi')
file.close()
</code></pre></div></div>

<p>(Der Code bleibt auf Englisch, da es sich um eine Programmiersprache handelt und die Befehle nicht übersetzt werden sollten.)</p>

<p>Führen Sie es aus, und tatsächlich gibt es die Datei <code class="language-plaintext highlighter-rouge">fib_v</code>.</p>

<p><code class="language-plaintext highlighter-rouge">fib_v</code>:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hi
</code></pre></div></div>

<p>Wenn wir es erneut ausführen, sieht es so aus.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hihi
</code></pre></div></div>

<p>Wie kann man einen Zeilenumbruch einfügen?</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_v'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">)</span>
<span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'hi</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p><em>Hinweis: Der Code bleibt auf Englisch, da es sich um eine Programmiersprache handelt und die Befehle und Dateinamen in der Regel nicht übersetzt werden.</em></p>

<p>Dies wird einmal gedruckt, es erscheint <code class="language-plaintext highlighter-rouge">hihihi</code>, und man sieht keinen Zeilenumbruch. Wenn es jedoch erneut gedruckt wird, erfolgt ein Zeilenumbruch. Es ist ersichtlich, dass beim ersten Mal bereits ein Zeilenumbruch gedruckt wurde, nur am Ende, wo er nicht sichtbar ist.</p>

<p>Wie liest man es?</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_v'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python fib.py
hihihi
hi
</code></pre></div></div>

<p>Als Nächstes passen wir unser Fibonacci-Programm an.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>
   <span class="n">v</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>(Anmerkung: Der Code bleibt auf Englisch, da es sich um eine Programmiersprache handelt und die Syntax nicht übersetzt wird.)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
   <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_v'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
   <span class="n">s</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
   <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">lines</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
           <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</code></pre></div></div>

<p><strong>Übersetzung:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
   <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_v'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
   <span class="n">s</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
   <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">lines</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)):</span>
           <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</code></pre></div></div>

<p><strong>Hinweis:</strong> Der Code wurde nicht übersetzt, da es sich um eine Programmiersprache handelt, die in der Regel nicht übersetzt wird. Die Funktion <code class="language-plaintext highlighter-rouge">read()</code> öffnet eine Datei namens <code class="language-plaintext highlighter-rouge">fib_v</code>, liest deren Inhalt und speichert die Werte in einer Liste <code class="language-plaintext highlighter-rouge">v</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">save</span><span class="p">():</span>
   <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_v'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
   <span class="n">s</span> <span class="o">=</span> <span class="s">''</span>
   <span class="n">start</span> <span class="o">=</span> <span class="bp">True</span>
   <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">vv</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
         <span class="k">break</span>      
      <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
         <span class="n">s</span> <span class="o">+=</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span>
      <span class="n">start</span> <span class="o">=</span> <span class="bp">False</span>   
      <span class="n">s</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span>
   <span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
   <span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fcache</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="n">x</span> <span class="o">=</span> <span class="n">fplus</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="n">save</span><span class="p">()</span>
   <span class="k">return</span> <span class="n">x</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fplus</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">800</span><span class="p">:</span>         
      <span class="n">fplus</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">800</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">n</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</code></pre></div></div>

<p>read()
fcache(10)
save()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Endlich haben wir das Programm fertiggestellt. Nachdem das Programm ausgeführt wurde, sieht die Datei `fib_v` so aus.

`fib_v`:

```shell
0
1
1
2
3
5
8
13
21
34
55
</code></pre></div></div>

<p>Die obige Analyse scheint etwas umständlich zu sein. <code class="language-plaintext highlighter-rouge">\n</code> ist ein Zeilenumbruchzeichen. Gibt es eine einfachere und einheitlichere Methode zur Analyse? Die Menschen haben das Datenformat <code class="language-plaintext highlighter-rouge">JSON</code> erfunden.</p>

<h2 id="json">JSON</h2>

<p>Der vollständige Name von JSON ist <code class="language-plaintext highlighter-rouge">JavaScript Object Notation</code>. Hier ist ein Beispiel für <code class="language-plaintext highlighter-rouge">JSON</code>.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"John"</span><span class="p">,</span><span class="w"> </span><span class="nl">"age"</span><span class="p">:</span><span class="mi">31</span><span class="p">,</span><span class="w"> </span><span class="nl">"city"</span><span class="p">:</span><span class="s2">"New York"</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Auf diese Weise wird eine Abbildung dargestellt.</p>

<p>JSON hat die folgenden grundlegenden Elemente:</p>

<ol>
  <li>Zahlen oder Zeichenketten</li>
  <li>Listen</li>
  <li>Abbildungen (Mappings)</li>
</ol>

<p>Diese grundlegenden Elemente können auch beliebig verschachtelt werden. Das bedeutet, dass eine Liste eine andere Liste enthalten kann. Eine Map kann ebenfalls eine Liste enthalten. Und so weiter.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"John"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"age"</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span><span class="w">
  </span><span class="nl">"cars"</span><span class="p">:[</span><span class="w"> </span><span class="s2">"Ford"</span><span class="p">,</span><span class="w"> </span><span class="s2">"BMW"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Fiat"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>In einer Zeile geschrieben und so geschrieben, gibt es einen Unterschied in der Bedeutung. Vielleicht können wir uns ihre Berechnungsgraphen vorstellen. Leerzeichen beeinflussen ihre Berechnungsgraphen nicht.</p>

<p>Als nächstes müssen wir das v-Array in einen <code class="language-plaintext highlighter-rouge">json</code>-formatierten String umwandeln.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">json</span>
</code></pre></div></div>

<p>v = []
for x in range(1000000):
   v.append(-1)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fplus</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">800</span><span class="p">:</span>         
      <span class="n">fplus</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">800</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">n</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fplus</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
<span class="nb">file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>Wenn wir es so schreiben, erhalten wir einen Fehler: <code class="language-plaintext highlighter-rouge">TypeError: dump() missing 1 required positional argument: 'fp'</code>. In <code class="language-plaintext highlighter-rouge">vscode</code> können wir die Funktionsdefinition wie folgt anzeigen.</p>

<p><img src="assets/images/web/json.png" alt="json" /></p>

<p>Sie können einfach mit der Maus über <code class="language-plaintext highlighter-rouge">dump</code> fahren. Sehr praktisch, oder?</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fplus</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
<span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
<span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p><em>Hinweis: Der Code wurde nicht übersetzt, da es sich um eine Programmiersprache handelt, die in der Regel nicht übersetzt wird.</em></p>

<p>Die Berechnung bis 100 zeigt zu viele Zahlen an, daher wird dies hier auf 10 geändert. Der zweite Parameter der ursprünglichen <code class="language-plaintext highlighter-rouge">dump</code>-Funktion kann einfach ein <code class="language-plaintext highlighter-rouge">file</code>-Objekt übergeben werden.</p>

<p>So können Sie die Datei sehen:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="mi">34</span><span class="p">,</span><span class="w"> </span><span class="mi">55</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p>(Der JSON-Code bleibt unverändert, da es sich um eine Datenstruktur handelt, die nicht übersetzt wird.)</p>

<p>Beachten Sie, dass viele <code class="language-plaintext highlighter-rouge">-1</code> am Ende weggelassen wurden.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">sv</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sv</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">sv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">save</span><span class="p">():</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
    <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
    <span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>read()</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">vv</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span>
</code></pre></div></div>

<p>Wenn dies der Fall ist, ist sichtbar, dass Folgendes gedruckt wurde:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
1
1
2
3
5
8
13
21
34
55
</code></pre></div></div>

<p>Diese Funktionen sollten gemeinsam überprüft werden:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">sv</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sv</span><span class="p">)):</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">save</span><span class="p">():</span>
    <span class="n">sv</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">sv</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>        
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
    <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">sv</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
    <span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>Übersetzt ins Deutsche:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">save</span><span class="p">():</span>
    <span class="n">sv</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">sv</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>        
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'fib_j'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
    <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">sv</span><span class="p">,</span> <span class="nb">file</span><span class="p">)</span>
    <span class="nb">file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>Die Funktion <code class="language-plaintext highlighter-rouge">save()</code> bleibt in der Übersetzung unverändert, da Code in der Regel nicht übersetzt wird. Die Kommentare und Variablennamen bleiben ebenfalls auf Englisch, um die Konsistenz und Verständlichkeit des Codes zu gewährleisten.</p>

<p>read()
fplus(100)
save()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Dann habe ich die Datei überprüft, und tatsächlich waren die korrekten Werte gespeichert, und zwar sehr ordentlich.

```json
[0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584, 4181, 6765, 10946, 17711, 28657, 46368, 75025, 121393, 196418, 317811, 514229, 832040, 1346269, 2178309, 3524578, 5702887, 9227465, 14930352, 24157817, 39088169, 63245986, 102334155, 165580141, 267914296, 433494437, 701408733, 1134903170, 1836311903, 2971215073, 4807526976, 7778742049, 12586269025, 20365011074, 32951280099, 53316291173, 86267571272, 139583862445, 225851433717, 365435296162, 591286729879, 956722026041, 1548008755920, 2504730781961, 4052739537881, 6557470319842, 10610209857723, 17167680177565, 27777890035288, 44945570212853, 72723460248141, 117669030460994, 190392490709135, 308061521170129, 498454011879264, 806515533049393, 1304969544928657, 2111485077978050, 3416454622906707, 5527939700884757, 8944394323791464, 14472334024676221, 23416728348467685, 37889062373143906, 61305790721611591, 99194853094755497, 160500643816367088, 259695496911122585, 420196140727489673, 679891637638612258, 1100087778366101931, 1779979416004714189, 2880067194370816120, 4660046610375530309, 7540113804746346429, 12200160415121876738, 19740274219868223167, 31940434634990099905, 51680708854858323072, 83621143489848422977, 135301852344706746049, 218922995834555169026, 354224848179261915075]
</code></pre></div></div>

<h2 id="datenbank">Datenbank</h2>

<p>Wenn die Daten sehr groß und die Struktur sehr komplex ist, was dann? Die Speicherung in Dateien wird langsam und umständlich. Hier kommt die <code class="language-plaintext highlighter-rouge">Datenbank</code> ins Spiel. Sie ist im Grunde eine programmierbare <code class="language-plaintext highlighter-rouge">Excel</code>-Tabelle. Eine <code class="language-plaintext highlighter-rouge">Excel</code>-Tabelle, die es ermöglicht, Daten bequem über Code hinzuzufügen, zu löschen, zu ändern und abzufragen.</p>

<p>Im offiziellen Dokument auf der Website ein Beispiel gefunden.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="s">'example.db'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>
</code></pre></div></div>

<h1 id="tabelle-erstellen">Tabelle erstellen</h1>
<p>cur.execute(‘'’CREATE TABLE stocks
               (date text, trans text, symbol text, qty real, price real)’’’)</p>

<h1 id="eine-zeile-mit-daten-einfügen">Eine Zeile mit Daten einfügen</h1>
<p>cur.execute(“INSERT INTO stocks VALUES (‘2006-01-05’,’BUY’,’RHAT’,100,35.14)”)</p>

<h1 id="änderungen-speichern-commit">Änderungen speichern (commit)</h1>
<p>con.commit()</p>

<h1 id="wir-können-die-verbindung-auch-schließen-wenn-wir-damit-fertig-sind">Wir können die Verbindung auch schließen, wenn wir damit fertig sind.</h1>
<h1 id="stellen-sie-nur-sicher-dass-alle-änderungen-committet-wurden-da-sie-sonst-verloren-gehen">Stellen Sie nur sicher, dass alle Änderungen committet wurden, da sie sonst verloren gehen.</h1>
<p>con.close()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
```python
for row in cur.execute('SELECT * FROM stocks ORDER BY price'):
        print(row)
</code></pre></div></div>

<p>(Anmerkung: Der Code wurde nicht übersetzt, da es sich um eine Programmiersprache handelt und die Syntax unverändert bleiben sollte.)</p>

<p><code class="language-plaintext highlighter-rouge">cursor</code> 表示游标，就像光标一样。上面的代码展示了连接数据库、创建表、插入数据、提交更改以及关闭连接的过程。最后面的例子则是一个查询数据的示例。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sqlite3</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>
   <span class="n">v</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">:</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">Connection</span><span class="p">):</span>
    <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'CREATE TABLE vs(v text)'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="k">pass</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">save</span><span class="p">():</span>
    <span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="s">'fib.db'</span><span class="p">)</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vv</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'INSERT INTO vs VALUES('</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span> <span class="o">+</span> <span class="s">')'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">con</span><span class="p">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="n">con</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fplus</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">save</span><span class="p">()</span>
</code></pre></div></div>

<p>Geschafft. Probier es mal aus.</p>

<p>Auf meinem Computer ist bereits <code class="language-plaintext highlighter-rouge">sqlite3</code> installiert.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>sqlite3
SQLite Version 3.32.3 2020-06-18 14:16:19
Geben Sie <span class="s2">".help"</span> für Nutzungshinweise ein.
Verbunden mit einer temporären In-Memory-Datenbank.
Verwenden Sie <span class="s2">".open DATEINAME"</span>, um eine persistente Datenbank erneut zu öffnen.
</code></pre></div></div>

<pre><code class="language-sqlite">sqlite&gt; .help
.auth ON|OFF             Zeige Autorisierungsrückrufe
.backup ?DB? FILE        Sichere DB (Standard "main") in FILE
.bail on|off             Stoppe nach einem Fehler. Standard AUS
.binary on|off           Schalte binäre Ausgabe ein oder aus. Standard AUS
.cd DIRECTORY            Ändere das Arbeitsverzeichnis zu DIRECTORY
.changes on|off          Zeige die Anzahl der durch SQL geänderten Zeilen
.check GLOB              Fehlschlag, wenn die Ausgabe seit .testcase nicht übereinstimmt
.clone NEWDB             Klone Daten in NEWDB aus der bestehenden Datenbank
.databases               Liste Namen und Dateien der angehängten Datenbanken
.dbconfig ?op? ?val?     Liste oder ändere sqlite3_db_config() Optionen
.dbinfo ?DB?             Zeige Statusinformationen über die Datenbank
.dump ?TABLE?            Rendere den Datenbankinhalt als SQL
.echo on|off             Schalte Befehlecho ein oder aus
.eqp on|off|full|...     Aktiviere oder deaktiviere automatischen EXPLAIN QUERY PLAN
.excel                   Zeige die Ausgabe des nächsten Befehls in einer Tabellenkalkulation
.exit ?CODE?             Beende dieses Programm mit Rückgabecode CODE
.expert                  EXPERIMENTELL. Schlage Indizes für Abfragen vor
.explain ?on|off|auto?   Ändere den EXPLAIN Formatierungsmodus. Standard: auto
.filectrl CMD ...        Führe verschiedene sqlite3_file_control() Operationen aus
.fullschema ?--indent?   Zeige Schema und Inhalt der sqlite_stat Tabellen
.headers on|off          Schalte die Anzeige von Kopfzeilen ein oder aus
.help ?-all? ?PATTERN?   Zeige Hilfetext für PATTERN
.import FILE TABLE       Importiere Daten aus FILE in TABLE
.imposter INDEX TABLE    Erstelle Imposter-Tabelle TABLE auf Index INDEX
.indexes ?TABLE?         Zeige Namen der Indizes
.limit ?LIMIT? ?VAL?     Zeige oder ändere den Wert eines SQLITE_LIMIT
.lint OPTIONS            Berichte potenzielle Schema-Probleme.
.log FILE|off            Schalte Protokollierung ein oder aus. FILE kann stderr/stdout sein
.mode MODE ?TABLE?       Setze Ausgabemodus
.nullvalue STRING        Verwende STRING anstelle von NULL-Werten
.once ?OPTIONS? ?FILE?   Ausgabe für den nächsten SQL-Befehl nur in FILE
.open ?OPTIONS? ?FILE?   Schließe bestehende Datenbank und öffne FILE neu
.output ?FILE?           Sende Ausgabe an FILE oder stdout, wenn FILE weggelassen wird
.parameter CMD ...       Verwalte SQL-Parameterbindungen
.print STRING...         Drucke wörtliche STRING
.progress N              Rufe Fortschrittshandler nach jedem N Opcodes auf
.prompt MAIN CONTINUE    Ersetze die Standardaufforderungen
.quit                    Beende dieses Programm
.read FILE               Lies Eingaben aus FILE
.recover                 Stelle so viele Daten wie möglich aus einer beschädigten DB wieder her
.restore ?DB? FILE       Stelle den Inhalt von DB (Standard "main") aus FILE wieder her
.save FILE               Schreibe die In-Memory-Datenbank in FILE
.scanstats on|off        Schalte sqlite3_stmt_scanstatus() Metriken ein oder aus
.schema ?PATTERN?        Zeige die CREATE-Anweisungen, die PATTERN entsprechen
.selftest ?OPTIONS?      Führe Tests aus, die in der SELFTEST-Tabelle definiert sind
.separator COL ?ROW?     Ändere die Spalten- und Zeilentrenner
.session ?NAME? CMD ...  Erstelle oder kontrolliere Sitzungen
.sha3sum ...             Berechne einen SHA3-Hash des Datenbankinhalts
.shell CMD ARGS...       Führe CMD ARGS... in einer System-Shell aus
.show                    Zeige die aktuellen Werte für verschiedene Einstellungen
.stats ?on|off?          Zeige Statistiken oder schalte Statistiken ein oder aus
.system CMD ARGS...      Führe CMD ARGS... in einer System-Shell aus
.tables ?TABLE?          Liste Namen der Tabellen, die dem LIKE-Muster TABLE entsprechen
.testcase NAME           Beginne die Ausgabe in 'testcase-out.txt' umzuleiten
.testctrl CMD ...        Führe verschiedene sqlite3_test_control() Operationen aus
.timeout MS              Versuche, gesperrte Tabellen für MS Millisekunden zu öffnen
.timer on|off            Schalte SQL-Timer ein oder aus
.trace ?OPTIONS?         Gib jede SQL-Anweisung aus, während sie ausgeführt wird
.vfsinfo ?AUX?           Informationen über das oberste VFS
.vfslist                 Liste alle verfügbaren VFSes
.vfsname ?AUX?           Drucke den Namen des VFS-Stacks
.width NUM1 NUM2 ...     Setze Spaltenbreiten für den "column"-Modus
</code></pre>

<p>Sie können viele Befehle sehen. Darunter bedeutet <code class="language-plaintext highlighter-rouge">.quit</code> das Beenden.</p>

<p>Falls Sie es noch nicht haben, können Sie es auf der offiziellen Website herunterladen oder den Befehl <code class="language-plaintext highlighter-rouge">brew install sqlite</code> ausführen, um es zu installieren.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>sqlite3 fib.db
</code></pre></div></div>

<pre><code class="language-sqlite">sqlite&gt; show tables
   ...&gt; ;
Fehler: in der Nähe von "show": Syntaxfehler
sqlite&gt; tables;
Fehler: in der Nähe von "tables": Syntaxfehler
sqlite&gt; .schema
CREATE TABLE vs(v text);
</code></pre>

<p>Zuerst dachte ich, es wäre wie bei <code class="language-plaintext highlighter-rouge">MySQL</code>. Man könnte <code class="language-plaintext highlighter-rouge">show tables</code> verwenden, um zu sehen, welche Tabellen vorhanden sind. Später stellte ich fest, dass es bei <code class="language-plaintext highlighter-rouge">SQLite</code> anders ist. <code class="language-plaintext highlighter-rouge">MySQL</code> ist eine andere Art von Datenbank, die wir in Zukunft noch lernen werden.</p>

<pre><code class="language-sqlite">sqlite&gt; select * from vs;
0
1
1
2
3
5
8
13
21
34
55
</code></pre>

<p>Tatsächlich haben wir die Daten korrekt geschrieben. Beachten Sie, dass wir <code class="language-plaintext highlighter-rouge">text</code> verwendet haben, da unsere Zahlen sehr groß sind und möglicherweise nicht vom Integer-Typ der Datenbank gespeichert werden können.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sqlite3</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>
   <span class="n">v</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fplus</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">800</span><span class="p">:</span>         
      <span class="n">fplus</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">800</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">n</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
      <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
      <span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">:</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">Connection</span><span class="p">):</span>
    <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'CREATE TABLE vs(v text)'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="s">'fib.db'</span><span class="p">)</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>    
    <span class="n">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'SELECT * from vs'</span><span class="p">):</span>
         <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="n">con</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p><strong>Übersetzung:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="s">'fib.db'</span><span class="p">)</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>    
    <span class="n">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'SELECT * from vs'</span><span class="p">):</span>
         <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="n">con</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p><strong>Hinweis:</strong> Der Code wurde nicht übersetzt, da es sich um Programmcode handelt, der in der Regel in der Originalsprache belassen wird, um die Funktionalität und Lesbarkeit zu gewährleisten.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">save</span><span class="p">():</span>
    <span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="s">'fib.db'</span><span class="p">)</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">vv</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vv</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'INSERT INTO vs VALUES('</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span> <span class="o">+</span> <span class="s">')'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">con</span><span class="p">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="n">con</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">read</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</code></pre></div></div>

<p>Wir fügen weiterhin die <code class="language-plaintext highlighter-rouge">read</code>-Funktion hinzu. Nach dem Ausführen tritt jedoch ein Fehler auf.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">python</span> <span class="n">fib_db</span><span class="p">.</span><span class="n">py</span>
  <span class="p">...</span>
  <span class="n">Datei</span> <span class="s">"fib_db.py"</span><span class="p">,</span> <span class="n">Zeile</span> <span class="mi">27</span><span class="p">,</span> <span class="ow">in</span> <span class="n">create_table</span>
    <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'CREATE TABLE vs(v text)'</span><span class="p">)</span>
<span class="n">sqlite3</span><span class="p">.</span><span class="n">OperationalError</span><span class="p">:</span> <span class="n">Tabelle</span> <span class="n">vs</span> <span class="n">existiert</span> <span class="n">bereits</span>
</code></pre></div></div>

<p>Wir können die Tabelle nicht mehr erstellen, da sie bereits existiert. Ändern wir die Syntax ein wenig.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">:</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">Connection</span><span class="p">):</span>
    <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'CREATE TABLE IF NOT EXISTS vs(v text)'</span><span class="p">)</span>
</code></pre></div></div>

<p>Es ist jedoch ein Fehler aufgetreten.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    v[i] <span class="o">=</span> int<span class="o">(</span>row<span class="o">)</span>
TypeError: int<span class="o">()</span> Argument muss ein String, ein bytes-ähnliches Objekt oder eine Zahl sein, kein <span class="s1">'tuple'</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">tuple</code> 是什么. Es bedeutet, dass <code class="language-plaintext highlighter-rouge">row</code> ein <code class="language-plaintext highlighter-rouge">tuple</code> zurückgibt. Lass es uns ausdrucken.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'SELECT * from vs'</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</code></pre></div></div>

<p><em>Hinweis: Der Code wurde nicht übersetzt, da es sich um eine Programmiersprache handelt, die in der Regel nicht übersetzt wird.</em></p>

<p>Das Ergebnis lautet:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span><span class="s1">'0'</span>,<span class="o">)</span>
</code></pre></div></div>

<p>Tatsächlich ist ein <code class="language-plaintext highlighter-rouge">tuple</code> einem Array ziemlich ähnlich. Der Unterschied besteht darin, dass seine Elemente unterschiedlich sein können, im Gegensatz zu einem Array, dessen Elemente alle vom gleichen Typ sein müssen.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
    <span class="n">con</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span><span class="s">'fib.db'</span><span class="p">)</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">con</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>    
    <span class="n">create_table</span><span class="p">(</span><span class="n">cur</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'SELECT * from vs'</span><span class="p">):</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">con</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>So ändern Sie es. Es ist jedoch seltsam. Die Ausgabe sieht so aus:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>55
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
<span class="nt">-1</span>
</code></pre></div></div>

<p>Es stellte sich heraus, dass unser <code class="language-plaintext highlighter-rouge">i</code> nicht inkrementiert wurde.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">'SELECT * from vs'</span><span class="p">):</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></div>

<p><em>Hinweis: Der Code wurde nicht übersetzt, da es sich um eine Programmiersprache handelt, die in der Regel nicht übersetzt wird.</em></p>

<p>Das ist richtig.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
1
1
2
3
5
8
13
21
34
</code></pre></div></div>

<p>Wir haben jedoch bemerkt, dass, wenn die Zahlen sehr groß sind, sie in der Datenbank so gespeichert werden:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4660046610375530309
7540113804746346429
1.22001604151219e+19
1.97402742198682e+19
3.19404346349901e+19
</code></pre></div></div>

<p>Noch einmal ausführen, und es sieht so aus.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python fib_db.py
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"fib_db.py"</span>, line 35, <span class="k">in </span><span class="nb">read
    </span>v[i] <span class="o">=</span> int<span class="o">(</span>row[0]<span class="o">)</span>
ValueError: invalid literal <span class="k">for </span>int<span class="o">()</span> with base 10: <span class="s1">'1.22001604151219e+19'</span>
</code></pre></div></div>

<p>Ändere es:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cur</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="s">"INSERT INTO vs VALUES('"</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span> <span class="o">+</span> <span class="s">"')"</span><span class="p">)</span>
</code></pre></div></div>

<p>(Der Code bleibt unverändert, da es sich um eine Programmiersprache handelt und keine Übersetzung erforderlich ist.)</p>

<p>Beachte, dass wir hier die einfachen Anführungszeichen um die <code class="language-plaintext highlighter-rouge">INSERT</code>-Anweisung durch doppelte Anführungszeichen ersetzt haben und gleichzeitig unsere numerischen Zeichenfolgen in Anführungszeichen gesetzt haben. Wenn wir dies zuvor so geschrieben hätten, hätte die Datenbank unsere Zeichenfolgen als Zahlen interpretiert. Jetzt, da sie in Anführungszeichen gesetzt sind, werden sie als Zeichenfolgen behandelt.</p>

<p>Dann ist es korrekt. Aber wie kann man die vorherigen fehlerhaften Daten löschen?</p>

<pre><code class="language-sqlite">$ sqlite3 fib.db
SQLite Version 3.32.3 2020-06-18 14:16:19
Geben Sie ".help" für Nutzungshinweise ein.
sqlite&gt; delete * from vs;
</code></pre>

<p>Als Nächstes können Sie andere Anweisungen ausprobieren. <code class="language-plaintext highlighter-rouge">增删改查</code> (Einfügen, Löschen, Aktualisieren, Abfragen). Hier haben wir Beispiele für <code class="language-plaintext highlighter-rouge">增删查</code> (Einfügen, Löschen, Abfragen) gegeben.</p>

<h2 id="übung">Übung</h2>

<ul>
  <li>Die Schüler erkunden ähnlich wie oben.</li>
</ul>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-de" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
