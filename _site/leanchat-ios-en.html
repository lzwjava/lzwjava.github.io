<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>LeanChat iOS</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>LeanChat iOS | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="LeanChat iOS" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="en" />
<meta name="description" content="This is the README.md from github project https://github.com/lzwjava/leanchat-ios." />
<meta property="og:description" content="This is the README.md from github project https://github.com/lzwjava/leanchat-ios." />
<link rel="canonical" href="https://lzwjava.github.io/leanchat-ios-en" />
<meta property="og:url" content="https://lzwjava.github.io/leanchat-ios-en" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-11-20T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="LeanChat iOS" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2014-11-20T00:00:00+08:00","datePublished":"2014-11-20T00:00:00+08:00","description":"This is the README.md from github project https://github.com/lzwjava/leanchat-ios.","headline":"LeanChat iOS","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/leanchat-ios-en"},"url":"https://lzwjava.github.io/leanchat-ios-en"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=8d72cd9dd05a5be70a4c8f531699185b14bb21db">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=8d72cd9dd05a5be70a4c8f531699185b14bb21db" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       LeanChat iOS | Original
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/en/2014-11-20-leanchat-ios-en.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsen2014-11-20-leanchat-ios-en.md</span> -->
      

      <!-- <span>2014-11-20-leanchat-ios-en.md</span> -->

      
        

        
          
          <a href="#" class="button">2014.11</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/leanchat-ios-en" selected>English</option>
        <option value="/leanchat-ios-zh" >中文</option>
        <option value="/leanchat-ios-ja" >日本語</option>
        <option value="/leanchat-ios-es" >Español</option>
        <option value="/leanchat-ios-hi" >हिंदी</option>
        <option value="/leanchat-ios-fr" >Français</option>
        <option value="/leanchat-ios-de" >Deutsch</option>
        <option value="/leanchat-ios-ar" >العربية</option>
        <option value="/leanchat-ios-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <p>This is the README.md from github project <a href="https://github.com/lzwjava/leanchat-ios">https://github.com/lzwjava/leanchat-ios</a>.</p>

<hr />

<p><img src="https://img.shields.io/badge/license-MIT-green.svg?style=flat" alt="License MIT" /> 
<a href="http://cocoapods.org/?q=LeanChatLib"><img src="http://img.shields.io/cocoapods/v/LeanChatLib.svg?style=flat" alt="CocoaPods" /></a> 
<a href="http://cocoapods.org/?q=LeanChatLib"><img src="http://img.shields.io/cocoapods/p/LeanChatLib.svg?style=flat" alt="CocoaPods" /></a> 
<a href="https://www.apple.com/nl/ios/"><img src="https://img.shields.io/badge/support-iOS%207%2B%20-blue.svg?style=flat" alt="Support" /></a></p>

<p><img src="https://cloud.githubusercontent.com/assets/5022872/8431636/4eff0aca-1f6d-11e5-8728-f8f450dac380.gif" alt="leanchat" /></p>

<h2 id="app-store">App Store</h2>
<p>LeanChat is available on the App Store. You can visit https://itunes.apple.com/gb/app/leanchat/id943324553 or search for LeanChat on the App Store.</p>

<h2 id="introduction">Introduction</h2>
<p>This example project comprehensively demonstrates the application of LeanCloud’s real-time communication feature. However, it contains a lot of UI code and other functionalities, making it not suitable for quick learning. If you are new to LeanMessage, we recommend the <a href="https://github.com/leancloud/LeanMessage-Demo">LeanMessage-Demo</a> project. Once you are familiar, you can go to <a href="https://github.com/leancloud/leancloud-demos">LeanCloud-Demos</a> to select your favorite IM skin for integration. During integration, if you encounter difficult problems, you can refer back to the LeanChat project.</p>

<h2 id="leanchat-project-structure">LeanChat Project Structure</h2>

<ul>
  <li><a href="https://github.com/leancloud/leanchat-android">leanchat-android</a>: Android client</li>
  <li><a href="https://github.com/leancloud/leanchat-ios">leanchat-ios</a>: iOS client</li>
  <li><a href="https://github.com/leancloud/leanchat-webapp">leanchat-webapp</a>: Web client</li>
  <li><a href="https://github.com/leancloud/leanchat-cloudcode">leanchat-cloud-code</a>: Server-side</li>
</ul>

<h2 id="valuable-feedback">Valuable Feedback</h2>

<p>If you have any questions, feel free to raise an <a href="https://github.com/leancloud/leanchat-ios/issues">issue</a>, stating what you don’t understand, and we’ll provide assistance as soon as possible.</p>

<h2 id="download">Download</h2>
<p>Please directly click on <code class="language-plaintext highlighter-rouge">Download Zip</code> on Github as shown in the image below to download the latest version only. If you use <code class="language-plaintext highlighter-rouge">git clone</code>, it might be very slow because it includes a large commit history. In a test, the difference was 1.5M:40M.</p>

<p><img src="https://cloud.githubusercontent.com/assets/5022872/8223520/4c25415a-15ab-11e5-912d-b5dab916ce86.png" alt="qq20150618-2 2x" /></p>

<h2 id="running">Running</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  // LeanChat <span class="o">(</span>Complex Example<span class="o">)</span>
  <span class="nb">cd </span>LeanChat
  pod <span class="nb">install</span> <span class="nt">--verbose</span>  // If you have AVOSCloud dependency library locally, you can add the <span class="nt">--no-repo-update</span> option to speed up the process
  open LeanChat.workspace
  
  // LeanChatExample <span class="o">(</span>Simple Example<span class="o">)</span>
  <span class="nb">cd </span>LeanChatExample
  pod <span class="nb">install</span> <span class="nt">--verbose</span> <span class="nt">--no-repo-update</span>
  open LeanChatExample.xcworkspace

  // LeanChatSwift <span class="o">(</span>Swift Example<span class="o">)</span>
  <span class="nb">cd </span>LeanChatSwift
  pod <span class="nb">install</span> <span class="nt">--verbose</span> <span class="nt">--no-repo-update</span>
  open LeanChatSwift.xcworkspace
  
  // LeanChatLib <span class="o">(</span>Library encapsulating LeanCloud communication components and UI<span class="o">)</span>
  <span class="nb">cd </span>LeanChatLib
  pod <span class="nb">install</span> <span class="nt">--verbose</span> <span class="nt">--no-repo-update</span>
  open LeanChatLib.xcworkspace
</code></pre></div></div>

<p>If you encounter issues like <code class="language-plaintext highlighter-rouge">definition of 'AVUser' must be imported from module 'LeanChatLib.CDChatListVC' before it is required</code>, you can hold Option in the Product menu and click on <a href="http://stackoverflow.com/questions/8087065/xcode-4-clean-vs-clean-build-folder">Clean Build Folder</a> to clear all Build files, then recompile. This issue seems to be a bug when Cocoapods is performing complex compilation. You can see this <a href="https://cloud.githubusercontent.com/assets/5022872/9230256/cf822fe4-4153-11e5-876d-ed819babad89.gif">Gif</a> for more details.</p>

<p>Please note that because the default uses production certificates, there are no push notifications for offline messages during development. However, push notifications are available in the online version, which can be downloaded from the <a href="https://itunes.apple.com/gb/app/leanchat/id943324553">App Store</a>. For more details, you can also refer to this <a href="https://github.com/leancloud/leanchat-ios/issues/40">issue</a>.</p>

<p>Here you can see three projects, as described below.</p>

<h2 id="subproject-introduction">Subproject Introduction</h2>
<ul>
  <li>LeanChatLib: The core logic and UI library for chatting. With it, you can quickly integrate chat functionality, supporting text, audio, image, and emoji messages, as well as message notifications. There is also a corresponding <a href="https://github.com/leancloud/leanchat-android">Android version</a>.</li>
  <li>LeanChatExample: The simplest usage example of LeanChatLib. It shows how to use a minimal amount of code to call LeanChatLib to join a chat, regardless of whether you use LeanCloud’s user system or your own user system.</li>
  <li>LeanChat-ios: The entire LeanChat application. It includes features such as friend management, group management, location-based messaging, nearby users, personal pages, login, and registration, all based on LeanCloud’s storage and communication capabilities. It is a more complex application of LeanChatLib.</li>
</ul>

<h2 id="leanchatlib-introduction">LeanChatLib Introduction</h2>

<p>It encapsulates the recent conversation page and chat page. Both LeanChat and LeanChatExample projects depend on it. You can install it as follows,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    pod 'LeanChatLib'
</code></pre></div></div>

<p>Most of the time, you will integrate LeanChatLib by dragging the source code into your project. In this case, you need to install <code class="language-plaintext highlighter-rouge">AVOSCloud.framework</code> and <code class="language-plaintext highlighter-rouge">AVOSCloudIM.framework</code> first. If you didn’t use <code class="language-plaintext highlighter-rouge">pod install 'AVOSCloud'</code>, <code class="language-plaintext highlighter-rouge">pod install 'AVOSCloudIM'</code> to install, you can configure the required Frameworks according to the LeanCloud <a href="https://leancloud.cn/docs/start.html">Quick Start Guide</a>. Also, install two other dependent libraries <code class="language-plaintext highlighter-rouge">JSBadgeView</code> and <code class="language-plaintext highlighter-rouge">DateTools</code>. When running <code class="language-plaintext highlighter-rouge">pod install</code> for this Demo, a Pods directory will be generated, from which you can find these two Pods. Alternatively, you can search online. You can also configure it through the <a href="https://github.com/leancloud/leanchat-ios/blob/master/LeanChatLib.podspec#L9">.podspec file</a>, which describes which source files need to be integrated and which system frameworks need to be introduced, etc. Or, please refer to this <a href="https://ticket.leancloud.cn/tickets/7666">ticket</a>.</p>

<h2 id="how-to-add-im-in-three-steps">How to Add IM in Three Steps</h2>
<ol>
  <li>Create an application in LeanCloud.</li>
  <li>Add the LeanChatLib pod dependency, or drag the LeanChatLib code files into your project for easier UI customization and feature adjustment.</li>
  <li>Add the following code in</li>
</ol>

<p>appropriate places,</p>

<p>Upon application launch, initialize and configure IM User,</p>
<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">[</span><span class="n">AVOSCloud</span> <span class="nf">setApplicationId</span><span class="p">:</span><span class="s">@"YourAppId"</span> <span class="nf">clientKey</span><span class="p">:</span><span class="s">@"YourAppKey"</span><span class="p">];</span>
    <span class="p">[</span><span class="n">CDChatManager</span> <span class="nf">manager</span><span class="p">].</span><span class="n">userDelegate</span> <span class="o">=</span> <span class="p">[[</span><span class="n">CDUserFactory</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
</code></pre></div></div>

<p>Configure a UserFactory, which conforms to the CDUserDelegate protocol.</p>

<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#import "CDUserFactory.h"
</span>
<span class="cp">#import &lt;LeanChatLib/LeanChatLib.h&gt;
</span>
<span class="k">@interface</span> <span class="nc">CDUserFactory</span> <span class="p">()</span><span class="o">&lt;</span><span class="n">CDUserDelegate</span><span class="o">&gt;</span>

<span class="k">@end</span>


<span class="k">@implementation</span> <span class="nc">CDUserFactory</span>

<span class="cp">#pragma mark - CDUserDelegate
</span><span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cacheUserByIds</span><span class="p">:(</span><span class="n">NSSet</span> <span class="o">*</span><span class="p">)</span><span class="nv">userIds</span> <span class="nf">block</span><span class="p">:(</span><span class="n">AVIMArrayResultBlock</span><span class="p">)</span><span class="nv">block</span><span class="p">{</span>
    <span class="n">block</span><span class="p">(</span><span class="nb">nil</span><span class="p">,</span><span class="nb">nil</span><span class="p">);</span> <span class="c1">// don't forget it</span>
<span class="p">}</span>

<span class="k">-</span><span class="p">(</span><span class="n">id</span><span class="o">&lt;</span><span class="n">CDUserModel</span><span class="o">&gt;</span><span class="p">)</span><span class="nf">getUserById</span><span class="p">:(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">userId</span><span class="p">{</span>
    <span class="n">CDUser</span><span class="o">*</span> <span class="n">user</span><span class="o">=</span><span class="p">[[</span><span class="n">CDUser</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
    <span class="n">user</span><span class="p">.</span><span class="n">userId</span><span class="o">=</span><span class="n">userId</span><span class="p">;</span>
    <span class="n">user</span><span class="p">.</span><span class="n">username</span><span class="o">=</span><span class="n">userId</span><span class="p">;</span>
    <span class="n">user</span><span class="p">.</span><span class="n">avatarUrl</span><span class="o">=</span><span class="s">@"http://ac-x3o016bx.clouddn.com/86O7RAPx2BtTW5zgZTPGNwH9RZD5vNDtPm1YbIcu"</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">user</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">@end</span>

</code></pre></div></div>

<p>Here, CDUser is the User object within the application, and you can implement the CDUserModel protocol in your User object.</p>

<p>CDUserModel,</p>
<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">@protocol</span> <span class="nc">CDUserModel</span> <span class="o">&lt;</span><span class="n">NSObject</span><span class="o">&gt;</span>

<span class="err">@required</span>

<span class="k">-</span><span class="p">(</span><span class="n">NSString</span><span class="o">*</span><span class="p">)</span><span class="n">userId</span><span class="p">;</span>

<span class="k">-</span><span class="p">(</span><span class="n">NSString</span><span class="o">*</span><span class="p">)</span><span class="n">avatarUrl</span><span class="p">;</span>

<span class="k">-</span><span class="p">(</span><span class="n">NSString</span><span class="o">*</span><span class="p">)</span><span class="n">username</span><span class="p">;</span>

<span class="k">@end</span>
</code></pre></div></div>

<p>Call when logging in,</p>
<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="p">[[</span><span class="n">CDChatManager</span> <span class="nf">manager</span><span class="p">]</span> <span class="nf">openWithClientId</span><span class="p">:</span><span class="n">selfId</span> <span class="nf">callback</span><span class="p">:</span> <span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">DLog</span><span class="p">(</span><span class="s">@"%@"</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
               <span class="c1">//go Main Controller</span>
            <span class="p">}</span>
        <span class="p">}];</span>
</code></pre></div></div>

<p>To chat with someone,</p>
<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="p">[[</span><span class="n">CDChatManager</span> <span class="nf">manager</span><span class="p">]</span> <span class="nf">fetchConvWithOtherId</span> <span class="p">:</span> <span class="n">otherId</span> <span class="nf">callback</span> <span class="p">:</span> <span class="o">^</span><span class="p">(</span><span class="n">AVIMConversation</span> <span class="o">*</span><span class="n">conversation</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">DLog</span><span class="p">(</span><span class="s">@"%@"</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="n">LCEChatRoomVC</span> <span class="o">*</span><span class="n">chatRoomVC</span> <span class="o">=</span> <span class="p">[[</span><span class="n">LCEChatRoomVC</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithConv</span><span class="p">:</span><span class="n">conversation</span><span class="p">];</span>
                <span class="p">[</span><span class="n">weakSelf</span><span class="p">.</span><span class="n">navigationController</span> <span class="nf">pushViewController</span><span class="p">:</span><span class="n">chatRoomVC</span> <span class="nf">animated</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}];</span>
</code></pre></div></div>

<p>To group chat,</p>
<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="n">NSMutableArray</span> <span class="o">*</span><span class="n">memberIds</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSMutableArray</span> <span class="nf">array</span><span class="p">];</span>
        <span class="p">[</span><span class="n">memberIds</span> <span class="nf">addObject</span><span class="p">:</span><span class="n">groupId1</span><span class="p">];</span>
        <span class="p">[</span><span class="n">memberIds</span> <span class="nf">addObject</span><span class="p">:</span><span class="n">groupId2</span><span class="p">];</span>
        <span class="p">[</span><span class="n">memberIds</span> <span class="nf">addObject</span><span class="p">:[</span><span class="n">CDChatManager</span> <span class="nf">manager</span><span class="p">].</span><span class="n">selfId</span><span class="p">];</span>
        <span class="p">[[</span><span class="n">CDChatManager</span> <span class="nf">manager</span><span class="p">]</span> <span class="nf">fetchConvWithMembers</span><span class="p">:</span><span class="n">memberIds</span> <span class="nf">callback</span><span class="p">:</span> <span class="o">^</span><span class="p">(</span><span class="n">AVIMConversation</span> <span class="o">*</span><span class="n">conversation</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">DLog</span><span class="p">(</span><span class="s">@"%@"</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="n">LCEChatRoomVC</span> <span class="o">*</span><span class="n">chatRoomVC</span> <span class="o">=</span> <span class="p">[[</span><span class="n">LCEChatRoomVC</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">initWithConv</span><span class="p">:</span><span class="n">conversation</span><span class="p">];</span>
                <span class="p">[</span><span class="n">weakSelf</span><span class="p">.</span><span class="n">navigationController</span> <span class="nf">pushViewController</span><span class="p">:</span><span class="n">chatRoomVC</span> <span class="nf">animated</span><span class="p">:</span><span class="nb">YES</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}];</span>
</code></pre></div></div>

<p>When logging out,</p>
<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="p">[[</span><span class="n">CDChatManager</span> <span class="nf">manager</span><span class="p">]</span> <span class="nf">closeWithCallback</span><span class="p">:</span> <span class="o">^</span><span class="p">(</span><span class="n">BOOL</span> <span class="n">succeeded</span><span class="p">,</span> <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        
    <span class="p">}];</span>
</code></pre></div></div>

<p>Then, you can chat as shown in the screenshot above. Note that we currently do not recommend using the pod method to import LeanChatLib directly because some interfaces and functionalities need to be customized by you. Therefore, we recommend copying the LeanChatLib code into the project for easier customization.</p>

<h2 id="leanchatlib-changelog">LeanChatLib ChangeLog</h2>

<p>0.2.6</p>

<p>Upgrade SDK to 3.1.4 to adapt to iOS 9</p>

<p>0.2.5</p>

<p>Use cachePolicy in AVIMConversationQuery to save traffic and better support offline
Fixed a bug where calling fetchConvWithConvid when the conversation does not exist may cause a crash</p>

<p>0.2.4</p>

<p>Added Tuzki emoji</p>

<p>0.2.3</p>

<p>Added parameter checking for the fetchConvWithMembers: interface, fixed a potential crash in the conversation list when it is a single chat but only has one member</p>

<p>0.2.2</p>

<p>Upgrade AVOSCloud library to 3.1.2.8</p>

<p>0.2.1</p>

<p>ChatListDelegate adds configureCell: and prepareConversaion: interfaces for more complex conversation customization.</p>

<p>For image messages, use AVFile for caching images, so that your own sent photos do not need to be re-downloaded.</p>

<p>0.2.0</p>

<p>Add comments, support message resend, display failed messages, add sound effects, and vibration</p>

<p>0.1.3</p>

<p>Fixed a bug where the app might crash when loading historical messages quickly by pulling down</p>

<p>0.1.2</p>

<p>Using SDK’s chat cache, removed FMDB dependency. You can see historical messages on the server and historical chat records even after reinstallation. Removed the CDNotify class.</p>

<p>0.1.1</p>

<p>Refactoring</p>

<p>0.1.0</p>

<p>Initial release</p>

<h2 id="deployment-notes-for-leanchat">Deployment Notes for LeanChat</h2>

<p>If you want to deploy the complete LeanChat, since the application has a friend adding feature, please go to Settings-&gt;Application Options and check the Mutual Follow option so that when one party agrees, they can add each other as friends.</p>

<p><img src="https://cloud.githubusercontent.com/assets/5022872/7016645/53f91bb8-dd1b-11e4-8ce0-72312c655094.png" alt="qq20150407-5" /></p>

<h2 id="development-guide">Development Guide</h2>

<p><a href="https://leancloud.cn/docs/realtime_v2.html">Realtime Messaging Service Development Guide</a></p>

<p><a href="https://github.com/leancloud/leanchat-android">More Information</a></p>

<h2 id="acknowledgments">Acknowledgments</h2>

<p>Thanks to the great <a href="https://github.com/xhzengAIB/MessageDisplayKit">MessageDisplayKit</a> open-source library by Xian-Hua Han.</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-en" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
