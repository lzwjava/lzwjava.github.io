<!DOCTYPE html>
<html lang=" en-US">

<head>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">

  <link rel="alternate" type="application/rss+xml" title="RSS Feed for Zhiwei Li"
    href="https://lzwjava.github.io/feeds/feed.xml" />

  <title>mathjax2mobi : Convertir des fichiers HTML avec MathJax en livres électroniques</title>

  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' 
          data-cf-beacon='{"token": "70fc8c466cc1445098b3fc6f209c22c2"}'>
  </script>

  <!-- 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66656236-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-66656236-1');
  </script>
   -->
  <meta charset="UTF-8">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>mathjax2mobi : Convertir des fichiers HTML avec MathJax en livres électroniques | Zhiwei Li</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="mathjax2mobi : Convertir des fichiers HTML avec MathJax en livres électroniques" />
<meta name="author" content="Zhiwei Li" />
<meta property="og:locale" content="fr" />
<meta name="description" content="Présentation du projet" />
<meta property="og:description" content="Présentation du projet" />
<link rel="canonical" href="https://lzwjava.github.io/feynman-fr" />
<meta property="og:url" content="https://lzwjava.github.io/feynman-fr" />
<meta property="og:site_name" content="Zhiwei Li" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-15T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="mathjax2mobi : Convertir des fichiers HTML avec MathJax en livres électroniques" />
<meta name="twitter:site" content="@lzwjava" />
<meta name="twitter:creator" content="@lzwjava" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zhiwei Li"},"dateModified":"2021-03-15T00:00:00+08:00","datePublished":"2021-03-15T00:00:00+08:00","description":"Présentation du projet","headline":"mathjax2mobi : Convertir des fichiers HTML avec MathJax en livres électroniques","mainEntityOfPage":{"@type":"WebPage","@id":"https://lzwjava.github.io/feynman-fr"},"url":"https://lzwjava.github.io/feynman-fr"}</script>
<!-- End Jekyll SEO tag -->


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- Facebook Meta Tags -->
  <!-- <meta property="og:url" content="https://lzwjava.github.io"> -->
  <meta property="og:type" content="website">
  <!-- <meta property="og:title" content="Zhiwei Li's Blog">
  <meta property="og:description" content="A personal blog featuring programming insights and projects."> -->
  
  
  
  
  
  
  
  
  <meta property="og:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@lzwjava">
  <meta property="twitter:domain" content="lzwjava.github.io">
  <!-- <meta property="twitter:url" content="https://lzwjava.github.io"> -->
  <!-- <meta name="twitter:title" content="Zhiwei Li's Blog">
  <meta name="twitter:description" content="A personal blog featuring programming insights and projects."> -->
  <meta name="twitter:image" content="https://lzwjava.github.io/assets/images/og/og4.jpg">


  <link rel="stylesheet" href="/assets/css/style.css?v=a875484e59fe737dc8e492a99512502e6511b468">

  <!-- for mathjax support -->
  <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['\\(','\\)'], ['$', '$']],
            displayMath: [ ['$$','$$'], ['\\[','\\]']],
            processEscapes: false
          },
          "HTML-CSS": { linebreaks: { automatic: true } },
          "CommonHTML": {
            linebreaks: { automatic: true }
          },
          TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
      </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <!-- <script src="/assets/js/donatePopup.js?v=a875484e59fe737dc8e492a99512502e6511b468" defer></script> -->
</head>

<body>
  <main id="content" class="main-content post-content" role="main">
  

  

  


  <div class="title-row post-title-row">
    <h2 class="title post-title">
       mathjax2mobi : Convertir des fichiers HTML avec MathJax en livres électroniques | Original, traduit par l'IA
    </h2>
  </div>

  <div class="button-container">
    <a href="/" class="button left-button">Home</a>

    <!-- PDF Button -->
     
    <!-- <a href="#" id="downloadPdfButton" class="button pdf-button" data-file-path="_posts/fr/2021-03-15-feynman-fr.md">PDF</a> -->

    <!-- Audio Button -->



    <!--  -->

        <!-- Date Button -->
    
      
      <!-- <span>_postsfr2021-03-15-feynman-fr.md</span> -->
      

      <!-- <span>2021-03-15-feynman-fr.md</span> -->

      
        

        
          
          <a href="#" class="button">2021.03</a>
        

      
    

    <button id="themeTogglePost" class="button icon-button" aria-label="Toggle Theme" style="float: right;margin-bottom: 5px;">
      <!-- theme-icons.html -->
<svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <circle cx="12" cy="12" r="5"></circle>
    <line x1="12" y1="1" x2="12" y2="3"></line>
    <line x1="12" y1="21" x2="12" y2="23"></line>
    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
    <line x1="1" y1="12" x2="3" y2="12"></line>
    <line x1="21" y1="12" x2="23" y2="12"></line>
    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

<svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
    <path d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"></path>
</svg>
    </button>    

    <!-- Language Select Section -->
    
    
    
    
    
    
    

    
    <select id="languageSelect" class="button right-button">
        
        <option value="/feynman-en" >English</option>
        <option value="/feynman-zh" >中文</option>
        <option value="/feynman-ja" >日本語</option>
        <option value="/feynman-es" >Español</option>
        <option value="/feynman-hi" >हिंदी</option>
        <option value="/feynman-fr" selected>Français</option>
        <option value="/feynman-de" >Deutsch</option>
        <option value="/feynman-ar" >العربية</option>
        <option value="/feynman-hant" >繁體中文</option>
    </select>
  </div>

  <!-- Audio player for text-to-speech -->
  <div class="audio-container">
    <audio id="audioPlayer" controls loop style="display:none;">
      <source id="audioSource" src="" type="audio/mp3">
      Your browser does not support the audio element.
    </audio>
  </div>

  <hr>

  <h3 id="présentation-du-projet">Présentation du projet</h3>

<p>Commençons par un aperçu général du projet.</p>

<p><img src="assets/images/feynman/feynman_online.jpg" alt="feynman_online" /></p>

<p><img src="/assets/images/feynman/change.JPG" alt="changement" style="zoom:50%;" /></p>

<p><img src="assets/images/feynman/latex.JPG" alt="latex" /></p>

<p><img src="assets/images/feynman/epub_black.JPG" alt="epub_black" /></p>

<p><img src="assets/images/feynman/epub_beautiful.JPG" alt="epub_beautiful" /></p>

<p>Après avoir terminé le projet, je me sens un peu heureux. J’ai écrit ce passage.</p>

<p>Après une journée entière à coder, j’ai enfin obtenu un magnifique livre électronique des “Feynman Lectures on Physics” ! Les “Feynman Lectures on Physics” sont disponibles en ligne, rendues en <code class="language-plaintext highlighter-rouge">latex</code>. Les gens utilisent souvent <code class="language-plaintext highlighter-rouge">latex</code> pour écrire des articles, car il est excellent pour le rendu des formules mathématiques. Disponibles en ligne, elles utilisent la bibliothèque <code class="language-plaintext highlighter-rouge">mathjax</code>. Cela transforme le code source <code class="language-plaintext highlighter-rouge">latex</code> en code <code class="language-plaintext highlighter-rouge">html</code>, générant de nombreuses balises <code class="language-plaintext highlighter-rouge">div</code> et <code class="language-plaintext highlighter-rouge">span</code>. Cependant, les livres électroniques ne supportent pas cette méthode. L’idée était donc de scraper les pages web, de faire un rendu inverse de <code class="language-plaintext highlighter-rouge">mathjax</code>, puis de remplacer par des images <code class="language-plaintext highlighter-rouge">svg</code>. Plusieurs problèmes sont apparus : d’abord, le code source contient de nombreuses macros <code class="language-plaintext highlighter-rouge">latex</code> personnalisées qui doivent être ajoutées ; ensuite, l’intégration de nombreux <code class="language-plaintext highlighter-rouge">svg</code> pose des problèmes. Si un seul <code class="language-plaintext highlighter-rouge">svg</code> ne pose pas de problème, en revanche, plusieurs peuvent causer des soucis. C’est probablement un bug bizarre entre le navigateur et <code class="language-plaintext highlighter-rouge">svg</code>. La solution était donc de sauvegarder les <code class="language-plaintext highlighter-rouge">svg</code> en fichiers et de les inclure via des balises <code class="language-plaintext highlighter-rouge">img</code>. Les formules se divisent en deux types : celles qui sont au milieu du texte et celles qui sont sur une ligne à part. Ainsi, au final, j’ai obtenu un magnifique livre électronique !</p>

<h3 id="documentation-consultée">Documentation consultée</h3>

<p>Voici les ressources consultées pour résoudre les problèmes rencontrés lors du projet. Comme il s’agit d’un tutoriel, cela permet aux étudiants de voir à quoi ressemble l’expérience de réalisation d’un projet.</p>

<p><img src="assets/images/feynman/s1.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s2.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s3.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s4.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s5.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s6.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s7.PNG" alt="" /></p>

<p><img src="assets/images/feynman/s8.PNG" alt="" /></p>

<h3 id="démarrer-le-projet">Démarrer le projet</h3>

<p>Les cours de physique de Feynman sont désormais disponibles en ligne pour une lecture publique. Je souhaite les lire sur mon <code class="language-plaintext highlighter-rouge">Kindle</code>. Cependant, comme ils contiennent de nombreuses formules mathématiques, leur version originale a probablement été réalisée avec <code class="language-plaintext highlighter-rouge">LaTeX</code>. Ils utilisent la bibliothèque <code class="language-plaintext highlighter-rouge">MathJax</code> pour afficher le contenu au format <code class="language-plaintext highlighter-rouge">LaTeX</code> sur les pages web.</p>

<p>Voici un exemple.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax_Preview"</span> <span class="na">style=</span><span class="s">"color: inherit; display: none;"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"MathJax_Display"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax MathJax_FullWidth"</span> <span class="na">id=</span><span class="s">"MathJax-Element-10-Frame"</span> <span class="na">tabindex=</span><span class="s">"0"</span> <span class="na">style=</span><span class="s">""</span><span class="nt">&gt;</span>
              <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"mi"</span> <span class="na">id=</span><span class="s">"MathJax-Span-159"</span> <span class="na">style=</span><span class="s">"font-family: MathJax_Math-italic;"</span><span class="nt">&gt;</span>d<span class="nt">&lt;span</span> <span class="na">style=</span><span class="s">"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;/span&gt;</span>  
    <span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"math/tex; mode=display"</span> <span class="na">id=</span><span class="s">"MathJax-Element-10"</span><span class="nt">&gt;</span><span class="err">\</span><span class="nx">begin</span><span class="p">{</span><span class="nx">equation</span><span class="p">}</span>
<span class="err">\</span><span class="nx">label</span><span class="p">{</span><span class="nl">Eq</span><span class="p">:</span><span class="nl">I</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">3</span><span class="p">}</span>
<span class="nx">dT</span><span class="o">/</span><span class="nx">dt</span> <span class="o">=</span> <span class="nx">Fv</span><span class="p">.</span>
<span class="err">\</span><span class="nx">end</span><span class="p">{</span><span class="nx">equation</span><span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>Voici un extrait de code <code class="language-plaintext highlighter-rouge">html</code>. Dans ce bloc de code <code class="language-plaintext highlighter-rouge">html</code>, le texte brut <code class="language-plaintext highlighter-rouge">latex</code> se trouve sous la balise <code class="language-plaintext highlighter-rouge">script</code>. <code class="language-plaintext highlighter-rouge">mathjax</code> le transforme en de nombreuses balises <code class="language-plaintext highlighter-rouge">span</code> pour l’affichage.</p>

<p>Nous avons maintenant une idée. Il s’agit de modifier la méthode d’affichage de <code class="language-plaintext highlighter-rouge">mathjax</code> pour utiliser des images <code class="language-plaintext highlighter-rouge">svg</code>.</p>

<p>J’ai trouvé un projet sur GitHub appelé <code class="language-plaintext highlighter-rouge">tuxu/latex2svg</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">latex2svg</span> <span class="kn">import</span> <span class="n">latex2svg</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">latex2svg</span><span class="p">(</span><span class="sa">r</span><span class="s">'\( e^{i \pi} + 1 = 0 \)'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'depth'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">])</span>
</code></pre></div></div>

<p>Essayez de l’exécuter, mais une erreur s’est produite.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    raise RuntimeError<span class="o">(</span><span class="s1">'latex non trouvé'</span><span class="o">)</span>
RuntimeError: latex non trouvé
</code></pre></div></div>

<p>Regardons le code.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1"># Exécuter LaTeX et créer un fichier DVI
</span>    <span class="k">try</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">shlex</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s">'latex_cmd'</span><span class="p">]</span><span class="o">+</span><span class="s">' code.tex'</span><span class="p">),</span>
                             <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span>
                             <span class="n">cwd</span><span class="o">=</span><span class="n">working_directory</span><span class="p">)</span>
        <span class="n">ret</span><span class="p">.</span><span class="n">check_returncode</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">RuntimeError</span><span class="p">(</span><span class="s">'latex non trouvé'</span><span class="p">)</span>
</code></pre></div></div>

<p>Cela dépend également de la commande <code class="language-plaintext highlighter-rouge">latex</code>.</p>

<p>Installez-le.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew <span class="nb">install</span> <span class="nt">--cask</span> mactex
<span class="o">==&gt;</span> Caveats
Vous devez redémarrer votre fenêtre de terminal pour que l<span class="s1">'installation des outils CLI de MacTex prenne effet.
Alternativement, les utilisateurs de Bash et Zsh peuvent exécuter la commande :
  eval "$(/usr/libexec/path_helper)"
==&gt; Téléchargement de http://mirror.ctan.org/systems/mac/mactex/mactex-20200407.pkg
==&gt; Téléchargement depuis https://mirrors.aliyun.com/CTAN/systems/mac/mactex/mactex-20200407.pkg
######################################################################## 100.0%
Toutes les dépendances des formules sont satisfaites.
==&gt; Installation du Cask mactex
==&gt; Exécution de l'</span>installateur pour mactex <span class="p">;</span> votre mot de passe peut être nécessaire.
installer: Le nom <span class="nb">du </span>package est MacTeX
installer: fichier de modifications des choix <span class="s1">'/private/tmp/choices20210315-4643-5884ro.xml'</span> appliqué
installer: Installation au chemin de base /
installer: L<span class="s1">'installation a réussi.
🍺  mactex a été installé avec succès !
</span></code></pre></div></div>

<p>Installation réussie.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% latex
Ceci est pdfTeX, Version 3.14159265-2.6-1.40.21 <span class="o">(</span>TeX Live 2020<span class="o">)</span> <span class="o">(</span>format préchargé<span class="o">=</span>latex<span class="o">)</span>
 <span class="se">\w</span>rite18 restreint activé.
<span class="k">**</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">out</span> <span class="o">=</span> <span class="n">latex2svg</span><span class="p">(</span><span class="sa">r</span><span class="s">'\( e^{i \pi} + 1 = 0 \)'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'depth'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">svg</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'1.svg'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
<span class="n">svg</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">])</span>
<span class="n">svg</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>Il est maintenant possible de générer des <code class="language-plaintext highlighter-rouge">svg</code>.</p>

<p>Alors, essayons de générer tous les textes <code class="language-plaintext highlighter-rouge">latex</code> obtenus dans <code class="language-plaintext highlighter-rouge">mathjax</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">latex2svg</span> <span class="kn">import</span> <span class="n">latex2svg</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'The Feynman Lectures on Physics Vol. I Ch. 13_ Work and Potential Energy (A).html'</span><span class="p">)</span>
<span class="n">content</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mathjaxs</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">,</span> <span class="p">{</span><span class="s">'type'</span><span class="p">:</span> <span class="s">'math/tex'</span><span class="p">})</span>
<span class="k">for</span> <span class="n">mathjax</span> <span class="ow">in</span> <span class="n">mathjaxs</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">latex2svg</span><span class="p">(</span><span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">])</span>
</code></pre></div></div>

<p>Malheureusement, une erreur s’est produite.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">raise</span> <span class="n">CalledProcessError</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">returncode</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">stdout</span><span class="p">,</span>
<span class="n">subprocess</span><span class="p">.</span><span class="n">CalledProcessError</span><span class="p">:</span> <span class="n">La</span> <span class="n">commande</span> <span class="s">'['</span><span class="n">latex</span><span class="s">', '</span><span class="o">-</span><span class="n">interaction</span><span class="s">', '</span><span class="n">nonstopmode</span><span class="s">', '</span><span class="o">-</span><span class="n">halt</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">error</span><span class="s">', '</span><span class="n">code</span><span class="p">.</span><span class="n">tex</span><span class="s">']'</span> <span class="n">a</span> <span class="n">retourné</span> <span class="n">un</span> <span class="n">statut</span> <span class="n">de</span> <span class="n">sortie</span> <span class="n">non</span> <span class="n">nul</span> <span class="p">:</span> <span class="mf">1.</span>
</code></pre></div></div>

<p>Quelle formule exactement est incorrecte ?</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\tfrac</span><span class="p">{</span>1<span class="p">}{</span>2<span class="p">}</span>mv<span class="p">^</span>2
</code></pre></div></div>

<h2 id="latex">LaTeX</h2>

<p>LaTeX est un système de composition de documents largement utilisé dans les domaines académiques et scientifiques. Il permet de créer des documents de haute qualité avec une mise en page précise, en particulier pour les formules mathématiques complexes. Voici un exemple simple de code LaTeX pour créer un document de base :</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\documentclass</span><span class="p">{</span>article<span class="p">}</span>
<span class="k">\usepackage</span><span class="na">[utf8]</span><span class="p">{</span>inputenc<span class="p">}</span>

<span class="k">\title</span><span class="p">{</span>Exemple de document LaTeX<span class="p">}</span>
<span class="k">\author</span><span class="p">{</span>Auteur<span class="p">}</span>
<span class="k">\date</span><span class="p">{</span><span class="k">\today</span><span class="p">}</span>

<span class="nt">\begin{document}</span>

<span class="k">\maketitle</span>

<span class="k">\section</span><span class="p">{</span>Introduction<span class="p">}</span>
Ceci est un exemple de document LaTeX. Il montre comment structurer un document avec des sections, des sous-sections et des formules mathématiques.

<span class="k">\subsection</span><span class="p">{</span>Formules mathématiques<span class="p">}</span>
La formule de l'équation quadratique est donnée par :
<span class="p">\[</span><span class="nb">
x </span><span class="o">=</span><span class="nb"> </span><span class="nv">\frac</span><span class="p">{</span><span class="o">-</span><span class="nb">b </span><span class="nv">\pm</span><span class="nb"> </span><span class="nv">\sqrt</span><span class="p">{</span><span class="nb">b</span><span class="p">^</span><span class="m">2</span><span class="nb"> </span><span class="o">-</span><span class="nb"> </span><span class="m">4</span><span class="nb">ac</span><span class="p">}}{</span><span class="m">2</span><span class="nb">a</span><span class="p">}</span><span class="nb">
</span><span class="p">\]</span>

<span class="nt">\end{document}</span>
</code></pre></div></div>

<p>Ce code produit un document avec un titre, une introduction, et une formule mathématique. LaTeX est particulièrement utile pour les documents contenant des équations, des tableaux et des références croisées.</p>

<p>Apprenons un peu de <code class="language-plaintext highlighter-rouge">latex</code>.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\documentclass</span><span class="na">[12pt]</span><span class="p">{</span>article<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>lingmacros<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>tree-dvips<span class="p">}</span>
<span class="nt">\begin{document}</span>
</code></pre></div></div>

<p>\section*{Notes pour mon article}</p>

<p>N’oubliez pas d’inclure des exemples de topicalisation.
Ils ressemblent à ceci :</p>

<p>{\small
\enumsentence{Topicalisation à partir du sujet de la phrase :\ 
\shortex{7}{a John$_i$ [a &amp; kltukl &amp; [el &amp; 
  {\bf l-}oltoir &amp; er &amp; ngii$_i$ &amp; a Mary]]}
{ &amp; {\bf R-}clair &amp; {\sc comp} &amp; 
  {\bf IR}.{\sc 3s}-aimer   &amp; P &amp; lui &amp; }
{John, (c’est) clair que Mary l’aime.}}
}</p>

<p>\subsection*{Comment gérer la topicalisation}</p>

<p>Je vais simplement supposer une structure arborescente comme (\ex{1}).</p>

<p>{\small
\enumsentence{Structure des Projections de A$’$:\ [2ex]
\begin{tabular}[t]{cccc}
    &amp; \node{i}{CP}\ [2ex]
    \node{ii}{Spec} &amp;   &amp;\node{iii}{C$’$}\ [2ex]
        &amp;\node{iv}{C} &amp; &amp; \node{v}{SAgrP}
\end{tabular}
\nodeconnect{i}{ii}
\nodeconnect{i}{iii}
\nodeconnect{iii}{iv}
\nodeconnect{iii}{v}
}
}</p>

<p>\subsection*{Humeur}</p>

<p>Le mode change lorsqu’il y a un thème, ainsi que lorsqu’il y a un mouvement WH. \emph{Irrealis} est le mode lorsqu’il y a un thème non sujet ou une phrase WH dans Comp. \emph{Realis} est le mode lorsqu’il y a un thème sujet ou une phrase WH.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">\end{document}</span>
</code></pre></div></div>

<p>J’ai trouvé un exemple de code source <code class="language-plaintext highlighter-rouge">latex</code> sur Internet.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% latex code.tex
This is pdfTeX, Version 3.14159265-2.6-1.40.21 <span class="o">(</span>TeX Live 2020<span class="o">)</span> <span class="o">(</span>preloaded <span class="nv">format</span><span class="o">=</span>latex<span class="o">)</span>
 restricted <span class="se">\w</span>rite18 enabled.
entering extended mode
<span class="o">(</span>./code.tex
LaTeX2e &lt;2020-02-02&gt; patch level 5
L3 programming layer &lt;2020-03-06&gt;
<span class="o">(</span>/usr/local/texlive/2020/texmf-dist/tex/latex/base/article.cls
Document Class: article 2019/12/20 v1.4l Standard LaTeX document class
<span class="o">(</span>/usr/local/texlive/2020/texmf-dist/tex/latex/base/size12.clo<span class="o">))</span>
<span class="o">(</span>/usr/local/texlive/2020/texmf-dist/tex/latex/tree-dvips/lingmacros.sty<span class="o">)</span>
<span class="o">(</span>/usr/local/texlive/2020/texmf-dist/tex/latex/tree-dvips/tree-dvips.sty
tree-dvips version .91 of May 16, 1995
<span class="o">)</span> <span class="o">(</span>/usr/local/texlive/2020/texmf-dist/tex/latex/l3backend/l3backend-dvips.def<span class="o">)</span>
<span class="o">(</span>./code.aux<span class="o">)</span> <span class="o">[</span>1] <span class="o">(</span>./code.aux<span class="o">)</span> <span class="o">)</span>
Output written on code.dvi <span class="o">(</span>1 page, 3416 bytes<span class="o">)</span><span class="nb">.</span>
Transcript written on code.log.
</code></pre></div></div>

<p><img src="assets/images/feynman/latex.png" alt="latex" /></p>

<p>Examinons le code source et le rendu final pour voir ce que nous pouvons apprendre.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">\begin{document}</span>
<span class="nt">\end{document}</span>
</code></pre></div></div>

<p>Voici comment envelopper le document.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\section*</span><span class="p">{</span>Notes pour mon article<span class="p">}</span>
</code></pre></div></div>

<p>Cela indique le début du titre de la <code class="language-plaintext highlighter-rouge">section</code>.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\subsection*</span><span class="p">{</span>Comment gérer la topicalisation<span class="p">}</span>
</code></pre></div></div>

<p>Cela indique un sous-titre.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\shortex</span><span class="p">{</span>7<span class="p">}{</span>a John<span class="p">$_</span><span class="nb">i</span><span class="p">$</span> [a <span class="p">&amp;</span> kltukl <span class="p">&amp;</span> [el <span class="p">&amp;</span> 
  <span class="p">{</span><span class="k">\bf</span> l-<span class="p">}</span>oltoir <span class="p">&amp;</span> er <span class="p">&amp;</span> ngii<span class="p">$_</span><span class="nb">i</span><span class="p">$</span> <span class="p">&amp;</span> a Mary]]<span class="p">}</span>
</code></pre></div></div>

<p><img src="assets/images/feynman/shortex.png" alt="shortex" /></p>

<p>On peut voir <code class="language-plaintext highlighter-rouge">$_i$</code> pour représenter l’indice. <code class="language-plaintext highlighter-rouge">{\bf l-}</code> pour représenter le texte en gras.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\enumsentence</span><span class="p">{</span>Structure of A<span class="p">$</span><span class="nb">'</span><span class="p">$</span> Projections:<span class="k">\\</span> [2ex]
<span class="nt">\begin{tabular}</span>[t]<span class="p">{</span>cccc<span class="p">}</span>
    <span class="p">&amp;</span> <span class="k">\node</span><span class="p">{</span>i<span class="p">}{</span>CP<span class="p">}</span><span class="k">\\</span> [2ex]
    <span class="k">\node</span><span class="p">{</span>ii<span class="p">}{</span>Spec<span class="p">}</span> <span class="p">&amp;</span>   <span class="p">&amp;</span><span class="k">\node</span><span class="p">{</span>iii<span class="p">}{</span>C<span class="p">$</span><span class="nb">'</span><span class="p">$}</span><span class="k">\\</span> [2ex]
        <span class="p">&amp;</span><span class="k">\node</span><span class="p">{</span>iv<span class="p">}{</span>C<span class="p">}</span> <span class="p">&amp;</span> <span class="p">&amp;</span> <span class="k">\node</span><span class="p">{</span>v<span class="p">}{</span>SAgrP<span class="p">}</span>
<span class="nt">\end{tabular}</span>
<span class="k">\nodeconnect</span><span class="p">{</span>i<span class="p">}{</span>ii<span class="p">}</span>
<span class="k">\nodeconnect</span><span class="p">{</span>i<span class="p">}{</span>iii<span class="p">}</span>
<span class="k">\nodeconnect</span><span class="p">{</span>iii<span class="p">}{</span>iv<span class="p">}</span>
<span class="k">\nodeconnect</span><span class="p">{</span>iii<span class="p">}{</span>v<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/assets/images/feynman/node.png" alt="node" style="zoom:50%;" /></p>

<p>Notez que <code class="language-plaintext highlighter-rouge">nodeconnect</code> est utilisé pour représenter les connexions.</p>

<h3 id="conversion-de-latex-en-svg">Conversion de LaTeX en SVG</h3>

<p>La conversion de LaTeX en SVG (Scalable Vector Graphics) est une tâche courante pour ceux qui souhaitent intégrer des formules mathématiques ou des diagrammes complexes dans des pages web ou des présentations. SVG est un format vectoriel qui permet de redimensionner les images sans perte de qualité, ce qui le rend idéal pour les formules mathématiques.</p>

<p>Voici quelques méthodes pour convertir du LaTeX en SVG :</p>

<h4 id="1-utilisation-de-dvisvgm">1. Utilisation de <code class="language-plaintext highlighter-rouge">dvisvgm</code></h4>
<p><code class="language-plaintext highlighter-rouge">dvisvgm</code> est un outil en ligne de commande qui convertit les fichiers DVI (Device Independent) générés par LaTeX en fichiers SVG.</p>

<ol>
  <li>Compilez votre fichier LaTeX en DVI :
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>latex fichier.tex
</code></pre></div>    </div>
  </li>
  <li>Convertissez le fichier DVI en SVG :
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dvisvgm fichier.dvi
</code></pre></div>    </div>
  </li>
</ol>

<h4 id="2-utilisation-de-mathjax">2. Utilisation de <code class="language-plaintext highlighter-rouge">MathJax</code></h4>
<p><code class="language-plaintext highlighter-rouge">MathJax</code> est une bibliothèque JavaScript qui permet de rendre des formules mathématiques en LaTeX directement dans le navigateur. Vous pouvez également utiliser <code class="language-plaintext highlighter-rouge">MathJax</code> pour générer des fichiers SVG.</p>

<ol>
  <li>Incluez <code class="language-plaintext highlighter-rouge">MathJax</code> dans votre page HTML :
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://polyfill.io/v3/polyfill.min.js?features=es6"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">id=</span><span class="s">"MathJax-script"</span> <span class="na">async</span> <span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>Utilisez <code class="language-plaintext highlighter-rouge">MathJax</code> pour convertir une formule LaTeX en SVG :
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"math"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">MathJax</span><span class="p">.</span><span class="nx">tex2svgPromise</span><span class="p">(</span><span class="dl">'</span><span class="se">\\</span><span class="s1">frac{a}{b}</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">svg</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">math</span><span class="dl">'</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">svg</span><span class="p">);</span>
  <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>    </div>
  </li>
</ol>

<h4 id="3-utilisation-de-latexjs">3. Utilisation de <code class="language-plaintext highlighter-rouge">LaTeX.js</code></h4>
<p><code class="language-plaintext highlighter-rouge">LaTeX.js</code> est une bibliothèque JavaScript qui permet de compiler du LaTeX en HTML ou SVG directement dans le navigateur.</p>

<ol>
  <li>Incluez <code class="language-plaintext highlighter-rouge">LaTeX.js</code> dans votre page HTML :
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/latex.js/dist/latex.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>Utilisez <code class="language-plaintext highlighter-rouge">LaTeX.js</code> pour convertir une formule LaTeX en SVG :
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"math"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="kd">const</span> <span class="nx">latex</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LaTeX</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">latex</span><span class="p">.</span><span class="nx">toSVG</span><span class="p">(</span><span class="dl">'</span><span class="se">\\</span><span class="s1">frac{a}{b}</span><span class="dl">'</span><span class="p">);</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">math</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">;</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div>    </div>
  </li>
</ol>

<h4 id="4-utilisation-de-overleaf">4. Utilisation de <code class="language-plaintext highlighter-rouge">Overleaf</code></h4>
<p><code class="language-plaintext highlighter-rouge">Overleaf</code> est un éditeur LaTeX en ligne qui permet de compiler des documents LaTeX et de les exporter en différents formats, y compris SVG.</p>

<ol>
  <li>Créez un document LaTeX sur <code class="language-plaintext highlighter-rouge">Overleaf</code>.</li>
  <li>Compilez le document.</li>
  <li>Téléchargez le fichier PDF généré.</li>
  <li>Utilisez un outil comme <code class="language-plaintext highlighter-rouge">pdf2svg</code> pour convertir le PDF en SVG.</li>
</ol>

<h4 id="conclusion">Conclusion</h4>
<p>La conversion de LaTeX en SVG peut être réalisée de plusieurs manières, en fonction de vos besoins et de votre environnement de travail. Que vous utilisiez des outils en ligne de commande comme <code class="language-plaintext highlighter-rouge">dvisvgm</code>, des bibliothèques JavaScript comme <code class="language-plaintext highlighter-rouge">MathJax</code> ou <code class="language-plaintext highlighter-rouge">LaTeX.js</code>, ou des services en ligne comme <code class="language-plaintext highlighter-rouge">Overleaf</code>, vous avez plusieurs options pour intégrer des formules mathématiques en LaTeX dans vos projets web.</p>

<p>Continuer le projet.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\documentclass</span><span class="na">[16pt]</span><span class="p">{</span>article<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsmath<span class="p">}</span>
<span class="nt">\begin{document}</span>
</code></pre></div></div>

<p>[\tfrac{1}{2}mv^2]</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">\end{document}</span>
</code></pre></div></div>

<p><img src="/assets/images/feynman/frac.png" alt="frac" style="zoom:50%;" /></p>

<p>Cela peut être correctement rendu. Dans le code, il est possible que cela ne soit pas rendu correctement, peut-être parce que <code class="language-plaintext highlighter-rouge">\usepackage{amsmath}</code> n’a pas été ajouté.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\documentclass</span><span class="na">[12pt,preview]</span><span class="p">{</span>standalone<span class="p">}</span>
</code></pre></div></div>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\usepackage</span><span class="na">[utf8x]</span><span class="p">{</span>inputenc<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsmath<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsfonts<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amssymb<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>newtxtext<span class="p">}</span>
<span class="k">\usepackage</span><span class="na">[libertine]</span><span class="p">{</span>newtxmath<span class="p">}</span>
</code></pre></div></div>

<p>\begin{document}
\begin{preview}
\tfrac{1}{2}mv^2
\end{preview}
\end{document}</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
```shell
! Missing $ inserted.
&lt;inserted text&gt;
                $
l.12 \tfrac{1}{2}
                 mv^2
</code></pre></div></div>

<p><em>Note : Le message d’erreur est en anglais, il est donc laissé tel quel. La traduction en français serait :</em></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">!</span> <span class="nv">$ </span>manquant inséré.
&lt;texte inséré&gt;
                <span class="err">$</span>
l.12 <span class="se">\t</span>frac<span class="o">{</span>1<span class="o">}{</span>2<span class="o">}</span>
                 <span class="nb">mv</span>^2
</code></pre></div></div>

<p>Cela a causé une erreur. En revanche, en modifiant comme suit, cela fonctionne.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">\[</span><span class="nv">\tfrac</span><span class="p">{</span><span class="m">1</span><span class="p">}{</span><span class="m">2</span><span class="p">}</span><span class="nb">mv</span><span class="p">^</span><span class="m">2</span><span class="p">\]</span>
</code></pre></div></div>

<p>Effectuer diverses tentatives d’exploration.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">latex2svg</span> <span class="kn">import</span> <span class="n">latex2svg</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'The Feynman Lectures on Physics Vol. I Ch. 13_ Work and Potential Energy (A).html'</span><span class="p">)</span>
<span class="n">content</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mathjaxs</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">,</span> <span class="p">{</span><span class="s">'type'</span><span class="p">:</span> <span class="s">'math/tex'</span><span class="p">})</span>
<span class="k">for</span> <span class="n">mathjax</span> <span class="ow">in</span> <span class="n">mathjaxs</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">)</span>
    <span class="n">wrap</span> <span class="o">=</span> <span class="s">'$'</span> <span class="o">+</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span> <span class="o">+</span> <span class="s">'$'</span>
    <span class="c1"># if 'frac' in mathjax.string:
</span>    <span class="c1">#     wrap = '$' + mathjax.string + '$'
</span>    <span class="k">if</span> <span class="s">'FLP'</span> <span class="ow">in</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">elif</span> <span class="s">'Fig'</span> <span class="ow">in</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="k">elif</span> <span class="s">'eps'</span> <span class="ow">in</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">latex2svg</span><span class="p">(</span><span class="n">wrap</span><span class="p">)</span>
    <span class="c1"># print(out)
</span>    <span class="n">node</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">],</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>
    <span class="n">svg</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'svg'</span><span class="p">)</span>
    <span class="n">mathjax</span><span class="p">.</span><span class="n">insert_after</span><span class="p">(</span><span class="n">svg</span><span class="p">)</span>
    <span class="c1"># print(out['svg'])
</span>    <span class="c1"># break
</span>    <span class="c1"># mathjax.replaceWith(out['svg'])    
</span>    
    <span class="c1"># print(dir(mathjax))
</span>    <span class="c1"># break
</span>    
    <span class="c1"># out = latex2svg(wrap)    
</span>    <span class="c1"># print(out['svg'])
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># print(len(soup.contents))
</span>    
<span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'out.html'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
<span class="n">output_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">prettify</span><span class="p">())</span>
<span class="n">output_file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># print(soup.contents)
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># out = latex2svg(r'\( e^{i \pi} + 1 = 0 \)')
# print(out['depth'])
# print(out['svg'])
</span></code></pre></div></div>

<p>Traduction en français :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># out = latex2svg(r'\( e^{i \pi} + 1 = 0 \)')
# print(out['depth'])
# print(out['svg'])
</span></code></pre></div></div>

<p>Le code reste en anglais car il s’agit d’un exemple de code Python. Les commentaires et les noms de variables ne sont pas traduits.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># svg = open('1.svg', 'w')
# svg.write(out['svg'])
# svg.close()
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
En quoi est-ce que je suis en train de tâtonner ?

```python
    if 'FLP' in mathjax.string:
        continue
    elif 'Fig' in mathjax.string:
        continue
    elif 'eps' in mathjax.string:
        continue
</code></pre></div></div>

<p>Lors de l’analyse du code source <code class="language-plaintext highlighter-rouge">latex</code>, une erreur s’est produite lors du processus de conversion lorsqu’il a rencontré <code class="language-plaintext highlighter-rouge">FLP</code>, <code class="language-plaintext highlighter-rouge">Fig</code> ou <code class="language-plaintext highlighter-rouge">eps</code>.</p>

<p>Par exemple, dans le <code class="language-plaintext highlighter-rouge">HTML</code>, on peut trouver un script comme celui-ci :</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"math/tex"</span> <span class="na">id=</span><span class="s">"MathJax-Element-11"</span><span class="nt">&gt;</span><span class="err">\</span><span class="nx">FLPF</span><span class="err">\</span><span class="nx">cdot</span><span class="err">\</span><span class="nx">FLPv</span><span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>Analyse des résultats obtenus :</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\FLPF\cdot\FLPv</span>
</code></pre></div></div>

<p><em>Note : Le code LaTeX ci-dessus n’a pas été traduit car il s’agit d’une notation mathématique standard. La traduction de formules mathématiques n’est généralement pas nécessaire, car elles sont universellement comprises dans leur forme originale.</em></p>

<p>Lors de la conversion dans le code, une erreur s’est produite. Plus précisément, <code class="language-plaintext highlighter-rouge">latex2svg.py</code> a échoué. Ici, nous utilisons le programme <code class="language-plaintext highlighter-rouge">latex</code> pour effectuer la conversion.</p>

<p><code class="language-plaintext highlighter-rouge">code.tex</code> :</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\documentclass</span><span class="na">[12pt,preview]</span><span class="p">{</span>standalone<span class="p">}</span>
</code></pre></div></div>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\usepackage</span><span class="na">[utf8x]</span><span class="p">{</span>inputenc<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsmath<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsfonts<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amssymb<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>newtxtext<span class="p">}</span>
<span class="k">\usepackage</span><span class="na">[libertine]</span><span class="p">{</span>newtxmath<span class="p">}</span>
</code></pre></div></div>

<p>\begin{document}
\begin{preview}
\begin{equation}
    \FLPF\cdot\FLPv
\end{equation}
\end{preview}
\end{document}</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
```shell
$latex code.tex
! Séquence de contrôle non définie.
l.13     \FLPF
              \cdot\FLPv
?
</code></pre></div></div>

<p>Quel était donc ce problème ? Ce n’est que plus tard que j’ai remarqué ce morceau de code dans le fichier <code class="language-plaintext highlighter-rouge">html</code>.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/x-mathjax-config;executed=true"</span><span class="nt">&gt;</span>
      <span class="nx">MathJax</span><span class="p">.</span><span class="nx">Hub</span><span class="p">.</span><span class="nx">Config</span><span class="p">({</span>
        <span class="na">TeX</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">Macros</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">FLPvec</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">boldsymbol{#1}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="na">Figvec</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">mathbf{#1}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="na">FLPC</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{C}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FLPF</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{F}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FLPa</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{a}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FLPb</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{b}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FLPr</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{r}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FLPs</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{s}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FLPv</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">FLPvec{v}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">ddt</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">frac{d#1}{d#2}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="na">epsO</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">epsilon_0</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="na">FigC</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="se">\\</span><span class="s2">Figvec{C}</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>Cela signifie que lors du rendu de la page web, des macros ont été définies pour <code class="language-plaintext highlighter-rouge">MathJax</code>. Par conséquent, nous devrions également les ajouter dans notre code source de conversion <code class="language-plaintext highlighter-rouge">latex</code>. Ajoutons-les.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\documentclass</span><span class="na">[12pt,preview]</span><span class="p">{</span>standalone<span class="p">}</span>
</code></pre></div></div>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\usepackage</span><span class="na">[utf8x]</span><span class="p">{</span>inputenc<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsmath<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amsfonts<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>amssymb<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>newtxtext<span class="p">}</span>
<span class="k">\usepackage</span><span class="na">[libertine]</span><span class="p">{</span>newtxmath<span class="p">}</span>
</code></pre></div></div>

<p>\newcommand{\FLPvec}[1]{\boldsymbol{#1}}
\newcommand{\Figvec}[1]{\mathbf{#1}}
\newcommand{\FLPC}{\FLPvec{C}}
\newcommand{\FLPF}{\FLPvec{F}}
\newcommand{\FLPa}{\FLPvec{a}}
\newcommand{\FLPb}{\FLPvec{a}}
\newcommand{\FLPr}{\FLPvec{r}}
\newcommand{\FLPs}{\FLPvec{s}}
\newcommand{\FLPv}{\FLPvec{v}}
\newcommand{\ddt}[2]{\frac{d#1}{d#2}}
\newcommand{\epsO}{\epsilon_0}
\newcommand{\FigC}{\Figvec{C}}
\begin{document}
\begin{preview}
\begin{equation}
    \FLPF\cdot\FLPv
\end{equation}
\end{preview}
\end{document}</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
C'est comme ça qu'il faut faire.

![fv1](assets/images/feynman/fv1.png)

### Analyse du code

Voici le code final :

```python
import subprocess
from bs4 import BeautifulSoup
from latex2svg import latex2svg
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cls</span><span class="p">):</span>
    <span class="n">previews</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="n">cls</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">preview</span> <span class="ow">in</span> <span class="n">previews</span><span class="p">:</span>
        <span class="n">preview</span><span class="p">.</span><span class="n">decompose</span><span class="p">()</span>
        
<span class="k">def</span> <span class="nf">clean_script</span><span class="p">(</span><span class="n">soup</span><span class="p">):</span>
    <span class="n">scripts</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scripts</span><span class="p">:</span>
        <span class="n">s</span><span class="p">.</span><span class="n">decompose</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">wrap_latex</span><span class="p">(</span><span class="n">mathjax</span><span class="p">,</span> <span class="n">equation</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="n">wrap</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">if</span> <span class="n">equation</span><span class="p">:</span>
        <span class="n">wrap</span> <span class="o">=</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wrap</span> <span class="o">=</span> <span class="s">'$'</span> <span class="o">+</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span> <span class="o">+</span> <span class="s">'$'</span>
    <span class="n">wrap</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'label'</span><span class="p">,</span> <span class="s">'tag'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrap</span>
 
<span class="k">def</span> <span class="nf">wrap_svg</span><span class="p">(</span><span class="n">svg</span><span class="p">,</span> <span class="n">equation</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">equation</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="sa">f</span><span class="s">'&lt;div style="text-align:center;"&gt;&lt;/div&gt;'</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>
        <span class="n">p</span><span class="p">.</span><span class="n">div</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">svg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">.</span><span class="n">div</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">svg</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">to_svg</span><span class="p">(</span><span class="n">mathjaxs</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">equation</span><span class="p">:</span>
        <span class="n">svg_prefix</span> <span class="o">=</span> <span class="s">'eq_'</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_prefix</span> <span class="o">=</span> <span class="s">'in_'</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">mathjax</span> <span class="ow">in</span> <span class="n">mathjaxs</span><span class="p">:</span>     
        <span class="k">print</span><span class="p">(</span><span class="n">mathjax</span><span class="p">.</span><span class="n">string</span><span class="p">)</span>
        <span class="n">wrap</span> <span class="o">=</span> <span class="n">wrap_latex</span><span class="p">(</span><span class="n">mathjax</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="n">equation</span><span class="p">)</span>   
        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">latex2svg</span><span class="p">(</span><span class="n">wrap</span><span class="p">)</span>   
        <span class="k">except</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">err</span>      
            
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s">'svgs/</span><span class="si">{</span><span class="n">svg_prefix</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s">.svg'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
        <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">])</span>
        <span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        
        <span class="n">node</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="s">'&lt;img&gt;'</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'img'</span><span class="p">)</span>
        <span class="n">img</span><span class="p">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">'src'</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'./svgs/</span><span class="si">{</span><span class="n">svg_prefix</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s">.svg'</span>
        <span class="n">img</span><span class="p">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">'style'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'vertical-align: middle; margin: 0.5em 0;'</span>
        
        <span class="n">p</span> <span class="o">=</span> <span class="n">wrap_svg</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">equation</span><span class="p">)</span>
        <span class="n">mathjax</span><span class="p">.</span><span class="n">insert_after</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span><span class="mi">1</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>    
    <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'The Feynman Lectures on Physics Vol. I Ch. 13_ Work and Potential Energy (A).html'</span><span class="p">)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
    
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>
    <span class="n">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="s">'span'</span><span class="p">,</span> <span class="s">'MathJax'</span><span class="p">)</span>
    <span class="n">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="s">'div'</span><span class="p">,</span> <span class="s">'MathJax_Display'</span><span class="p">)</span>
    <span class="n">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="s">'span'</span><span class="p">,</span> <span class="s">'MathJax_Preview'</span><span class="p">)</span>
    
    <span class="n">mathjaxs</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">,</span> <span class="p">{</span><span class="s">'type'</span><span class="p">:</span> <span class="s">'math/tex'</span><span class="p">})</span>
    <span class="n">to_svg</span><span class="p">(</span><span class="n">mathjaxs</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    
    <span class="n">mathjaxs</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">,</span> <span class="p">{</span><span class="s">'type'</span><span class="p">:</span> <span class="s">'math/tex; mode=display'</span><span class="p">})</span>   
    <span class="n">to_svg</span><span class="p">(</span><span class="n">mathjaxs</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="n">clean_script</span><span class="p">(</span><span class="n">soup</span><span class="p">)</span>
    
    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'out.html'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
    <span class="n">output_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">prettify</span><span class="p">())</span>
    <span class="n">output_file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>    
</code></pre></div></div>

<p>main()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Lorsque nous souhaitons convertir un livre électronique entier, nous pouvons d'abord essayer avec une seule page.

```python
    file = open('The Feynman Lectures on Physics Vol. I Ch. 13_ Work and Potential Energy (A).html')
    content = file.read()
</code></pre></div></div>

<p>Voici où vous pouvez télécharger une page.</p>

<p><code class="language-plaintext highlighter-rouge">MathJax</code> génère de nombreux éléments <code class="language-plaintext highlighter-rouge">div</code> et <code class="language-plaintext highlighter-rouge">span</code>. Par exemple, pour l’expression <code class="language-plaintext highlighter-rouge">T+U=const</code>, MathJax la génère de cette manière.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax"</span><span class="nt">&gt;</span>T<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax"</span><span class="nt">&gt;</span>+<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax"</span><span class="nt">&gt;</span>U<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax"</span><span class="nt">&gt;</span>=<span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"MathJax"</span><span class="nt">&gt;</span>const<span class="nt">&lt;/span&gt;</span>
</code></pre></div></div>

<p>Ces éléments sont gênants et peuvent perturber notre texte. Puisque nous avons déjà des <code class="language-plaintext highlighter-rouge">svg</code>, nous n’avons pas besoin de ceux-ci.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">cls</span><span class="p">):</span>
    <span class="n">previews</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="n">cls</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">preview</span> <span class="ow">in</span> <span class="n">previews</span><span class="p">:</span>
        <span class="n">preview</span><span class="p">.</span><span class="n">decompose</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="s">'span'</span><span class="p">,</span> <span class="s">'MathJax'</span><span class="p">)</span>
    <span class="n">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="s">'div'</span><span class="p">,</span> <span class="s">'MathJax_Display'</span><span class="p">)</span>
    <span class="n">clean_mathjax</span><span class="p">(</span><span class="n">soup</span><span class="p">,</span> <span class="s">'span'</span><span class="p">,</span> <span class="s">'MathJax_Preview'</span><span class="p">)</span>
</code></pre></div></div>

<p>Supprimez-les tous.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">mathjaxs</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">,</span> <span class="p">{</span><span class="s">'type'</span><span class="p">:</span> <span class="s">'math/tex'</span><span class="p">})</span>
    <span class="n">to_svg</span><span class="p">(</span><span class="n">mathjaxs</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    
    <span class="n">mathjaxs</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">,</span> <span class="p">{</span><span class="s">'type'</span><span class="p">:</span> <span class="s">'math/tex; mode=display'</span><span class="p">})</span>   
    <span class="n">to_svg</span><span class="p">(</span><span class="n">mathjaxs</span><span class="p">,</span> <span class="n">equation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>Notez qu’il y a deux types de <code class="language-plaintext highlighter-rouge">script</code> ici.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>m(dv/dt)=F
</code></pre></div></div>

<p><em>Note :</em> L’équation est en notation mathématique standard et ne nécessite pas de traduction. Elle représente la deuxième loi de Newton, où ( m ) est la masse, ( \frac{dv}{dt} ) est l’accélération, et ( F ) est la force.</p>

<p>Voici la forme intégrée.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">\begin{equation}</span>
<span class="k">\underset</span><span class="p">{</span><span class="k">\text</span><span class="p">{</span>Énergie cinétique<span class="p">}}{</span><span class="k">\tfrac</span><span class="p">{</span>1<span class="p">}{</span>2<span class="p">}</span>mv<span class="p">^</span>2<span class="p">}</span>+
<span class="k">\underset</span><span class="p">{</span><span class="k">\text</span><span class="p">{</span>Énergie potentielle<span class="p">}}{</span><span class="k">\vphantom</span><span class="p">{</span><span class="k">\tfrac</span><span class="p">{</span>1<span class="p">}{</span>2<span class="p">}}</span>mgh<span class="p">}</span>=<span class="k">\text</span><span class="p">{</span>constante<span class="p">}</span>,<span class="k">\notag</span>
</code></pre></div></div>

<p>Ceci est sous forme de paragraphe.</p>

<p>Lors de l’utilisation de la forme intégrée, la conversion doit être entourée de <code class="language-plaintext highlighter-rouge">$</code> ou de <code class="language-plaintext highlighter-rouge">[]</code> de part et d’autre de l’expression. Sinon, des erreurs peuvent survenir.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">\begin{document}</span>
<span class="nt">\begin{preview}</span>
<span class="k">\tfrac</span><span class="p">{</span>1<span class="p">}{</span>2<span class="p">}</span>mv<span class="p">^</span>2
<span class="nt">\end{preview}</span>
<span class="nt">\end{document}</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">!</span> Missing <span class="nv">$ </span>inserted.
&lt;inserted text&gt;
                <span class="err">$</span>
l.26 <span class="se">\t</span>frac<span class="o">{</span>1<span class="o">}{</span>2<span class="o">}</span>
                 <span class="nb">mv</span>^2
</code></pre></div></div>

<p><em>Note : Le message d’erreur est en anglais et ne nécessite pas de traduction, car il s’agit d’un message technique lié à LaTeX. Cependant, voici une explication en français :</em></p>

<p><strong>Explication :</strong><br />
Cette erreur LaTeX indique qu’un symbole <code class="language-plaintext highlighter-rouge">$</code> est manquant. Dans LaTeX, les expressions mathématiques doivent être encadrées par des symboles <code class="language-plaintext highlighter-rouge">$</code> (pour le mode mathématique en ligne) ou <code class="language-plaintext highlighter-rouge">$$</code> (pour le mode mathématique centré). Ici, l’expression <code class="language-plaintext highlighter-rouge">\tfrac{1}{2} mv^2</code> doit être placée entre <code class="language-plaintext highlighter-rouge">$</code> pour être correctement interprétée. Par exemple :</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">$</span><span class="nv">\tfrac</span><span class="p">{</span><span class="m">1</span><span class="p">}{</span><span class="m">2</span><span class="p">}</span><span class="nb"> mv</span><span class="p">^</span><span class="m">2</span><span class="p">$</span>
</code></pre></div></div>

<p>Cela résoudra l’erreur.</p>

<p>Il faut le modifier comme ceci :</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">\begin{document}</span>
<span class="nt">\begin{preview}</span>
<span class="p">$</span><span class="nv">\tfrac</span><span class="p">{</span><span class="m">1</span><span class="p">}{</span><span class="m">2</span><span class="p">}</span><span class="nb">mv</span><span class="p">^</span><span class="m">2</span><span class="p">$</span>
<span class="nt">\end{preview}</span>
<span class="nt">\end{document}</span>
</code></pre></div></div>

<p>Voyons ensuite comment convertir <code class="language-plaintext highlighter-rouge">latex</code> en <code class="language-plaintext highlighter-rouge">svg</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">if</span> <span class="n">equation</span><span class="p">:</span>
        <span class="n">svg_prefix</span> <span class="o">=</span> <span class="s">'eq_'</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_prefix</span> <span class="o">=</span> <span class="s">'in_'</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% tree svgs
svgs
├── eq_0.svg
├── eq_1.svg
├── in_0.svg
</code></pre></div></div>

<p>Voici comment enregistrer un fichier <code class="language-plaintext highlighter-rouge">svg</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">wrap_latex</span><span class="p">(</span><span class="n">mathjax</span><span class="p">,</span> <span class="n">equation</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="n">wrap</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">if</span> <span class="n">equation</span><span class="p">:</span>
        <span class="n">wrap</span> <span class="o">=</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wrap</span> <span class="o">=</span> <span class="s">'$'</span> <span class="o">+</span> <span class="n">mathjax</span><span class="p">.</span><span class="n">string</span> <span class="o">+</span> <span class="s">'$'</span>
    <span class="n">wrap</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'label'</span><span class="p">,</span> <span class="s">'tag'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrap</span>
</code></pre></div></div>

<p>Voici quelques ajustements apportés au code source <code class="language-plaintext highlighter-rouge">latex</code>. Notez que <code class="language-plaintext highlighter-rouge">label</code> est devenu <code class="language-plaintext highlighter-rouge">tag</code>.</p>

<p><img src="assets/images/feynman/tag.png" alt="tag" /></p>

<p>Remarquez à droite le <code class="language-plaintext highlighter-rouge">(Eq:I:13:14)</code>. S’il s’agissait d’un <code class="language-plaintext highlighter-rouge">label</code>, il n’aurait pas été correctement interprété. Cela afficherait <code class="language-plaintext highlighter-rouge">(1)</code>. Ici, nous utilisons temporairement <code class="language-plaintext highlighter-rouge">tag</code> pour représenter cela, sans approfondir davantage pour le moment.</p>

<p>Ensuite, on procède à l’appel de <code class="language-plaintext highlighter-rouge">latex2svg.py</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">latex2svg</span><span class="p">(</span><span class="n">wrap</span><span class="p">)</span>   
        <span class="k">except</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">err</span>    
</code></pre></div></div>

<p>Regardez <code class="language-plaintext highlighter-rouge">latex2svg.py</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1"># Exécuter LaTeX et créer un fichier DVI
</span>    <span class="k">try</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">shlex</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s">'latex_cmd'</span><span class="p">]</span><span class="o">+</span><span class="s">' code.tex'</span><span class="p">),</span>
                             <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span>
                             <span class="n">cwd</span><span class="o">=</span><span class="n">working_directory</span><span class="p">)</span>
        <span class="n">ret</span><span class="p">.</span><span class="n">check_returncode</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">RuntimeError</span><span class="p">(</span><span class="s">'latex non trouvé'</span><span class="p">)</span>
</code></pre></div></div>

<p>Ici, nous appelons la commande <code class="language-plaintext highlighter-rouge">latex</code>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code> % latex <span class="nt">--help</span>
Usage: pdftex <span class="o">[</span>OPTION]... <span class="o">[</span>TEXNAME[.tex]] <span class="o">[</span>COMMANDS]
   or: pdftex <span class="o">[</span>OPTION]... <span class="se">\F</span>IRST-LINE
   or: pdftex <span class="o">[</span>OPTION]... &amp;FMT ARGS
  Exécute pdfTeX sur TEXNAME, créant généralement TEXNAME.pdf.
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">try</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">shlex</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s">'dvisvgm_cmd'</span><span class="p">]</span><span class="o">+</span><span class="s">' code.dvi'</span><span class="p">),</span>
                             <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span>
                             <span class="n">cwd</span><span class="o">=</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">)</span>
        <span class="n">ret</span><span class="p">.</span><span class="n">check_returncode</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">RuntimeError</span><span class="p">(</span><span class="s">'dvisvgm non trouvé'</span><span class="p">)</span>
</code></pre></div></div>

<p>Ici, on appelle la commande <code class="language-plaintext highlighter-rouge">dvisvgm</code>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>% dvisvgm
dvisvgm 2.9.1
</code></pre></div></div>

<p>Ce programme convertit les fichiers DVI, tels que ceux créés par TeX/LaTeX, ainsi que les fichiers EPS et PDF, au format de graphiques vectoriels évolutifs basé sur XML, SVG.</p>

<p>Utilisation : dvisvgm [options] fichier_dvi
       dvisvgm –eps [options] fichier_eps
       dvisvgm –pdf [options] fichier_pdf</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Où écrire les macros personnalisées `latex` mentionnées ci-dessus ? Il faut modifier ici le fichier `latex2svg.py`. Modifiez le `default_preamble`.

```python
default_preamble = r"""
\usepackage[utf8x]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{newtxtext}
\usepackage[libertine]{newtxmath}

\newcommand{\FLPvec}[1]{\boldsymbol{#1}}
\newcommand{\Figvec}[1]{\mathbf{#1}}
\newcommand{\FLPC}{\FLPvec{C}}
\newcommand{\FLPF}{\FLPvec{F}}
\newcommand{\FLPa}{\FLPvec{a}}
\newcommand{\FLPb}{\FLPvec{a}}
\newcommand{\FLPr}{\FLPvec{r}}
\newcommand{\FLPs}{\FLPvec{s}}
\newcommand{\FLPv}{\FLPvec{v}}
\newcommand{\ddt}[2]{\frac{d#1}{d#2}}
\newcommand{\epsO}{\epsilon_0}
\newcommand{\FigC}{\Figvec{C}}
"""
</code></pre></div></div>

<p>Une fois la conversion réussie, écrivez dans le fichier.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s">'svgs/</span><span class="si">{</span><span class="n">svg_prefix</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s">.svg'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
        <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">'svg'</span><span class="p">])</span>
        <span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p>Continuez.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="n">node</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="s">'&lt;img&gt;'</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'img'</span><span class="p">)</span>
        <span class="n">img</span><span class="p">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">'src'</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s">'./svgs/</span><span class="si">{</span><span class="n">svg_prefix</span><span class="si">}{</span><span class="n">i</span><span class="si">}</span><span class="s">.svg'</span>
        <span class="n">img</span><span class="p">.</span><span class="n">attrs</span><span class="p">[</span><span class="s">'style'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'vertical-align: middle; margin: 0.5em 0;'</span>
</code></pre></div></div>

<p>Voici comment construire une balise <code class="language-plaintext highlighter-rouge">img</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">wrap_svg</span><span class="p">(</span><span class="n">svg</span><span class="p">,</span> <span class="n">equation</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">equation</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="sa">f</span><span class="s">'&lt;div style="text-align:center;"&gt;&lt;/div&gt;'</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s">"lxml"</span><span class="p">)</span>
        <span class="n">p</span><span class="p">.</span><span class="n">div</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">svg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p</span><span class="p">.</span><span class="n">div</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">svg</span>
      
<span class="n">p</span> <span class="o">=</span> <span class="n">wrap_svg</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">equation</span><span class="p">)</span>
</code></pre></div></div>

<p>Si c’est un <code class="language-plaintext highlighter-rouge">latex</code> sur une seule ligne, alors enveloppez-le avec une <code class="language-plaintext highlighter-rouge">div</code> et centrez-le.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mathjax</span><span class="p">.</span><span class="n">insert_after</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</code></pre></div></div>

<p>Ici, on ajoute la balise <code class="language-plaintext highlighter-rouge">div</code> ou la balise <code class="language-plaintext highlighter-rouge">img</code> après le <code class="language-plaintext highlighter-rouge">script</code> d’origine.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">clean_script</span><span class="p">(</span><span class="n">soup</span><span class="p">):</span>
    <span class="n">scripts</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">findAll</span><span class="p">(</span><span class="s">'script'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scripts</span><span class="p">:</span>
        <span class="n">s</span><span class="p">.</span><span class="n">decompose</span><span class="p">()</span>    
        
<span class="n">clean_script</span><span class="p">(</span><span class="n">soup</span><span class="p">)</span>
</code></pre></div></div>

<p>Après avoir remplacé tous les <code class="language-plaintext highlighter-rouge">latex</code> par des <code class="language-plaintext highlighter-rouge">svg</code>, vous n’avez plus besoin des <code class="language-plaintext highlighter-rouge">script</code>. Supprimez-les pour un code plus propre.</p>

<p>Enfin, écrivez le <code class="language-plaintext highlighter-rouge">html</code> modifié dans son intégralité dans un fichier.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'out.html'</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span>
    <span class="n">output_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">prettify</span><span class="p">())</span>
    <span class="n">output_file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>    
</code></pre></div></div>

<p>Ensuite, utilisez l’outil <code class="language-plaintext highlighter-rouge">pandoc</code> pour convertir en <code class="language-plaintext highlighter-rouge">epub</code>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pandoc <span class="nt">-s</span> <span class="nt">-r</span> html out.html <span class="nt">-o</span> feynman.epub
</code></pre></div></div>

<p>Cela ouvrira un bel ebook.</p>

<p>Pourquoi ne pas directement intégrer la balise <code class="language-plaintext highlighter-rouge">svg</code> au lieu d’utiliser <code class="language-plaintext highlighter-rouge">img</code> pour l’inclure ? Autrement dit, pourquoi écrire ceci :</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;p&gt;&lt;/p&gt;</span>
<span class="nt">&lt;svg&gt;&lt;/svg&gt;</span>
<span class="nt">&lt;p&gt;&lt;/p&gt;</span>
</code></pre></div></div>

<p>Il y a un <code class="language-plaintext highlighter-rouge">bug</code> très étrange. Lorsqu’il y a beaucoup de <code class="language-plaintext highlighter-rouge">svg</code>, une situation comme celle-ci peut se produire.</p>

<p><img src="/assets/images/feynman/svg_p1.png" alt="svg_p1" style="zoom:40%;" /></p>

<p>J’ai découvert plus tard qu’il suffisait d’utiliser la balise <code class="language-plaintext highlighter-rouge">img</code> pour l’intégrer. Quant à la raison pour laquelle cela fonctionne ainsi, je n’ai pas vraiment compris. Lorsque j’ai extrait ce <code class="language-plaintext highlighter-rouge">svg</code> individuel et que je l’ai visualisé dans le navigateur, il n’y avait aucun problème. Il semble donc que l’erreur se produit lorsque le navigateur essaie de rendre un très grand nombre de <code class="language-plaintext highlighter-rouge">svg</code> à la fois.</p>

<h3 id="enfin">Enfin</h3>

<p>Quant à la conversion d’un fichier <code class="language-plaintext highlighter-rouge">epub</code> en <code class="language-plaintext highlighter-rouge">mobi</code>, vous pouvez utiliser l’outil officiel de <code class="language-plaintext highlighter-rouge">Kindle</code>, <code class="language-plaintext highlighter-rouge">Kindle Previewer 3</code>. Notez qu’il s’agit ici d’un seul chapitre.</p>

<p>Le code du projet se trouve sur <a href="https://github.com/lzwjava/feynman-lectures-mobi">feynman-lectures-mobi@lzwjava</a>.</p>

<p>Comment capturer et organiser toutes les pages pour en faire un livre électronique ? Nous en parlerons plus tard. Mais pour l’instant, ce chapitre des “Leçons de physique de Feynman” est déjà suffisant pour vous occuper. Alors, prenons notre Kindle et commençons à lire.</p>


  <hr>

  <div class="button-container">
    <a href="/" class="button left-button">Back</a>


    

    
    
    <a href="/donate-fr" class="button right-button">Donate</a>
  </div>
</main>

<script src="/assets/js/dark-mode.js"></script>
<script src="/assets/js/audio.js" defer></script>
<script src="/assets/js/pdf.js" defer></script>
<script>
    document.getElementById('languageSelect').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue) {
            window.location.href = selectedValue;
        }
    });
</script>

</body>

</html>
